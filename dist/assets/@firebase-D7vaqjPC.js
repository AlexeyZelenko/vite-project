import{_ as V,a as at,b as Ot,c as gt,d as A,e as C,f as ve}from"./tslib-D8iC_YxN.js";import{o as tO}from"./idb-Bj22Fb4p.js";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var PE={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var L=function(t,e){if(!t)throw vs(e)},vs=function(t){return new Error("Firebase Database ("+PE.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xE=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var o=t.charCodeAt(r);o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=o&63|128):(o&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(o=65536+((o&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=o&63|128):(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=o&63|128)}return e},nO=function(t){for(var e=[],n=0,r=0;n<t.length;){var o=t[n++];if(o<128)e[r++]=String.fromCharCode(o);else if(o>191&&o<224){var s=t[n++];e[r++]=String.fromCharCode((o&31)<<6|s&63)}else if(o>239&&o<365){var s=t[n++],u=t[n++],l=t[n++],h=((o&7)<<18|(s&63)<<12|(u&63)<<6|l&63)-65536;e[r++]=String.fromCharCode(55296+(h>>10)),e[r++]=String.fromCharCode(56320+(h&1023))}else{var s=t[n++],u=t[n++];e[r++]=String.fromCharCode((o&15)<<12|(s&63)<<6|u&63)}}return e.join("")},ag={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],o=0;o<t.length;o+=3){var s=t[o],u=o+1<t.length,l=u?t[o+1]:0,h=o+2<t.length,d=h?t[o+2]:0,p=s>>2,g=(s&3)<<4|l>>4,y=(l&15)<<2|d>>6,w=d&63;h||(w=64,u||(y=64)),r.push(n[p],n[g],n[y],n[w])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(xE(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):nO(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],o=0;o<t.length;){var s=n[t.charAt(o++)],u=o<t.length,l=u?n[t.charAt(o)]:0;++o;var h=o<t.length,d=h?n[t.charAt(o)]:64;++o;var p=o<t.length,g=p?n[t.charAt(o)]:64;if(++o,s==null||l==null||d==null||g==null)throw Error();var y=s<<2|l>>4;if(r.push(y),d!==64){var w=l<<4&240|d>>2;if(r.push(w),g!==64){var b=d<<6&192|g;r.push(b)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},LE=function(t){var e=xE(t);return ag.encodeByteArray(e,!0)},a0=function(t){return LE(t).replace(/\./g,"")},u0=function(t){try{return ag.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ME(t){return Fa(void 0,t)}function Fa(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:var n=e;return new Date(n.getTime());case Object:t===void 0&&(t={});break;case Array:t=[];break;default:return e}for(var r in e)!e.hasOwnProperty(r)||!rO(r)||(t[r]=Fa(t[r],e[r]));return t}function rO(t){return t!=="__proto__"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ut=function(){function t(){var e=this;this.reject=function(){},this.resolve=function(){},this.promise=new Promise(function(n,r){e.resolve=n,e.reject=r})}return t.prototype.wrapCallback=function(e){var n=this;return function(r,o){r?n.reject(r):n.resolve(o),typeof e=="function"&&(n.promise.catch(function(){}),e.length===1?e(r):e(r,o))}},t}();/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ug(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');var n={alg:"none",type:"JWT"},r=e||"demo-project",o=t.iat||0,s=t.sub||t.user_id;if(!s)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");var u=at({iss:"https://securetoken.google.com/"+r,aud:r,iat:o,exp:o+3600,auth_time:o,sub:s,user_id:s,firebase:{sign_in_provider:"custom",identities:{}}},t),l="";return[a0(JSON.stringify(n)),a0(JSON.stringify(u)),l].join(".")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vi(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function cg(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(Vi())}function FE(){try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function iO(){return typeof self=="object"&&self.self===self}function lg(){var t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function UE(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function oO(){return Vi().indexOf("Electron/")>=0}function sO(){var t=Vi();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function aO(){return Vi().indexOf("MSAppHost/")>=0}function VE(){return PE.NODE_ADMIN===!0}function uO(){return!FE()&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function jE(){return"indexedDB"in self&&indexedDB!=null}function BE(){return new Promise(function(t,e){try{var n=!0,r="validate-browser-context-for-indexeddb-analytics-module",o=self.indexedDB.open(r);o.onsuccess=function(){o.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},o.onupgradeneeded=function(){n=!1},o.onerror=function(){var s;e(((s=o.error)===null||s===void 0?void 0:s.message)||"")}}catch(s){e(s)}})}function qE(){return!(!navigator||!navigator.cookieEnabled)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cO="FirebaseError",Ql=function(t){V(e,t);function e(n,r,o){var s=t.call(this,r)||this;return s.code=n,s.customData=o,s.name=cO,Object.setPrototypeOf(s,e.prototype),Error.captureStackTrace&&Error.captureStackTrace(s,au.prototype.create),s}return e}(Error),au=function(){function t(e,n,r){this.service=e,this.serviceName=n,this.errors=r}return t.prototype.create=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=n[0]||{},s=this.service+"/"+e,u=this.errors[e],l=u?lO(u,o):"Error",h=this.serviceName+": "+l+" ("+s+").",d=new Ql(s,h,o);return d},t}();function lO(t,e){return t.replace(hO,function(n,r){var o=e[r];return o!=null?String(o):"<"+r+"?>"})}var hO=/\{\$([^}]+)}/g;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ua(t){return JSON.parse(t)}function Qe(t){return JSON.stringify(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var GE=function(t){var e={},n={},r={},o="";try{var s=t.split(".");e=Ua(u0(s[0])||""),n=Ua(u0(s[1])||""),o=s[2],r=n.d||{},delete n.d}catch{}return{header:e,claims:n,data:r,signature:o}},fO=function(t){var e=GE(t),n=e.claims;return!!n&&typeof n=="object"&&n.hasOwnProperty("iat")},dO=function(t){var e=GE(t).claims;return typeof e=="object"&&e.admin===!0};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function tn(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function ji(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]}function av(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function sl(t,e,n){var r={};for(var o in t)Object.prototype.hasOwnProperty.call(t,o)&&(r[o]=e.call(n,t[o],o,t));return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pO(t){for(var e=[],n=function(h,d){Array.isArray(d)?d.forEach(function(p){e.push(encodeURIComponent(h)+"="+encodeURIComponent(p))}):e.push(encodeURIComponent(h)+"="+encodeURIComponent(d))},r=0,o=Object.entries(t);r<o.length;r++){var s=o[r],u=s[0],l=s[1];n(u,l)}return e.length?"&"+e.join("&"):""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vO=function(){function t(){this.chain_=[],this.buf_=[],this.W_=[],this.pad_=[],this.inbuf_=0,this.total_=0,this.blockSize=512/8,this.pad_[0]=128;for(var e=1;e<this.blockSize;++e)this.pad_[e]=0;this.reset()}return t.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},t.prototype.compress_=function(e,n){n||(n=0);var r=this.W_;if(typeof e=="string")for(var o=0;o<16;o++)r[o]=e.charCodeAt(n)<<24|e.charCodeAt(n+1)<<16|e.charCodeAt(n+2)<<8|e.charCodeAt(n+3),n+=4;else for(var o=0;o<16;o++)r[o]=e[n]<<24|e[n+1]<<16|e[n+2]<<8|e[n+3],n+=4;for(var o=16;o<80;o++){var s=r[o-3]^r[o-8]^r[o-14]^r[o-16];r[o]=(s<<1|s>>>31)&4294967295}for(var u=this.chain_[0],l=this.chain_[1],h=this.chain_[2],d=this.chain_[3],p=this.chain_[4],g,y,o=0;o<80;o++){o<40?o<20?(g=d^l&(h^d),y=1518500249):(g=l^h^d,y=1859775393):o<60?(g=l&h|d&(l|h),y=2400959708):(g=l^h^d,y=3395469782);var s=(u<<5|u>>>27)+g+p+y+r[o]&4294967295;p=d,d=h,h=(l<<30|l>>>2)&4294967295,l=u,u=s}this.chain_[0]=this.chain_[0]+u&4294967295,this.chain_[1]=this.chain_[1]+l&4294967295,this.chain_[2]=this.chain_[2]+h&4294967295,this.chain_[3]=this.chain_[3]+d&4294967295,this.chain_[4]=this.chain_[4]+p&4294967295},t.prototype.update=function(e,n){if(e!=null){n===void 0&&(n=e.length);for(var r=n-this.blockSize,o=0,s=this.buf_,u=this.inbuf_;o<n;){if(u===0)for(;o<=r;)this.compress_(e,o),o+=this.blockSize;if(typeof e=="string"){for(;o<n;)if(s[u]=e.charCodeAt(o),++u,++o,u===this.blockSize){this.compress_(s),u=0;break}}else for(;o<n;)if(s[u]=e[o],++u,++o,u===this.blockSize){this.compress_(s),u=0;break}}this.inbuf_=u,this.total_+=n}},t.prototype.digest=function(){var e=[],n=this.total_*8;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var r=this.blockSize-1;r>=56;r--)this.buf_[r]=n&255,n/=256;this.compress_(this.buf_);for(var o=0,r=0;r<5;r++)for(var s=24;s>=0;s-=8)e[o]=this.chain_[r]>>s&255,++o;return e},t}();function gO(t,e){var n=new mO(t,e);return n.subscribe.bind(n)}var mO=function(){function t(e,n){var r=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(function(){e(r)}).catch(function(o){r.error(o)})}return t.prototype.next=function(e){this.forEachObserver(function(n){n.next(e)})},t.prototype.error=function(e){this.forEachObserver(function(n){n.error(e)}),this.close(e)},t.prototype.complete=function(){this.forEachObserver(function(e){e.complete()}),this.close()},t.prototype.subscribe=function(e,n,r){var o=this,s;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");yO(e,["next","error","complete"])?s=e:s={next:e,error:n,complete:r},s.next===void 0&&(s.next=Lp),s.error===void 0&&(s.error=Lp),s.complete===void 0&&(s.complete=Lp);var u=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{o.finalError?s.error(o.finalError):s.complete()}catch{}}),this.observers.push(s),u},t.prototype.unsubscribeOne=function(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))},t.prototype.forEachObserver=function(e){if(!this.finalized)for(var n=0;n<this.observers.length;n++)this.sendOne(n,e)},t.prototype.sendOne=function(e,n){var r=this;this.task.then(function(){if(r.observers!==void 0&&r.observers[e]!==void 0)try{n(r.observers[e])}catch(o){typeof console<"u"&&console.error&&console.error(o)}})},t.prototype.close=function(e){var n=this;this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(function(){n.observers=void 0,n.onNoObservers=void 0}))},t}();function yO(t,e){if(typeof t!="object"||t===null)return!1;for(var n=0,r=e;n<r.length;n++){var o=r[n];if(o in t&&typeof t[o]=="function")return!0}return!1}function Lp(){}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Q=function(t,e,n,r){var o;if(r<e?o="at least "+e:r>n&&(o=n===0?"none":"no more than "+n),o){var s=t+" failed: Was called with "+r+(r===1?" argument.":" arguments.")+" Expects "+o+".";throw new Error(s)}};function jt(t,e){return t+" failed: "+e+" argument "}function tt(t,e,n,r){if(!(r&&!n)&&typeof n!="function")throw new Error(jt(t,e)+"must be a valid function.")}function c0(t,e,n,r){if(n&&(typeof n!="object"||n===null))throw new Error(jt(t,e)+"must be a valid context object.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _O=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var o=t.charCodeAt(r);if(o>=55296&&o<=56319){var s=o-55296;r++,L(r<t.length,"Surrogate pair missing trail surrogate.");var u=t.charCodeAt(r)-56320;o=65536+(s<<10)+u}o<128?e[n++]=o:o<2048?(e[n++]=o>>6|192,e[n++]=o&63|128):o<65536?(e[n++]=o>>12|224,e[n++]=o>>6&63|128,e[n++]=o&63|128):(e[n++]=o>>18|240,e[n++]=o>>12&63|128,e[n++]=o>>6&63|128,e[n++]=o&63|128)}return e},Yl=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wO=1e3,bO=2,IO=4*60*60*1e3,EO=.5;function l0(t,e,n){e===void 0&&(e=wO),n===void 0&&(n=bO);var r=e*Math.pow(n,t),o=Math.round(EO*r*(Math.random()-.5)*2);return Math.min(IO,r+o)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function re(t){return t&&t._delegate?t._delegate:t}var Kn=function(){function t(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}return t.prototype.setInstantiationMode=function(e){return this.instantiationMode=e,this},t.prototype.setMultipleInstances=function(e){return this.multipleInstances=e,this},t.prototype.setServiceProps=function(e){return this.serviceProps=e,this},t.prototype.setInstanceCreatedCallback=function(e){return this.onInstanceCreated=e,this},t}();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ii="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var WE=function(){function t(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}return t.prototype.get=function(e){var n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){var r=new Ut;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{var o=this.getOrInitializeService({instanceIdentifier:n});o&&r.resolve(o)}catch{}}return this.instancesDeferred.get(n).promise},t.prototype.getImmediate=function(e){var n,r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),o=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(s){if(o)return null;throw s}else{if(o)return null;throw Error("Service "+this.name+" is not available")}},t.prototype.getComponent=function(){return this.component},t.prototype.setComponent=function(e){var n,r;if(e.name!==this.name)throw Error("Mismatching Component "+e.name+" for Provider "+this.name+".");if(this.component)throw Error("Component for "+this.name+" has already been provided");if(this.component=e,!!this.shouldAutoInitialize()){if(SO(e))try{this.getOrInitializeService({instanceIdentifier:Ii})}catch{}try{for(var o=Ot(this.instancesDeferred.entries()),s=o.next();!s.done;s=o.next()){var u=gt(s.value,2),l=u[0],h=u[1],d=this.normalizeInstanceIdentifier(l);try{var p=this.getOrInitializeService({instanceIdentifier:d});h.resolve(p)}catch{}}}catch(g){n={error:g}}finally{try{s&&!s.done&&(r=o.return)&&r.call(o)}finally{if(n)throw n.error}}}},t.prototype.clearInstance=function(e){e===void 0&&(e=Ii),this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)},t.prototype.delete=function(){return A(this,void 0,void 0,function(){var e;return C(this,function(n){switch(n.label){case 0:return e=Array.from(this.instances.values()),[4,Promise.all(ve(ve([],gt(e.filter(function(r){return"INTERNAL"in r}).map(function(r){return r.INTERNAL.delete()}))),gt(e.filter(function(r){return"_delete"in r}).map(function(r){return r._delete()}))))];case 1:return n.sent(),[2]}})})},t.prototype.isComponentSet=function(){return this.component!=null},t.prototype.isInitialized=function(e){return e===void 0&&(e=Ii),this.instances.has(e)},t.prototype.getOptions=function(e){return e===void 0&&(e=Ii),this.instancesOptions.get(e)||{}},t.prototype.initialize=function(e){var n,r;e===void 0&&(e={});var o=e.options,s=o===void 0?{}:o,u=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(u))throw Error(this.name+"("+u+") has already been initialized");if(!this.isComponentSet())throw Error("Component "+this.name+" has not been registered yet");var l=this.getOrInitializeService({instanceIdentifier:u,options:s});try{for(var h=Ot(this.instancesDeferred.entries()),d=h.next();!d.done;d=h.next()){var p=gt(d.value,2),g=p[0],y=p[1],w=this.normalizeInstanceIdentifier(g);u===w&&y.resolve(l)}}catch(b){n={error:b}}finally{try{d&&!d.done&&(r=h.return)&&r.call(h)}finally{if(n)throw n.error}}return l},t.prototype.onInit=function(e,n){var r,o=this.normalizeInstanceIdentifier(n),s=(r=this.onInitCallbacks.get(o))!==null&&r!==void 0?r:new Set;s.add(e),this.onInitCallbacks.set(o,s);var u=this.instances.get(o);return u&&e(u,o),function(){s.delete(e)}},t.prototype.invokeOnInitCallbacks=function(e,n){var r,o,s=this.onInitCallbacks.get(n);if(s)try{for(var u=Ot(s),l=u.next();!l.done;l=u.next()){var h=l.value;try{h(e,n)}catch{}}}catch(d){r={error:d}}finally{try{l&&!l.done&&(o=u.return)&&o.call(u)}finally{if(r)throw r.error}}},t.prototype.getOrInitializeService=function(e){var n=e.instanceIdentifier,r=e.options,o=r===void 0?{}:r,s=this.instances.get(n);if(!s&&this.component&&(s=this.component.instanceFactory(this.container,{instanceIdentifier:TO(n),options:o}),this.instances.set(n,s),this.instancesOptions.set(n,o),this.invokeOnInitCallbacks(s,n),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,n,s)}catch{}return s||null},t.prototype.normalizeInstanceIdentifier=function(e){return e===void 0&&(e=Ii),this.component?this.component.multipleInstances?e:Ii:e},t.prototype.shouldAutoInitialize=function(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"},t}();function TO(t){return t===Ii?void 0:t}function SO(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var HE=function(){function t(e){this.name=e,this.providers=new Map}return t.prototype.addComponent=function(e){var n=this.getProvider(e.name);if(n.isComponentSet())throw new Error("Component "+e.name+" has already been registered with "+this.name);n.setComponent(e)},t.prototype.addOrOverwriteComponent=function(e){var n=this.getProvider(e.name);n.isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)},t.prototype.getProvider=function(e){if(this.providers.has(e))return this.providers.get(e);var n=new WE(e,this);return this.providers.set(e,n),n},t.prototype.getProviders=function(){return Array.from(this.providers.values())},t}();/*! *****************************************************************************
Copyright (c) Microsoft Corporation. All rights reserved.
Licensed under the Apache License, Version 2.0 (the "License"); you may not use
this file except in compliance with the License. You may obtain a copy of the
License at http://www.apache.org/licenses/LICENSE-2.0

THIS CODE IS PROVIDED ON AN *AS IS* BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
KIND, EITHER EXPRESS OR IMPLIED, INCLUDING WITHOUT LIMITATION ANY IMPLIED
WARRANTIES OR CONDITIONS OF TITLE, FITNESS FOR A PARTICULAR PURPOSE,
MERCHANTABLITY OR NON-INFRINGEMENT.

See the Apache Version 2.0 License for specific language governing permissions
and limitations under the License.
***************************************************************************** */function Sn(){for(var t=0,e=0,n=arguments.length;e<n;e++)t+=arguments[e].length;for(var r=Array(t),o=0,e=0;e<n;e++)for(var s=arguments[e],u=0,l=s.length;u<l;u++,o++)r[o]=s[u];return r}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bi,hg=[],fe;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(fe||(fe={}));var KE={debug:fe.DEBUG,verbose:fe.VERBOSE,info:fe.INFO,warn:fe.WARN,error:fe.ERROR,silent:fe.SILENT},CO=fe.INFO,AO=(bi={},bi[fe.DEBUG]="log",bi[fe.VERBOSE]="log",bi[fe.INFO]="info",bi[fe.WARN]="warn",bi[fe.ERROR]="error",bi),kO=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var o=new Date().toISOString(),s=AO[e];if(s)console[s].apply(console,Sn(["["+o+"]  "+t.name+":"],n));else throw new Error("Attempted to log a message with an invalid logType (value: "+e+")")}},Xl=function(){function t(e){this.name=e,this._logLevel=CO,this._logHandler=kO,this._userLogHandler=null,hg.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(e){if(!(e in fe))throw new TypeError('Invalid value "'+e+'" assigned to `logLevel`');this._logLevel=e},enumerable:!1,configurable:!0}),t.prototype.setLogLevel=function(e){this._logLevel=typeof e=="string"?KE[e]:e},Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userLogHandler",{get:function(){return this._userLogHandler},set:function(e){this._userLogHandler=e},enumerable:!1,configurable:!0}),t.prototype.debug=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,Sn([this,fe.DEBUG],e)),this._logHandler.apply(this,Sn([this,fe.DEBUG],e))},t.prototype.log=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,Sn([this,fe.VERBOSE],e)),this._logHandler.apply(this,Sn([this,fe.VERBOSE],e))},t.prototype.info=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,Sn([this,fe.INFO],e)),this._logHandler.apply(this,Sn([this,fe.INFO],e))},t.prototype.warn=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,Sn([this,fe.WARN],e)),this._logHandler.apply(this,Sn([this,fe.WARN],e))},t.prototype.error=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._userLogHandler&&this._userLogHandler.apply(this,Sn([this,fe.ERROR],e)),this._logHandler.apply(this,Sn([this,fe.ERROR],e))},t}();function NO(t){hg.forEach(function(e){e.setLogLevel(t)})}function RO(t,e){for(var n=function(u){var l=null;e&&e.level&&(l=KE[e.level]),t===null?u.userLogHandler=null:u.userLogHandler=function(h,d){for(var p=[],g=2;g<arguments.length;g++)p[g-2]=arguments[g];var y=p.map(function(w){if(w==null)return null;if(typeof w=="string")return w;if(typeof w=="number"||typeof w=="boolean")return w.toString();if(w instanceof Error)return w.message;try{return JSON.stringify(w)}catch{return null}}).filter(function(w){return w}).join(" ");d>=(l??h.logLevel)&&t({level:fe[d].toLowerCase(),message:y,args:p,type:h.name})}},r=0,o=hg;r<o.length;r++){var s=o[r];n(s)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ar,DO=(Ar={},Ar["no-app"]="No Firebase App '{$appName}' has been created - call Firebase App.initializeApp()",Ar["bad-app-name"]="Illegal App name: '{$appName}",Ar["duplicate-app"]="Firebase App named '{$appName}' already exists",Ar["app-deleted"]="Firebase App named '{$appName}' already deleted",Ar["invalid-app-argument"]="firebase.{$appName}() takes either no argument or a Firebase App instance.",Ar["invalid-log-argument"]="First argument to `onLog` must be null or a function.",Ar),Fo=new au("app","Firebase",DO),zE="@firebase/app",OO="0.6.30",PO="@firebase/analytics",xO="@firebase/app-check",LO="@firebase/auth",MO="@firebase/database",FO="@firebase/functions",UO="@firebase/installations",VO="@firebase/messaging",jO="@firebase/performance",BO="@firebase/remote-config",qO="@firebase/storage",GO="@firebase/firestore",WO="firebase-wrapper";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dt,al="[DEFAULT]",HO=(dt={},dt[zE]="fire-core",dt[PO]="fire-analytics",dt[xO]="fire-app-check",dt[LO]="fire-auth",dt[MO]="fire-rtdb",dt[FO]="fire-fn",dt[UO]="fire-iid",dt[VO]="fire-fcm",dt[jO]="fire-perf",dt[BO]="fire-rc",dt[qO]="fire-gcs",dt[GO]="fire-fst",dt["fire-js"]="fire-js",dt[WO]="fire-js-all",dt);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ho=new Xl("@firebase/app");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jc=function(){function t(e,n,r){var o=this;this.firebase_=r,this.isDeleted_=!1,this.name_=n.name,this.automaticDataCollectionEnabled_=n.automaticDataCollectionEnabled||!1,this.options_=ME(e),this.container=new HE(n.name),this._addComponent(new Kn("app",function(){return o},"PUBLIC")),this.firebase_.INTERNAL.components.forEach(function(s){return o._addComponent(s)})}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this.automaticDataCollectionEnabled_},set:function(e){this.checkDestroyed_(),this.automaticDataCollectionEnabled_=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!1,configurable:!0}),t.prototype.delete=function(){var e=this;return new Promise(function(n){e.checkDestroyed_(),n()}).then(function(){return e.firebase_.INTERNAL.removeApp(e.name_),Promise.all(e.container.getProviders().map(function(n){return n.delete()}))}).then(function(){e.isDeleted_=!0})},t.prototype._getService=function(e,n){var r;n===void 0&&(n=al),this.checkDestroyed_();var o=this.container.getProvider(e);return!o.isInitialized()&&((r=o.getComponent())===null||r===void 0?void 0:r.instantiationMode)==="EXPLICIT"&&o.initialize(),o.getImmediate({identifier:n})},t.prototype._removeServiceInstance=function(e,n){n===void 0&&(n=al),this.container.getProvider(e).clearInstance(n)},t.prototype._addComponent=function(e){try{this.container.addComponent(e)}catch(n){Ho.debug("Component "+e.name+" failed to register with FirebaseApp "+this.name,n)}},t.prototype._addOrOverwriteComponent=function(e){this.container.addOrOverwriteComponent(e)},t.prototype.toJSON=function(){return{name:this.name,automaticDataCollectionEnabled:this.automaticDataCollectionEnabled,options:this.options}},t.prototype.checkDestroyed_=function(){if(this.isDeleted_)throw Fo.create("app-deleted",{appName:this.name_})},t}();Jc.prototype.name&&Jc.prototype.options||Jc.prototype.delete||console.log("dc");var KO="8.10.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zO(t){var e={},n=new Map,r={__esModule:!0,initializeApp:u,app:s,registerVersion:d,setLogLevel:NO,onLog:p,apps:null,SDK_VERSION:KO,INTERNAL:{registerComponent:h,removeApp:o,components:n,useAsService:g}};r.default=r,Object.defineProperty(r,"apps",{get:l});function o(y){delete e[y]}function s(y){if(y=y||al,!tn(e,y))throw Fo.create("no-app",{appName:y});return e[y]}s.App=t;function u(y,w){if(w===void 0&&(w={}),typeof w!="object"||w===null){var b=w;w={name:b}}var E=w;E.name===void 0&&(E.name=al);var T=E.name;if(typeof T!="string"||!T)throw Fo.create("bad-app-name",{appName:String(T)});if(tn(e,T))throw Fo.create("duplicate-app",{appName:T});var k=new t(y,E,r);return e[T]=k,k}function l(){return Object.keys(e).map(function(y){return e[y]})}function h(y){var w=y.name;if(n.has(w))return Ho.debug("There were multiple attempts to register component "+w+"."),y.type==="PUBLIC"?r[w]:null;if(n.set(w,y),y.type==="PUBLIC"){var b=function(O){if(O===void 0&&(O=s()),typeof O[w]!="function")throw Fo.create("invalid-app-argument",{appName:w});return O[w]()};y.serviceProps!==void 0&&Fa(b,y.serviceProps),r[w]=b,t.prototype[w]=function(){for(var O=[],M=0;M<arguments.length;M++)O[M]=arguments[M];var H=this._getService.bind(this,w);return H.apply(this,y.multipleInstances?O:[])}}for(var E=0,T=Object.keys(e);E<T.length;E++){var k=T[E];e[k]._addComponent(y)}return y.type==="PUBLIC"?r[w]:null}function d(y,w,b){var E,T=(E=HO[y])!==null&&E!==void 0?E:y;b&&(T+="-"+b);var k=T.match(/\s|\//),O=w.match(/\s|\//);if(k||O){var M=['Unable to register library "'+T+'" with version "'+w+'":'];k&&M.push('library name "'+T+'" contains illegal characters (whitespace or "/")'),k&&O&&M.push("and"),O&&M.push('version name "'+w+'" contains illegal characters (whitespace or "/")'),Ho.warn(M.join(" "));return}h(new Kn(T+"-version",function(){return{library:T,version:w}},"VERSION"))}function p(y,w){if(y!==null&&typeof y!="function")throw Fo.create("invalid-log-argument");RO(y,w)}function g(y,w){if(w==="serverAuth")return null;var b=w;return b}return r}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $E(){var t=zO(Jc);t.INTERNAL=at(at({},t.INTERNAL),{createFirebaseNamespace:$E,extendNamespace:e,createSubscribe:gO,ErrorFactory:au,deepExtend:Fa});function e(n){Fa(t,n)}return t}var fg=$E();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $O=function(){function t(e){this.container=e}return t.prototype.getPlatformInfoString=function(){var e=this.container.getProviders();return e.map(function(n){if(QO(n)){var r=n.getImmediate();return r.library+"/"+r.version}else return null}).filter(function(n){return n}).join(" ")},t}();function QO(t){var e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YO(t,e){t.INTERNAL.registerComponent(new Kn("platform-logger",function(n){return new $O(n)},"PRIVATE")),t.registerVersion(zE,OO,e),t.registerVersion("fire-js","")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */if(iO()&&self.firebase!==void 0){Ho.warn(`
    Warning: Firebase is already defined in the global scope. Please make sure
    Firebase library is only loaded once.
  `);var h0=self.firebase.SDK_VERSION;h0&&h0.indexOf("LITE")>=0&&Ho.warn(`
    Warning: You are trying to load Firebase while using Firebase Performance standalone script.
    You should load Firebase Performance with this instance of Firebase to avoid loading duplicate code.
    `)}var XO=fg.initializeApp;fg.initializeApp=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return FE()&&Ho.warn(`
      Warning: This is a browser-targeted Firebase bundle but it appears it is being
      run in a Node environment.  If running in a Node environment, make sure you
      are using the bundle specified by the "main" field in package.json.
      
      If you are using Webpack, you can specify "main" as the first item in
      "resolve.mainFields":
      https://webpack.js.org/configuration/resolve/#resolvemainfields
      
      If using Rollup, use the @rollup/plugin-node-resolve plugin and specify "main"
      as the first item in "mainFields", e.g. ['main', 'module'].
      https://github.com/rollup/@rollup/plugin-node-resolve
      `),XO.apply(void 0,t)};var J=fg;YO(J);/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var uv=function(t,e){return uv=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,r){n.__proto__=r}||function(n,r){for(var o in r)Object.prototype.hasOwnProperty.call(r,o)&&(n[o]=r[o])},uv(t,e)};function JO(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");uv(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function QE(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],r=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&r>=t.length&&(t=void 0),{value:t&&t[r++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}var ZO=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},B,dg=dg||{},ee=ZO||self;function ul(){}function cv(t){var e=typeof t;return e=e!="object"?e:t?Array.isArray(t)?"array":e:"null",e=="array"||e=="object"&&typeof t.length=="number"}function Jl(t){var e=typeof t;return e=="object"&&t!=null||e=="function"}function eP(t){return Object.prototype.hasOwnProperty.call(t,Mp)&&t[Mp]||(t[Mp]=++tP)}var Mp="closure_uid_"+(1e9*Math.random()>>>0),tP=0;function nP(t,e,n){return t.call.apply(t.bind,arguments)}function rP(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var o=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(o,r),t.apply(e,o)}}return function(){return t.apply(e,arguments)}}function ct(t,e,n){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?ct=nP:ct=rP,ct.apply(null,arguments)}function Uc(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var r=n.slice();return r.push.apply(r,arguments),t.apply(this,r)}}function ft(t,e){function n(){}n.prototype=e.prototype,t.Z=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Vb=function(r,o,s){for(var u=Array(arguments.length-2),l=2;l<arguments.length;l++)u[l-2]=arguments[l];return e.prototype[o].apply(r,u)}}function zr(){this.s=this.s,this.o=this.o}var iP=0;zr.prototype.s=!1;zr.prototype.na=function(){!this.s&&(this.s=!0,this.M(),iP!=0)&&eP(this)};zr.prototype.M=function(){if(this.o)for(;this.o.length;)this.o.shift()()};var YE=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(typeof t=="string")return typeof e!="string"||e.length!=1?-1:t.indexOf(e,0);for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},XE=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,o=typeof t=="string"?t.split(""):t,s=0;s<r;s++)s in o&&e.call(n,o[s],s,t)};function oP(t){e:{for(var e=XP,n=t.length,r=typeof t=="string"?t.split(""):t,o=0;o<n;o++)if(o in r&&e.call(void 0,r[o],o,t)){e=o;break e}e=-1}return 0>e?null:typeof t=="string"?t.charAt(e):t[e]}function f0(t){return Array.prototype.concat.apply([],arguments)}function pg(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function cl(t){return/^[\s\xa0]*$/.test(t)}var d0=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]};function At(t,e){return t.indexOf(e)!=-1}function Fp(t,e){return t<e?-1:t>e?1:0}var kt;e:{var p0=ee.navigator;if(p0){var v0=p0.userAgent;if(v0){kt=v0;break e}}kt=""}function vg(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function JE(t){var e={};for(var n in t)e[n]=t[n];return e}var g0="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function ZE(t,e){for(var n,r,o=1;o<arguments.length;o++){r=arguments[o];for(n in r)t[n]=r[n];for(var s=0;s<g0.length;s++)n=g0[s],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function gg(t){return gg[" "](t),t}gg[" "]=ul;function sP(t){var e=cP;return Object.prototype.hasOwnProperty.call(e,9)?e[9]:e[9]=t(9)}var aP=At(kt,"Opera"),Ko=At(kt,"Trident")||At(kt,"MSIE"),eT=At(kt,"Edge"),lv=eT||Ko,tT=At(kt,"Gecko")&&!(At(kt.toLowerCase(),"webkit")&&!At(kt,"Edge"))&&!(At(kt,"Trident")||At(kt,"MSIE"))&&!At(kt,"Edge"),uP=At(kt.toLowerCase(),"webkit")&&!At(kt,"Edge");function nT(){var t=ee.document;return t?t.documentMode:void 0}var ll;e:{var Up="",Vp=function(){var t=kt;if(tT)return/rv:([^\);]+)(\)|;)/.exec(t);if(eT)return/Edge\/([\d\.]+)/.exec(t);if(Ko)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t);if(uP)return/WebKit\/(\S+)/.exec(t);if(aP)return/(?:Version)[ \/]?(\S+)/.exec(t)}();if(Vp&&(Up=Vp?Vp[1]:""),Ko){var jp=nT();if(jp!=null&&jp>parseFloat(Up)){ll=String(jp);break e}}ll=Up}var cP={};function lP(){return sP(function(){for(var t=0,e=d0(String(ll)).split("."),n=d0("9").split("."),r=Math.max(e.length,n.length),o=0;t==0&&o<r;o++){var s=e[o]||"",u=n[o]||"";do{if(s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],u=/(\d*)(\D*)(.*)/.exec(u)||["","","",""],s[0].length==0&&u[0].length==0)break;t=Fp(s[1].length==0?0:parseInt(s[1],10),u[1].length==0?0:parseInt(u[1],10))||Fp(s[2].length==0,u[2].length==0)||Fp(s[2],u[2]),s=s[3],u=u[3]}while(t==0)}return 0<=t})}var hv;if(ee.document&&Ko){var m0=nT();hv=m0||parseInt(ll,10)||void 0}else hv=void 0;var hP=hv,fP=function(){if(!ee.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});try{ee.addEventListener("test",ul,e),ee.removeEventListener("test",ul,e)}catch{}return t}();function yt(t,e){this.type=t,this.g=this.target=e,this.defaultPrevented=!1}yt.prototype.h=function(){this.defaultPrevented=!0};function Va(t,e){if(yt.call(this,t?t.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,t){var n=this.type=t.type,r=t.changedTouches&&t.changedTouches.length?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.g=e,e=t.relatedTarget){if(tT){e:{try{gg(e.nodeName);var o=!0;break e}catch{}o=!1}o||(e=null)}}else n=="mouseover"?e=t.fromElement:n=="mouseout"&&(e=t.toElement);this.relatedTarget=e,r?(this.clientX=r.clientX!==void 0?r.clientX:r.pageX,this.clientY=r.clientY!==void 0?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0):(this.clientX=t.clientX!==void 0?t.clientX:t.pageX,this.clientY=t.clientY!==void 0?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=typeof t.pointerType=="string"?t.pointerType:dP[t.pointerType]||"",this.state=t.state,this.i=t,t.defaultPrevented&&Va.Z.h.call(this)}}ft(Va,yt);var dP={2:"touch",3:"pen",4:"mouse"};Va.prototype.h=function(){Va.Z.h.call(this);var t=this.i;t.preventDefault?t.preventDefault():t.returnValue=!1};var Zl="closure_listenable_"+(1e6*Math.random()|0),pP=0;function vP(t,e,n,r,o){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ia=o,this.key=++pP,this.ca=this.fa=!1}function eh(t){t.ca=!0,t.listener=null,t.proxy=null,t.src=null,t.ia=null}function th(t){this.src=t,this.g={},this.h=0}th.prototype.add=function(t,e,n,r,o){var s=t.toString();t=this.g[s],t||(t=this.g[s]=[],this.h++);var u=dv(t,e,r,o);return-1<u?(e=t[u],n||(e.fa=!1)):(e=new vP(e,this.src,s,!!r,o),e.fa=n,t.push(e)),e};function fv(t,e){var n=e.type;if(n in t.g){var r=t.g[n],o=YE(r,e),s;(s=0<=o)&&Array.prototype.splice.call(r,o,1),s&&(eh(e),t.g[n].length==0&&(delete t.g[n],t.h--))}}function dv(t,e,n,r){for(var o=0;o<t.length;++o){var s=t[o];if(!s.ca&&s.listener==e&&s.capture==!!n&&s.ia==r)return o}return-1}var mg="closure_lm_"+(1e6*Math.random()|0),Bp={};function rT(t,e,n,r,o){if(Array.isArray(e)){for(var s=0;s<e.length;s++)rT(t,e[s],n,r,o);return null}return n=sT(n),t&&t[Zl]?t.N(e,n,Jl(r)?!!r.capture:!!r,o):gP(t,e,n,!1,r,o)}function gP(t,e,n,r,o,s){if(!e)throw Error("Invalid event type");var u=Jl(o)?!!o.capture:!!o,l=_g(t);if(l||(t[mg]=l=new th(t)),n=l.add(e,n,r,u,s),n.proxy)return n;if(r=mP(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)fP||(o=u),o===void 0&&(o=!1),t.addEventListener(e.toString(),r,o);else if(t.attachEvent)t.attachEvent(oT(e.toString()),r);else if(t.addListener&&t.removeListener)t.addListener(r);else throw Error("addEventListener and attachEvent are unavailable.");return n}function mP(){function t(n){return e.call(t.src,t.listener,n)}var e=yP;return t}function iT(t,e,n,r,o){if(Array.isArray(e))for(var s=0;s<e.length;s++)iT(t,e[s],n,r,o);else r=Jl(r)?!!r.capture:!!r,n=sT(n),t&&t[Zl]?(t=t.i,e=String(e).toString(),e in t.g&&(s=t.g[e],n=dv(s,n,r,o),-1<n&&(eh(s[n]),Array.prototype.splice.call(s,n,1),s.length==0&&(delete t.g[e],t.h--)))):t&&(t=_g(t))&&(e=t.g[e.toString()],t=-1,e&&(t=dv(e,n,r,o)),(n=-1<t?e[t]:null)&&yg(n))}function yg(t){if(typeof t!="number"&&t&&!t.ca){var e=t.src;if(e&&e[Zl])fv(e.i,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(oT(n),r):e.addListener&&e.removeListener&&e.removeListener(r),(n=_g(e))?(fv(n,t),n.h==0&&(n.src=null,e[mg]=null)):eh(t)}}}function oT(t){return t in Bp?Bp[t]:Bp[t]="on"+t}function yP(t,e){if(t.ca)t=!0;else{e=new Va(e,this);var n=t.listener,r=t.ia||t.src;t.fa&&yg(t),t=n.call(r,e)}return t}function _g(t){return t=t[mg],t instanceof th?t:null}var qp="__closure_events_fn_"+(1e9*Math.random()>>>0);function sT(t){return typeof t=="function"?t:(t[qp]||(t[qp]=function(e){return t.handleEvent(e)}),t[qp])}function rt(){zr.call(this),this.i=new th(this),this.P=this,this.I=null}ft(rt,zr);rt.prototype[Zl]=!0;rt.prototype.removeEventListener=function(t,e,n,r){iT(this,t,e,n,r)};function lt(t,e){var n,r=t.I;if(r)for(n=[];r;r=r.I)n.push(r);if(t=t.P,r=e.type||e,typeof e=="string")e=new yt(e,t);else if(e instanceof yt)e.target=e.target||t;else{var o=e;e=new yt(r,t),ZE(e,o)}if(o=!0,n)for(var s=n.length-1;0<=s;s--){var u=e.g=n[s];o=Vc(u,r,!0,e)&&o}if(u=e.g=t,o=Vc(u,r,!0,e)&&o,o=Vc(u,r,!1,e)&&o,n)for(s=0;s<n.length;s++)u=e.g=n[s],o=Vc(u,r,!1,e)&&o}rt.prototype.M=function(){if(rt.Z.M.call(this),this.i){var t=this.i,e;for(e in t.g){for(var n=t.g[e],r=0;r<n.length;r++)eh(n[r]);delete t.g[e],t.h--}}this.I=null};rt.prototype.N=function(t,e,n,r){return this.i.add(String(t),e,!1,n,r)};rt.prototype.O=function(t,e,n,r){return this.i.add(String(t),e,!0,n,r)};function Vc(t,e,n,r){if(e=t.i.g[String(e)],!e)return!0;e=e.concat();for(var o=!0,s=0;s<e.length;++s){var u=e[s];if(u&&!u.ca&&u.capture==n){var l=u.listener,h=u.ia||u.src;u.fa&&fv(t.i,u),o=l.call(h,r)!==!1&&o}}return o&&!r.defaultPrevented}var wg=ee.JSON.stringify;function _P(){var t=uT,e=null;return t.g&&(e=t.g,t.g=t.g.next,t.g||(t.h=null),e.next=null),e}var wP=function(){function t(){this.h=this.g=null}return t.prototype.add=function(e,n){var r=aT.get();r.set(e,n),this.h?this.h.next=r:this.g=r,this.h=r},t}(),aT=new(function(){function t(e,n){this.i=e,this.j=n,this.h=0,this.g=null}return t.prototype.get=function(){var e;return 0<this.h?(this.h--,e=this.g,this.g=e.next,e.next=null):e=this.i(),e},t}())(function(){return new bP},function(t){return t.reset()}),bP=function(){function t(){this.next=this.g=this.h=null}return t.prototype.set=function(e,n){this.h=e,this.g=n,this.next=null},t.prototype.reset=function(){this.next=this.g=this.h=null},t}();function IP(t){ee.setTimeout(function(){throw t},0)}function bg(t,e){pv||EP(),vv||(pv(),vv=!0),uT.add(t,e)}var pv;function EP(){var t=ee.Promise.resolve(void 0);pv=function(){t.then(TP)}}var vv=!1,uT=new wP;function TP(){for(var t;t=_P();){try{t.h.call(t.g)}catch(n){IP(n)}var e=aT;e.j(t),100>e.h&&(e.h++,t.next=e.g,e.g=t)}vv=!1}function nh(t,e){rt.call(this),this.h=t||1,this.g=e||ee,this.j=ct(this.kb,this),this.l=Date.now()}ft(nh,rt);B=nh.prototype;B.da=!1;B.S=null;B.kb=function(){if(this.da){var t=Date.now()-this.l;0<t&&t<.8*this.h?this.S=this.g.setTimeout(this.j,this.h-t):(this.S&&(this.g.clearTimeout(this.S),this.S=null),lt(this,"tick"),this.da&&(Ig(this),this.start()))}};B.start=function(){this.da=!0,this.S||(this.S=this.g.setTimeout(this.j,this.h),this.l=Date.now())};function Ig(t){t.da=!1,t.S&&(t.g.clearTimeout(t.S),t.S=null)}B.M=function(){nh.Z.M.call(this),Ig(this),delete this.g};function Eg(t,e,n){if(typeof t=="function")n&&(t=ct(t,n));else if(t&&typeof t.handleEvent=="function")t=ct(t.handleEvent,t);else throw Error("Invalid listener argument");return 2147483647<Number(e)?-1:ee.setTimeout(t,e||0)}function cT(t){t.g=Eg(function(){t.g=null,t.i&&(t.i=!1,cT(t))},t.j);var e=t.h;t.h=null,t.m.apply(null,e)}var SP=function(t){JO(e,t);function e(n,r){var o=t.call(this)||this;return o.m=n,o.j=r,o.h=null,o.i=!1,o.g=null,o}return e.prototype.l=function(n){this.h=arguments,this.g?this.i=!0:cT(this)},e.prototype.M=function(){t.prototype.M.call(this),this.g&&(ee.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)},e}(zr);function ja(t){zr.call(this),this.h=t,this.g={}}ft(ja,zr);var y0=[];function lT(t,e,n,r){Array.isArray(n)||(n&&(y0[0]=n.toString()),n=y0);for(var o=0;o<n.length;o++){var s=rT(e,n[o],r||t.handleEvent,!1,t.h||t);if(!s)break;t.g[s.key]=s}}function hT(t){vg(t.g,function(e,n){this.g.hasOwnProperty(n)&&yg(e)},t),t.g={}}ja.prototype.M=function(){ja.Z.M.call(this),hT(this)};ja.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};function rh(){this.g=!0}rh.prototype.Aa=function(){this.g=!1};function CP(t,e,n,r,o,s){t.info(function(){if(t.g)if(s)for(var u="",l=s.split("&"),h=0;h<l.length;h++){var d=l[h].split("=");if(1<d.length){var p=d[0];d=d[1];var g=p.split("_");u=2<=g.length&&g[1]=="type"?u+(p+"="+d+"&"):u+(p+"=redacted&")}}else u=null;else u=s;return"XMLHTTP REQ ("+r+") [attempt "+o+"]: "+e+`
`+n+`
`+u})}function AP(t,e,n,r,o,s,u){t.info(function(){return"XMLHTTP RESP ("+r+") [ attempt "+o+"]: "+e+`
`+n+`
`+s+" "+u})}function jo(t,e,n,r){t.info(function(){return"XMLHTTP TEXT ("+e+"): "+NP(t,n)+(r?" "+r:"")})}function kP(t,e){t.info(function(){return"TIMEOUT: "+e})}rh.prototype.info=function(){};function NP(t,e){if(!t.g)return e;if(!e)return null;try{var n=JSON.parse(e);if(n){for(t=0;t<n.length;t++)if(Array.isArray(n[t])){var r=n[t];if(!(2>r.length)){var o=r[1];if(Array.isArray(o)&&!(1>o.length)){var s=o[0];if(s!="noop"&&s!="stop"&&s!="close")for(var u=1;u<o.length;u++)o[u]=""}}}}return wg(n)}catch{return e}}var Yi={},_0=null;function ih(){return _0=_0||new rt}Yi.Ma="serverreachability";function fT(t){yt.call(this,Yi.Ma,t)}ft(fT,yt);function Ba(t){var e=ih();lt(e,new fT(e))}Yi.STAT_EVENT="statevent";function dT(t,e){yt.call(this,Yi.STAT_EVENT,t),this.stat=e}ft(dT,yt);function Nt(t){var e=ih();lt(e,new dT(e,t))}Yi.Na="timingevent";function pT(t,e){yt.call(this,Yi.Na,t),this.size=e}ft(pT,yt);function uu(t,e){if(typeof t!="function")throw Error("Fn must not be null and must be a function");return ee.setTimeout(function(){t()},e)}var oh={NO_ERROR:0,lb:1,yb:2,xb:3,sb:4,wb:5,zb:6,Ja:7,TIMEOUT:8,Cb:9},vT={qb:"complete",Mb:"success",Ka:"error",Ja:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",tb:"downloadprogress",Ub:"uploadprogress"};function Tg(){}Tg.prototype.h=null;function w0(t){return t.h||(t.h=t.i())}function gT(){}var cu={OPEN:"a",pb:"b",Ka:"c",Bb:"d"};function Sg(){yt.call(this,"d")}ft(Sg,yt);function Cg(){yt.call(this,"c")}ft(Cg,yt);var gv;function sh(){}ft(sh,Tg);sh.prototype.g=function(){return new XMLHttpRequest};sh.prototype.i=function(){return{}};gv=new sh;function lu(t,e,n,r){this.l=t,this.j=e,this.m=n,this.X=r||1,this.V=new ja(this),this.P=RP,t=lv?125:void 0,this.W=new nh(t),this.H=null,this.i=!1,this.s=this.A=this.v=this.K=this.F=this.Y=this.B=null,this.D=[],this.g=null,this.C=0,this.o=this.u=null,this.N=-1,this.I=!1,this.O=0,this.L=null,this.aa=this.J=this.$=this.U=!1,this.h=new mT}function mT(){this.i=null,this.g="",this.h=!1}var RP=45e3,mv={},hl={};B=lu.prototype;B.setTimeout=function(t){this.P=t};function yv(t,e,n){t.K=1,t.v=uh(dr(e)),t.s=n,t.U=!0,yT(t,null)}function yT(t,e){t.F=Date.now(),hu(t),t.A=dr(t.v);var n=t.A,r=t.X;Array.isArray(r)||(r=[String(r)]),ST(n.h,"t",r),t.C=0,n=t.l.H,t.h=new mT,t.g=HT(t.l,n?e:null,!t.s),0<t.O&&(t.L=new SP(ct(t.Ia,t,t.g),t.O)),lT(t.V,t.g,"readystatechange",t.gb),e=t.H?JE(t.H):{},t.s?(t.u||(t.u="POST"),e["Content-Type"]="application/x-www-form-urlencoded",t.g.ea(t.A,t.u,t.s,e)):(t.u="GET",t.g.ea(t.A,t.u,null,e)),Ba(),CP(t.j,t.u,t.A,t.m,t.X,t.s)}B.gb=function(t){t=t.target;var e=this.L;e&&sr(t)==3?e.l():this.Ia(t)};B.Ia=function(t){try{if(t==this.g)e:{var e=sr(this.g),n=this.g.Da(),r=this.g.ba();if(!(3>e)&&(e!=3||lv||this.g&&(this.h.h||this.g.ga()||T0(this.g)))){this.I||e!=4||n==7||(n==8||0>=r?Ba(3):Ba(2)),ah(this);var o=this.g.ba();this.N=o;t:if(_T(this)){var s=T0(this.g);t="";var u=s.length,l=sr(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){Ci(this),Sa(this);var h="";break t}this.h.i=new ee.TextDecoder}for(n=0;n<u;n++)this.h.h=!0,t+=this.h.i.decode(s[n],{stream:l&&n==u-1});s.splice(0,u),this.h.g+=t,this.C=0,h=this.h.g}else h=this.g.ga();if(this.i=o==200,AP(this.j,this.u,this.A,this.m,this.X,e,o),this.i){if(this.$&&!this.J){t:{if(this.g){var d,p=this.g;if((d=p.g?p.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!cl(d)){var g=d;break t}}g=null}if(o=g)jo(this.j,this.m,o,"Initial handshake response via X-HTTP-Initial-Response"),this.J=!0,_v(this,o);else{this.i=!1,this.o=3,Nt(12),Ci(this),Sa(this);break e}}this.U?(wT(this,e,h),lv&&this.i&&e==3&&(lT(this.V,this.W,"tick",this.fb),this.W.start())):(jo(this.j,this.m,h,null),_v(this,h)),e==4&&Ci(this),this.i&&!this.I&&(e==4?BT(this.l,this):(this.i=!1,hu(this)))}else o==400&&0<h.indexOf("Unknown SID")?(this.o=3,Nt(12)):(this.o=0,Nt(13)),Ci(this),Sa(this)}}}catch{}finally{}};function _T(t){return t.g?t.u=="GET"&&t.K!=2&&t.l.Ba:!1}function wT(t,e,n){for(var r=!0,o;!t.I&&t.C<n.length;)if(o=DP(t,n),o==hl){e==4&&(t.o=4,Nt(14),r=!1),jo(t.j,t.m,null,"[Incomplete Response]");break}else if(o==mv){t.o=4,Nt(15),jo(t.j,t.m,n,"[Invalid Chunk]"),r=!1;break}else jo(t.j,t.m,o,null),_v(t,o);_T(t)&&o!=hl&&o!=mv&&(t.h.g="",t.C=0),e!=4||n.length!=0||t.h.h||(t.o=1,Nt(16),r=!1),t.i=t.i&&r,r?0<n.length&&!t.aa&&(t.aa=!0,e=t.l,e.g==t&&e.$&&!e.L&&(e.h.info("Great, no buffering proxy detected. Bytes received: "+n.length),Lg(e),e.L=!0,Nt(11))):(jo(t.j,t.m,n,"[Invalid Chunked Response]"),Ci(t),Sa(t))}B.fb=function(){if(this.g){var t=sr(this.g),e=this.g.ga();this.C<e.length&&(ah(this),wT(this,t,e),this.i&&t!=4&&hu(this))}};function DP(t,e){var n=t.C,r=e.indexOf(`
`,n);return r==-1?hl:(n=Number(e.substring(n,r)),isNaN(n)?mv:(r+=1,r+n>e.length?hl:(e=e.substr(r,n),t.C=r+n,e)))}B.cancel=function(){this.I=!0,Ci(this)};function hu(t){t.Y=Date.now()+t.P,bT(t,t.P)}function bT(t,e){if(t.B!=null)throw Error("WatchDog timer not null");t.B=uu(ct(t.eb,t),e)}function ah(t){t.B&&(ee.clearTimeout(t.B),t.B=null)}B.eb=function(){this.B=null;var t=Date.now();0<=t-this.Y?(kP(this.j,this.A),this.K!=2&&(Ba(),Nt(17)),Ci(this),this.o=2,Sa(this)):bT(this,this.Y-t)};function Sa(t){t.l.G==0||t.I||BT(t.l,t)}function Ci(t){ah(t);var e=t.L;e&&typeof e.na=="function"&&e.na(),t.L=null,Ig(t.W),hT(t.V),t.g&&(e=t.g,t.g=null,e.abort(),e.na())}function _v(t,e){try{var n=t.l;if(n.G!=0&&(n.g==t||wv(n.i,t))){if(n.I=t.N,!t.J&&wv(n.i,t)&&n.G==3){try{var r=n.Ca.g.parse(e)}catch{r=null}if(Array.isArray(r)&&r.length==3){var o=r;if(o[0]==0){e:if(!n.u){if(n.g)if(n.g.F+3e3<t.F)vl(n),hh(n);else break e;xg(n),Nt(18)}}else n.ta=o[1],0<n.ta-n.U&&37500>o[2]&&n.N&&n.A==0&&!n.v&&(n.v=uu(ct(n.ab,n),6e3));if(1>=kT(n.i)&&n.ka){try{n.ka()}catch{}n.ka=void 0}}else Ai(n,11)}else if((t.J||n.g==t)&&vl(n),!cl(e))for(o=n.Ca.g.parse(e),e=0;e<o.length;e++){var s=o[e];if(n.U=s[0],s=s[1],n.G==2)if(s[0]=="c"){n.J=s[1],n.la=s[2];var u=s[3];u!=null&&(n.ma=u,n.h.info("VER="+n.ma));var l=s[4];l!=null&&(n.za=l,n.h.info("SVER="+n.za));var h=s[5];h!=null&&typeof h=="number"&&0<h&&(r=1.5*h,n.K=r,n.h.info("backChannelRequestTimeoutMs_="+r)),r=n;var d=t.g;if(d){var p=d.g?d.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(p){var g=r.i;!g.g&&(At(p,"spdy")||At(p,"quic")||At(p,"h2"))&&(g.j=g.l,g.g=new Set,g.h&&(Ng(g,g.h),g.h=null))}if(r.D){var y=d.g?d.g.getResponseHeader("X-HTTP-Session-Id"):null;y&&(r.sa=y,Ne(r.F,r.D,y))}}n.G=3,n.j&&n.j.xa(),n.$&&(n.O=Date.now()-t.F,n.h.info("Handshake RTT: "+n.O+"ms")),r=n;var w=t;if(r.oa=WT(r,r.H?r.la:null,r.W),w.J){NT(r.i,w);var b=w,E=r.K;E&&b.setTimeout(E),b.B&&(ah(b),hu(b)),r.g=w}else VT(r);0<n.l.length&&fh(n)}else s[0]!="stop"&&s[0]!="close"||Ai(n,7);else n.G==3&&(s[0]=="stop"||s[0]=="close"?s[0]=="stop"?Ai(n,7):Pg(n):s[0]!="noop"&&n.j&&n.j.wa(s),n.A=0)}}Ba(4)}catch{}}function OP(t){if(t.R&&typeof t.R=="function")return t.R();if(typeof t=="string")return t.split("");if(cv(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}e=[],n=0;for(r in t)e[n++]=t[r];return e}function Ag(t,e){if(t.forEach&&typeof t.forEach=="function")t.forEach(e,void 0);else if(cv(t)||typeof t=="string")XE(t,e,void 0);else{if(t.T&&typeof t.T=="function")var n=t.T();else if(t.R&&typeof t.R=="function")n=void 0;else if(cv(t)||typeof t=="string"){n=[];for(var r=t.length,o=0;o<r;o++)n.push(o)}else for(o in n=[],r=0,t)n[r++]=o;r=OP(t),o=r.length;for(var s=0;s<o;s++)e.call(void 0,r[s],n&&n[s],t)}}function gs(t,e){this.h={},this.g=[],this.i=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof gs)for(n=t.T(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}B=gs.prototype;B.R=function(){kg(this);for(var t=[],e=0;e<this.g.length;e++)t.push(this.h[this.g[e]]);return t};B.T=function(){return kg(this),this.g.concat()};function kg(t){if(t.i!=t.g.length){for(var e=0,n=0;e<t.g.length;){var r=t.g[e];Bi(t.h,r)&&(t.g[n++]=r),e++}t.g.length=n}if(t.i!=t.g.length){var o={};for(n=e=0;e<t.g.length;)r=t.g[e],Bi(o,r)||(t.g[n++]=r,o[r]=1),e++;t.g.length=n}}B.get=function(t,e){return Bi(this.h,t)?this.h[t]:e};B.set=function(t,e){Bi(this.h,t)||(this.i++,this.g.push(t)),this.h[t]=e};B.forEach=function(t,e){for(var n=this.T(),r=0;r<n.length;r++){var o=n[r],s=this.get(o);t.call(e,s,o,this)}};function Bi(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var IT=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function PP(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),o=null;if(0<=r){var s=t[n].substring(0,r);o=t[n].substring(r+1)}else s=t[n];e(s,o?decodeURIComponent(o.replace(/\+/g," ")):"")}}}function qi(t,e){if(this.i=this.s=this.j="",this.m=null,this.o=this.l="",this.g=!1,t instanceof qi){this.g=e!==void 0?e:t.g,fl(this,t.j),this.s=t.s,dl(this,t.i),pl(this,t.m),this.l=t.l,e=t.h;var n=new qa;n.i=e.i,e.g&&(n.g=new gs(e.g),n.h=e.h),b0(this,n),this.o=t.o}else t&&(n=String(t).match(IT))?(this.g=!!e,fl(this,n[1]||"",!0),this.s=Ca(n[2]||""),dl(this,n[3]||"",!0),pl(this,n[4]),this.l=Ca(n[5]||"",!0),b0(this,n[6]||"",!0),this.o=Ca(n[7]||"")):(this.g=!!e,this.h=new qa(null,this.g))}qi.prototype.toString=function(){var t=[],e=this.j;e&&t.push(Ea(e,I0,!0),":");var n=this.i;return(n||e=="file")&&(t.push("//"),(e=this.s)&&t.push(Ea(e,I0,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),n=this.m,n!=null&&t.push(":",String(n))),(n=this.l)&&(this.i&&n.charAt(0)!="/"&&t.push("/"),t.push(Ea(n,n.charAt(0)=="/"?UP:FP,!0))),(n=this.h.toString())&&t.push("?",n),(n=this.o)&&t.push("#",Ea(n,jP)),t.join("")};function dr(t){return new qi(t)}function fl(t,e,n){t.j=n?Ca(e,!0):e,t.j&&(t.j=t.j.replace(/:$/,""))}function dl(t,e,n){t.i=n?Ca(e,!0):e}function pl(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.m=e}else t.m=null}function b0(t,e,n){e instanceof qa?(t.h=e,BP(t.h,t.g)):(n||(e=Ea(e,VP)),t.h=new qa(e,t.g))}function Ne(t,e,n){t.h.set(e,n)}function uh(t){return Ne(t,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),t}function xP(t){return t instanceof qi?dr(t):new qi(t,void 0)}function LP(t,e,n,r){var o=new qi(null,void 0);return t&&fl(o,t),e&&dl(o,e),n&&pl(o,n),r&&(o.l=r),o}function Ca(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function Ea(t,e,n){return typeof t=="string"?(t=encodeURI(t).replace(e,MP),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function MP(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(t&15).toString(16)}var I0=/[#\/\?@]/g,FP=/[#\?:]/g,UP=/[#\?]/g,VP=/[#\?@]/g,jP=/#/g;function qa(t,e){this.h=this.g=null,this.i=t||null,this.j=!!e}function $r(t){t.g||(t.g=new gs,t.h=0,t.i&&PP(t.i,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}B=qa.prototype;B.add=function(t,e){$r(this),this.i=null,t=ms(this,t);var n=this.g.get(t);return n||this.g.set(t,n=[]),n.push(e),this.h+=1,this};function ET(t,e){$r(t),e=ms(t,e),Bi(t.g.h,e)&&(t.i=null,t.h-=t.g.get(e).length,t=t.g,Bi(t.h,e)&&(delete t.h[e],t.i--,t.g.length>2*t.i&&kg(t)))}function TT(t,e){return $r(t),e=ms(t,e),Bi(t.g.h,e)}B.forEach=function(t,e){$r(this),this.g.forEach(function(n,r){XE(n,function(o){t.call(e,o,r,this)},this)},this)};B.T=function(){$r(this);for(var t=this.g.R(),e=this.g.T(),n=[],r=0;r<e.length;r++)for(var o=t[r],s=0;s<o.length;s++)n.push(e[r]);return n};B.R=function(t){$r(this);var e=[];if(typeof t=="string")TT(this,t)&&(e=f0(e,this.g.get(ms(this,t))));else{t=this.g.R();for(var n=0;n<t.length;n++)e=f0(e,t[n])}return e};B.set=function(t,e){return $r(this),this.i=null,t=ms(this,t),TT(this,t)&&(this.h-=this.g.get(t).length),this.g.set(t,[e]),this.h+=1,this};B.get=function(t,e){return t?(t=this.R(t),0<t.length?String(t[0]):e):e};function ST(t,e,n){ET(t,e),0<n.length&&(t.i=null,t.g.set(ms(t,e),pg(n)),t.h+=n.length)}B.toString=function(){if(this.i)return this.i;if(!this.g)return"";for(var t=[],e=this.g.T(),n=0;n<e.length;n++){var r=e[n],o=encodeURIComponent(String(r));r=this.R(r);for(var s=0;s<r.length;s++){var u=o;r[s]!==""&&(u+="="+encodeURIComponent(String(r[s]))),t.push(u)}}return this.i=t.join("&")};function ms(t,e){return e=String(e),t.j&&(e=e.toLowerCase()),e}function BP(t,e){e&&!t.j&&($r(t),t.i=null,t.g.forEach(function(n,r){var o=r.toLowerCase();r!=o&&(ET(this,r),ST(this,o,n))},t)),t.j=e}var qP=function(){function t(e,n){this.h=e,this.g=n}return t}();function CT(t){this.l=t||GP,ee.PerformanceNavigationTiming?(t=ee.performance.getEntriesByType("navigation"),t=0<t.length&&(t[0].nextHopProtocol=="hq"||t[0].nextHopProtocol=="h2")):t=!!(ee.g&&ee.g.Ea&&ee.g.Ea()&&ee.g.Ea().Zb),this.j=t?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}var GP=10;function AT(t){return t.h?!0:t.g?t.g.size>=t.j:!1}function kT(t){return t.h?1:t.g?t.g.size:0}function wv(t,e){return t.h?t.h==e:t.g?t.g.has(e):!1}function Ng(t,e){t.g?t.g.add(e):t.h=e}function NT(t,e){t.h&&t.h==e?t.h=null:t.g&&t.g.has(e)&&t.g.delete(e)}CT.prototype.cancel=function(){var t,e;if(this.i=RT(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){try{for(var n=QE(this.g.values()),r=n.next();!r.done;r=n.next()){var o=r.value;o.cancel()}}catch(s){t={error:s}}finally{try{r&&!r.done&&(e=n.return)&&e.call(n)}finally{if(t)throw t.error}}this.g.clear()}};function RT(t){var e,n;if(t.h!=null)return t.i.concat(t.h.D);if(t.g!=null&&t.g.size!==0){var r=t.i;try{for(var o=QE(t.g.values()),s=o.next();!s.done;s=o.next()){var u=s.value;r=r.concat(u.D)}}catch(l){e={error:l}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r}return pg(t.i)}function Rg(){}Rg.prototype.stringify=function(t){return ee.JSON.stringify(t,void 0)};Rg.prototype.parse=function(t){return ee.JSON.parse(t,void 0)};function WP(){this.g=new Rg}function HP(t,e,n){var r=n||"";try{Ag(t,function(o,s){var u=o;Jl(o)&&(u=wg(o)),e.push(r+s+"="+encodeURIComponent(u))})}catch(o){throw e.push(r+"type="+encodeURIComponent("_badmap")),o}}function KP(t,e){var n=new rh;if(ee.Image){var r=new Image;r.onload=Uc(jc,n,r,"TestLoadImage: loaded",!0,e),r.onerror=Uc(jc,n,r,"TestLoadImage: error",!1,e),r.onabort=Uc(jc,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=Uc(jc,n,r,"TestLoadImage: timeout",!1,e),ee.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}else e(!1)}function jc(t,e,n,r,o){try{e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,o(r)}catch{}}function fu(t){this.l=t.$b||null,this.j=t.ib||!1}ft(fu,Tg);fu.prototype.g=function(){return new ch(this.l,this.j)};fu.prototype.i=function(t){return function(){return t}}({});function ch(t,e){rt.call(this),this.D=t,this.u=e,this.m=void 0,this.readyState=Dg,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.v=new Headers,this.h=null,this.C="GET",this.B="",this.g=!1,this.A=this.j=this.l=null}ft(ch,rt);var Dg=0;B=ch.prototype;B.open=function(t,e){if(this.readyState!=Dg)throw this.abort(),Error("Error reopening a connection");this.C=t,this.B=e,this.readyState=1,Ga(this)};B.send=function(t){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;var e={headers:this.v,method:this.C,credentials:this.m,cache:void 0};t&&(e.body=t),(this.D||ee).fetch(new Request(this.B,e)).then(this.Va.bind(this),this.ha.bind(this))};B.abort=function(){this.response=this.responseText="",this.v=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted."),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,du(this)),this.readyState=Dg};B.Va=function(t){if(this.g&&(this.l=t,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=t.headers,this.readyState=2,Ga(this)),this.g&&(this.readyState=3,Ga(this),this.g)))if(this.responseType==="arraybuffer")t.arrayBuffer().then(this.Ta.bind(this),this.ha.bind(this));else if(typeof ee.ReadableStream<"u"&&"body"in t){if(this.j=t.body.getReader(),this.u){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.A=new TextDecoder;DT(this)}else t.text().then(this.Ua.bind(this),this.ha.bind(this))};function DT(t){t.j.read().then(t.Sa.bind(t)).catch(t.ha.bind(t))}B.Sa=function(t){if(this.g){if(this.u&&t.value)this.response.push(t.value);else if(!this.u){var e=t.value?t.value:new Uint8Array(0);(e=this.A.decode(e,{stream:!t.done}))&&(this.response=this.responseText+=e)}t.done?du(this):Ga(this),this.readyState==3&&DT(this)}};B.Ua=function(t){this.g&&(this.response=this.responseText=t,du(this))};B.Ta=function(t){this.g&&(this.response=t,du(this))};B.ha=function(){this.g&&du(this)};function du(t){t.readyState=4,t.l=null,t.j=null,t.A=null,Ga(t)}B.setRequestHeader=function(t,e){this.v.append(t,e)};B.getResponseHeader=function(t){return this.h&&this.h.get(t.toLowerCase())||""};B.getAllResponseHeaders=function(){if(!this.h)return"";for(var t=[],e=this.h.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join(`\r
`)};function Ga(t){t.onreadystatechange&&t.onreadystatechange.call(t)}Object.defineProperty(ch.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(t){this.m=t?"include":"same-origin"}});var zP=ee.JSON.parse;function He(t){rt.call(this),this.headers=new gs,this.u=t||null,this.h=!1,this.C=this.g=null,this.H="",this.m=0,this.j="",this.l=this.F=this.v=this.D=!1,this.B=0,this.A=null,this.J=OT,this.K=this.L=!1}ft(He,rt);var OT="",$P=/^https?$/i,QP=["POST","PUT"];B=He.prototype;B.ea=function(t,e,n,r){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.H+"; newUri="+t);e=e?e.toUpperCase():"GET",this.H=t,this.j="",this.m=0,this.D=!1,this.h=!0,this.g=this.u?this.u.g():gv.g(),this.C=this.u?w0(this.u):w0(gv),this.g.onreadystatechange=ct(this.Fa,this);try{this.F=!0,this.g.open(e,String(t),!0),this.F=!1}catch(s){E0(this,s);return}t=n||"";var o=new gs(this.headers);r&&Ag(r,function(s,u){o.set(u,s)}),r=oP(o.T()),n=ee.FormData&&t instanceof ee.FormData,!(0<=YE(QP,e))||r||n||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(s,u){this.g.setRequestHeader(u,s)},this),this.J&&(this.g.responseType=this.J),"withCredentials"in this.g&&this.g.withCredentials!==this.L&&(this.g.withCredentials=this.L);try{LT(this),0<this.B&&((this.K=YP(this.g))?(this.g.timeout=this.B,this.g.ontimeout=ct(this.pa,this)):this.A=Eg(this.pa,this.B,this)),this.v=!0,this.g.send(t),this.v=!1}catch(s){E0(this,s)}};function YP(t){return Ko&&lP()&&typeof t.timeout=="number"&&t.ontimeout!==void 0}function XP(t){return t.toLowerCase()=="content-type"}B.pa=function(){typeof dg<"u"&&this.g&&(this.j="Timed out after "+this.B+"ms, aborting",this.m=8,lt(this,"timeout"),this.abort(8))};function E0(t,e){t.h=!1,t.g&&(t.l=!0,t.g.abort(),t.l=!1),t.j=e,t.m=5,PT(t),lh(t)}function PT(t){t.D||(t.D=!0,lt(t,"complete"),lt(t,"error"))}B.abort=function(t){this.g&&this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1,this.m=t||7,lt(this,"complete"),lt(this,"abort"),lh(this))};B.M=function(){this.g&&(this.h&&(this.h=!1,this.l=!0,this.g.abort(),this.l=!1),lh(this,!0)),He.Z.M.call(this)};B.Fa=function(){this.s||(this.F||this.v||this.l?xT(this):this.cb())};B.cb=function(){xT(this)};function xT(t){if(t.h&&typeof dg<"u"&&(!t.C[1]||sr(t)!=4||t.ba()!=2)){if(t.v&&sr(t)==4)Eg(t.Fa,0,t);else if(lt(t,"readystatechange"),sr(t)==4){t.h=!1;try{var e=t.ba();e:switch(e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var n=!0;break e;default:n=!1}var r;if(!(r=n)){var o;if(o=e===0){var s=String(t.H).match(IT)[1]||null;if(!s&&ee.self&&ee.self.location){var u=ee.self.location.protocol;s=u.substr(0,u.length-1)}o=!$P.test(s?s.toLowerCase():"")}r=o}if(r)lt(t,"complete"),lt(t,"success");else{t.m=6;try{var l=2<sr(t)?t.g.statusText:""}catch{l=""}t.j=l+" ["+t.ba()+"]",PT(t)}}finally{lh(t)}}}}function lh(t,e){if(t.g){LT(t);var n=t.g,r=t.C[0]?ul:null;t.g=null,t.C=null,e||lt(t,"ready");try{n.onreadystatechange=r}catch{}}}function LT(t){t.g&&t.K&&(t.g.ontimeout=null),t.A&&(ee.clearTimeout(t.A),t.A=null)}function sr(t){return t.g?t.g.readyState:0}B.ba=function(){try{return 2<sr(this)?this.g.status:-1}catch{return-1}};B.ga=function(){try{return this.g?this.g.responseText:""}catch{return""}};B.Qa=function(t){if(this.g){var e=this.g.responseText;return t&&e.indexOf(t)==0&&(e=e.substring(t.length)),zP(e)}};function T0(t){try{if(!t.g)return null;if("response"in t.g)return t.g.response;switch(t.J){case OT:case"text":return t.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in t.g)return t.g.mozResponseArrayBuffer}return null}catch{return null}}B.Da=function(){return this.m};B.La=function(){return typeof this.j=="string"?this.j:String(this.j)};function JP(t){var e="";return vg(t,function(n,r){e+=r,e+=":",e+=n,e+=`\r
`}),e}function Og(t,e,n){e:{for(r in n){var r=!1;break e}r=!0}r||(n=JP(n),typeof t=="string"?n!=null&&encodeURIComponent(String(n)):Ne(t,e,n))}function ga(t,e,n){return n&&n.internalChannelParams&&n.internalChannelParams[t]||e}function MT(t){this.za=0,this.l=[],this.h=new rh,this.la=this.oa=this.F=this.W=this.g=this.sa=this.D=this.aa=this.o=this.P=this.s=null,this.Za=this.V=0,this.Xa=ga("failFast",!1,t),this.N=this.v=this.u=this.m=this.j=null,this.X=!0,this.I=this.ta=this.U=-1,this.Y=this.A=this.C=0,this.Pa=ga("baseRetryDelayMs",5e3,t),this.$a=ga("retryDelaySeedMs",1e4,t),this.Ya=ga("forwardChannelMaxRetries",2,t),this.ra=ga("forwardChannelRequestTimeoutMs",2e4,t),this.qa=t&&t.xmlHttpFactory||void 0,this.Ba=t&&t.Yb||!1,this.K=void 0,this.H=t&&t.supportsCrossDomainXhr||!1,this.J="",this.i=new CT(t&&t.concurrentRequestLimit),this.Ca=new WP,this.ja=t&&t.fastHandshake||!1,this.Ra=t&&t.Wb||!1,t&&t.Aa&&this.h.Aa(),t&&t.forceLongPolling&&(this.X=!1),this.$=!this.ja&&this.X&&t&&t.detectBufferingProxy||!1,this.ka=void 0,this.O=0,this.L=!1,this.B=null,this.Wa=!t||t.Xb!==!1}B=MT.prototype;B.ma=8;B.G=1;function Pg(t){if(FT(t),t.G==3){var e=t.V++,n=dr(t.F);Ne(n,"SID",t.J),Ne(n,"RID",e),Ne(n,"TYPE","terminate"),pu(t,n),e=new lu(t,t.h,e,void 0),e.K=2,e.v=uh(dr(n)),n=!1,ee.navigator&&ee.navigator.sendBeacon&&(n=ee.navigator.sendBeacon(e.v.toString(),"")),!n&&ee.Image&&(new Image().src=e.v,n=!0),n||(e.g=HT(e.l,null),e.g.ea(e.v)),e.F=Date.now(),hu(e)}GT(t)}B.hb=function(t){try{this.h.info("Origin Trials invoked: "+t)}catch{}};function hh(t){t.g&&(Lg(t),t.g.cancel(),t.g=null)}function FT(t){hh(t),t.u&&(ee.clearTimeout(t.u),t.u=null),vl(t),t.i.cancel(),t.m&&(typeof t.m=="number"&&ee.clearTimeout(t.m),t.m=null)}function Gp(t,e){t.l.push(new qP(t.Za++,e)),t.G==3&&fh(t)}function fh(t){AT(t.i)||t.m||(t.m=!0,bg(t.Ha,t),t.C=0)}function ZP(t,e){return kT(t.i)>=t.i.j-(t.m?1:0)?!1:t.m?(t.l=e.D.concat(t.l),!0):t.G==1||t.G==2||t.C>=(t.Xa?0:t.Ya)?!1:(t.m=uu(ct(t.Ha,t,e),qT(t,t.C)),t.C++,!0)}B.Ha=function(t){if(this.m)if(this.m=null,this.G==1){if(!t){this.V=Math.floor(1e5*Math.random()),t=this.V++;var e=new lu(this,this.h,t,void 0),n=this.s;if(this.P&&(n?(n=JE(n),ZE(n,this.P)):n=this.P),this.o===null&&(e.H=n),this.ja)e:{for(var r=0,o=0;o<this.l.length;o++){t:{var s=this.l[o];if("__data__"in s.g&&(s=s.g.__data__,typeof s=="string")){s=s.length;break t}s=void 0}if(s===void 0)break;if(r+=s,4096<r){r=o;break e}if(r===4096||o===this.l.length-1){r=o+1;break e}}r=1e3}else r=1e3;r=UT(this,e,r),o=dr(this.F),Ne(o,"RID",t),Ne(o,"CVER",22),this.D&&Ne(o,"X-HTTP-Session-Id",this.D),pu(this,o),this.o&&n&&Og(o,this.o,n),Ng(this.i,e),this.Ra&&Ne(o,"TYPE","init"),this.ja?(Ne(o,"$req",r),Ne(o,"SID","null"),e.$=!0,yv(e,o,null)):yv(e,o,r),this.G=2}}else this.G==3&&(t?S0(this,t):this.l.length==0||AT(this.i)||S0(this))};function S0(t,e){var n;e?n=e.m:n=t.V++;var r=dr(t.F);Ne(r,"SID",t.J),Ne(r,"RID",n),Ne(r,"AID",t.U),pu(t,r),t.o&&t.s&&Og(r,t.o,t.s),n=new lu(t,t.h,n,t.C+1),t.o===null&&(n.H=t.s),e&&(t.l=e.D.concat(t.l)),e=UT(t,n,1e3),n.setTimeout(Math.round(.5*t.ra)+Math.round(.5*t.ra*Math.random())),Ng(t.i,n),yv(n,r,e)}function pu(t,e){t.j&&Ag({},function(n,r){Ne(e,r,n)})}function UT(t,e,n){n=Math.min(t.l.length,n);var r=t.j?ct(t.j.Oa,t.j,t):null;e:for(var o=t.l,s=-1;;){var u=["count="+n];s==-1?0<n?(s=o[0].h,u.push("ofs="+s)):s=0:u.push("ofs="+s);for(var l=!0,h=0;h<n;h++){var d=o[h].h,p=o[h].g;if(d-=s,0>d)s=Math.max(0,o[h].h-100),l=!1;else try{HP(p,u,"req"+d+"_")}catch{r&&r(p)}}if(l){r=u.join("&");break e}}return t=t.l.splice(0,n),e.D=t,r}function VT(t){t.g||t.u||(t.Y=1,bg(t.Ga,t),t.A=0)}function xg(t){return t.g||t.u||3<=t.A?!1:(t.Y++,t.u=uu(ct(t.Ga,t),qT(t,t.A)),t.A++,!0)}B.Ga=function(){if(this.u=null,jT(this),this.$&&!(this.L||this.g==null||0>=this.O)){var t=2*this.O;this.h.info("BP detection timer enabled: "+t),this.B=uu(ct(this.bb,this),t)}};B.bb=function(){this.B&&(this.B=null,this.h.info("BP detection timeout reached."),this.h.info("Buffering proxy detected and switch to long-polling!"),this.N=!1,this.L=!0,Nt(10),hh(this),jT(this))};function Lg(t){t.B!=null&&(ee.clearTimeout(t.B),t.B=null)}function jT(t){t.g=new lu(t,t.h,"rpc",t.Y),t.o===null&&(t.g.H=t.s),t.g.O=0;var e=dr(t.oa);Ne(e,"RID","rpc"),Ne(e,"SID",t.J),Ne(e,"CI",t.N?"0":"1"),Ne(e,"AID",t.U),pu(t,e),Ne(e,"TYPE","xmlhttp"),t.o&&t.s&&Og(e,t.o,t.s),t.K&&t.g.setTimeout(t.K);var n=t.g;t=t.la,n.K=1,n.v=uh(dr(e)),n.s=null,n.U=!0,yT(n,t)}B.ab=function(){this.v!=null&&(this.v=null,hh(this),xg(this),Nt(19))};function vl(t){t.v!=null&&(ee.clearTimeout(t.v),t.v=null)}function BT(t,e){var n=null;if(t.g==e){vl(t),Lg(t),t.g=null;var r=2}else if(wv(t.i,e))n=e.D,NT(t.i,e),r=1;else return;if(t.I=e.N,t.G!=0){if(e.i)if(r==1){n=e.s?e.s.length:0,e=Date.now()-e.F;var o=t.C;r=ih(),lt(r,new pT(r,n)),fh(t)}else VT(t);else if(o=e.o,o==3||o==0&&0<t.I||!(r==1&&ZP(t,e)||r==2&&xg(t)))switch(n&&0<n.length&&(e=t.i,e.i=e.i.concat(n)),o){case 1:Ai(t,5);break;case 4:Ai(t,10);break;case 3:Ai(t,6);break;default:Ai(t,2)}}}function qT(t,e){var n=t.Pa+Math.floor(Math.random()*t.$a);return t.j||(n*=2),n*e}function Ai(t,e){if(t.h.info("Error code "+e),e==2){var n=null;t.j&&(n=null);var r=ct(t.jb,t);n||(n=new qi("//www.google.com/images/cleardot.gif"),ee.location&&ee.location.protocol=="http"||fl(n,"https"),uh(n)),KP(n.toString(),r)}else Nt(2);t.G=0,t.j&&t.j.va(e),GT(t),FT(t)}B.jb=function(t){t?(this.h.info("Successfully pinged google.com"),Nt(2)):(this.h.info("Failed to ping google.com"),Nt(1))};function GT(t){t.G=0,t.I=-1,t.j&&((RT(t.i).length!=0||t.l.length!=0)&&(t.i.i.length=0,pg(t.l),t.l.length=0),t.j.ua())}function WT(t,e,n){var r=xP(n);if(r.i!="")e&&dl(r,e+"."+r.i),pl(r,r.m);else{var o=ee.location;r=LP(o.protocol,e?e+"."+o.hostname:o.hostname,+o.port,n)}return t.aa&&vg(t.aa,function(s,u){Ne(r,u,s)}),e=t.D,n=t.sa,e&&n&&Ne(r,e,n),Ne(r,"VER",t.ma),pu(t,r),r}function HT(t,e,n){if(e&&!t.H)throw Error("Can't create secondary domain capable XhrIo object.");return e=n&&t.Ba&&!t.qa?new He(new fu({ib:!0})):new He(t.qa),e.L=t.H,e}function KT(){}B=KT.prototype;B.xa=function(){};B.wa=function(){};B.va=function(){};B.ua=function(){};B.Oa=function(){};function gl(){if(Ko&&!(10<=Number(hP)))throw Error("Environmental error: no available transport.")}gl.prototype.g=function(t,e){return new nn(t,e)};function nn(t,e){rt.call(this),this.g=new MT(e),this.l=t,this.h=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.g.s=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.ya&&(t?t["X-WebChannel-Client-Profile"]=e.ya:t={"X-WebChannel-Client-Profile":e.ya}),this.g.P=t,(t=e&&e.httpHeadersOverwriteParam)&&!cl(t)&&(this.g.o=t),this.A=e&&e.supportsCrossDomainXhr||!1,this.v=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!cl(e)&&(this.g.D=e,t=this.h,t!==null&&e in t&&(t=this.h,e in t&&delete t[e])),this.j=new ys(this)}ft(nn,rt);nn.prototype.m=function(){this.g.j=this.j,this.A&&(this.g.H=!0);var t=this.g,e=this.l,n=this.h||void 0;t.Wa&&(t.h.info("Origin Trials enabled."),bg(ct(t.hb,t,e))),Nt(0),t.W=e,t.aa=n||{},t.N=t.X,t.F=WT(t,null,t.W),fh(t)};nn.prototype.close=function(){Pg(this.g)};nn.prototype.u=function(t){if(typeof t=="string"){var e={};e.__data__=t,Gp(this.g,e)}else this.v?(e={},e.__data__=wg(t),Gp(this.g,e)):Gp(this.g,t)};nn.prototype.M=function(){this.g.j=null,delete this.j,Pg(this.g),delete this.g,nn.Z.M.call(this)};function zT(t){Sg.call(this);var e=t.__sm__;if(e){e:{for(var n in e){t=n;break e}t=void 0}(this.i=t)&&(t=this.i,e=e!==null&&t in e?e[t]:void 0),this.data=e}else this.data=t}ft(zT,Sg);function $T(){Cg.call(this),this.status=1}ft($T,Cg);function ys(t){this.g=t}ft(ys,KT);ys.prototype.xa=function(){lt(this.g,"a")};ys.prototype.wa=function(t){lt(this.g,new zT(t))};ys.prototype.va=function(t){lt(this.g,new $T)};ys.prototype.ua=function(){lt(this.g,"b")};gl.prototype.createWebChannel=gl.prototype.g;nn.prototype.send=nn.prototype.u;nn.prototype.open=nn.prototype.m;nn.prototype.close=nn.prototype.close;oh.NO_ERROR=0;oh.TIMEOUT=8;oh.HTTP_ERROR=6;vT.COMPLETE="complete";gT.EventType=cu;cu.OPEN="a";cu.CLOSE="b";cu.ERROR="c";cu.MESSAGE="d";rt.prototype.listen=rt.prototype.N;He.prototype.listenOnce=He.prototype.O;He.prototype.getLastError=He.prototype.La;He.prototype.getLastErrorCode=He.prototype.Da;He.prototype.getStatus=He.prototype.ba;He.prototype.getResponseJson=He.prototype.Qa;He.prototype.getResponseText=He.prototype.ga;He.prototype.send=He.prototype.ea;var ex=function(){return new gl},tx=function(){return ih()},Wp=oh,nx=vT,rx=Yi,C0={rb:0,ub:1,vb:2,Ob:3,Tb:4,Qb:5,Rb:6,Pb:7,Nb:8,Sb:9,PROXY:10,NOPROXY:11,Lb:12,Hb:13,Ib:14,Gb:15,Jb:16,Kb:17,nb:18,mb:19,ob:20},ix=fu,Bc=gT,ox=He,sx={};/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jt=function(){function t(e,n){var r=this;this.previousValue=e,n&&(n.sequenceNumberHandler=function(o){return r.t(o)},this.i=function(o){return n.writeSequenceNumber(o)})}return t.prototype.t=function(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue},t.prototype.next=function(){var e=++this.previousValue;return this.i&&this.i(e),e},t}();Jt.o=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var N={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},P=function(t){function e(n,r){var o=this;return(o=t.call(this,r)||this).code=n,o.message=r,o.name="FirebaseError",o.toString=function(){return o.name+": [code="+o.code+"]: "+o.message},o}return V(e,t),e}(Error),kn=new Xl("@firebase/firestore");function bv(){return kn.logLevel}function U(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(kn.logLevel<=fe.DEBUG){var r=e.map(Mg);kn.debug.apply(kn,ve(["Firestore (8.10.1): "+t],r))}}function We(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(kn.logLevel<=fe.ERROR){var r=e.map(Mg);kn.error.apply(kn,ve(["Firestore (8.10.1): "+t],r))}}function ml(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(kn.logLevel<=fe.WARN){var r=e.map(Mg);kn.warn.apply(kn,ve(["Firestore (8.10.1): "+t],r))}}function Mg(t){if(typeof t=="string")return t;try{return e=t,JSON.stringify(e)}catch{return t}var e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function W(t){t===void 0&&(t="Unexpected state");var e="FIRESTORE (8.10.1) INTERNAL ASSERTION FAILED: "+t;throw We(e),new Error(e)}function Y(t,e){t||W()}function j(t,e){return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ax(t){var e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(var r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var QT=function(){function t(){}return t.u=function(){for(var e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=Math.floor(256/e.length)*e.length,r="";r.length<20;)for(var o=ax(40),s=0;s<o.length;++s)r.length<20&&o[s]<n&&(r+=e.charAt(o[s]%e.length));return r},t}();function ce(t,e){return t<e?-1:t>e?1:0}function zo(t,e,n){return t.length===e.length&&t.every(function(r,o){return n(r,e[o])})}function YT(t){return t+"\0"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bt=function(){function t(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new P(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new P(N.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<-62135596800)throw new P(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new P(N.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,Math.floor(1e6*(e-1e3*n)))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(e){return this.seconds===e.seconds?ce(this.nanoseconds,e.nanoseconds):ce(this.seconds,e.seconds)},t.prototype.isEqual=function(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t.prototype.toJSON=function(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}},t.prototype.valueOf=function(){var e=this.seconds- -62135596800;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")},t}(),se=function(){function t(e){this.timestamp=e}return t.fromTimestamp=function(e){return new t(e)},t.min=function(){return new t(new Bt(0,0))},t.prototype.compareTo=function(e){return this.timestamp._compareTo(e.timestamp)},t.prototype.isEqual=function(e){return this.timestamp.isEqual(e.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function A0(t){var e=0;for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function Xi(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function XT(t){for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var JT=function(){function t(e,n,r){n===void 0?n=0:n>e.length&&W(),r===void 0?r=e.length-n:r>e.length-n&&W(),this.segments=e,this.offset=n,this.len=r}return Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return t.comparator(this,e)===0},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(r){n.push(r)}):n.push(e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)},t.prototype.popLast=function(){return this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return this.segments[this.offset]},t.prototype.lastSegment=function(){return this.get(this.length-1)},t.prototype.get=function(e){return this.segments[this.offset+e]},t.prototype.isEmpty=function(){return this.length===0},t.prototype.isPrefixOf=function(e){if(e.length<this.length)return!1;for(var n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0},t.prototype.isImmediateParentOf=function(e){if(this.length+1!==e.length)return!1;for(var n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0},t.prototype.forEach=function(e){for(var n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(e,n){for(var r=Math.min(e.length,n.length),o=0;o<r;o++){var s=e.get(o),u=n.get(o);if(s<u)return-1;if(s>u)return 1}return e.length<n.length?-1:e.length>n.length?1:0},t}(),ge=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return V(e,t),e.prototype.construct=function(n,r,o){return new e(n,r,o)},e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];for(var o=[],s=0,u=n;s<u.length;s++){var l=u[s];if(l.indexOf("//")>=0)throw new P(N.INVALID_ARGUMENT,"Invalid segment ("+l+"). Paths must not contain // in them.");o.push.apply(o,l.split("/").filter(function(h){return h.length>0}))}return new e(o)},e.emptyPath=function(){return new e([])},e}(JT),ux=/^[_a-zA-Z][_a-zA-Z0-9]*$/,Dn=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return V(e,t),e.prototype.construct=function(n,r,o){return new e(n,r,o)},e.isValidIdentifier=function(n){return ux.test(n)},e.prototype.canonicalString=function(){return this.toArray().map(function(n){return n=n.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),e.isValidIdentifier(n)||(n="`"+n+"`"),n}).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return this.length===1&&this.get(0)==="__name__"},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(n){for(var r=[],o="",s=0,u=function(){if(o.length===0)throw new P(N.INVALID_ARGUMENT,"Invalid field path ("+n+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");r.push(o),o=""},l=!1;s<n.length;){var h=n[s];if(h==="\\"){if(s+1===n.length)throw new P(N.INVALID_ARGUMENT,"Path has trailing escape character: "+n);var d=n[s+1];if(d!=="\\"&&d!=="."&&d!=="`")throw new P(N.INVALID_ARGUMENT,"Path has invalid escape sequence: "+n);o+=d,s+=2}else h==="`"?(l=!l,s++):h!=="."||l?(o+=h,s++):(u(),s++)}if(u(),l)throw new P(N.INVALID_ARGUMENT,"Unterminated ` in path: "+n);return new e(r)},e.emptyPath=function(){return new e([])},e}(JT),$o=function(){function t(e){this.fields=e,e.sort(Dn.comparator)}return t.prototype.covers=function(e){for(var n=0,r=this.fields;n<r.length;n++)if(r[n].isPrefixOf(e))return!0;return!1},t.prototype.isEqual=function(e){return zo(this.fields,e.fields,function(n,r){return n.isEqual(r)})},t}(),qt=function(){function t(e){this.binaryString=e}return t.fromBase64String=function(e){return new t(atob(e))},t.fromUint8Array=function(e){return new t(function(n){for(var r="",o=0;o<n.length;++o)r+=String.fromCharCode(n[o]);return r}(e))},t.prototype.toBase64=function(){return e=this.binaryString,btoa(e);var e},t.prototype.toUint8Array=function(){return function(e){for(var n=new Uint8Array(e.length),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);return n}(this.binaryString)},t.prototype.approximateByteSize=function(){return 2*this.binaryString.length},t.prototype.compareTo=function(e){return ce(this.binaryString,e.binaryString)},t.prototype.isEqual=function(e){return this.binaryString===e.binaryString},t}();qt.EMPTY_BYTE_STRING=new qt("");var cx=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Br(t){if(Y(!!t),typeof t=="string"){var e=0,n=cx.exec(t);if(Y(!!n),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var o=new Date(t);return{seconds:Math.floor(o.getTime()/1e3),nanos:e}}return{seconds:Ge(t.seconds),nanos:Ge(t.nanos)}}function Ge(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Qo(t){return typeof t=="string"?qt.fromBase64String(t):qt.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Fg(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{}).__type__)===null||n===void 0?void 0:n.stringValue)==="server_timestamp"}function ZT(t){var e=t.mapValue.fields.__previous_value__;return Fg(e)?ZT(e):e}function Wa(t){var e=Br(t.mapValue.fields.__local_write_time__.timestampValue);return new Bt(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ji(t){return t==null}function yl(t){return t===0&&1/t==-1/0}function eS(t){return typeof t=="number"&&Number.isInteger(t)&&!yl(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var K=function(){function t(e){this.path=e}return t.fromPath=function(e){return new t(ge.fromString(e))},t.fromName=function(e){return new t(ge.fromString(e).popFirst(5))},t.prototype.hasCollectionId=function(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e},t.prototype.isEqual=function(e){return e!==null&&ge.comparator(this.path,e.path)===0},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(e,n){return ge.comparator(e.path,n.path)},t.isDocumentKey=function(e){return e.length%2==0},t.fromSegments=function(e){return new t(new ge(e.slice()))},t}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Gi(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?Fg(t)?4:10:W()}function zn(t,e){var n=Gi(t);if(n!==Gi(e))return!1;switch(n){case 0:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return Wa(t).isEqual(Wa(e));case 3:return function(r,o){if(typeof r.timestampValue=="string"&&typeof o.timestampValue=="string"&&r.timestampValue.length===o.timestampValue.length)return r.timestampValue===o.timestampValue;var s=Br(r.timestampValue),u=Br(o.timestampValue);return s.seconds===u.seconds&&s.nanos===u.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(r,o){return Qo(r.bytesValue).isEqual(Qo(o.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(r,o){return Ge(r.geoPointValue.latitude)===Ge(o.geoPointValue.latitude)&&Ge(r.geoPointValue.longitude)===Ge(o.geoPointValue.longitude)}(t,e);case 2:return function(r,o){if("integerValue"in r&&"integerValue"in o)return Ge(r.integerValue)===Ge(o.integerValue);if("doubleValue"in r&&"doubleValue"in o){var s=Ge(r.doubleValue),u=Ge(o.doubleValue);return s===u?yl(s)===yl(u):isNaN(s)&&isNaN(u)}return!1}(t,e);case 9:return zo(t.arrayValue.values||[],e.arrayValue.values||[],zn);case 10:return function(r,o){var s=r.mapValue.fields||{},u=o.mapValue.fields||{};if(A0(s)!==A0(u))return!1;for(var l in s)if(s.hasOwnProperty(l)&&(u[l]===void 0||!zn(s[l],u[l])))return!1;return!0}(t,e);default:return W()}}function Ha(t,e){return(t.values||[]).find(function(n){return zn(n,e)})!==void 0}function Yo(t,e){var n=Gi(t),r=Gi(e);if(n!==r)return ce(n,r);switch(n){case 0:return 0;case 1:return ce(t.booleanValue,e.booleanValue);case 2:return function(o,s){var u=Ge(o.integerValue||o.doubleValue),l=Ge(s.integerValue||s.doubleValue);return u<l?-1:u>l?1:u===l?0:isNaN(u)?isNaN(l)?0:-1:1}(t,e);case 3:return k0(t.timestampValue,e.timestampValue);case 4:return k0(Wa(t),Wa(e));case 5:return ce(t.stringValue,e.stringValue);case 6:return function(o,s){var u=Qo(o),l=Qo(s);return u.compareTo(l)}(t.bytesValue,e.bytesValue);case 7:return function(o,s){for(var u=o.split("/"),l=s.split("/"),h=0;h<u.length&&h<l.length;h++){var d=ce(u[h],l[h]);if(d!==0)return d}return ce(u.length,l.length)}(t.referenceValue,e.referenceValue);case 8:return function(o,s){var u=ce(Ge(o.latitude),Ge(s.latitude));return u!==0?u:ce(Ge(o.longitude),Ge(s.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return function(o,s){for(var u=o.values||[],l=s.values||[],h=0;h<u.length&&h<l.length;++h){var d=Yo(u[h],l[h]);if(d)return d}return ce(u.length,l.length)}(t.arrayValue,e.arrayValue);case 10:return function(o,s){var u=o.fields||{},l=Object.keys(u),h=s.fields||{},d=Object.keys(h);l.sort(),d.sort();for(var p=0;p<l.length&&p<d.length;++p){var g=ce(l[p],d[p]);if(g!==0)return g;var y=Yo(u[l[p]],h[d[p]]);if(y!==0)return y}return ce(l.length,d.length)}(t.mapValue,e.mapValue);default:throw W()}}function k0(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return ce(t,e);var n=Br(t),r=Br(e),o=ce(n.seconds,r.seconds);return o!==0?o:ce(n.nanos,r.nanos)}function Ug(t){return Iv(t)}function Iv(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(r){var o=Br(r);return"time("+o.seconds+","+o.nanos+")"}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?Qo(t.bytesValue).toBase64():"referenceValue"in t?(n=t.referenceValue,K.fromName(n).toString()):"geoPointValue"in t?"geo("+(e=t.geoPointValue).latitude+","+e.longitude+")":"arrayValue"in t?function(r){for(var o="[",s=!0,u=0,l=r.values||[];u<l.length;u++)s?s=!1:o+=",",o+=Iv(l[u]);return o+"]"}(t.arrayValue):"mapValue"in t?function(r){for(var o="{",s=!0,u=0,l=Object.keys(r.fields||{}).sort();u<l.length;u++){var h=l[u];s?s=!1:o+=",",o+=h+":"+Iv(r.fields[h])}return o+"}"}(t.mapValue):W();var e,n}function _l(t,e){return{referenceValue:"projects/"+t.projectId+"/databases/"+t.database+"/documents/"+e.path.canonicalString()}}function Ev(t){return!!t&&"integerValue"in t}function Vg(t){return!!t&&"arrayValue"in t}function N0(t){return!!t&&"nullValue"in t}function R0(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function Zc(t){return!!t&&"mapValue"in t}function Aa(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){var e={mapValue:{fields:{}}};return Xi(t.mapValue.fields,function(o,s){return e.mapValue.fields[o]=Aa(s)}),e}if(t.arrayValue){for(var n={arrayValue:{values:[]}},r=0;r<(t.arrayValue.values||[]).length;++r)n.arrayValue.values[r]=Aa(t.arrayValue.values[r]);return n}return Object.assign({},t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xt=function(){function t(e){this.value=e}return t.empty=function(){return new t({mapValue:{}})},t.prototype.field=function(e){if(e.isEmpty())return this.value;for(var n=this.value,r=0;r<e.length-1;++r)if(!Zc(n=(n.mapValue.fields||{})[e.get(r)]))return null;return(n=(n.mapValue.fields||{})[e.lastSegment()])||null},t.prototype.set=function(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=Aa(n)},t.prototype.setAll=function(e){var n=this,r=Dn.emptyPath(),o={},s=[];e.forEach(function(l,h){if(!r.isImmediateParentOf(h)){var d=n.getFieldsMap(r);n.applyChanges(d,o,s),o={},s=[],r=h.popLast()}l?o[h.lastSegment()]=Aa(l):s.push(h.lastSegment())});var u=this.getFieldsMap(r);this.applyChanges(u,o,s)},t.prototype.delete=function(e){var n=this.field(e.popLast());Zc(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]},t.prototype.isEqual=function(e){return zn(this.value,e.value)},t.prototype.getFieldsMap=function(e){var n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(var r=0;r<e.length;++r){var o=n.mapValue.fields[e.get(r)];Zc(o)&&o.mapValue.fields||(o={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=o),n=o}return n.mapValue.fields},t.prototype.applyChanges=function(e,n,r){Xi(n,function(l,h){return e[l]=h});for(var o=0,s=r;o<s.length;o++){var u=s[o];delete e[u]}},t.prototype.clone=function(){return new t(Aa(this.value))},t}();function tS(t){var e=[];return Xi(t.fields,function(n,r){var o=new Dn([n]);if(Zc(r)){var s=tS(r.mapValue).fields;if(s.length===0)e.push(o);else for(var u=0,l=s;u<l.length;u++){var h=l[u];e.push(o.child(h))}}else e.push(o)}),new $o(e)}var wt=function(){function t(e,n,r,o,s){this.key=e,this.documentType=n,this.version=r,this.data=o,this.documentState=s}return t.newInvalidDocument=function(e){return new t(e,0,se.min(),Xt.empty(),0)},t.newFoundDocument=function(e,n,r){return new t(e,1,n,r,0)},t.newNoDocument=function(e,n){return new t(e,2,n,Xt.empty(),0)},t.newUnknownDocument=function(e,n){return new t(e,3,n,Xt.empty(),2)},t.prototype.convertToFoundDocument=function(e,n){return this.version=e,this.documentType=1,this.data=n,this.documentState=0,this},t.prototype.convertToNoDocument=function(e){return this.version=e,this.documentType=2,this.data=Xt.empty(),this.documentState=0,this},t.prototype.convertToUnknownDocument=function(e){return this.version=e,this.documentType=3,this.data=Xt.empty(),this.documentState=2,this},t.prototype.setHasCommittedMutations=function(){return this.documentState=2,this},t.prototype.setHasLocalMutations=function(){return this.documentState=1,this},Object.defineProperty(t.prototype,"hasLocalMutations",{get:function(){return this.documentState===1},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasCommittedMutations",{get:function(){return this.documentState===2},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return this.hasLocalMutations||this.hasCommittedMutations},enumerable:!1,configurable:!0}),t.prototype.isValidDocument=function(){return this.documentType!==0},t.prototype.isFoundDocument=function(){return this.documentType===1},t.prototype.isNoDocument=function(){return this.documentType===2},t.prototype.isUnknownDocument=function(){return this.documentType===3},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)},t.prototype.clone=function(){return new t(this.key,this.documentType,this.version,this.data.clone(),this.documentState)},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+JSON.stringify(this.data.value)+", {documentType: "+this.documentType+"}), {documentState: "+this.documentState+"})"},t}(),lx=function(t,e,n,r,o,s,u){e===void 0&&(e=null),n===void 0&&(n=[]),r===void 0&&(r=[]),o===void 0&&(o=null),s===void 0&&(s=null),u===void 0&&(u=null),this.path=t,this.collectionGroup=e,this.orderBy=n,this.filters=r,this.limit=o,this.startAt=s,this.endAt=u,this.h=null};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D0(t,e,n,r,o,s,u){return e===void 0&&(e=null),n===void 0&&(n=[]),r===void 0&&(r=[]),o===void 0&&(o=null),s===void 0&&(s=null),u===void 0&&(u=null),new lx(t,e,n,r,o,s,u)}function vu(t){var e=j(t);if(e.h===null){var n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(function(r){return function(o){return o.field.canonicalString()+o.op.toString()+Ug(o.value)}(r)}).join(","),n+="|ob:",n+=e.orderBy.map(function(r){return function(o){return o.field.canonicalString()+o.dir}(r)}).join(","),Ji(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=bl(e.startAt)),e.endAt&&(n+="|ub:",n+=bl(e.endAt)),e.h=n}return e.h}function dh(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(var n=0;n<t.orderBy.length;n++)if(!yx(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(var r=0;r<t.filters.length;r++)if(o=t.filters[r],s=e.filters[r],o.op!==s.op||!o.field.isEqual(s.field)||!zn(o.value,s.value))return!1;var o,s;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!P0(t.startAt,e.startAt)&&P0(t.endAt,e.endAt)}function wl(t){return K.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}var Zt=function(t){function e(n,r,o){var s=this;return(s=t.call(this)||this).field=n,s.op=r,s.value=o,s}return V(e,t),e.create=function(n,r,o){return n.isKeyField()?r==="in"||r==="not-in"?this.l(n,r,o):new hx(n,r,o):r==="array-contains"?new px(n,o):r==="in"?new vx(n,o):r==="not-in"?new gx(n,o):r==="array-contains-any"?new mx(n,o):new e(n,r,o)},e.l=function(n,r,o){return r==="in"?new fx(n,o):new dx(n,o)},e.prototype.matches=function(n){var r=n.data.field(this.field);return this.op==="!="?r!==null&&this.m(Yo(r,this.value)):r!==null&&Gi(this.value)===Gi(r)&&this.m(Yo(r,this.value))},e.prototype.m=function(n){switch(this.op){case"<":return n<0;case"<=":return n<=0;case"==":return n===0;case"!=":return n!==0;case">":return n>0;case">=":return n>=0;default:return W()}},e.prototype.g=function(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0},e}(function(){}),hx=function(t){function e(n,r,o){var s=this;return(s=t.call(this,n,r,o)||this).key=K.fromName(o.referenceValue),s}return V(e,t),e.prototype.matches=function(n){var r=K.comparator(n.key,this.key);return this.m(r)},e}(Zt),fx=function(t){function e(n,r){var o=this;return(o=t.call(this,n,"in",r)||this).keys=nS("in",r),o}return V(e,t),e.prototype.matches=function(n){return this.keys.some(function(r){return r.isEqual(n.key)})},e}(Zt),dx=function(t){function e(n,r){var o=this;return(o=t.call(this,n,"not-in",r)||this).keys=nS("not-in",r),o}return V(e,t),e.prototype.matches=function(n){return!this.keys.some(function(r){return r.isEqual(n.key)})},e}(Zt);function nS(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(function(r){return K.fromName(r.referenceValue)})}var px=function(t){function e(n,r){return t.call(this,n,"array-contains",r)||this}return V(e,t),e.prototype.matches=function(n){var r=n.data.field(this.field);return Vg(r)&&Ha(r.arrayValue,this.value)},e}(Zt),vx=function(t){function e(n,r){return t.call(this,n,"in",r)||this}return V(e,t),e.prototype.matches=function(n){var r=n.data.field(this.field);return r!==null&&Ha(this.value.arrayValue,r)},e}(Zt),gx=function(t){function e(n,r){return t.call(this,n,"not-in",r)||this}return V(e,t),e.prototype.matches=function(n){if(Ha(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;var r=n.data.field(this.field);return r!==null&&!Ha(this.value.arrayValue,r)},e}(Zt),mx=function(t){function e(n,r){return t.call(this,n,"array-contains-any",r)||this}return V(e,t),e.prototype.matches=function(n){var r=this,o=n.data.field(this.field);return!(!Vg(o)||!o.arrayValue.values)&&o.arrayValue.values.some(function(s){return Ha(r.value.arrayValue,s)})},e}(Zt),Ka=function(t,e){this.position=t,this.before=e};function bl(t){return(t.before?"b":"a")+":"+t.position.map(function(e){return Ug(e)}).join(",")}var qo=function(t,e){e===void 0&&(e="asc"),this.field=t,this.dir=e};function yx(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}function O0(t,e,n){for(var r=0,o=0;o<t.position.length;o++){var s=e[o],u=t.position[o];if(r=s.field.isKeyField()?K.comparator(K.fromName(u.referenceValue),n.key):Yo(u,n.data.field(s.field)),s.dir==="desc"&&(r*=-1),r!==0)break}return t.before?r<=0:r<0}function P0(t,e){if(t===null)return e===null;if(e===null||t.before!==e.before||t.position.length!==e.position.length)return!1;for(var n=0;n<t.position.length;n++)if(!zn(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var gr=function(t,e,n,r,o,s,u,l){e===void 0&&(e=null),n===void 0&&(n=[]),r===void 0&&(r=[]),o===void 0&&(o=null),s===void 0&&(s="F"),u===void 0&&(u=null),l===void 0&&(l=null),this.path=t,this.collectionGroup=e,this.explicitOrderBy=n,this.filters=r,this.limit=o,this.limitType=s,this.startAt=u,this.endAt=l,this.p=null,this.T=null,this.startAt,this.endAt};function rS(t,e,n,r,o,s,u,l){return new gr(t,e,n,r,o,s,u,l)}function gu(t){return new gr(t)}function el(t){return!Ji(t.limit)&&t.limitType==="F"}function Il(t){return!Ji(t.limit)&&t.limitType==="L"}function jg(t){return t.explicitOrderBy.length>0?t.explicitOrderBy[0].field:null}function Bg(t){for(var e=0,n=t.filters;e<n.length;e++){var r=n[e];if(r.g())return r.field}return null}function qg(t){return t.collectionGroup!==null}function Xo(t){var e=j(t);if(e.p===null){e.p=[];var n=Bg(e),r=jg(e);if(n!==null&&r===null)n.isKeyField()||e.p.push(new qo(n)),e.p.push(new qo(Dn.keyField(),"asc"));else{for(var o=!1,s=0,u=e.explicitOrderBy;s<u.length;s++){var l=u[s];e.p.push(l),l.field.isKeyField()&&(o=!0)}if(!o){var h=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";e.p.push(new qo(Dn.keyField(),h))}}}return e.p}function $n(t){var e=j(t);if(!e.T)if(e.limitType==="F")e.T=D0(e.path,e.collectionGroup,Xo(e),e.filters,e.limit,e.startAt,e.endAt);else{for(var n=[],r=0,o=Xo(e);r<o.length;r++){var s=o[r],u=s.dir==="desc"?"asc":"desc";n.push(new qo(s.field,u))}var l=e.endAt?new Ka(e.endAt.position,!e.endAt.before):null,h=e.startAt?new Ka(e.startAt.position,!e.startAt.before):null;e.T=D0(e.path,e.collectionGroup,n,e.filters,e.limit,l,h)}return e.T}function iS(t,e,n){return new gr(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function mu(t,e){return dh($n(t),$n(e))&&t.limitType===e.limitType}function oS(t){return vu($n(t))+"|lt:"+t.limitType}function Tv(t){return"Query(target="+function(e){var n=e.path.canonicalString();return e.collectionGroup!==null&&(n+=" collectionGroup="+e.collectionGroup),e.filters.length>0&&(n+=", filters: ["+e.filters.map(function(r){return(o=r).field.canonicalString()+" "+o.op+" "+Ug(o.value);var o}).join(", ")+"]"),Ji(e.limit)||(n+=", limit: "+e.limit),e.orderBy.length>0&&(n+=", orderBy: ["+e.orderBy.map(function(r){return function(o){return o.field.canonicalString()+" ("+o.dir+")"}(r)}).join(", ")+"]"),e.startAt&&(n+=", startAt: "+bl(e.startAt)),e.endAt&&(n+=", endAt: "+bl(e.endAt)),"Target("+n+")"}($n(t))+"; limitType="+t.limitType+")"}function yu(t,e){return e.isFoundDocument()&&function(n,r){var o=r.key.path;return n.collectionGroup!==null?r.key.hasCollectionId(n.collectionGroup)&&n.path.isPrefixOf(o):K.isDocumentKey(n.path)?n.path.isEqual(o):n.path.isImmediateParentOf(o)}(t,e)&&function(n,r){for(var o=0,s=n.explicitOrderBy;o<s.length;o++){var u=s[o];if(!u.field.isKeyField()&&r.data.field(u.field)===null)return!1}return!0}(t,e)&&function(n,r){for(var o=0,s=n.filters;o<s.length;o++)if(!s[o].matches(r))return!1;return!0}(t,e)&&function(n,r){return!(n.startAt&&!O0(n.startAt,Xo(n),r))&&(!n.endAt||!O0(n.endAt,Xo(n),r))}(t,e)}function sS(t){return function(e,n){for(var r=!1,o=0,s=Xo(t);o<s.length;o++){var u=s[o],l=_x(u,e,n);if(l!==0)return l;r=r||u.field.isKeyField()}return 0}}function _x(t,e,n){var r=t.field.isKeyField()?K.comparator(e.key,n.key):function(o,s,u){var l=s.data.field(o),h=u.data.field(o);return l!==null&&h!==null?Yo(l,h):W()}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return W()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aS(t,e){if(t.I){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:yl(e)?"-0":e}}function uS(t){return{integerValue:""+t}}function cS(t,e){return eS(e)?uS(e):aS(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ph=function(){this._=void 0};function wx(t,e,n){return t instanceof Jo?function(r,o){var s={fields:{__type__:{stringValue:"server_timestamp"},__local_write_time__:{timestampValue:{seconds:r.seconds,nanos:r.nanoseconds}}}};return o&&(s.fields.__previous_value__=o),{mapValue:s}}(n,e):t instanceof Wi?hS(t,e):t instanceof Hi?fS(t,e):function(r,o){var s=lS(r,o),u=x0(s)+x0(r.A);return Ev(s)&&Ev(r.A)?uS(u):aS(r.R,u)}(t,e)}function bx(t,e,n){return t instanceof Wi?hS(t,e):t instanceof Hi?fS(t,e):n}function lS(t,e){return t instanceof Zo?Ev(n=e)||function(r){return!!r&&"doubleValue"in r}(n)?e:{integerValue:0}:null;var n}var Jo=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return V(e,t),e}(ph),Wi=function(t){function e(n){var r=this;return(r=t.call(this)||this).elements=n,r}return V(e,t),e}(ph);function hS(t,e){for(var n=dS(e),r=function(u){n.some(function(l){return zn(l,u)})||n.push(u)},o=0,s=t.elements;o<s.length;o++)r(s[o]);return{arrayValue:{values:n}}}var Hi=function(t){function e(n){var r=this;return(r=t.call(this)||this).elements=n,r}return V(e,t),e}(ph);function fS(t,e){for(var n=dS(e),r=function(u){n=n.filter(function(l){return!zn(l,u)})},o=0,s=t.elements;o<s.length;o++)r(s[o]);return{arrayValue:{values:n}}}var Zo=function(t){function e(n,r){var o=this;return(o=t.call(this)||this).R=n,o.A=r,o}return V(e,t),e}(ph);function x0(t){return Ge(t.integerValue||t.doubleValue)}function dS(t){return Vg(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _u=function(t,e){this.field=t,this.transform=e},Ix=function(t,e){this.version=t,this.transformResults=e},mt=function(){function t(e,n){this.updateTime=e,this.exists=n}return t.none=function(){return new t},t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return this.updateTime===void 0&&this.exists===void 0},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)},t}();function tl(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}var vh=function(){};function Ex(t,e,n){t instanceof wu?function(r,o,s){var u=r.value.clone(),l=F0(r.fieldTransforms,o,s.transformResults);u.setAll(l),o.convertToFoundDocument(s.version,u).setHasCommittedMutations()}(t,e,n):t instanceof Qr?function(r,o,s){if(tl(r.precondition,o)){var u=F0(r.fieldTransforms,o,s.transformResults),l=o.data;l.setAll(pS(r)),l.setAll(u),o.convertToFoundDocument(s.version,l).setHasCommittedMutations()}else o.convertToUnknownDocument(s.version)}(t,e,n):function(r,o,s){o.convertToNoDocument(s.version).setHasCommittedMutations()}(0,e,n)}function Sv(t,e,n){t instanceof wu?function(r,o,s){if(tl(r.precondition,o)){var u=r.value.clone(),l=U0(r.fieldTransforms,s,o);u.setAll(l),o.convertToFoundDocument(M0(o),u).setHasLocalMutations()}}(t,e,n):t instanceof Qr?function(r,o,s){if(tl(r.precondition,o)){var u=U0(r.fieldTransforms,s,o),l=o.data;l.setAll(pS(r)),l.setAll(u),o.convertToFoundDocument(M0(o),l).setHasLocalMutations()}}(t,e,n):function(r,o){tl(r.precondition,o)&&o.convertToNoDocument(se.min())}(t,e)}function Tx(t,e){for(var n=null,r=0,o=t.fieldTransforms;r<o.length;r++){var s=o[r],u=e.data.field(s.field),l=lS(s.transform,u||null);l!=null&&(n==null&&(n=Xt.empty()),n.set(s.field,l))}return n||null}function L0(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(n,r){return n===void 0&&r===void 0||!(!n||!r)&&zo(n,r,function(o,s){return function(u,l){return u.field.isEqual(l.field)&&function(h,d){return h instanceof Wi&&d instanceof Wi||h instanceof Hi&&d instanceof Hi?zo(h.elements,d.elements,zn):h instanceof Zo&&d instanceof Zo?zn(h.A,d.A):h instanceof Jo&&d instanceof Jo}(u.transform,l.transform)}(o,s)})}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}function M0(t){return t.isFoundDocument()?t.version:se.min()}var wu=function(t){function e(n,r,o,s){s===void 0&&(s=[]);var u=this;return(u=t.call(this)||this).key=n,u.value=r,u.precondition=o,u.fieldTransforms=s,u.type=0,u}return V(e,t),e}(vh),Qr=function(t){function e(n,r,o,s,u){u===void 0&&(u=[]);var l=this;return(l=t.call(this)||this).key=n,l.data=r,l.fieldMask=o,l.precondition=s,l.fieldTransforms=u,l.type=1,l}return V(e,t),e}(vh);function pS(t){var e=new Map;return t.fieldMask.fields.forEach(function(n){if(!n.isEmpty()){var r=t.data.field(n);e.set(n,r)}}),e}function F0(t,e,n){var r=new Map;Y(t.length===n.length);for(var o=0;o<n.length;o++){var s=t[o],u=s.transform,l=e.data.field(s.field);r.set(s.field,bx(u,l,n[o]))}return r}function U0(t,e,n){for(var r=new Map,o=0,s=t;o<s.length;o++){var u=s[o],l=u.transform,h=n.data.field(u.field);r.set(u.field,wx(l,h,e))}return r}var qe,he,bu=function(t){function e(n,r){var o=this;return(o=t.call(this)||this).key=n,o.precondition=r,o.type=2,o.fieldTransforms=[],o}return V(e,t),e}(vh),Gg=function(t){function e(n,r){var o=this;return(o=t.call(this)||this).key=n,o.precondition=r,o.type=3,o.fieldTransforms=[],o}return V(e,t),e}(vh),Sx=function(t){this.count=t};function vS(t){switch(t){case N.OK:return W();case N.CANCELLED:case N.UNKNOWN:case N.DEADLINE_EXCEEDED:case N.RESOURCE_EXHAUSTED:case N.INTERNAL:case N.UNAVAILABLE:case N.UNAUTHENTICATED:return!1;case N.INVALID_ARGUMENT:case N.NOT_FOUND:case N.ALREADY_EXISTS:case N.PERMISSION_DENIED:case N.FAILED_PRECONDITION:case N.ABORTED:case N.OUT_OF_RANGE:case N.UNIMPLEMENTED:case N.DATA_LOSS:return!0;default:return W()}}function gS(t){if(t===void 0)return We("GRPC error has no .code"),N.UNKNOWN;switch(t){case qe.OK:return N.OK;case qe.CANCELLED:return N.CANCELLED;case qe.UNKNOWN:return N.UNKNOWN;case qe.DEADLINE_EXCEEDED:return N.DEADLINE_EXCEEDED;case qe.RESOURCE_EXHAUSTED:return N.RESOURCE_EXHAUSTED;case qe.INTERNAL:return N.INTERNAL;case qe.UNAVAILABLE:return N.UNAVAILABLE;case qe.UNAUTHENTICATED:return N.UNAUTHENTICATED;case qe.INVALID_ARGUMENT:return N.INVALID_ARGUMENT;case qe.NOT_FOUND:return N.NOT_FOUND;case qe.ALREADY_EXISTS:return N.ALREADY_EXISTS;case qe.PERMISSION_DENIED:return N.PERMISSION_DENIED;case qe.FAILED_PRECONDITION:return N.FAILED_PRECONDITION;case qe.ABORTED:return N.ABORTED;case qe.OUT_OF_RANGE:return N.OUT_OF_RANGE;case qe.UNIMPLEMENTED:return N.UNIMPLEMENTED;case qe.DATA_LOSS:return N.DATA_LOSS;default:return W()}}(he=qe||(qe={}))[he.OK=0]="OK",he[he.CANCELLED=1]="CANCELLED",he[he.UNKNOWN=2]="UNKNOWN",he[he.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",he[he.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",he[he.NOT_FOUND=5]="NOT_FOUND",he[he.ALREADY_EXISTS=6]="ALREADY_EXISTS",he[he.PERMISSION_DENIED=7]="PERMISSION_DENIED",he[he.UNAUTHENTICATED=16]="UNAUTHENTICATED",he[he.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",he[he.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",he[he.ABORTED=10]="ABORTED",he[he.OUT_OF_RANGE=11]="OUT_OF_RANGE",he[he.UNIMPLEMENTED=12]="UNIMPLEMENTED",he[he.INTERNAL=13]="INTERNAL",he[he.UNAVAILABLE=14]="UNAVAILABLE",he[he.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bt=function(){function t(e,n){this.comparator=e,this.root=n||Or.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Or.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Or.BLACK,null,null))},t.prototype.get=function(e){for(var n=this.root;!n.isEmpty();){var r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null},t.prototype.indexOf=function(e){for(var n=0,r=this.root;!r.isEmpty();){var o=this.comparator(e,r.key);if(o===0)return n+r.left.size;o<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!1,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(e){return this.root.inorderTraversal(e)},t.prototype.forEach=function(e){this.inorderTraversal(function(n,r){return e(n,r),!1})},t.prototype.toString=function(){var e=[];return this.inorderTraversal(function(n,r){return e.push(n+":"+r),!1}),"{"+e.join(", ")+"}"},t.prototype.reverseTraversal=function(e){return this.root.reverseTraversal(e)},t.prototype.getIterator=function(){return new qc(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(e){return new qc(this.root,e,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new qc(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(e){return new qc(this.root,e,this.comparator,!0)},t}(),qc=function(){function t(e,n,r,o){this.isReverse=o,this.nodeStack=[];for(var s=1;!e.isEmpty();)if(s=n?r(e.key,n):1,o&&(s*=-1),s<0)e=this.isReverse?e.left:e.right;else{if(s===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}return t.prototype.getNext=function(){var e=this.nodeStack.pop(),n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(this.nodeStack.length===0)return null;var e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}},t}(),Or=function(){function t(e,n,r,o,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=o??t.EMPTY,this.right=s??t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,o,s){return new t(e??this.key,n??this.value,r??this.color,o??this.left,s??this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)},t.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(e,n,r){var o=this,s=r(e,o.key);return(o=s<0?o.copy(null,null,null,o.left.insert(e,n,r),null):s===0?o.copy(null,n,null,null,null):o.copy(null,null,null,null,o.right.insert(e,n,r))).fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),(e=e.copy(null,null,null,e.left.removeMin(),null)).fixUp()},t.prototype.remove=function(e,n){var r,o=this;if(n(e,o.key)<0)o.left.isEmpty()||o.left.isRed()||o.left.left.isRed()||(o=o.moveRedLeft()),o=o.copy(null,null,null,o.left.remove(e,n),null);else{if(o.left.isRed()&&(o=o.rotateRight()),o.right.isEmpty()||o.right.isRed()||o.right.left.isRed()||(o=o.moveRedRight()),n(e,o.key)===0){if(o.right.isEmpty())return t.EMPTY;r=o.right.min(),o=o.copy(r.key,r.value,null,null,o.right.removeMin())}o=o.copy(null,null,null,null,o.right.remove(e,n))}return o.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e},t.prototype.moveRedLeft=function(){var e=this.colorFlip();return e.right.left.isRed()&&(e=(e=(e=e.copy(null,null,null,null,e.right.rotateRight())).rotateLeft()).colorFlip()),e},t.prototype.moveRedRight=function(){var e=this.colorFlip();return e.left.left.isRed()&&(e=(e=e.rotateRight()).colorFlip()),e},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)},t.prototype.checkMaxDepth=function(){var e=this.check();return Math.pow(2,e)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed()||this.right.isRed())throw W();var e=this.left.check();if(e!==this.right.check())throw W();return e+(this.isRed()?0:1)},t}();Or.EMPTY=null,Or.RED=!0,Or.BLACK=!1,Or.EMPTY=new(function(){function t(){this.size=0}return Object.defineProperty(t.prototype,"key",{get:function(){throw W()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"value",{get:function(){throw W()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"color",{get:function(){throw W()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"left",{get:function(){throw W()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"right",{get:function(){throw W()},enumerable:!1,configurable:!0}),t.prototype.copy=function(e,n,r,o,s){return this},t.prototype.insert=function(e,n,r){return new Or(e,n)},t.prototype.remove=function(e,n){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(e){return!1},t.prototype.reverseTraversal=function(e){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}());/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xe=function(){function t(e){this.comparator=e,this.data=new bt(this.comparator)}return t.prototype.has=function(e){return this.data.get(e)!==null},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!1,configurable:!0}),t.prototype.indexOf=function(e){return this.data.indexOf(e)},t.prototype.forEach=function(e){this.data.inorderTraversal(function(n,r){return e(n),!1})},t.prototype.forEachInRange=function(e,n){for(var r=this.data.getIteratorFrom(e[0]);r.hasNext();){var o=r.getNext();if(this.comparator(o.key,e[1])>=0)return;n(o.key)}},t.prototype.forEachWhile=function(e,n){var r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return},t.prototype.firstAfterOrEqual=function(e){var n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null},t.prototype.getIterator=function(){return new V0(this.data.getIterator())},t.prototype.getIteratorFrom=function(e){return new V0(this.data.getIteratorFrom(e))},t.prototype.add=function(e){return this.copy(this.data.remove(e).insert(e,!0))},t.prototype.delete=function(e){return this.has(e)?this.copy(this.data.remove(e)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(e){var n=this;return n.size<e.size&&(n=e,e=this),e.forEach(function(r){n=n.add(r)}),n},t.prototype.isEqual=function(e){if(!(e instanceof t)||this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var o=n.getNext().key,s=r.getNext().key;if(this.comparator(o,s)!==0)return!1}return!0},t.prototype.toArray=function(){var e=[];return this.forEach(function(n){e.push(n)}),e},t.prototype.toString=function(){var e=[];return this.forEach(function(n){return e.push(n)}),"SortedSet("+e.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),V0=function(){function t(e){this.iter=e}return t.prototype.getNext=function(){return this.iter.getNext().key},t.prototype.hasNext=function(){return this.iter.hasNext()},t}(),Cx=new bt(K.comparator);function Nn(){return Cx}var Ax=new bt(K.comparator);function Cv(){return Ax}var kx=new bt(K.comparator);function Nx(){return kx}var Rx=new Xe(K.comparator);function Te(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n=Rx,r=0,o=t;r<o.length;r++){var s=o[r];n=n.add(s)}return n}var Dx=new Xe(ce);function gh(){return Dx}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wg=function(){function t(e,n,r,o,s){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=o,this.resolvedLimboDocuments=s}return t.createSynthesizedRemoteEventForCurrentChange=function(e,n){var r=new Map;return r.set(e,Hg.createSynthesizedTargetChangeForCurrentChange(e,n)),new t(se.min(),r,gh(),Nn(),Te())},t}(),Hg=function(){function t(e,n,r,o,s){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=o,this.removedDocuments=s}return t.createSynthesizedTargetChangeForCurrentChange=function(e,n){return new t(qt.EMPTY_BYTE_STRING,n,Te(),Te(),Te())},t}(),nl=function(t,e,n,r){this.v=t,this.removedTargetIds=e,this.key=n,this.P=r},mS=function(t,e){this.targetId=t,this.V=e},yS=function(t,e,n,r){n===void 0&&(n=qt.EMPTY_BYTE_STRING),r===void 0&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r},j0=function(){function t(){this.S=0,this.D=q0(),this.C=qt.EMPTY_BYTE_STRING,this.N=!1,this.k=!0}return Object.defineProperty(t.prototype,"current",{get:function(){return this.N},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"resumeToken",{get:function(){return this.C},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"F",{get:function(){return this.S!==0},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"$",{get:function(){return this.k},enumerable:!1,configurable:!0}),t.prototype.O=function(e){e.approximateByteSize()>0&&(this.k=!0,this.C=e)},t.prototype.M=function(){var e=Te(),n=Te(),r=Te();return this.D.forEach(function(o,s){switch(s){case 0:e=e.add(o);break;case 2:n=n.add(o);break;case 1:r=r.add(o);break;default:W()}}),new Hg(this.C,this.N,e,n,r)},t.prototype.L=function(){this.k=!1,this.D=q0()},t.prototype.B=function(e,n){this.k=!0,this.D=this.D.insert(e,n)},t.prototype.q=function(e){this.k=!0,this.D=this.D.remove(e)},t.prototype.U=function(){this.S+=1},t.prototype.K=function(){this.S-=1},t.prototype.j=function(){this.k=!0,this.N=!0},t}(),Ox=function(){function t(e){this.W=e,this.G=new Map,this.H=Nn(),this.J=B0(),this.Y=new Xe(ce)}return t.prototype.X=function(e){for(var n=0,r=e.v;n<r.length;n++){var o=r[n];e.P&&e.P.isFoundDocument()?this.Z(o,e.P):this.tt(o,e.key,e.P)}for(var s=0,u=e.removedTargetIds;s<u.length;s++)o=u[s],this.tt(o,e.key,e.P)},t.prototype.et=function(e){var n=this;this.forEachTarget(e,function(r){var o=n.nt(r);switch(e.state){case 0:n.st(r)&&o.O(e.resumeToken);break;case 1:o.K(),o.F||o.L(),o.O(e.resumeToken);break;case 2:o.K(),o.F||n.removeTarget(r);break;case 3:n.st(r)&&(o.j(),o.O(e.resumeToken));break;case 4:n.st(r)&&(n.it(r),o.O(e.resumeToken));break;default:W()}})},t.prototype.forEachTarget=function(e,n){var r=this;e.targetIds.length>0?e.targetIds.forEach(n):this.G.forEach(function(o,s){r.st(s)&&n(s)})},t.prototype.rt=function(e){var n=e.targetId,r=e.V.count,o=this.ot(n);if(o){var s=o.target;if(wl(s))if(r===0){var u=new K(s.path);this.tt(n,u,wt.newNoDocument(u,se.min()))}else Y(r===1);else this.ct(n)!==r&&(this.it(n),this.Y=this.Y.add(n))}},t.prototype.ut=function(e){var n=this,r=new Map;this.G.forEach(function(u,l){var h=n.ot(l);if(h){if(u.current&&wl(h.target)){var d=new K(h.target.path);n.H.get(d)!==null||n.at(l,d)||n.tt(l,d,wt.newNoDocument(d,e))}u.$&&(r.set(l,u.M()),u.L())}});var o=Te();this.J.forEach(function(u,l){var h=!0;l.forEachWhile(function(d){var p=n.ot(d);return!p||p.purpose===2||(h=!1,!1)}),h&&(o=o.add(u))});var s=new Wg(e,r,this.Y,this.H,o);return this.H=Nn(),this.J=B0(),this.Y=new Xe(ce),s},t.prototype.Z=function(e,n){if(this.st(e)){var r=this.at(e,n.key)?2:0;this.nt(e).B(n.key,r),this.H=this.H.insert(n.key,n),this.J=this.J.insert(n.key,this.ht(n.key).add(e))}},t.prototype.tt=function(e,n,r){if(this.st(e)){var o=this.nt(e);this.at(e,n)?o.B(n,1):o.q(n),this.J=this.J.insert(n,this.ht(n).delete(e)),r&&(this.H=this.H.insert(n,r))}},t.prototype.removeTarget=function(e){this.G.delete(e)},t.prototype.ct=function(e){var n=this.nt(e).M();return this.W.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size},t.prototype.U=function(e){this.nt(e).U()},t.prototype.nt=function(e){var n=this.G.get(e);return n||(n=new j0,this.G.set(e,n)),n},t.prototype.ht=function(e){var n=this.J.get(e);return n||(n=new Xe(ce),this.J=this.J.insert(e,n)),n},t.prototype.st=function(e){var n=this.ot(e)!==null;return n||U("WatchChangeAggregator","Detected inactive target",e),n},t.prototype.ot=function(e){var n=this.G.get(e);return n&&n.F?null:this.W.lt(e)},t.prototype.it=function(e){var n=this;this.G.set(e,new j0),this.W.getRemoteKeysForTarget(e).forEach(function(r){n.tt(e,r,null)})},t.prototype.at=function(e,n){return this.W.getRemoteKeysForTarget(e).has(n)},t}();function B0(){return new bt(K.comparator)}function q0(){return new bt(K.comparator)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Px={asc:"ASCENDING",desc:"DESCENDING"},xx={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Lx=function(t,e){this.databaseId=t,this.I=e};function za(t,e){return t.I?new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")+"."+("000000000"+e.nanoseconds).slice(-9)+"Z":{seconds:""+e.seconds,nanos:e.nanoseconds}}function _S(t,e){return t.I?e.toBase64():e.toUint8Array()}function Mx(t,e){return za(t,e.toTimestamp())}function Rt(t){return Y(!!t),se.fromTimestamp(function(e){var n=Br(e);return new Bt(n.seconds,n.nanos)}(t))}function Kg(t,e){return function(n){return new ge(["projects",n.projectId,"databases",n.database])}(t).child("documents").child(e).canonicalString()}function wS(t){var e=ge.fromString(t);return Y(AS(e)),e}function $a(t,e){return Kg(t.databaseId,e.path)}function cr(t,e){var n=wS(e);if(n.get(1)!==t.databaseId.projectId)throw new P(N.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new P(N.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new K(IS(n))}function Av(t,e){return Kg(t.databaseId,e)}function bS(t){var e=wS(t);return e.length===4?ge.emptyPath():IS(e)}function Qa(t){return new ge(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function IS(t){return Y(t.length>4&&t.get(4)==="documents"),t.popFirst(5)}function G0(t,e,n){return{name:$a(t,e),fields:n.value.mapValue.fields}}function Fx(t,e,n){var r=cr(t,e.name),o=Rt(e.updateTime),s=new Xt({mapValue:{fields:e.fields}}),u=wt.newFoundDocument(r,o,s);return n&&u.setHasCommittedMutations(),n?u.setHasCommittedMutations():u}function El(t,e){var n;if(e instanceof wu)n={update:G0(t,e.key,e.value)};else if(e instanceof bu)n={delete:$a(t,e.key)};else if(e instanceof Qr)n={update:G0(t,e.key,e.data),updateMask:qx(e.fieldMask)};else{if(!(e instanceof Gg))return W();n={verify:$a(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(function(r){return function(o,s){var u=s.transform;if(u instanceof Jo)return{fieldPath:s.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(u instanceof Wi)return{fieldPath:s.field.canonicalString(),appendMissingElements:{values:u.elements}};if(u instanceof Hi)return{fieldPath:s.field.canonicalString(),removeAllFromArray:{values:u.elements}};if(u instanceof Zo)return{fieldPath:s.field.canonicalString(),increment:u.A};throw W()}(0,r)})),e.precondition.isNone||(n.currentDocument=function(r,o){return o.updateTime!==void 0?{updateTime:Mx(r,o.updateTime)}:o.exists!==void 0?{exists:o.exists}:W()}(t,e.precondition)),n}function W0(t,e){var n=e.currentDocument?function(d){return d.updateTime!==void 0?mt.updateTime(Rt(d.updateTime)):d.exists!==void 0?mt.exists(d.exists):mt.none()}(e.currentDocument):mt.none(),r=e.updateTransforms?e.updateTransforms.map(function(d){return function(p,g){var y=null;if("setToServerValue"in g)Y(g.setToServerValue==="REQUEST_TIME"),y=new Jo;else if("appendMissingElements"in g){var w=g.appendMissingElements.values||[];y=new Wi(w)}else if("removeAllFromArray"in g){var b=g.removeAllFromArray.values||[];y=new Hi(b)}else"increment"in g?y=new Zo(p,g.increment):W();var E=Dn.fromServerFormat(g.fieldPath);return new _u(E,y)}(t,d)}):[];if(e.update){e.update.name;var o=cr(t,e.update.name),s=new Xt({mapValue:{fields:e.update.fields}});if(e.updateMask){var u=function(d){var p=d.fieldPaths||[];return new $o(p.map(function(g){return Dn.fromServerFormat(g)}))}(e.updateMask);return new Qr(o,s,u,n,r)}return new wu(o,s,n,r)}if(e.delete){var l=cr(t,e.delete);return new bu(l,n)}if(e.verify){var h=cr(t,e.verify);return new Gg(h,n)}return W()}function ES(t,e){return{documents:[Av(t,e.path)]}}function TS(t,e){var n={structuredQuery:{}},r=e.path;e.collectionGroup!==null?(n.parent=Av(t,r),n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(n.parent=Av(t,r.popLast()),n.structuredQuery.from=[{collectionId:r.lastSegment()}]);var o=function(l){if(l.length!==0){var h=l.map(function(d){return function(p){if(p.op==="=="){if(R0(p.value))return{unaryFilter:{field:Po(p.field),op:"IS_NAN"}};if(N0(p.value))return{unaryFilter:{field:Po(p.field),op:"IS_NULL"}}}else if(p.op==="!="){if(R0(p.value))return{unaryFilter:{field:Po(p.field),op:"IS_NOT_NAN"}};if(N0(p.value))return{unaryFilter:{field:Po(p.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Po(p.field),op:Vx(p.op),value:p.value}}}(d)});return h.length===1?h[0]:{compositeFilter:{op:"AND",filters:h}}}}(e.filters);o&&(n.structuredQuery.where=o);var s=function(l){if(l.length!==0)return l.map(function(h){return function(d){return{field:Po(d.field),direction:Ux(d.dir)}}(h)})}(e.orderBy);s&&(n.structuredQuery.orderBy=s);var u=function(l,h){return l.I||Ji(h)?h:{value:h}}(t,e.limit);return u!==null&&(n.structuredQuery.limit=u),e.startAt&&(n.structuredQuery.startAt=H0(e.startAt)),e.endAt&&(n.structuredQuery.endAt=H0(e.endAt)),n}function SS(t){var e=bS(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0,o=null;if(r>0){Y(r===1);var s=n.from[0];s.allDescendants?o=s.collectionId:e=e.child(s.collectionId)}var u=[];n.where&&(u=CS(n.where));var l=[];n.orderBy&&(l=n.orderBy.map(function(g){return function(y){return new qo(Bo(y.field),function(w){switch(w){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(y.direction))}(g)}));var h=null;n.limit&&(h=function(g){var y;return Ji(y=typeof g=="object"?g.value:g)?null:y}(n.limit));var d=null;n.startAt&&(d=K0(n.startAt));var p=null;return n.endAt&&(p=K0(n.endAt)),rS(e,o,l,u,h,"F",d,p)}function CS(t){return t?t.unaryFilter!==void 0?[Bx(t)]:t.fieldFilter!==void 0?[jx(t)]:t.compositeFilter!==void 0?t.compositeFilter.filters.map(function(e){return CS(e)}).reduce(function(e,n){return e.concat(n)}):W():[]}function H0(t){return{before:t.before,values:t.position}}function K0(t){var e=!!t.before,n=t.values||[];return new Ka(n,e)}function Ux(t){return Px[t]}function Vx(t){return xx[t]}function Po(t){return{fieldPath:t.canonicalString()}}function Bo(t){return Dn.fromServerFormat(t.fieldPath)}function jx(t){return Zt.create(Bo(t.fieldFilter.field),function(e){switch(e){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":default:return W()}}(t.fieldFilter.op),t.fieldFilter.value)}function Bx(t){switch(t.unaryFilter.op){case"IS_NAN":var e=Bo(t.unaryFilter.field);return Zt.create(e,"==",{doubleValue:NaN});case"IS_NULL":var n=Bo(t.unaryFilter.field);return Zt.create(n,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":var r=Bo(t.unaryFilter.field);return Zt.create(r,"!=",{doubleValue:NaN});case"IS_NOT_NULL":var o=Bo(t.unaryFilter.field);return Zt.create(o,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":default:return W()}}function qx(t){var e=[];return t.fields.forEach(function(n){return e.push(n.canonicalString())}),{fieldPaths:e}}function AS(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rn(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=z0(e)),e=Gx(t.get(n),e);return z0(e)}function Gx(t,e){for(var n=e,r=t.length,o=0;o<r;o++){var s=t.charAt(o);switch(s){case"\0":n+="";break;case"":n+="";break;default:n+=s}}return n}function z0(t){return t+""}function ar(t){var e=t.length;if(Y(e>=2),e===2)return Y(t.charAt(0)===""&&t.charAt(1)===""),ge.emptyPath();for(var n=e-2,r=[],o="",s=0;s<e;){var u=t.indexOf("",s);switch((u<0||u>n)&&W(),t.charAt(u+1)){case"":var l=t.substring(s,u),h=void 0;o.length===0?h=l:(h=o+=l,o=""),r.push(h);break;case"":o+=t.substring(s,u),o+="\0";break;case"":o+=t.substring(s,u+1);break;default:W()}s=u+2}return new ge(r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wx=function(t,e){this.seconds=t,this.nanoseconds=e},Qt=function(t,e,n){this.ownerId=t,this.allowTabSynchronization=e,this.leaseTimestampMs=n};Qt.store="owner",Qt.key="owner";var Fr=function(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n};Fr.store="mutationQueues",Fr.keyPath="userId";var Ce=function(t,e,n,r,o){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.baseMutations=r,this.mutations=o};Ce.store="mutations",Ce.keyPath="batchId",Ce.userMutationsIndex="userMutationsIndex",Ce.userMutationsKeyPath=["userId","batchId"];var pt=function(){function t(){}return t.prefixForUser=function(e){return[e]},t.prefixForPath=function(e,n){return[e,Rn(n)]},t.key=function(e,n,r){return[e,Rn(n),r]},t}();pt.store="documentMutations",pt.PLACEHOLDER=new pt;var Hx=function(t,e){this.path=t,this.readTime=e},Kx=function(t,e){this.path=t,this.version=e},Me=function(t,e,n,r,o,s){this.unknownDocument=t,this.noDocument=e,this.document=n,this.hasCommittedMutations=r,this.readTime=o,this.parentPath=s};Me.store="remoteDocuments",Me.readTimeIndex="readTimeIndex",Me.readTimeIndexPath="readTime",Me.collectionReadTimeIndex="collectionReadTimeIndex",Me.collectionReadTimeIndexPath=["parentPath","readTime"];var qn=function(t){this.byteSize=t};qn.store="remoteDocumentGlobal",qn.key="remoteDocumentGlobalKey";var Vt=function(t,e,n,r,o,s,u){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=o,this.lastLimboFreeSnapshotVersion=s,this.query=u};Vt.store="targets",Vt.keyPath="targetId",Vt.queryTargetsIndexName="queryTargetsIndex",Vt.queryTargetsKeyPath=["canonicalId","targetId"];var ut=function(t,e,n){this.targetId=t,this.path=e,this.sequenceNumber=n};ut.store="targetDocuments",ut.keyPath=["targetId","path"],ut.documentTargetsIndex="documentTargetsIndex",ut.documentTargetsKeyPath=["path","targetId"];var Yt=function(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r};Yt.key="targetGlobalKey",Yt.store="targetGlobal";var Pi=function(t,e){this.collectionId=t,this.parent=e};Pi.store="collectionParents",Pi.keyPath=["collectionId","parent"];var lr=function(t,e,n,r){this.clientId=t,this.updateTimeMs=e,this.networkEnabled=n,this.inForeground=r};lr.store="clientMetadata",lr.keyPath="clientId";var es=function(t,e,n){this.bundleId=t,this.createTime=e,this.version=n};es.store="bundles",es.keyPath="bundleId";var ts=function(t,e,n){this.name=t,this.readTime=e,this.bundledQuery=n};ts.store="namedQueries",ts.keyPath="name";var zx=ve(ve([],ve(ve([],ve(ve([],ve(ve([],[Fr.store,Ce.store,pt.store,Me.store,Vt.store,Qt.store,Yt.store,ut.store]),[lr.store])),[qn.store])),[Pi.store])),[es.store,ts.store]),kS="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.",NS=function(){function t(){this.onCommittedListeners=[]}return t.prototype.addOnCommittedListener=function(e){this.onCommittedListeners.push(e)},t.prototype.raiseOnCommittedEvent=function(){this.onCommittedListeners.forEach(function(e){return e()})},t}(),Gt=function(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})},x=function(){function t(e){var n=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(function(r){n.isDone=!0,n.result=r,n.nextCallback&&n.nextCallback(r)},function(r){n.isDone=!0,n.error=r,n.catchCallback&&n.catchCallback(r)})}return t.prototype.catch=function(e){return this.next(void 0,e)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&W(),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(o,s){r.nextCallback=function(u){r.wrapSuccess(e,u).next(o,s)},r.catchCallback=function(u){r.wrapFailure(n,u).next(o,s)}})},t.prototype.toPromise=function(){var e=this;return new Promise(function(n,r){e.next(n,r)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(r){return t.reject(r)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(n,r){n(e)})},t.reject=function(e){return new t(function(n,r){r(e)})},t.waitFor=function(e){return new t(function(n,r){var o=0,s=0,u=!1;e.forEach(function(l){++o,l.next(function(){++s,u&&s===o&&n()},function(h){return r(h)})}),u=!0,s===o&&n()})},t.or=function(e){for(var n=t.resolve(!1),r=function(u){n=n.next(function(l){return l?t.resolve(l):u()})},o=0,s=e;o<s.length;o++)r(s[o]);return n},t.forEach=function(e,n){var r=this,o=[];return e.forEach(function(s,u){o.push(n.call(r,s,u))}),this.waitFor(o)},t}(),RS=function(){function t(e,n){var r=this;this.action=e,this.transaction=n,this.aborted=!1,this.ft=new Gt,this.transaction.oncomplete=function(){r.ft.resolve()},this.transaction.onabort=function(){n.error?r.ft.reject(new ka(e,n.error)):r.ft.resolve()},this.transaction.onerror=function(o){var s=zg(o.target.error);r.ft.reject(new ka(e,s))}}return t.open=function(e,n,r,o){try{return new t(n,e.transaction(o,r))}catch(s){throw new ka(n,s)}},Object.defineProperty(t.prototype,"dt",{get:function(){return this.ft.promise},enumerable:!1,configurable:!0}),t.prototype.abort=function(e){e&&this.ft.reject(e),this.aborted||(U("SimpleDb","Aborting transaction:",e?e.message:"Client-initiated abort"),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(e){var n=this.transaction.objectStore(e);return new Qx(n)},t}(),ns=function(){function t(e,n,r){this.name=e,this.version=n,this.wt=r,t._t(Vi())===12.2&&We("Firestore persistence suffers from a bug in iOS 12.2 Safari that may cause your app to stop working. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.")}return t.delete=function(e){return U("SimpleDb","Removing database:",e),Ti(window.indexedDB.deleteDatabase(e)).toPromise()},t.yt=function(){if(typeof indexedDB>"u")return!1;if(t.gt())return!0;var e=Vi(),n=t._t(e),r=0<n&&n<10,o=t.Et(e),s=0<o&&o<4.5;return!(e.indexOf("MSIE ")>0||e.indexOf("Trident/")>0||e.indexOf("Edge/")>0||r||s)},t.gt=function(){var e;return typeof process<"u"&&((e=sx)===null||e===void 0?void 0:e.Tt)==="YES"},t.It=function(e,n){return e.store(n)},t._t=function(e){var n=e.match(/i(?:phone|pad|pod) os ([\d_]+)/i),r=n?n[1].split("_").slice(0,2).join("."):"-1";return Number(r)},t.Et=function(e){var n=e.match(/Android ([\d.]+)/i),r=n?n[1].split(".").slice(0,2).join("."):"-1";return Number(r)},t.prototype.At=function(e){return A(this,void 0,void 0,function(){var n,r=this;return C(this,function(o){switch(o.label){case 0:return this.db?[3,2]:(U("SimpleDb","Opening database:",this.name),n=this,[4,new Promise(function(s,u){var l=indexedDB.open(r.name,r.version);l.onsuccess=function(h){var d=h.target.result;s(d)},l.onblocked=function(){u(new ka(e,"Cannot upgrade IndexedDB schema while another tab is open. Close all tabs that access Firestore and reload this page to proceed."))},l.onerror=function(h){var d=h.target.error;d.name==="VersionError"?u(new P(N.FAILED_PRECONDITION,"A newer version of the Firestore SDK was previously used and so the persisted data is not compatible with the version of the SDK you are now using. The SDK will operate with persistence disabled. If you need persistence, please re-upgrade to a newer version of the SDK or else clear the persisted IndexedDB data for your app to start fresh.")):u(new ka(e,d))},l.onupgradeneeded=function(h){U("SimpleDb",'Database "'+r.name+'" requires upgrade from version:',h.oldVersion);var d=h.target.result;r.wt.Rt(d,l.transaction,h.oldVersion,r.version).next(function(){U("SimpleDb","Database upgrade to version "+r.version+" complete")})}})]);case 1:n.db=o.sent(),o.label=2;case 2:return[2,(this.bt&&(this.db.onversionchange=function(s){return r.bt(s)}),this.db)]}})})},t.prototype.vt=function(e){this.bt=e,this.db&&(this.db.onversionchange=function(n){return e(n)})},t.prototype.runTransaction=function(e,n,r,o){return A(this,void 0,void 0,function(){var s,u,l,h,d;return C(this,function(p){switch(p.label){case 0:s=n==="readonly",u=0,l=function(){var g,y,w,b,E;return C(this,function(T){switch(T.label){case 0:++u,T.label=1;case 1:return T.trys.push([1,4,,5]),[4,h.At(e)];case 2:return h.db=T.sent(),g=RS.open(h.db,e,s?"readonly":"readwrite",r),y=o(g).catch(function(k){return g.abort(k),x.reject(k)}).toPromise(),w={},y.catch(function(){}),[4,g.dt];case 3:return[2,(w.value=(T.sent(),y),w)];case 4:return b=T.sent(),E=b.name!=="FirebaseError"&&u<3,U("SimpleDb","Transaction failed with error:",b.message,"Retrying:",E),h.close(),E?[3,5]:[2,{value:Promise.reject(b)}];case 5:return[2]}})},h=this,p.label=1;case 1:return[5,l()];case 2:if(typeof(d=p.sent())=="object")return[2,d.value];p.label=3;case 3:return[3,1];case 4:return[2]}})})},t.prototype.close=function(){this.db&&this.db.close(),this.db=void 0},t}(),$x=function(){function t(e){this.Pt=e,this.Vt=!1,this.St=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.Vt},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Dt",{get:function(){return this.St},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(e){this.Pt=e},enumerable:!1,configurable:!0}),t.prototype.done=function(){this.Vt=!0},t.prototype.Ct=function(e){this.St=e},t.prototype.delete=function(){return Ti(this.Pt.delete())},t}(),ka=function(t){function e(n,r){var o=this;return(o=t.call(this,N.UNAVAILABLE,"IndexedDB transaction '"+n+"' failed: "+r)||this).name="IndexedDbTransactionError",o}return V(e,t),e}(P);function Zi(t){return t.name==="IndexedDbTransactionError"}var Qx=function(){function t(e){this.store=e}return t.prototype.put=function(e,n){var r;return n!==void 0?(U("SimpleDb","PUT",this.store.name,e,n),r=this.store.put(n,e)):(U("SimpleDb","PUT",this.store.name,"<auto-key>",e),r=this.store.put(e)),Ti(r)},t.prototype.add=function(e){return U("SimpleDb","ADD",this.store.name,e,e),Ti(this.store.add(e))},t.prototype.get=function(e){var n=this;return Ti(this.store.get(e)).next(function(r){return r===void 0&&(r=null),U("SimpleDb","GET",n.store.name,e,r),r})},t.prototype.delete=function(e){return U("SimpleDb","DELETE",this.store.name,e),Ti(this.store.delete(e))},t.prototype.count=function(){return U("SimpleDb","COUNT",this.store.name),Ti(this.store.count())},t.prototype.Nt=function(e,n){var r=this.cursor(this.options(e,n)),o=[];return this.xt(r,function(s,u){o.push(u)}).next(function(){return o})},t.prototype.kt=function(e,n){U("SimpleDb","DELETE ALL",this.store.name);var r=this.options(e,n);r.Ft=!1;var o=this.cursor(r);return this.xt(o,function(s,u,l){return l.delete()})},t.prototype.$t=function(e,n){var r;n?r=e:(r={},n=e);var o=this.cursor(r);return this.xt(o,n)},t.prototype.Ot=function(e){var n=this.cursor({});return new x(function(r,o){n.onerror=function(s){var u=zg(s.target.error);o(u)},n.onsuccess=function(s){var u=s.target.result;u?e(u.primaryKey,u.value).next(function(l){l?u.continue():r()}):r()}})},t.prototype.xt=function(e,n){var r=[];return new x(function(o,s){e.onerror=function(u){s(u.target.error)},e.onsuccess=function(u){var l=u.target.result;if(l){var h=new $x(l),d=n(l.primaryKey,l.value,h);if(d instanceof x){var p=d.catch(function(g){return h.done(),x.reject(g)});r.push(p)}h.isDone?o():h.Dt===null?l.continue():l.continue(h.Dt)}else o()}}).next(function(){return x.waitFor(r)})},t.prototype.options=function(e,n){var r;return e!==void 0&&(typeof e=="string"?r=e:n=e),{index:r,range:n}},t.prototype.cursor=function(e){var n="next";if(e.reverse&&(n="prev"),e.index){var r=this.store.index(e.index);return e.Ft?r.openKeyCursor(e.range,n):r.openCursor(e.range,n)}return this.store.openCursor(e.range,n)},t}();function Ti(t){return new x(function(e,n){t.onsuccess=function(r){var o=r.target.result;e(o)},t.onerror=function(r){var o=zg(r.target.error);n(o)}})}var $0=!1;function zg(t){var e=ns._t(Vi());if(e>=12.2&&e<13){var n="An internal error was encountered in the Indexed Database server";if(t.message.indexOf(n)>=0){var r=new P("internal","IOS_INDEXEDDB_BUG1: IndexedDb has thrown '"+n+"'. This is likely due to an unavoidable bug in iOS. See https://stackoverflow.com/q/56496296/110915 for details and a potential workaround.");return $0||($0=!0,setTimeout(function(){throw r},0)),r}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Q0=function(t){function e(n,r){var o=this;return(o=t.call(this)||this).Mt=n,o.currentSequenceNumber=r,o}return V(e,t),e}(NS);function Wt(t,e){var n=j(t);return ns.It(n.Mt,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $g=function(){function t(e,n,r,o){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=o}return t.prototype.applyToRemoteDocument=function(e,n){for(var r=n.mutationResults,o=0;o<this.mutations.length;o++){var s=this.mutations[o];s.key.isEqual(e.key)&&Ex(s,e,r[o])}},t.prototype.applyToLocalView=function(e){for(var n=0,r=this.baseMutations;n<r.length;n++)(u=r[n]).key.isEqual(e.key)&&Sv(u,e,this.localWriteTime);for(var o=0,s=this.mutations;o<s.length;o++){var u;(u=s[o]).key.isEqual(e.key)&&Sv(u,e,this.localWriteTime)}},t.prototype.applyToLocalDocumentSet=function(e){var n=this;this.mutations.forEach(function(r){var o=e.get(r.key),s=o;n.applyToLocalView(s),o.isValidDocument()||s.convertToNoDocument(se.min())})},t.prototype.keys=function(){return this.mutations.reduce(function(e,n){return e.add(n.key)},Te())},t.prototype.isEqual=function(e){return this.batchId===e.batchId&&zo(this.mutations,e.mutations,function(n,r){return L0(n,r)})&&zo(this.baseMutations,e.baseMutations,function(n,r){return L0(n,r)})},t}(),Yx=function(){function t(e,n,r,o){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=o}return t.from=function(e,n,r){Y(e.mutations.length===r.length);for(var o=Nx(),s=e.mutations,u=0;u<s.length;u++)o=o.insert(s[u].key,r[u].version);return new t(e,n,r,o)},t}(),mh=function(){function t(e,n,r,o,s,u,l){s===void 0&&(s=se.min()),u===void 0&&(u=se.min()),l===void 0&&(l=qt.EMPTY_BYTE_STRING),this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=o,this.snapshotVersion=s,this.lastLimboFreeSnapshotVersion=u,this.resumeToken=l}return t.prototype.withSequenceNumber=function(e){return new t(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken)},t.prototype.withResumeToken=function(e,n){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e)},t.prototype.withLastLimboFreeSnapshotVersion=function(e){return new t(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken)},t}(),DS=function(t){this.Lt=t};function kv(t,e){if(e.document)return Fx(t.Lt,e.document,!!e.hasCommittedMutations);if(e.noDocument){var n=K.fromSegments(e.noDocument.path),r=is(e.noDocument.readTime),o=wt.newNoDocument(n,r);return e.hasCommittedMutations?o.setHasCommittedMutations():o}if(e.unknownDocument){var s=K.fromSegments(e.unknownDocument.path);return r=is(e.unknownDocument.version),wt.newUnknownDocument(s,r)}return W()}function Y0(t,e,n){var r=Qg(n),o=e.key.path.popLast().toArray();if(e.isFoundDocument()){var s=function(g,y){return{name:$a(g,y.key),fields:y.data.value.mapValue.fields,updateTime:za(g,y.version.toTimestamp())}}(t.Lt,e),u=e.hasCommittedMutations;return new Me(null,null,s,u,r,o)}if(e.isNoDocument()){var l=e.key.path.toArray(),h=rs(e.version);return u=e.hasCommittedMutations,new Me(null,new Hx(l,h),null,u,r,o)}if(e.isUnknownDocument()){var d=e.key.path.toArray(),p=rs(e.version);return new Me(new Kx(d,p),null,null,!0,r,o)}return W()}function Qg(t){var e=t.toTimestamp();return[e.seconds,e.nanoseconds]}function OS(t){var e=new Bt(t[0],t[1]);return se.fromTimestamp(e)}function rs(t){var e=t.toTimestamp();return new Wx(e.seconds,e.nanoseconds)}function is(t){var e=new Bt(t.seconds,t.nanoseconds);return se.fromTimestamp(e)}function Uo(t,e){for(var n=(e.baseMutations||[]).map(function(h){return W0(t.Lt,h)}),r=0;r<e.mutations.length-1;++r){var o=e.mutations[r];if(r+1<e.mutations.length&&e.mutations[r+1].transform!==void 0){var s=e.mutations[r+1];o.updateTransforms=s.transform.fieldTransforms,e.mutations.splice(r+1,1),++r}}var u=e.mutations.map(function(h){return W0(t.Lt,h)}),l=Bt.fromMillis(e.localWriteTimeMs);return new $g(e.batchId,l,n,u)}function Ta(t){var e,n,r=is(t.readTime),o=t.lastLimboFreeSnapshotVersion!==void 0?is(t.lastLimboFreeSnapshotVersion):se.min();return t.query.documents!==void 0?(Y((n=t.query).documents.length===1),e=$n(gu(bS(n.documents[0])))):e=function(s){return $n(SS(s))}(t.query),new mh(e,t.targetId,0,t.lastListenSequenceNumber,r,o,qt.fromBase64String(t.resumeToken))}function PS(t,e){var n,r=rs(e.snapshotVersion),o=rs(e.lastLimboFreeSnapshotVersion);n=wl(e.target)?ES(t.Lt,e.target):TS(t.Lt,e.target);var s=e.resumeToken.toBase64();return new Vt(e.targetId,vu(e.target),r,s,e.sequenceNumber,o,n)}function xS(t){var e=SS({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?iS(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xx=function(){function t(){}return t.prototype.getBundleMetadata=function(e,n){return X0(e).get(n).next(function(r){if(r)return{id:(o=r).bundleId,createTime:is(o.createTime),version:o.version};var o})},t.prototype.saveBundleMetadata=function(e,n){return X0(e).put({bundleId:(r=n).id,createTime:rs(Rt(r.createTime)),version:r.version});var r},t.prototype.getNamedQuery=function(e,n){return J0(e).get(n).next(function(r){if(r)return{name:(o=r).name,query:xS(o.bundledQuery),readTime:is(o.readTime)};var o})},t.prototype.saveNamedQuery=function(e,n){return J0(e).put(function(r){return{name:r.name,readTime:rs(Rt(r.readTime)),bundledQuery:r.bundledQuery}}(n))},t}();function X0(t){return Wt(t,es.store)}function J0(t){return Wt(t,ts.store)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jx=function(){function t(){this.Bt=new Yg}return t.prototype.addToCollectionParentIndex=function(e,n){return this.Bt.add(n),x.resolve()},t.prototype.getCollectionParents=function(e,n){return x.resolve(this.Bt.getEntries(n))},t}(),Yg=function(){function t(){this.index={}}return t.prototype.add=function(e){var n=e.lastSegment(),r=e.popLast(),o=this.index[n]||new Xe(ge.comparator),s=!o.has(r);return this.index[n]=o.add(r),s},t.prototype.has=function(e){var n=e.lastSegment(),r=e.popLast(),o=this.index[n];return o&&o.has(r)},t.prototype.getEntries=function(e){return(this.index[e]||new Xe(ge.comparator)).toArray()},t}(),Zx=function(){function t(){this.qt=new Yg}return t.prototype.addToCollectionParentIndex=function(e,n){var r=this;if(!this.qt.has(n)){var o=n.lastSegment(),s=n.popLast();e.addOnCommittedListener(function(){r.qt.add(n)});var u={collectionId:o,parent:Rn(s)};return Z0(e).put(u)}return x.resolve()},t.prototype.getCollectionParents=function(e,n){var r=[],o=IDBKeyRange.bound([n,""],[YT(n),""],!1,!0);return Z0(e).Nt(o).next(function(s){for(var u=0,l=s;u<l.length;u++){var h=l[u];if(h.collectionId!==n)break;r.push(ar(h.parent))}return r})},t}();function Z0(t){return Wt(t,Pi.store)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var eI={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},Bn=function(){function t(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}return t.withCacheSize=function(e){return new t(e,t.DEFAULT_COLLECTION_PERCENTILE,t.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)},t}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LS(t,e,n){var r=t.store(Ce.store),o=t.store(pt.store),s=[],u=IDBKeyRange.only(n.batchId),l=0,h=r.$t({range:u},function(b,E,T){return l++,T.delete()});s.push(h.next(function(){Y(l===1)}));for(var d=[],p=0,g=n.mutations;p<g.length;p++){var y=g[p],w=pt.key(e,y.key.path,n.batchId);s.push(o.delete(w)),d.push(y.key)}return x.waitFor(s).next(function(){return d})}function Tl(t){if(!t)return 0;var e;if(t.document)e=t.document;else if(t.unknownDocument)e=t.unknownDocument;else{if(!t.noDocument)throw W();e=t.noDocument}return JSON.stringify(e).length}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Bn.DEFAULT_COLLECTION_PERCENTILE=10,Bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Bn.DEFAULT=new Bn(41943040,Bn.DEFAULT_COLLECTION_PERCENTILE,Bn.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Bn.DISABLED=new Bn(-1,0,0);var eL=function(){function t(e,n,r,o){this.userId=e,this.R=n,this.Ut=r,this.referenceDelegate=o,this.Kt={}}return t.Qt=function(e,n,r,o){return Y(e.uid!==""),new t(e.isAuthenticated()?e.uid:"",n,r,o)},t.prototype.checkEmpty=function(e){var n=!0,r=IDBKeyRange.bound([this.userId,Number.NEGATIVE_INFINITY],[this.userId,Number.POSITIVE_INFINITY]);return kr(e).$t({index:Ce.userMutationsIndex,range:r},function(o,s,u){n=!1,u.done()}).next(function(){return n})},t.prototype.addMutationBatch=function(e,n,r,o){var s=this,u=Vo(e),l=kr(e);return l.add({}).next(function(h){Y(typeof h=="number");for(var d=new $g(h,n,r,o),p=function(k,O,M){var H=M.baseMutations.map(function(F){return El(k.Lt,F)}),X=M.mutations.map(function(F){return El(k.Lt,F)});return new Ce(O,M.batchId,M.localWriteTime.toMillis(),H,X)}(s.R,s.userId,d),g=[],y=new Xe(function(k,O){return ce(k.canonicalString(),O.canonicalString())}),w=0,b=o;w<b.length;w++){var E=b[w],T=pt.key(s.userId,E.key.path,h);y=y.add(E.key.path.popLast()),g.push(l.put(p)),g.push(u.put(T,pt.PLACEHOLDER))}return y.forEach(function(k){g.push(s.Ut.addToCollectionParentIndex(e,k))}),e.addOnCommittedListener(function(){s.Kt[h]=d.keys()}),x.waitFor(g).next(function(){return d})})},t.prototype.lookupMutationBatch=function(e,n){var r=this;return kr(e).get(n).next(function(o){return o?(Y(o.userId===r.userId),Uo(r.R,o)):null})},t.prototype.jt=function(e,n){var r=this;return this.Kt[n]?x.resolve(this.Kt[n]):this.lookupMutationBatch(e,n).next(function(o){if(o){var s=o.keys();return r.Kt[n]=s,s}return null})},t.prototype.getNextMutationBatchAfterBatchId=function(e,n){var r=this,o=n+1,s=IDBKeyRange.lowerBound([this.userId,o]),u=null;return kr(e).$t({index:Ce.userMutationsIndex,range:s},function(l,h,d){h.userId===r.userId&&(Y(h.batchId>=o),u=Uo(r.R,h)),d.done()}).next(function(){return u})},t.prototype.getHighestUnacknowledgedBatchId=function(e){var n=IDBKeyRange.upperBound([this.userId,Number.POSITIVE_INFINITY]),r=-1;return kr(e).$t({index:Ce.userMutationsIndex,range:n,reverse:!0},function(o,s,u){r=s.batchId,u.done()}).next(function(){return r})},t.prototype.getAllMutationBatches=function(e){var n=this,r=IDBKeyRange.bound([this.userId,-1],[this.userId,Number.POSITIVE_INFINITY]);return kr(e).Nt(Ce.userMutationsIndex,r).next(function(o){return o.map(function(s){return Uo(n.R,s)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,n){var r=this,o=pt.prefixForPath(this.userId,n.path),s=IDBKeyRange.lowerBound(o),u=[];return Vo(e).$t({range:s},function(l,h,d){var p=l[0],g=l[1],y=l[2],w=ar(g);if(p===r.userId&&n.path.isEqual(w))return kr(e).get(y).next(function(b){if(!b)throw W();Y(b.userId===r.userId),u.push(Uo(r.R,b))});d.done()}).next(function(){return u})},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,n){var r=this,o=new Xe(ce),s=[];return n.forEach(function(u){var l=pt.prefixForPath(r.userId,u.path),h=IDBKeyRange.lowerBound(l),d=Vo(e).$t({range:h},function(p,g,y){var w=p[0],b=p[1],E=p[2],T=ar(b);w===r.userId&&u.path.isEqual(T)?o=o.add(E):y.done()});s.push(d)}),x.waitFor(s).next(function(){return r.Wt(e,o)})},t.prototype.getAllMutationBatchesAffectingQuery=function(e,n){var r=this,o=n.path,s=o.length+1,u=pt.prefixForPath(this.userId,o),l=IDBKeyRange.lowerBound(u),h=new Xe(ce);return Vo(e).$t({range:l},function(d,p,g){var y=d[0],w=d[1],b=d[2],E=ar(w);y===r.userId&&o.isPrefixOf(E)?E.length===s&&(h=h.add(b)):g.done()}).next(function(){return r.Wt(e,h)})},t.prototype.Wt=function(e,n){var r=this,o=[],s=[];return n.forEach(function(u){s.push(kr(e).get(u).next(function(l){if(l===null)throw W();Y(l.userId===r.userId),o.push(Uo(r.R,l))}))}),x.waitFor(s).next(function(){return o})},t.prototype.removeMutationBatch=function(e,n){var r=this;return LS(e.Mt,this.userId,n).next(function(o){return e.addOnCommittedListener(function(){r.Gt(n.batchId)}),x.forEach(o,function(s){return r.referenceDelegate.markPotentiallyOrphaned(e,s)})})},t.prototype.Gt=function(e){delete this.Kt[e]},t.prototype.performConsistencyCheck=function(e){var n=this;return this.checkEmpty(e).next(function(r){if(!r)return x.resolve();var o=IDBKeyRange.lowerBound(pt.prefixForUser(n.userId)),s=[];return Vo(e).$t({range:o},function(u,l,h){if(u[0]===n.userId){var d=ar(u[1]);s.push(d)}else h.done()}).next(function(){Y(s.length===0)})})},t.prototype.containsKey=function(e,n){return MS(e,this.userId,n)},t.prototype.zt=function(e){var n=this;return FS(e).get(this.userId).next(function(r){return r||new Fr(n.userId,-1,"")})},t}();function MS(t,e,n){var r=pt.prefixForPath(e,n.path),o=r[1],s=IDBKeyRange.lowerBound(r),u=!1;return Vo(t).$t({range:s,Ft:!0},function(l,h,d){var p=l[0],g=l[1];l[2],p===e&&g===o&&(u=!0),d.done()}).next(function(){return u})}function kr(t){return Wt(t,Ce.store)}function Vo(t){return Wt(t,pt.store)}function FS(t){return Wt(t,Fr.store)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Sl=function(){function t(e){this.Ht=e}return t.prototype.next=function(){return this.Ht+=2,this.Ht},t.Jt=function(){return new t(0)},t.Yt=function(){return new t(-1)},t}(),tL=function(){function t(e,n){this.referenceDelegate=e,this.R=n}return t.prototype.allocateTargetId=function(e){var n=this;return this.Xt(e).next(function(r){var o=new Sl(r.highestTargetId);return r.highestTargetId=o.next(),n.Zt(e,r).next(function(){return r.highestTargetId})})},t.prototype.getLastRemoteSnapshotVersion=function(e){return this.Xt(e).next(function(n){return se.fromTimestamp(new Bt(n.lastRemoteSnapshotVersion.seconds,n.lastRemoteSnapshotVersion.nanoseconds))})},t.prototype.getHighestSequenceNumber=function(e){return this.Xt(e).next(function(n){return n.highestListenSequenceNumber})},t.prototype.setTargetsMetadata=function(e,n,r){var o=this;return this.Xt(e).next(function(s){return s.highestListenSequenceNumber=n,r&&(s.lastRemoteSnapshotVersion=r.toTimestamp()),n>s.highestListenSequenceNumber&&(s.highestListenSequenceNumber=n),o.Zt(e,s)})},t.prototype.addTargetData=function(e,n){var r=this;return this.te(e,n).next(function(){return r.Xt(e).next(function(o){return o.targetCount+=1,r.ee(n,o),r.Zt(e,o)})})},t.prototype.updateTargetData=function(e,n){return this.te(e,n)},t.prototype.removeTargetData=function(e,n){var r=this;return this.removeMatchingKeysForTargetId(e,n.targetId).next(function(){return xo(e).delete(n.targetId)}).next(function(){return r.Xt(e)}).next(function(o){return Y(o.targetCount>0),o.targetCount-=1,r.Zt(e,o)})},t.prototype.removeTargets=function(e,n,r){var o=this,s=0,u=[];return xo(e).$t(function(l,h){var d=Ta(h);d.sequenceNumber<=n&&r.get(d.targetId)===null&&(s++,u.push(o.removeTargetData(e,d)))}).next(function(){return x.waitFor(u)}).next(function(){return s})},t.prototype.forEachTarget=function(e,n){return xo(e).$t(function(r,o){var s=Ta(o);n(s)})},t.prototype.Xt=function(e){return tI(e).get(Yt.key).next(function(n){return Y(n!==null),n})},t.prototype.Zt=function(e,n){return tI(e).put(Yt.key,n)},t.prototype.te=function(e,n){return xo(e).put(PS(this.R,n))},t.prototype.ee=function(e,n){var r=!1;return e.targetId>n.highestTargetId&&(n.highestTargetId=e.targetId,r=!0),e.sequenceNumber>n.highestListenSequenceNumber&&(n.highestListenSequenceNumber=e.sequenceNumber,r=!0),r},t.prototype.getTargetCount=function(e){return this.Xt(e).next(function(n){return n.targetCount})},t.prototype.getTargetData=function(e,n){var r=vu(n),o=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),s=null;return xo(e).$t({range:o,index:Vt.queryTargetsIndexName},function(u,l,h){var d=Ta(l);dh(n,d.target)&&(s=d,h.done())}).next(function(){return s})},t.prototype.addMatchingKeys=function(e,n,r){var o=this,s=[],u=Pr(e);return n.forEach(function(l){var h=Rn(l.path);s.push(u.put(new ut(r,h))),s.push(o.referenceDelegate.addReference(e,r,l))}),x.waitFor(s)},t.prototype.removeMatchingKeys=function(e,n,r){var o=this,s=Pr(e);return x.forEach(n,function(u){var l=Rn(u.path);return x.waitFor([s.delete([r,l]),o.referenceDelegate.removeReference(e,r,u)])})},t.prototype.removeMatchingKeysForTargetId=function(e,n){var r=Pr(e),o=IDBKeyRange.bound([n],[n+1],!1,!0);return r.delete(o)},t.prototype.getMatchingKeysForTargetId=function(e,n){var r=IDBKeyRange.bound([n],[n+1],!1,!0),o=Pr(e),s=Te();return o.$t({range:r,Ft:!0},function(u,l,h){var d=ar(u[1]),p=new K(d);s=s.add(p)}).next(function(){return s})},t.prototype.containsKey=function(e,n){var r=Rn(n.path),o=IDBKeyRange.bound([r],[YT(r)],!1,!0),s=0;return Pr(e).$t({index:ut.documentTargetsIndex,Ft:!0,range:o},function(u,l,h){var d=u[0];u[1],d!==0&&(s++,h.done())}).next(function(){return s>0})},t.prototype.lt=function(e,n){return xo(e).get(n).next(function(r){return r?Ta(r):null})},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xo(t){return Wt(t,Vt.store)}function tI(t){return Wt(t,Yt.store)}function Pr(t){return Wt(t,ut.store)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function eo(t){return A(this,void 0,void 0,function(){return C(this,function(e){if(t.code!==N.FAILED_PRECONDITION||t.message!==kS)throw t;return U("LocalStore","Unexpectedly lost primary lease"),[2]})})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function nI(t,e){var n=t[0],r=t[1],o=e[0],s=e[1],u=ce(n,o);return u===0?ce(r,s):u}var nL=function(){function t(e){this.ne=e,this.buffer=new Xe(nI),this.se=0}return t.prototype.ie=function(){return++this.se},t.prototype.re=function(e){var n=[e,this.ie()];if(this.buffer.size<this.ne)this.buffer=this.buffer.add(n);else{var r=this.buffer.last();nI(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}},Object.defineProperty(t.prototype,"maxValue",{get:function(){return this.buffer.last()[0]},enumerable:!1,configurable:!0}),t}(),rL=function(){function t(e,n){this.garbageCollector=e,this.asyncQueue=n,this.oe=!1,this.ce=null}return t.prototype.start=function(e){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.ue(e)},t.prototype.stop=function(){this.ce&&(this.ce.cancel(),this.ce=null)},Object.defineProperty(t.prototype,"started",{get:function(){return this.ce!==null},enumerable:!1,configurable:!0}),t.prototype.ue=function(e){var n=this,r=this.oe?3e5:6e4;U("LruGarbageCollector","Garbage collection scheduled in "+r+"ms"),this.ce=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",r,function(){return A(n,void 0,void 0,function(){var o;return C(this,function(s){switch(s.label){case 0:this.ce=null,this.oe=!0,s.label=1;case 1:return s.trys.push([1,3,,7]),[4,e.collectGarbage(this.garbageCollector)];case 2:return s.sent(),[3,7];case 3:return Zi(o=s.sent())?(U("LruGarbageCollector","Ignoring IndexedDB error during garbage collection: ",o),[3,6]):[3,4];case 4:return[4,eo(o)];case 5:s.sent(),s.label=6;case 6:return[3,7];case 7:return[4,this.ue(e)];case 8:return s.sent(),[2]}})})})},t}(),iL=function(){function t(e,n){this.ae=e,this.params=n}return t.prototype.calculateTargetCount=function(e,n){return this.ae.he(e).next(function(r){return Math.floor(n/100*r)})},t.prototype.nthSequenceNumber=function(e,n){var r=this;if(n===0)return x.resolve(Jt.o);var o=new nL(n);return this.ae.forEachTarget(e,function(s){return o.re(s.sequenceNumber)}).next(function(){return r.ae.le(e,function(s){return o.re(s)})}).next(function(){return o.maxValue})},t.prototype.removeTargets=function(e,n,r){return this.ae.removeTargets(e,n,r)},t.prototype.removeOrphanedDocuments=function(e,n){return this.ae.removeOrphanedDocuments(e,n)},t.prototype.collect=function(e,n){var r=this;return this.params.cacheSizeCollectionThreshold===-1?(U("LruGarbageCollector","Garbage collection skipped; disabled"),x.resolve(eI)):this.getCacheSize(e).next(function(o){return o<r.params.cacheSizeCollectionThreshold?(U("LruGarbageCollector","Garbage collection skipped; Cache size "+o+" is lower than threshold "+r.params.cacheSizeCollectionThreshold),eI):r.fe(e,n)})},t.prototype.getCacheSize=function(e){return this.ae.getCacheSize(e)},t.prototype.fe=function(e,n){var r,o,s,u,l,h,d,p=this,g=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(function(y){return y>p.params.maximumSequenceNumbersToCollect?(U("LruGarbageCollector","Capping sequence numbers to collect down to the maximum of "+p.params.maximumSequenceNumbersToCollect+" from "+y),o=p.params.maximumSequenceNumbersToCollect):o=y,u=Date.now(),p.nthSequenceNumber(e,o)}).next(function(y){return r=y,l=Date.now(),p.removeTargets(e,r,n)}).next(function(y){return s=y,h=Date.now(),p.removeOrphanedDocuments(e,r)}).next(function(y){return d=Date.now(),bv()<=fe.DEBUG&&U("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in `+(u-g)+`ms
	Determined least recently used `+o+" in "+(l-u)+`ms
	Removed `+s+" targets in "+(h-l)+`ms
	Removed `+y+" documents in "+(d-h)+`ms
Total Duration: `+(d-g)+"ms"),x.resolve({didRun:!0,sequenceNumbersCollected:o,targetsRemoved:s,documentsRemoved:y})})},t}(),oL=function(){function t(e,n){this.db=e,this.garbageCollector=function(r,o){return new iL(r,o)}(this,n)}return t.prototype.he=function(e){var n=this.de(e);return this.db.getTargetCache().getTargetCount(e).next(function(r){return n.next(function(o){return r+o})})},t.prototype.de=function(e){var n=0;return this.le(e,function(r){n++}).next(function(){return n})},t.prototype.forEachTarget=function(e,n){return this.db.getTargetCache().forEachTarget(e,n)},t.prototype.le=function(e,n){return this.we(e,function(r,o){return n(o)})},t.prototype.addReference=function(e,n,r){return Gc(e,r)},t.prototype.removeReference=function(e,n,r){return Gc(e,r)},t.prototype.removeTargets=function(e,n,r){return this.db.getTargetCache().removeTargets(e,n,r)},t.prototype.markPotentiallyOrphaned=function(e,n){return Gc(e,n)},t.prototype._e=function(e,n){return function(r,o){var s=!1;return FS(r).Ot(function(u){return MS(r,u,o).next(function(l){return l&&(s=!0),x.resolve(!l)})}).next(function(){return s})}(e,n)},t.prototype.removeOrphanedDocuments=function(e,n){var r=this,o=this.db.getRemoteDocumentCache().newChangeBuffer(),s=[],u=0;return this.we(e,function(l,h){if(h<=n){var d=r._e(e,l).next(function(p){if(!p)return u++,o.getEntry(e,l).next(function(){return o.removeEntry(l),Pr(e).delete([0,Rn(l.path)])})});s.push(d)}}).next(function(){return x.waitFor(s)}).next(function(){return o.apply(e)}).next(function(){return u})},t.prototype.removeTarget=function(e,n){var r=n.withSequenceNumber(e.currentSequenceNumber);return this.db.getTargetCache().updateTargetData(e,r)},t.prototype.updateLimboDocument=function(e,n){return Gc(e,n)},t.prototype.we=function(e,n){var r,o=Pr(e),s=Jt.o;return o.$t({index:ut.documentTargetsIndex},function(u,l){var h=u[0];u[1];var d=l.path,p=l.sequenceNumber;h===0?(s!==Jt.o&&n(new K(ar(r)),s),s=p,r=d):s=Jt.o}).next(function(){s!==Jt.o&&n(new K(ar(r)),s)})},t.prototype.getCacheSize=function(e){return this.db.getRemoteDocumentCache().getSize(e)},t}();function Gc(t,e){return Pr(t).put(function(n,r){return new ut(0,Rn(n.path),r)}(e,t.currentSequenceNumber))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _s=function(){function t(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={}}return t.prototype.get=function(e){var n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0)for(var o=0,s=r;o<s.length;o++){var u=s[o],l=u[0],h=u[1];if(this.equalsFn(l,e))return h}},t.prototype.has=function(e){return this.get(e)!==void 0},t.prototype.set=function(e,n){var r=this.mapKeyFn(e),o=this.inner[r];if(o!==void 0){for(var s=0;s<o.length;s++)if(this.equalsFn(o[s][0],e))return void(o[s]=[e,n]);o.push([e,n])}else this.inner[r]=[[e,n]]},t.prototype.delete=function(e){var n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(var o=0;o<r.length;o++)if(this.equalsFn(r[o][0],e))return r.length===1?delete this.inner[n]:r.splice(o,1),!0;return!1},t.prototype.forEach=function(e){Xi(this.inner,function(n,r){for(var o=0,s=r;o<s.length;o++){var u=s[o],l=u[0],h=u[1];e(l,h)}})},t.prototype.isEmpty=function(){return XT(this.inner)},t}(),US=function(){function t(){this.changes=new _s(function(e){return e.toString()},function(e,n){return e.isEqual(n)}),this.changesApplied=!1}return t.prototype.getReadTime=function(e){var n=this.changes.get(e);return n?n.readTime:se.min()},t.prototype.addEntry=function(e,n){this.assertNotApplied(),this.changes.set(e.key,{document:e,readTime:n})},t.prototype.removeEntry=function(e,n){n===void 0&&(n=null),this.assertNotApplied(),this.changes.set(e,{document:wt.newInvalidDocument(e),readTime:n})},t.prototype.getEntry=function(e,n){this.assertNotApplied();var r=this.changes.get(n);return r!==void 0?x.resolve(r.document):this.getFromCache(e,n)},t.prototype.getEntries=function(e,n){return this.getAllFromCache(e,n)},t.prototype.apply=function(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)},t.prototype.assertNotApplied=function(){},t}(),sL=function(){function t(e,n){this.R=e,this.Ut=n}return t.prototype.addEntry=function(e,n,r){return Dr(e).put(Wc(n),r)},t.prototype.removeEntry=function(e,n){var r=Dr(e),o=Wc(n);return r.delete(o)},t.prototype.updateMetadata=function(e,n){var r=this;return this.getMetadata(e).next(function(o){return o.byteSize+=n,r.me(e,o)})},t.prototype.getEntry=function(e,n){var r=this;return Dr(e).get(Wc(n)).next(function(o){return r.ye(n,o)})},t.prototype.ge=function(e,n){var r=this;return Dr(e).get(Wc(n)).next(function(o){return{document:r.ye(n,o),size:Tl(o)}})},t.prototype.getEntries=function(e,n){var r=this,o=Nn();return this.pe(e,n,function(s,u){var l=r.ye(s,u);o=o.insert(s,l)}).next(function(){return o})},t.prototype.Ee=function(e,n){var r=this,o=Nn(),s=new bt(K.comparator);return this.pe(e,n,function(u,l){var h=r.ye(u,l);o=o.insert(u,h),s=s.insert(u,Tl(l))}).next(function(){return{documents:o,Te:s}})},t.prototype.pe=function(e,n,r){if(n.isEmpty())return x.resolve();var o=IDBKeyRange.bound(n.first().path.toArray(),n.last().path.toArray()),s=n.getIterator(),u=s.getNext();return Dr(e).$t({range:o},function(l,h,d){for(var p=K.fromSegments(l);u&&K.comparator(u,p)<0;)r(u,null),u=s.getNext();u&&u.isEqual(p)&&(r(u,h),u=s.hasNext()?s.getNext():null),u?d.Ct(u.path.toArray()):d.done()}).next(function(){for(;u;)r(u,null),u=s.hasNext()?s.getNext():null})},t.prototype.getDocumentsMatchingQuery=function(e,n,r){var o=this,s=Nn(),u=n.path.length+1,l={};if(r.isEqual(se.min())){var h=n.path.toArray();l.range=IDBKeyRange.lowerBound(h)}else{var d=n.path.toArray(),p=Qg(r);l.range=IDBKeyRange.lowerBound([d,p],!0),l.index=Me.collectionReadTimeIndex}return Dr(e).$t(l,function(g,y,w){if(g.length===u){var b=kv(o.R,y);n.path.isPrefixOf(b.key.path)?yu(n,b)&&(s=s.insert(b.key,b)):w.done()}}).next(function(){return s})},t.prototype.newChangeBuffer=function(e){return new aL(this,!!e&&e.trackRemovals)},t.prototype.getSize=function(e){return this.getMetadata(e).next(function(n){return n.byteSize})},t.prototype.getMetadata=function(e){return rI(e).get(qn.key).next(function(n){return Y(!!n),n})},t.prototype.me=function(e,n){return rI(e).put(qn.key,n)},t.prototype.ye=function(e,n){if(n){var r=kv(this.R,n);if(!r.isNoDocument()||!r.version.isEqual(se.min()))return r}return wt.newInvalidDocument(e)},t}(),aL=function(t){function e(n,r){var o=this;return(o=t.call(this)||this).Ie=n,o.trackRemovals=r,o.Ae=new _s(function(s){return s.toString()},function(s,u){return s.isEqual(u)}),o}return V(e,t),e.prototype.applyChanges=function(n){var r=this,o=[],s=0,u=new Xe(function(l,h){return ce(l.canonicalString(),h.canonicalString())});return this.changes.forEach(function(l,h){var d=r.Ae.get(l);if(h.document.isValidDocument()){var p=Y0(r.Ie.R,h.document,r.getReadTime(l));u=u.add(l.path.popLast());var g=Tl(p);s+=g-d,o.push(r.Ie.addEntry(n,l,p))}else if(s-=d,r.trackRemovals){var y=Y0(r.Ie.R,wt.newNoDocument(l,se.min()),r.getReadTime(l));o.push(r.Ie.addEntry(n,l,y))}else o.push(r.Ie.removeEntry(n,l))}),u.forEach(function(l){o.push(r.Ie.Ut.addToCollectionParentIndex(n,l))}),o.push(this.Ie.updateMetadata(n,s)),x.waitFor(o)},e.prototype.getFromCache=function(n,r){var o=this;return this.Ie.ge(n,r).next(function(s){return o.Ae.set(r,s.size),s.document})},e.prototype.getAllFromCache=function(n,r){var o=this;return this.Ie.Ee(n,r).next(function(s){var u=s.documents;return s.Te.forEach(function(l,h){o.Ae.set(l,h)}),u})},e}(US);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rI(t){return Wt(t,qn.store)}function Dr(t){return Wt(t,Me.store)}function Wc(t){return t.path.toArray()}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var uL=function(){function t(e){this.R=e}return t.prototype.Rt=function(e,n,r,o){var s=this;Y(r<o&&r>=0&&o<=11);var u=new RS("createOrUpgrade",n);r<1&&o>=1&&(function(h){h.createObjectStore(Qt.store)}(e),function(h){h.createObjectStore(Fr.store,{keyPath:Fr.keyPath}),h.createObjectStore(Ce.store,{keyPath:Ce.keyPath,autoIncrement:!0}).createIndex(Ce.userMutationsIndex,Ce.userMutationsKeyPath,{unique:!0}),h.createObjectStore(pt.store)}(e),iI(e),function(h){h.createObjectStore(Me.store)}(e));var l=x.resolve();return r<3&&o>=3&&(r!==0&&(function(h){h.deleteObjectStore(ut.store),h.deleteObjectStore(Vt.store),h.deleteObjectStore(Yt.store)}(e),iI(e)),l=l.next(function(){return function(h){var d=h.store(Yt.store),p=new Yt(0,0,se.min().toTimestamp(),0);return d.put(Yt.key,p)}(u)})),r<4&&o>=4&&(r!==0&&(l=l.next(function(){return function(h,d){return d.store(Ce.store).Nt().next(function(p){h.deleteObjectStore(Ce.store),h.createObjectStore(Ce.store,{keyPath:Ce.keyPath,autoIncrement:!0}).createIndex(Ce.userMutationsIndex,Ce.userMutationsKeyPath,{unique:!0});var g=d.store(Ce.store),y=p.map(function(w){return g.put(w)});return x.waitFor(y)})}(e,u)})),l=l.next(function(){(function(h){h.createObjectStore(lr.store,{keyPath:lr.keyPath})})(e)})),r<5&&o>=5&&(l=l.next(function(){return s.Re(u)})),r<6&&o>=6&&(l=l.next(function(){return function(h){h.createObjectStore(qn.store)}(e),s.be(u)})),r<7&&o>=7&&(l=l.next(function(){return s.ve(u)})),r<8&&o>=8&&(l=l.next(function(){return s.Pe(e,u)})),r<9&&o>=9&&(l=l.next(function(){(function(h){h.objectStoreNames.contains("remoteDocumentChanges")&&h.deleteObjectStore("remoteDocumentChanges")})(e),function(h){var d=h.objectStore(Me.store);d.createIndex(Me.readTimeIndex,Me.readTimeIndexPath,{unique:!1}),d.createIndex(Me.collectionReadTimeIndex,Me.collectionReadTimeIndexPath,{unique:!1})}(n)})),r<10&&o>=10&&(l=l.next(function(){return s.Ve(u)})),r<11&&o>=11&&(l=l.next(function(){(function(h){h.createObjectStore(es.store,{keyPath:es.keyPath})})(e),function(h){h.createObjectStore(ts.store,{keyPath:ts.keyPath})}(e)})),l},t.prototype.be=function(e){var n=0;return e.store(Me.store).$t(function(r,o){n+=Tl(o)}).next(function(){var r=new qn(n);return e.store(qn.store).put(qn.key,r)})},t.prototype.Re=function(e){var n=this,r=e.store(Fr.store),o=e.store(Ce.store);return r.Nt().next(function(s){return x.forEach(s,function(u){var l=IDBKeyRange.bound([u.userId,-1],[u.userId,u.lastAcknowledgedBatchId]);return o.Nt(Ce.userMutationsIndex,l).next(function(h){return x.forEach(h,function(d){Y(d.userId===u.userId);var p=Uo(n.R,d);return LS(e,u.userId,p).next(function(){})})})})})},t.prototype.ve=function(e){var n=e.store(ut.store),r=e.store(Me.store);return e.store(Yt.store).get(Yt.key).next(function(o){var s=[];return r.$t(function(u,l){var h=new ge(u),d=function(p){return[0,Rn(p)]}(h);s.push(n.get(d).next(function(p){return p?x.resolve():function(g){return n.put(new ut(0,Rn(g),o.highestListenSequenceNumber))}(h)}))}).next(function(){return x.waitFor(s)})})},t.prototype.Pe=function(e,n){e.createObjectStore(Pi.store,{keyPath:Pi.keyPath});var r=n.store(Pi.store),o=new Yg,s=function(u){if(o.add(u)){var l=u.lastSegment(),h=u.popLast();return r.put({collectionId:l,parent:Rn(h)})}};return n.store(Me.store).$t({Ft:!0},function(u,l){var h=new ge(u);return s(h.popLast())}).next(function(){return n.store(pt.store).$t({Ft:!0},function(u,l){u[0];var h=u[1];u[2];var d=ar(h);return s(d.popLast())})})},t.prototype.Ve=function(e){var n=this,r=e.store(Vt.store);return r.$t(function(o,s){var u=Ta(s),l=PS(n.R,u);return r.put(l)})},t}();function iI(t){t.createObjectStore(ut.store,{keyPath:ut.keyPath}).createIndex(ut.documentTargetsIndex,ut.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Vt.store,{keyPath:Vt.keyPath}).createIndex(Vt.queryTargetsIndexName,Vt.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Yt.store)}var Hp="Failed to obtain exclusive access to the persistence layer. To allow shared access, multi-tab synchronization has to be enabled in all tabs. If you are using `experimentalForceOwningTab:true`, make sure that only one tab has persistence enabled at any given time.",cL=function(){function t(e,n,r,o,s,u,l,h,d,p){if(this.allowTabSynchronization=e,this.persistenceKey=n,this.clientId=r,this.Se=s,this.window=u,this.document=l,this.De=d,this.Ce=p,this.Ne=null,this.xe=!1,this.isPrimary=!1,this.networkEnabled=!0,this.ke=null,this.inForeground=!1,this.Fe=null,this.$e=null,this.Oe=Number.NEGATIVE_INFINITY,this.Me=function(g){return Promise.resolve()},!t.yt())throw new P(N.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled.");this.referenceDelegate=new oL(this,o),this.Le=n+"main",this.R=new DS(h),this.Be=new ns(this.Le,11,new uL(this.R)),this.qe=new tL(this.referenceDelegate,this.R),this.Ut=new Zx,this.Ue=function(g,y){return new sL(g,y)}(this.R,this.Ut),this.Ke=new Xx,this.window&&this.window.localStorage?this.Qe=this.window.localStorage:(this.Qe=null,p===!1&&We("IndexedDbPersistence","LocalStorage is unavailable. As a result, persistence may not work reliably. In particular enablePersistence() could fail immediately after refreshing the page."))}return t.prototype.start=function(){var e=this;return this.je().then(function(){if(!e.isPrimary&&!e.allowTabSynchronization)throw new P(N.FAILED_PRECONDITION,Hp);return e.We(),e.Ge(),e.ze(),e.runTransaction("getHighestListenSequenceNumber","readonly",function(n){return e.qe.getHighestSequenceNumber(n)})}).then(function(n){e.Ne=new Jt(n,e.De)}).then(function(){e.xe=!0}).catch(function(n){return e.Be&&e.Be.close(),Promise.reject(n)})},t.prototype.He=function(e){var n=this;return this.Me=function(r){return A(n,void 0,void 0,function(){return C(this,function(o){return this.started?[2,e(r)]:[2]})})},e(this.isPrimary)},t.prototype.setDatabaseDeletedListener=function(e){var n=this;this.Be.vt(function(r){return A(n,void 0,void 0,function(){return C(this,function(o){switch(o.label){case 0:return r.newVersion===null?[4,e()]:[3,2];case 1:o.sent(),o.label=2;case 2:return[2]}})})})},t.prototype.setNetworkEnabled=function(e){var n=this;this.networkEnabled!==e&&(this.networkEnabled=e,this.Se.enqueueAndForget(function(){return A(n,void 0,void 0,function(){return C(this,function(r){switch(r.label){case 0:return this.started?[4,this.je()]:[3,2];case 1:r.sent(),r.label=2;case 2:return[2]}})})}))},t.prototype.je=function(){var e=this;return this.runTransaction("updateClientMetadataAndTryBecomePrimary","readwrite",function(n){return Hc(n).put(new lr(e.clientId,Date.now(),e.networkEnabled,e.inForeground)).next(function(){if(e.isPrimary)return e.Je(n).next(function(r){r||(e.isPrimary=!1,e.Se.enqueueRetryable(function(){return e.Me(!1)}))})}).next(function(){return e.Ye(n)}).next(function(r){return e.isPrimary&&!r?e.Xe(n).next(function(){return!1}):!!r&&e.Ze(n).next(function(){return!0})})}).catch(function(n){if(Zi(n))return U("IndexedDbPersistence","Failed to extend owner lease: ",n),e.isPrimary;if(!e.allowTabSynchronization)throw n;return U("IndexedDbPersistence","Releasing owner lease after error during lease refresh",n),!1}).then(function(n){e.isPrimary!==n&&e.Se.enqueueRetryable(function(){return e.Me(n)}),e.isPrimary=n})},t.prototype.Je=function(e){var n=this;return ma(e).get(Qt.key).next(function(r){return x.resolve(n.tn(r))})},t.prototype.en=function(e){return Hc(e).delete(this.clientId)},t.prototype.nn=function(){return A(this,void 0,void 0,function(){var e,n,r,o,s=this;return C(this,function(u){switch(u.label){case 0:return!this.isPrimary||this.sn(this.Oe,18e5)?[3,2]:(this.Oe=Date.now(),[4,this.runTransaction("maybeGarbageCollectMultiClientState","readwrite-primary",function(l){var h=Wt(l,lr.store);return h.Nt().next(function(d){var p=s.rn(d,18e5),g=d.filter(function(y){return p.indexOf(y)===-1});return x.forEach(g,function(y){return h.delete(y.clientId)}).next(function(){return g})})}).catch(function(){return[]})]);case 1:if(e=u.sent(),this.Qe)for(n=0,r=e;n<r.length;n++)o=r[n],this.Qe.removeItem(this.on(o.clientId));u.label=2;case 2:return[2]}})})},t.prototype.ze=function(){var e=this;this.$e=this.Se.enqueueAfterDelay("client_metadata_refresh",4e3,function(){return e.je().then(function(){return e.nn()}).then(function(){return e.ze()})})},t.prototype.tn=function(e){return!!e&&e.ownerId===this.clientId},t.prototype.Ye=function(e){var n=this;return this.Ce?x.resolve(!0):ma(e).get(Qt.key).next(function(r){if(r!==null&&n.sn(r.leaseTimestampMs,5e3)&&!n.cn(r.ownerId)){if(n.tn(r)&&n.networkEnabled)return!0;if(!n.tn(r)){if(!r.allowTabSynchronization)throw new P(N.FAILED_PRECONDITION,Hp);return!1}}return!(!n.networkEnabled||!n.inForeground)||Hc(e).Nt().next(function(o){return n.rn(o,5e3).find(function(s){if(n.clientId!==s.clientId){var u=!n.networkEnabled&&s.networkEnabled,l=!n.inForeground&&s.inForeground,h=n.networkEnabled===s.networkEnabled;if(u||l&&h)return!0}return!1})===void 0})}).next(function(r){return n.isPrimary!==r&&U("IndexedDbPersistence","Client "+(r?"is":"is not")+" eligible for a primary lease."),r})},t.prototype.shutdown=function(){return A(this,void 0,void 0,function(){var e=this;return C(this,function(n){switch(n.label){case 0:return this.xe=!1,this.un(),this.$e&&(this.$e.cancel(),this.$e=null),this.an(),this.hn(),[4,this.Be.runTransaction("shutdown","readwrite",[Qt.store,lr.store],function(r){var o=new Q0(r,Jt.o);return e.Xe(o).next(function(){return e.en(o)})})];case 1:return n.sent(),this.Be.close(),this.ln(),[2]}})})},t.prototype.rn=function(e,n){var r=this;return e.filter(function(o){return r.sn(o.updateTimeMs,n)&&!r.cn(o.clientId)})},t.prototype.fn=function(){var e=this;return this.runTransaction("getActiveClients","readonly",function(n){return Hc(n).Nt().next(function(r){return e.rn(r,18e5).map(function(o){return o.clientId})})})},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.getMutationQueue=function(e){return eL.Qt(e,this.R,this.Ut,this.referenceDelegate)},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(e,n,r){var o=this;U("IndexedDbPersistence","Starting transaction:",e);var s,u=n==="readonly"?"readonly":"readwrite";return this.Be.runTransaction(e,u,zx,function(l){return s=new Q0(l,o.Ne?o.Ne.next():Jt.o),n==="readwrite-primary"?o.Je(s).next(function(h){return!!h||o.Ye(s)}).next(function(h){if(!h)throw We("Failed to obtain primary lease for action '"+e+"'."),o.isPrimary=!1,o.Se.enqueueRetryable(function(){return o.Me(!1)}),new P(N.FAILED_PRECONDITION,kS);return r(s)}).next(function(h){return o.Ze(s).next(function(){return h})}):o.dn(s).next(function(){return r(s)})}).then(function(l){return s.raiseOnCommittedEvent(),l})},t.prototype.dn=function(e){var n=this;return ma(e).get(Qt.key).next(function(r){if(r!==null&&n.sn(r.leaseTimestampMs,5e3)&&!n.cn(r.ownerId)&&!n.tn(r)&&!(n.Ce||n.allowTabSynchronization&&r.allowTabSynchronization))throw new P(N.FAILED_PRECONDITION,Hp)})},t.prototype.Ze=function(e){var n=new Qt(this.clientId,this.allowTabSynchronization,Date.now());return ma(e).put(Qt.key,n)},t.yt=function(){return ns.yt()},t.prototype.Xe=function(e){var n=this,r=ma(e);return r.get(Qt.key).next(function(o){return n.tn(o)?(U("IndexedDbPersistence","Releasing primary lease."),r.delete(Qt.key)):x.resolve()})},t.prototype.sn=function(e,n){var r=Date.now();return!(e<r-n||e>r&&(We("Detected an update time that is in the future: "+e+" > "+r),1))},t.prototype.We=function(){var e=this;this.document!==null&&typeof this.document.addEventListener=="function"&&(this.Fe=function(){e.Se.enqueueAndForget(function(){return e.inForeground=e.document.visibilityState==="visible",e.je()})},this.document.addEventListener("visibilitychange",this.Fe),this.inForeground=this.document.visibilityState==="visible")},t.prototype.an=function(){this.Fe&&(this.document.removeEventListener("visibilitychange",this.Fe),this.Fe=null)},t.prototype.Ge=function(){var e,n=this;typeof((e=this.window)===null||e===void 0?void 0:e.addEventListener)=="function"&&(this.ke=function(){n.un(),uO()&&navigator.appVersion.match("Version/14")&&n.Se.enterRestrictedMode(!0),n.Se.enqueueAndForget(function(){return n.shutdown()})},this.window.addEventListener("pagehide",this.ke))},t.prototype.hn=function(){this.ke&&(this.window.removeEventListener("pagehide",this.ke),this.ke=null)},t.prototype.cn=function(e){var n;try{var r=((n=this.Qe)===null||n===void 0?void 0:n.getItem(this.on(e)))!==null;return U("IndexedDbPersistence","Client '"+e+"' "+(r?"is":"is not")+" zombied in LocalStorage"),r}catch(o){return We("IndexedDbPersistence","Failed to get zombied client id.",o),!1}},t.prototype.un=function(){if(this.Qe)try{this.Qe.setItem(this.on(this.clientId),String(Date.now()))}catch(e){We("Failed to set zombie client id.",e)}},t.prototype.ln=function(){if(this.Qe)try{this.Qe.removeItem(this.on(this.clientId))}catch{}},t.prototype.on=function(e){return"firestore_zombie_"+this.persistenceKey+"_"+e},t}();function ma(t){return Wt(t,Qt.store)}function Hc(t){return Wt(t,lr.store)}function Xg(t,e){var n=t.projectId;return t.isDefaultDatabase||(n+="."+t.database),"firestore/"+e+"/"+n+"/"}var VS=function(){function t(e,n,r){this.Ue=e,this._n=n,this.Ut=r}return t.prototype.mn=function(e,n){var r=this;return this._n.getAllMutationBatchesAffectingDocumentKey(e,n).next(function(o){return r.yn(e,n,o)})},t.prototype.yn=function(e,n,r){return this.Ue.getEntry(e,n).next(function(o){for(var s=0,u=r;s<u.length;s++)u[s].applyToLocalView(o);return o})},t.prototype.gn=function(e,n){e.forEach(function(r,o){for(var s=0,u=n;s<u.length;s++)u[s].applyToLocalView(o)})},t.prototype.pn=function(e,n){var r=this;return this.Ue.getEntries(e,n).next(function(o){return r.En(e,o).next(function(){return o})})},t.prototype.En=function(e,n){var r=this;return this._n.getAllMutationBatchesAffectingDocumentKeys(e,n).next(function(o){return r.gn(n,o)})},t.prototype.getDocumentsMatchingQuery=function(e,n,r){return function(o){return K.isDocumentKey(o.path)&&o.collectionGroup===null&&o.filters.length===0}(n)?this.Tn(e,n.path):qg(n)?this.In(e,n,r):this.An(e,n,r)},t.prototype.Tn=function(e,n){return this.mn(e,new K(n)).next(function(r){var o=Cv();return r.isFoundDocument()&&(o=o.insert(r.key,r)),o})},t.prototype.In=function(e,n,r){var o=this,s=n.collectionGroup,u=Cv();return this.Ut.getCollectionParents(e,s).next(function(l){return x.forEach(l,function(h){var d=function(p,g){return new gr(g,null,p.explicitOrderBy.slice(),p.filters.slice(),p.limit,p.limitType,p.startAt,p.endAt)}(n,h.child(s));return o.An(e,d,r).next(function(p){p.forEach(function(g,y){u=u.insert(g,y)})})}).next(function(){return u})})},t.prototype.An=function(e,n,r){var o,s,u=this;return this.Ue.getDocumentsMatchingQuery(e,n,r).next(function(l){return o=l,u._n.getAllMutationBatchesAffectingQuery(e,n)}).next(function(l){return s=l,u.Rn(e,s,o).next(function(h){o=h;for(var d=0,p=s;d<p.length;d++)for(var g=p[d],y=0,w=g.mutations;y<w.length;y++){var b=w[y],E=b.key,T=o.get(E);T==null&&(T=wt.newInvalidDocument(E),o=o.insert(E,T)),Sv(b,T,g.localWriteTime),T.isFoundDocument()||(o=o.remove(E))}})}).next(function(){return o.forEach(function(l,h){yu(n,h)||(o=o.remove(l))}),o})},t.prototype.Rn=function(e,n,r){for(var o=Te(),s=0,u=n;s<u.length;s++)for(var l=0,h=u[s].mutations;l<h.length;l++){var d=h[l];d instanceof Qr&&r.get(d.key)===null&&(o=o.add(d.key))}var p=r;return this.Ue.getEntries(e,o).next(function(g){return g.forEach(function(y,w){w.isFoundDocument()&&(p=p.insert(y,w))}),p})},t}(),lL=function(){function t(e,n,r,o){this.targetId=e,this.fromCache=n,this.bn=r,this.vn=o}return t.Pn=function(e,n){for(var r=Te(),o=Te(),s=0,u=n.docChanges;s<u.length;s++){var l=u[s];switch(l.type){case 0:r=r.add(l.doc.key);break;case 1:o=o.add(l.doc.key)}}return new t(e,n.fromCache,r,o)},t}(),jS=function(){function t(){}return t.prototype.Vn=function(e){this.Sn=e},t.prototype.getDocumentsMatchingQuery=function(e,n,r,o){var s=this;return function(u){return u.filters.length===0&&u.limit===null&&u.startAt==null&&u.endAt==null&&(u.explicitOrderBy.length===0||u.explicitOrderBy.length===1&&u.explicitOrderBy[0].field.isKeyField())}(n)||r.isEqual(se.min())?this.Dn(e,n):this.Sn.pn(e,o).next(function(u){var l=s.Cn(n,u);return(el(n)||Il(n))&&s.Nn(n.limitType,l,o,r)?s.Dn(e,n):(bv()<=fe.DEBUG&&U("QueryEngine","Re-using previous result from %s to execute query: %s",r.toString(),Tv(n)),s.Sn.getDocumentsMatchingQuery(e,n,r).next(function(h){return l.forEach(function(d){h=h.insert(d.key,d)}),h}))})},t.prototype.Cn=function(e,n){var r=new Xe(sS(e));return n.forEach(function(o,s){yu(e,s)&&(r=r.add(s))}),r},t.prototype.Nn=function(e,n,r,o){if(r.size!==n.size)return!0;var s=e==="F"?n.last():n.first();return!!s&&(s.hasPendingWrites||s.version.compareTo(o)>0)},t.prototype.Dn=function(e,n){return bv()<=fe.DEBUG&&U("QueryEngine","Using full collection scan to execute query:",Tv(n)),this.Sn.getDocumentsMatchingQuery(e,n,se.min())},t}(),hL=function(){function t(e,n,r,o){this.persistence=e,this.xn=n,this.R=o,this.kn=new bt(ce),this.Fn=new _s(function(s){return vu(s)},dh),this.$n=se.min(),this._n=e.getMutationQueue(r),this.On=e.getRemoteDocumentCache(),this.qe=e.getTargetCache(),this.Mn=new VS(this.On,this._n,this.persistence.getIndexManager()),this.Ke=e.getBundleCache(),this.xn.Vn(this.Mn)}return t.prototype.collectGarbage=function(e){var n=this;return this.persistence.runTransaction("Collect garbage","readwrite-primary",function(r){return e.collect(r,n.kn)})},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function BS(t,e,n,r){return new hL(t,e,n,r)}function qS(t,e){return A(this,void 0,void 0,function(){var n,r,o,s;return C(this,function(u){switch(u.label){case 0:return n=j(t),r=n._n,o=n.Mn,[4,n.persistence.runTransaction("Handle user change","readonly",function(l){var h;return n._n.getAllMutationBatches(l).next(function(d){return h=d,r=n.persistence.getMutationQueue(e),o=new VS(n.On,r,n.persistence.getIndexManager()),r.getAllMutationBatches(l)}).next(function(d){for(var p=[],g=[],y=Te(),w=0,b=h;w<b.length;w++){var E=b[w];p.push(E.batchId);for(var T=0,k=E.mutations;T<k.length;T++){var O=k[T];y=y.add(O.key)}}for(var M=0,H=d;M<H.length;M++){var X=H[M];g.push(X.batchId);for(var F=0,me=X.mutations;F<me.length;F++){var $=me[F];y=y.add($.key)}}return o.pn(l,y).next(function(Fe){return{Ln:Fe,removedBatchIds:p,addedBatchIds:g}})})})];case 1:return s=u.sent(),[2,(n._n=r,n.Mn=o,n.xn.Vn(n.Mn),s)]}})})}function fL(t,e){var n=j(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",function(r){var o=e.batch.keys(),s=n.On.newChangeBuffer({trackRemovals:!0});return function(u,l,h,d){var p=h.batch,g=p.keys(),y=x.resolve();return g.forEach(function(w){y=y.next(function(){return d.getEntry(l,w)}).next(function(b){var E=h.docVersions.get(w);Y(E!==null),b.version.compareTo(E)<0&&(p.applyToRemoteDocument(b,h),b.isValidDocument()&&d.addEntry(b,h.commitVersion))})}),y.next(function(){return u._n.removeMutationBatch(l,p)})}(n,r,e,s).next(function(){return s.apply(r)}).next(function(){return n._n.performConsistencyCheck(r)}).next(function(){return n.Mn.pn(r,o)})})}function GS(t){var e=j(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",function(n){return e.qe.getLastRemoteSnapshotVersion(n)})}function dL(t,e){var n=j(t),r=e.snapshotVersion,o=n.kn;return n.persistence.runTransaction("Apply remote event","readwrite-primary",function(s){var u=n.On.newChangeBuffer({trackRemovals:!0});o=n.kn;var l=[];e.targetChanges.forEach(function(p,g){var y=o.get(g);if(y){l.push(n.qe.removeMatchingKeys(s,p.removedDocuments,g).next(function(){return n.qe.addMatchingKeys(s,p.addedDocuments,g)}));var w=p.resumeToken;if(w.approximateByteSize()>0){var b=y.withResumeToken(w,r).withSequenceNumber(s.currentSequenceNumber);o=o.insert(g,b),function(E,T,k){return Y(T.resumeToken.approximateByteSize()>0),E.resumeToken.approximateByteSize()===0||T.snapshotVersion.toMicroseconds()-E.snapshotVersion.toMicroseconds()>=3e8||k.addedDocuments.size+k.modifiedDocuments.size+k.removedDocuments.size>0}(y,b,p)&&l.push(n.qe.updateTargetData(s,b))}}});var h=Nn();if(e.documentUpdates.forEach(function(p,g){e.resolvedLimboDocuments.has(p)&&l.push(n.persistence.referenceDelegate.updateLimboDocument(s,p))}),l.push(pL(s,u,e.documentUpdates,r).next(function(p){h=p})),!r.isEqual(se.min())){var d=n.qe.getLastRemoteSnapshotVersion(s).next(function(p){return n.qe.setTargetsMetadata(s,s.currentSequenceNumber,r)});l.push(d)}return x.waitFor(l).next(function(){return u.apply(s)}).next(function(){return n.Mn.En(s,h)}).next(function(){return h})}).then(function(s){return n.kn=o,s})}function pL(t,e,n,r,o){var s=Te();return n.forEach(function(u){return s=s.add(u)}),e.getEntries(t,s).next(function(u){var l=Nn();return n.forEach(function(h,d){var p=u.get(h),g=r;d.isNoDocument()&&d.version.isEqual(se.min())?(e.removeEntry(h,g),l=l.insert(h,d)):!p.isValidDocument()||d.version.compareTo(p.version)>0||d.version.compareTo(p.version)===0&&p.hasPendingWrites?(e.addEntry(d,g),l=l.insert(h,d)):U("LocalStore","Ignoring outdated watch update for ",h,". Current version:",p.version," Watch version:",d.version)}),l})}function vL(t,e){var n=j(t);return n.persistence.runTransaction("Get next mutation batch","readonly",function(r){return e===void 0&&(e=-1),n._n.getNextMutationBatchAfterBatchId(r,e)})}function Cl(t,e){var n=j(t);return n.persistence.runTransaction("Allocate target","readwrite",function(r){var o;return n.qe.getTargetData(r,e).next(function(s){return s?(o=s,x.resolve(o)):n.qe.allocateTargetId(r).next(function(u){return o=new mh(e,u,0,r.currentSequenceNumber),n.qe.addTargetData(r,o).next(function(){return o})})})}).then(function(r){var o=n.kn.get(r.targetId);return(o===null||r.snapshotVersion.compareTo(o.snapshotVersion)>0)&&(n.kn=n.kn.insert(r.targetId,r),n.Fn.set(e,r.targetId)),r})}function os(t,e,n){return A(this,void 0,void 0,function(){var r,o,s,u;return C(this,function(l){switch(l.label){case 0:r=j(t),o=r.kn.get(e),s=n?"readwrite":"readwrite-primary",l.label=1;case 1:return l.trys.push([1,4,,5]),n?[3,3]:[4,r.persistence.runTransaction("Release target",s,function(h){return r.persistence.referenceDelegate.removeTarget(h,o)})];case 2:l.sent(),l.label=3;case 3:return[3,5];case 4:if(!Zi(u=l.sent()))throw u;return U("LocalStore","Failed to update sequence numbers for target "+e+": "+u),[3,5];case 5:return r.kn=r.kn.remove(e),r.Fn.delete(o.target),[2]}})})}function Al(t,e,n){var r=j(t),o=se.min(),s=Te();return r.persistence.runTransaction("Execute query","readonly",function(u){return function(l,h,d){var p=j(l),g=p.Fn.get(d);return g!==void 0?x.resolve(p.kn.get(g)):p.qe.getTargetData(h,d)}(r,u,$n(e)).next(function(l){if(l)return o=l.lastLimboFreeSnapshotVersion,r.qe.getMatchingKeysForTargetId(u,l.targetId).next(function(h){s=h})}).next(function(){return r.xn.getDocumentsMatchingQuery(u,e,n?o:se.min(),n?s:Te())}).next(function(l){return{documents:l,Bn:s}})})}function WS(t,e){var n=j(t),r=j(n.qe),o=n.kn.get(e);return o?Promise.resolve(o.target):n.persistence.runTransaction("Get target data","readonly",function(s){return r.lt(s,e).next(function(u){return u?u.target:null})})}function HS(t){var e=j(t);return e.persistence.runTransaction("Get new document changes","readonly",function(n){return function(r,o,s){var u=j(r),l=Nn(),h=Qg(s),d=Dr(o),p=IDBKeyRange.lowerBound(h,!0);return d.$t({index:Me.readTimeIndex,range:p},function(g,y){var w=kv(u.R,y);l=l.insert(w.key,w),h=y.readTime}).next(function(){return{wn:l,readTime:OS(h)}})}(e.On,n,e.$n)}).then(function(n){var r=n.wn,o=n.readTime;return e.$n=o,r})}function gL(t){return A(this,void 0,void 0,function(){var e;return C(this,function(n){return[2,(e=j(t)).persistence.runTransaction("Synchronize last document change read time","readonly",function(r){return function(o){var s=Dr(o),u=se.min();return s.$t({index:Me.readTimeIndex,reverse:!0},function(l,h,d){h.readTime&&(u=OS(h.readTime)),d.done()}).next(function(){return u})}(r)}).then(function(r){e.$n=r})]})})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mL=function(){function t(e){this.R=e,this.Qn=new Map,this.jn=new Map}return t.prototype.getBundleMetadata=function(e,n){return x.resolve(this.Qn.get(n))},t.prototype.saveBundleMetadata=function(e,n){var r;return this.Qn.set(n.id,{id:(r=n).id,version:r.version,createTime:Rt(r.createTime)}),x.resolve()},t.prototype.getNamedQuery=function(e,n){return x.resolve(this.jn.get(n))},t.prototype.saveNamedQuery=function(e,n){return this.jn.set(n.name,function(r){return{name:r.name,query:xS(r.bundledQuery),readTime:Rt(r.readTime)}}(n)),x.resolve()},t}(),Jg=function(){function t(){this.Wn=new Xe(et.Gn),this.zn=new Xe(et.Hn)}return t.prototype.isEmpty=function(){return this.Wn.isEmpty()},t.prototype.addReference=function(e,n){var r=new et(e,n);this.Wn=this.Wn.add(r),this.zn=this.zn.add(r)},t.prototype.Jn=function(e,n){var r=this;e.forEach(function(o){return r.addReference(o,n)})},t.prototype.removeReference=function(e,n){this.Yn(new et(e,n))},t.prototype.Xn=function(e,n){var r=this;e.forEach(function(o){return r.removeReference(o,n)})},t.prototype.Zn=function(e){var n=this,r=new K(new ge([])),o=new et(r,e),s=new et(r,e+1),u=[];return this.zn.forEachInRange([o,s],function(l){n.Yn(l),u.push(l.key)}),u},t.prototype.ts=function(){var e=this;this.Wn.forEach(function(n){return e.Yn(n)})},t.prototype.Yn=function(e){this.Wn=this.Wn.delete(e),this.zn=this.zn.delete(e)},t.prototype.es=function(e){var n=new K(new ge([])),r=new et(n,e),o=new et(n,e+1),s=Te();return this.zn.forEachInRange([r,o],function(u){s=s.add(u.key)}),s},t.prototype.containsKey=function(e){var n=new et(e,0),r=this.Wn.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)},t}(),et=function(){function t(e,n){this.key=e,this.ns=n}return t.Gn=function(e,n){return K.comparator(e.key,n.key)||ce(e.ns,n.ns)},t.Hn=function(e,n){return ce(e.ns,n.ns)||K.comparator(e.key,n.key)},t}(),yL=function(){function t(e,n){this.Ut=e,this.referenceDelegate=n,this._n=[],this.ss=1,this.rs=new Xe(et.Gn)}return t.prototype.checkEmpty=function(e){return x.resolve(this._n.length===0)},t.prototype.addMutationBatch=function(e,n,r,o){var s=this.ss;this.ss++,this._n.length>0&&this._n[this._n.length-1];var u=new $g(s,n,r,o);this._n.push(u);for(var l=0,h=o;l<h.length;l++){var d=h[l];this.rs=this.rs.add(new et(d.key,s)),this.Ut.addToCollectionParentIndex(e,d.key.path.popLast())}return x.resolve(u)},t.prototype.lookupMutationBatch=function(e,n){return x.resolve(this.os(n))},t.prototype.getNextMutationBatchAfterBatchId=function(e,n){var r=n+1,o=this.cs(r),s=o<0?0:o;return x.resolve(this._n.length>s?this._n[s]:null)},t.prototype.getHighestUnacknowledgedBatchId=function(){return x.resolve(this._n.length===0?-1:this.ss-1)},t.prototype.getAllMutationBatches=function(e){return x.resolve(this._n.slice())},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(e,n){var r=this,o=new et(n,0),s=new et(n,Number.POSITIVE_INFINITY),u=[];return this.rs.forEachInRange([o,s],function(l){var h=r.os(l.ns);u.push(h)}),x.resolve(u)},t.prototype.getAllMutationBatchesAffectingDocumentKeys=function(e,n){var r=this,o=new Xe(ce);return n.forEach(function(s){var u=new et(s,0),l=new et(s,Number.POSITIVE_INFINITY);r.rs.forEachInRange([u,l],function(h){o=o.add(h.ns)})}),x.resolve(this.us(o))},t.prototype.getAllMutationBatchesAffectingQuery=function(e,n){var r=n.path,o=r.length+1,s=r;K.isDocumentKey(s)||(s=s.child(""));var u=new et(new K(s),0),l=new Xe(ce);return this.rs.forEachWhile(function(h){var d=h.key.path;return!!r.isPrefixOf(d)&&(d.length===o&&(l=l.add(h.ns)),!0)},u),x.resolve(this.us(l))},t.prototype.us=function(e){var n=this,r=[];return e.forEach(function(o){var s=n.os(o);s!==null&&r.push(s)}),r},t.prototype.removeMutationBatch=function(e,n){var r=this;Y(this.hs(n.batchId,"removed")===0),this._n.shift();var o=this.rs;return x.forEach(n.mutations,function(s){var u=new et(s.key,n.batchId);return o=o.delete(u),r.referenceDelegate.markPotentiallyOrphaned(e,s.key)}).next(function(){r.rs=o})},t.prototype.Gt=function(e){},t.prototype.containsKey=function(e,n){var r=new et(n,0),o=this.rs.firstAfterOrEqual(r);return x.resolve(n.isEqual(o&&o.key))},t.prototype.performConsistencyCheck=function(e){return this._n.length,x.resolve()},t.prototype.hs=function(e,n){return this.cs(e)},t.prototype.cs=function(e){return this._n.length===0?0:e-this._n[0].batchId},t.prototype.os=function(e){var n=this.cs(e);return n<0||n>=this._n.length?null:this._n[n]},t}(),_L=function(){function t(e,n){this.Ut=e,this.ls=n,this.docs=new bt(K.comparator),this.size=0}return t.prototype.addEntry=function(e,n,r){var o=n.key,s=this.docs.get(o),u=s?s.size:0,l=this.ls(n);return this.docs=this.docs.insert(o,{document:n.clone(),size:l,readTime:r}),this.size+=l-u,this.Ut.addToCollectionParentIndex(e,o.path.popLast())},t.prototype.removeEntry=function(e){var n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)},t.prototype.getEntry=function(e,n){var r=this.docs.get(n);return x.resolve(r?r.document.clone():wt.newInvalidDocument(n))},t.prototype.getEntries=function(e,n){var r=this,o=Nn();return n.forEach(function(s){var u=r.docs.get(s);o=o.insert(s,u?u.document.clone():wt.newInvalidDocument(s))}),x.resolve(o)},t.prototype.getDocumentsMatchingQuery=function(e,n,r){for(var o=Nn(),s=new K(n.path.child("")),u=this.docs.getIteratorFrom(s);u.hasNext();){var l=u.getNext(),h=l.key,d=l.value,p=d.document,g=d.readTime;if(!n.path.isPrefixOf(h.path))break;g.compareTo(r)<=0||yu(n,p)&&(o=o.insert(p.key,p.clone()))}return x.resolve(o)},t.prototype.fs=function(e,n){return x.forEach(this.docs,function(r){return n(r)})},t.prototype.newChangeBuffer=function(e){return new wL(this)},t.prototype.getSize=function(e){return x.resolve(this.size)},t}(),wL=function(t){function e(n){var r=this;return(r=t.call(this)||this).Ie=n,r}return V(e,t),e.prototype.applyChanges=function(n){var r=this,o=[];return this.changes.forEach(function(s,u){u.document.isValidDocument()?o.push(r.Ie.addEntry(n,u.document,r.getReadTime(s))):r.Ie.removeEntry(s)}),x.waitFor(o)},e.prototype.getFromCache=function(n,r){return this.Ie.getEntry(n,r)},e.prototype.getAllFromCache=function(n,r){return this.Ie.getEntries(n,r)},e}(US),bL=function(){function t(e){this.persistence=e,this.ds=new _s(function(n){return vu(n)},dh),this.lastRemoteSnapshotVersion=se.min(),this.highestTargetId=0,this.ws=0,this._s=new Jg,this.targetCount=0,this.ys=Sl.Jt()}return t.prototype.forEachTarget=function(e,n){return this.ds.forEach(function(r,o){return n(o)}),x.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(e){return x.resolve(this.lastRemoteSnapshotVersion)},t.prototype.getHighestSequenceNumber=function(e){return x.resolve(this.ws)},t.prototype.allocateTargetId=function(e){return this.highestTargetId=this.ys.next(),x.resolve(this.highestTargetId)},t.prototype.setTargetsMetadata=function(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this.ws&&(this.ws=n),x.resolve()},t.prototype.te=function(e){this.ds.set(e.target,e);var n=e.targetId;n>this.highestTargetId&&(this.ys=new Sl(n),this.highestTargetId=n),e.sequenceNumber>this.ws&&(this.ws=e.sequenceNumber)},t.prototype.addTargetData=function(e,n){return this.te(n),this.targetCount+=1,x.resolve()},t.prototype.updateTargetData=function(e,n){return this.te(n),x.resolve()},t.prototype.removeTargetData=function(e,n){return this.ds.delete(n.target),this._s.Zn(n.targetId),this.targetCount-=1,x.resolve()},t.prototype.removeTargets=function(e,n,r){var o=this,s=0,u=[];return this.ds.forEach(function(l,h){h.sequenceNumber<=n&&r.get(h.targetId)===null&&(o.ds.delete(l),u.push(o.removeMatchingKeysForTargetId(e,h.targetId)),s++)}),x.waitFor(u).next(function(){return s})},t.prototype.getTargetCount=function(e){return x.resolve(this.targetCount)},t.prototype.getTargetData=function(e,n){var r=this.ds.get(n)||null;return x.resolve(r)},t.prototype.addMatchingKeys=function(e,n,r){return this._s.Jn(n,r),x.resolve()},t.prototype.removeMatchingKeys=function(e,n,r){this._s.Xn(n,r);var o=this.persistence.referenceDelegate,s=[];return o&&n.forEach(function(u){s.push(o.markPotentiallyOrphaned(e,u))}),x.waitFor(s)},t.prototype.removeMatchingKeysForTargetId=function(e,n){return this._s.Zn(n),x.resolve()},t.prototype.getMatchingKeysForTargetId=function(e,n){var r=this._s.es(n);return x.resolve(r)},t.prototype.containsKey=function(e,n){return x.resolve(this._s.containsKey(n))},t}(),IL=function(){function t(e,n){var r=this;this.gs={},this.Ne=new Jt(0),this.xe=!1,this.xe=!0,this.referenceDelegate=e(this),this.qe=new bL(this),this.Ut=new Jx,this.Ue=function(o,s){return new _L(o,function(u){return r.referenceDelegate.ps(u)})}(this.Ut),this.R=new DS(n),this.Ke=new mL(this.R)}return t.prototype.start=function(){return Promise.resolve()},t.prototype.shutdown=function(){return this.xe=!1,Promise.resolve()},Object.defineProperty(t.prototype,"started",{get:function(){return this.xe},enumerable:!1,configurable:!0}),t.prototype.setDatabaseDeletedListener=function(){},t.prototype.setNetworkEnabled=function(){},t.prototype.getIndexManager=function(){return this.Ut},t.prototype.getMutationQueue=function(e){var n=this.gs[e.toKey()];return n||(n=new yL(this.Ut,this.referenceDelegate),this.gs[e.toKey()]=n),n},t.prototype.getTargetCache=function(){return this.qe},t.prototype.getRemoteDocumentCache=function(){return this.Ue},t.prototype.getBundleCache=function(){return this.Ke},t.prototype.runTransaction=function(e,n,r){var o=this;U("MemoryPersistence","Starting transaction:",e);var s=new EL(this.Ne.next());return this.referenceDelegate.Es(),r(s).next(function(u){return o.referenceDelegate.Ts(s).next(function(){return u})}).toPromise().then(function(u){return s.raiseOnCommittedEvent(),u})},t.prototype.Is=function(e,n){return x.or(Object.values(this.gs).map(function(r){return function(){return r.containsKey(e,n)}}))},t}(),EL=function(t){function e(n){var r=this;return(r=t.call(this)||this).currentSequenceNumber=n,r}return V(e,t),e}(NS),TL=function(){function t(e){this.persistence=e,this.As=new Jg,this.Rs=null}return t.bs=function(e){return new t(e)},Object.defineProperty(t.prototype,"vs",{get:function(){if(this.Rs)return this.Rs;throw W()},enumerable:!1,configurable:!0}),t.prototype.addReference=function(e,n,r){return this.As.addReference(r,n),this.vs.delete(r.toString()),x.resolve()},t.prototype.removeReference=function(e,n,r){return this.As.removeReference(r,n),this.vs.add(r.toString()),x.resolve()},t.prototype.markPotentiallyOrphaned=function(e,n){return this.vs.add(n.toString()),x.resolve()},t.prototype.removeTarget=function(e,n){var r=this;this.As.Zn(n.targetId).forEach(function(s){return r.vs.add(s.toString())});var o=this.persistence.getTargetCache();return o.getMatchingKeysForTargetId(e,n.targetId).next(function(s){s.forEach(function(u){return r.vs.add(u.toString())})}).next(function(){return o.removeTargetData(e,n)})},t.prototype.Es=function(){this.Rs=new Set},t.prototype.Ts=function(e){var n=this,r=this.persistence.getRemoteDocumentCache().newChangeBuffer();return x.forEach(this.vs,function(o){var s=K.fromPath(o);return n.Ps(e,s).next(function(u){u||r.removeEntry(s)})}).next(function(){return n.Rs=null,r.apply(e)})},t.prototype.updateLimboDocument=function(e,n){var r=this;return this.Ps(e,n).next(function(o){o?r.vs.delete(n.toString()):r.vs.add(n.toString())})},t.prototype.ps=function(e){return 0},t.prototype.Ps=function(e,n){var r=this;return x.or([function(){return x.resolve(r.As.containsKey(n))},function(){return r.persistence.getTargetCache().containsKey(e,n)},function(){return r.persistence.Is(e,n)}])},t}(),ot=function(){function t(e){this.uid=e}return t.prototype.isAuthenticated=function(){return this.uid!=null},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(e){return e.uid===this.uid},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oI(t,e){return"firestore_clients_"+t+"_"+e}function sI(t,e,n){var r="firestore_mutations_"+t+"_"+n;return e.isAuthenticated()&&(r+="_"+e.uid),r}function Kp(t,e){return"firestore_targets_"+t+"_"+e}ot.UNAUTHENTICATED=new ot(null),ot.GOOGLE_CREDENTIALS=new ot("google-credentials-uid"),ot.FIRST_PARTY=new ot("first-party-uid"),ot.MOCK_USER=new ot("mock-user");var aI=function(){function t(e,n,r,o){this.user=e,this.batchId=n,this.state=r,this.error=o}return t.Vs=function(e,n,r){var o,s=JSON.parse(r),u=typeof s=="object"&&["pending","acknowledged","rejected"].indexOf(s.state)!==-1&&(s.error===void 0||typeof s.error=="object");return u&&s.error&&(u=typeof s.error.message=="string"&&typeof s.error.code=="string")&&(o=new P(s.error.code,s.error.message)),u?new t(e,n,s.state,o):(We("SharedClientState","Failed to parse mutation state for ID '"+n+"': "+r),null)},t.prototype.Ss=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},t}(),zp=function(){function t(e,n,r){this.targetId=e,this.state=n,this.error=r}return t.Vs=function(e,n){var r,o=JSON.parse(n),s=typeof o=="object"&&["not-current","current","rejected"].indexOf(o.state)!==-1&&(o.error===void 0||typeof o.error=="object");return s&&o.error&&(s=typeof o.error.message=="string"&&typeof o.error.code=="string")&&(r=new P(o.error.code,o.error.message)),s?new t(e,o.state,r):(We("SharedClientState","Failed to parse target state for ID '"+e+"': "+n),null)},t.prototype.Ss=function(){var e={state:this.state,updateTimeMs:Date.now()};return this.error&&(e.error={code:this.error.code,message:this.error.message}),JSON.stringify(e)},t}(),uI=function(){function t(e,n){this.clientId=e,this.activeTargetIds=n}return t.Vs=function(e,n){for(var r=JSON.parse(n),o=typeof r=="object"&&r.activeTargetIds instanceof Array,s=gh(),u=0;o&&u<r.activeTargetIds.length;++u)o=eS(r.activeTargetIds[u]),s=s.add(r.activeTargetIds[u]);return o?new t(e,s):(We("SharedClientState","Failed to parse client data for instance '"+e+"': "+n),null)},t}(),SL=function(){function t(e,n){this.clientId=e,this.onlineState=n}return t.Vs=function(e){var n=JSON.parse(e);return typeof n=="object"&&["Unknown","Online","Offline"].indexOf(n.onlineState)!==-1&&typeof n.clientId=="string"?new t(n.clientId,n.onlineState):(We("SharedClientState","Failed to parse online state: "+e),null)},t}(),Nv=function(){function t(){this.activeTargetIds=gh()}return t.prototype.Ds=function(e){this.activeTargetIds=this.activeTargetIds.add(e)},t.prototype.Cs=function(e){this.activeTargetIds=this.activeTargetIds.delete(e)},t.prototype.Ss=function(){var e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)},t}(),$p=function(){function t(e,n,r,o,s){this.window=e,this.Se=n,this.persistenceKey=r,this.Ns=o,this.syncEngine=null,this.onlineStateHandler=null,this.sequenceNumberHandler=null,this.xs=this.ks.bind(this),this.Fs=new bt(ce),this.started=!1,this.$s=[];var u=r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");this.storage=this.window.localStorage,this.currentUser=s,this.Os=oI(this.persistenceKey,this.Ns),this.Ms=function(l){return"firestore_sequence_number_"+l}(this.persistenceKey),this.Fs=this.Fs.insert(this.Ns,new Nv),this.Ls=new RegExp("^firestore_clients_"+u+"_([^_]*)$"),this.Bs=new RegExp("^firestore_mutations_"+u+"_(\\d+)(?:_(.*))?$"),this.qs=new RegExp("^firestore_targets_"+u+"_(\\d+)$"),this.Us=function(l){return"firestore_online_state_"+l}(this.persistenceKey),this.Ks=function(l){return"firestore_bundle_loaded_"+l}(this.persistenceKey),this.window.addEventListener("storage",this.xs)}return t.yt=function(e){return!(!e||!e.localStorage)},t.prototype.start=function(){return A(this,void 0,void 0,function(){var e,n,r,o,s,u,l,h,d,p,g,y=this;return C(this,function(w){switch(w.label){case 0:return[4,this.syncEngine.fn()];case 1:for(e=w.sent(),n=0,r=e;n<r.length;n++)(o=r[n])!==this.Ns&&(s=this.getItem(oI(this.persistenceKey,o)))&&(u=uI.Vs(o,s))&&(this.Fs=this.Fs.insert(u.clientId,u));for(this.Qs(),(l=this.storage.getItem(this.Us))&&(h=this.js(l))&&this.Ws(h),d=0,p=this.$s;d<p.length;d++)g=p[d],this.ks(g);return this.$s=[],this.window.addEventListener("pagehide",function(){return y.shutdown()}),this.started=!0,[2]}})})},t.prototype.writeSequenceNumber=function(e){this.setItem(this.Ms,JSON.stringify(e))},t.prototype.getAllActiveQueryTargets=function(){return this.Gs(this.Fs)},t.prototype.isActiveQueryTarget=function(e){var n=!1;return this.Fs.forEach(function(r,o){o.activeTargetIds.has(e)&&(n=!0)}),n},t.prototype.addPendingMutation=function(e){this.zs(e,"pending")},t.prototype.updateMutationState=function(e,n,r){this.zs(e,n,r),this.Hs(e)},t.prototype.addLocalQueryTarget=function(e){var n="not-current";if(this.isActiveQueryTarget(e)){var r=this.storage.getItem(Kp(this.persistenceKey,e));if(r){var o=zp.Vs(e,r);o&&(n=o.state)}}return this.Js.Ds(e),this.Qs(),n},t.prototype.removeLocalQueryTarget=function(e){this.Js.Cs(e),this.Qs()},t.prototype.isLocalQueryTarget=function(e){return this.Js.activeTargetIds.has(e)},t.prototype.clearQueryState=function(e){this.removeItem(Kp(this.persistenceKey,e))},t.prototype.updateQueryState=function(e,n,r){this.Ys(e,n,r)},t.prototype.handleUserChange=function(e,n,r){var o=this;n.forEach(function(s){o.Hs(s)}),this.currentUser=e,r.forEach(function(s){o.addPendingMutation(s)})},t.prototype.setOnlineState=function(e){this.Xs(e)},t.prototype.notifyBundleLoaded=function(){this.Zs()},t.prototype.shutdown=function(){this.started&&(this.window.removeEventListener("storage",this.xs),this.removeItem(this.Os),this.started=!1)},t.prototype.getItem=function(e){var n=this.storage.getItem(e);return U("SharedClientState","READ",e,n),n},t.prototype.setItem=function(e,n){U("SharedClientState","SET",e,n),this.storage.setItem(e,n)},t.prototype.removeItem=function(e){U("SharedClientState","REMOVE",e),this.storage.removeItem(e)},t.prototype.ks=function(e){var n=this,r=e;if(r.storageArea===this.storage){if(U("SharedClientState","EVENT",r.key,r.newValue),r.key===this.Os)return void We("Received WebStorage notification for local change. Another client might have garbage-collected our state");this.Se.enqueueRetryable(function(){return A(n,void 0,void 0,function(){var o,s,u,l,h,d;return C(this,function(p){if(this.started){if(r.key!==null){if(this.Ls.test(r.key)){if(r.newValue==null)return o=this.ti(r.key),[2,this.ei(o,null)];if(s=this.ni(r.key,r.newValue))return[2,this.ei(s.clientId,s)]}else if(this.Bs.test(r.key)){if(r.newValue!==null&&(u=this.si(r.key,r.newValue)))return[2,this.ii(u)]}else if(this.qs.test(r.key)){if(r.newValue!==null&&(l=this.ri(r.key,r.newValue)))return[2,this.oi(l)]}else if(r.key===this.Us){if(r.newValue!==null&&(h=this.js(r.newValue)))return[2,this.Ws(h)]}else if(r.key===this.Ms)(d=function(g){var y=Jt.o;if(g!=null)try{var w=JSON.parse(g);Y(typeof w=="number"),y=w}catch(b){We("SharedClientState","Failed to read sequence number from WebStorage",b)}return y}(r.newValue))!==Jt.o&&this.sequenceNumberHandler(d);else if(r.key===this.Ks)return[2,this.syncEngine.ci()]}}else this.$s.push(r);return[2]})})})}},Object.defineProperty(t.prototype,"Js",{get:function(){return this.Fs.get(this.Ns)},enumerable:!1,configurable:!0}),t.prototype.Qs=function(){this.setItem(this.Os,this.Js.Ss())},t.prototype.zs=function(e,n,r){var o=new aI(this.currentUser,e,n,r),s=sI(this.persistenceKey,this.currentUser,e);this.setItem(s,o.Ss())},t.prototype.Hs=function(e){var n=sI(this.persistenceKey,this.currentUser,e);this.removeItem(n)},t.prototype.Xs=function(e){var n={clientId:this.Ns,onlineState:e};this.storage.setItem(this.Us,JSON.stringify(n))},t.prototype.Ys=function(e,n,r){var o=Kp(this.persistenceKey,e),s=new zp(e,n,r);this.setItem(o,s.Ss())},t.prototype.Zs=function(){this.setItem(this.Ks,"value-not-used")},t.prototype.ti=function(e){var n=this.Ls.exec(e);return n?n[1]:null},t.prototype.ni=function(e,n){var r=this.ti(e);return uI.Vs(r,n)},t.prototype.si=function(e,n){var r=this.Bs.exec(e),o=Number(r[1]),s=r[2]!==void 0?r[2]:null;return aI.Vs(new ot(s),o,n)},t.prototype.ri=function(e,n){var r=this.qs.exec(e),o=Number(r[1]);return zp.Vs(o,n)},t.prototype.js=function(e){return SL.Vs(e)},t.prototype.ii=function(e){return A(this,void 0,void 0,function(){return C(this,function(n){return e.user.uid===this.currentUser.uid?[2,this.syncEngine.ui(e.batchId,e.state,e.error)]:(U("SharedClientState","Ignoring mutation for non-active user "+e.user.uid),[2])})})},t.prototype.oi=function(e){return this.syncEngine.ai(e.targetId,e.state,e.error)},t.prototype.ei=function(e,n){var r=this,o=n?this.Fs.insert(e,n):this.Fs.remove(e),s=this.Gs(this.Fs),u=this.Gs(o),l=[],h=[];return u.forEach(function(d){s.has(d)||l.push(d)}),s.forEach(function(d){u.has(d)||h.push(d)}),this.syncEngine.hi(l,h).then(function(){r.Fs=o})},t.prototype.Ws=function(e){this.Fs.get(e.clientId)&&this.onlineStateHandler(e.onlineState)},t.prototype.Gs=function(e){var n=gh();return e.forEach(function(r,o){n=n.unionWith(o.activeTargetIds)}),n},t}(),KS=function(){function t(){this.li=new Nv,this.fi={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}return t.prototype.addPendingMutation=function(e){},t.prototype.updateMutationState=function(e,n,r){},t.prototype.addLocalQueryTarget=function(e){return this.li.Ds(e),this.fi[e]||"not-current"},t.prototype.updateQueryState=function(e,n,r){this.fi[e]=n},t.prototype.removeLocalQueryTarget=function(e){this.li.Cs(e)},t.prototype.isLocalQueryTarget=function(e){return this.li.activeTargetIds.has(e)},t.prototype.clearQueryState=function(e){delete this.fi[e]},t.prototype.getAllActiveQueryTargets=function(){return this.li.activeTargetIds},t.prototype.isActiveQueryTarget=function(e){return this.li.activeTargetIds.has(e)},t.prototype.start=function(){return this.li=new Nv,Promise.resolve()},t.prototype.handleUserChange=function(e,n,r){},t.prototype.setOnlineState=function(e){},t.prototype.shutdown=function(){},t.prototype.writeSequenceNumber=function(e){},t.prototype.notifyBundleLoaded=function(){},t}(),CL=function(){function t(){}return t.prototype.di=function(e){},t.prototype.shutdown=function(){},t}(),cI=function(){function t(){var e=this;this.wi=function(){return e._i()},this.mi=function(){return e.yi()},this.gi=[],this.pi()}return t.prototype.di=function(e){this.gi.push(e)},t.prototype.shutdown=function(){window.removeEventListener("online",this.wi),window.removeEventListener("offline",this.mi)},t.prototype.pi=function(){window.addEventListener("online",this.wi),window.addEventListener("offline",this.mi)},t.prototype._i=function(){U("ConnectivityMonitor","Network connectivity changed: AVAILABLE");for(var e=0,n=this.gi;e<n.length;e++)(0,n[e])(0)},t.prototype.yi=function(){U("ConnectivityMonitor","Network connectivity changed: UNAVAILABLE");for(var e=0,n=this.gi;e<n.length;e++)(0,n[e])(1)},t.yt=function(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0},t}(),AL={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery"},kL=function(){function t(e){this.Ei=e.Ei,this.Ti=e.Ti}return t.prototype.Ii=function(e){this.Ai=e},t.prototype.Ri=function(e){this.bi=e},t.prototype.onMessage=function(e){this.vi=e},t.prototype.close=function(){this.Ti()},t.prototype.send=function(e){this.Ei(e)},t.prototype.Pi=function(){this.Ai()},t.prototype.Vi=function(e){this.bi(e)},t.prototype.Si=function(e){this.vi(e)},t}(),NL=function(t){function e(n){var r=this;return(r=t.call(this,n)||this).forceLongPolling=n.forceLongPolling,r.autoDetectLongPolling=n.autoDetectLongPolling,r.useFetchStreams=n.useFetchStreams,r}return V(e,t),e.prototype.Fi=function(n,r,o,s){return new Promise(function(u,l){var h=new ox;h.listenOnce(nx.COMPLETE,function(){try{switch(h.getLastErrorCode()){case Wp.NO_ERROR:var p=h.getResponseJson();U("Connection","XHR received:",JSON.stringify(p)),u(p);break;case Wp.TIMEOUT:U("Connection",'RPC "'+n+'" timed out'),l(new P(N.DEADLINE_EXCEEDED,"Request time out"));break;case Wp.HTTP_ERROR:var g=h.getStatus();if(U("Connection",'RPC "'+n+'" failed with status:',g,"response text:",h.getResponseText()),g>0){var y=h.getResponseJson().error;if(y&&y.status&&y.message){var w=function(b){var E=b.toLowerCase().replace(/_/g,"-");return Object.values(N).indexOf(E)>=0?E:N.UNKNOWN}(y.status);l(new P(w,y.message))}else l(new P(N.UNKNOWN,"Server responded with status "+h.getStatus()))}else l(new P(N.UNAVAILABLE,"Connection failed."));break;default:W()}}finally{U("Connection",'RPC "'+n+'" completed.')}});var d=JSON.stringify(s);h.send(r,"POST",d,o,15)})},e.prototype.Oi=function(n,r){var o=[this.Di,"/","google.firestore.v1.Firestore","/",n,"/channel"],s=ex(),u=tx(),l={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling};this.useFetchStreams&&(l.xmlHttpFactory=new ix({})),this.ki(l.initMessageHeaders,r),cg()||UE()||oO()||sO()||aO()||lg()||(l.httpHeadersOverwriteParam="$httpHeaders");var h=o.join("");U("Connection","Creating WebChannel: "+h,l);var d=s.createWebChannel(h,l),p=!1,g=!1,y=new kL({Ei:function(b){g?U("Connection","Not sending because WebChannel is closed:",b):(p||(U("Connection","Opening WebChannel transport."),d.open(),p=!0),U("Connection","WebChannel sending:",b),d.send(b))},Ti:function(){return d.close()}}),w=function(b,E,T){b.listen(E,function(k){try{T(k)}catch(O){setTimeout(function(){throw O},0)}})};return w(d,Bc.EventType.OPEN,function(){g||U("Connection","WebChannel transport opened.")}),w(d,Bc.EventType.CLOSE,function(){g||(g=!0,U("Connection","WebChannel transport closed"),y.Vi())}),w(d,Bc.EventType.ERROR,function(b){g||(g=!0,ml("Connection","WebChannel transport errored:",b),y.Vi(new P(N.UNAVAILABLE,"The operation could not be completed")))}),w(d,Bc.EventType.MESSAGE,function(b){var E;if(!g){var T=b.data[0];Y(!!T);var k=T,O=k.error||((E=k[0])===null||E===void 0?void 0:E.error);if(O){U("Connection","WebChannel received error:",O);var M=O.status,H=function(F){var me=qe[F];if(me!==void 0)return gS(me)}(M),X=O.message;H===void 0&&(H=N.INTERNAL,X="Unknown error status: "+M+" with message "+O.message),g=!0,y.Vi(new P(H,X)),d.close()}else U("Connection","WebChannel received:",T),y.Si(T)}}),w(u,rx.STAT_EVENT,function(b){b.stat===C0.PROXY?U("Connection","Detected buffering proxy"):b.stat===C0.NOPROXY&&U("Connection","Detected no buffering proxy")}),setTimeout(function(){y.Pi()},0),y},e}(function(){function t(e){this.databaseInfo=e,this.databaseId=e.databaseId;var n=e.ssl?"https":"http";this.Di=n+"://"+e.host,this.Ci="projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database+"/documents"}return t.prototype.Ni=function(e,n,r,o){var s=this.xi(e,n);U("RestConnection","Sending: ",s,r);var u={};return this.ki(u,o),this.Fi(e,s,u,r).then(function(l){return U("RestConnection","Received: ",l),l},function(l){throw ml("RestConnection",e+" failed with error: ",l,"url: ",s,"request:",r),l})},t.prototype.$i=function(e,n,r,o){return this.Ni(e,n,r,o)},t.prototype.ki=function(e,n){if(e["X-Goog-Api-Client"]="gl-js/ fire/8.10.1",e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n)for(var r in n.authHeaders)n.authHeaders.hasOwnProperty(r)&&(e[r]=n.authHeaders[r])},t.prototype.xi=function(e,n){var r=AL[e];return this.Di+"/v1/"+n+":"+r},t}());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zS(){return typeof window<"u"?window:null}function rl(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yh(t){return new Lx(t,!0)}var Zg=function(){function t(e,n,r,o,s){r===void 0&&(r=1e3),o===void 0&&(o=1.5),s===void 0&&(s=6e4),this.Se=e,this.timerId=n,this.Mi=r,this.Li=o,this.Bi=s,this.qi=0,this.Ui=null,this.Ki=Date.now(),this.reset()}return t.prototype.reset=function(){this.qi=0},t.prototype.Qi=function(){this.qi=this.Bi},t.prototype.ji=function(e){var n=this;this.cancel();var r=Math.floor(this.qi+this.Wi()),o=Math.max(0,Date.now()-this.Ki),s=Math.max(0,r-o);s>0&&U("ExponentialBackoff","Backing off for "+s+" ms (base delay: "+this.qi+" ms, delay with jitter: "+r+" ms, last attempt: "+o+" ms ago)"),this.Ui=this.Se.enqueueAfterDelay(this.timerId,s,function(){return n.Ki=Date.now(),e()}),this.qi*=this.Li,this.qi<this.Mi&&(this.qi=this.Mi),this.qi>this.Bi&&(this.qi=this.Bi)},t.prototype.Gi=function(){this.Ui!==null&&(this.Ui.skipDelay(),this.Ui=null)},t.prototype.cancel=function(){this.Ui!==null&&(this.Ui.cancel(),this.Ui=null)},t.prototype.Wi=function(){return(Math.random()-.5)*this.qi},t}(),$S=function(){function t(e,n,r,o,s,u){this.Se=e,this.zi=r,this.Hi=o,this.Ji=s,this.listener=u,this.state=0,this.Yi=0,this.Xi=null,this.stream=null,this.Zi=new Zg(e,n)}return t.prototype.tr=function(){return this.state===1||this.state===2||this.state===4},t.prototype.er=function(){return this.state===2},t.prototype.start=function(){this.state!==3?this.auth():this.nr()},t.prototype.stop=function(){return A(this,void 0,void 0,function(){return C(this,function(e){switch(e.label){case 0:return this.tr()?[4,this.close(0)]:[3,2];case 1:e.sent(),e.label=2;case 2:return[2]}})})},t.prototype.sr=function(){this.state=0,this.Zi.reset()},t.prototype.ir=function(){var e=this;this.er()&&this.Xi===null&&(this.Xi=this.Se.enqueueAfterDelay(this.zi,6e4,function(){return e.rr()}))},t.prototype.cr=function(e){this.ur(),this.stream.send(e)},t.prototype.rr=function(){return A(this,void 0,void 0,function(){return C(this,function(e){return this.er()?[2,this.close(0)]:[2]})})},t.prototype.ur=function(){this.Xi&&(this.Xi.cancel(),this.Xi=null)},t.prototype.close=function(e,n){return A(this,void 0,void 0,function(){return C(this,function(r){switch(r.label){case 0:return this.ur(),this.Zi.cancel(),this.Yi++,e!==3?this.Zi.reset():n&&n.code===N.RESOURCE_EXHAUSTED?(We(n.toString()),We("Using maximum backoff delay to prevent overloading the backend."),this.Zi.Qi()):n&&n.code===N.UNAUTHENTICATED&&this.Ji.invalidateToken(),this.stream!==null&&(this.ar(),this.stream.close(),this.stream=null),this.state=e,[4,this.listener.Ri(n)];case 1:return r.sent(),[2]}})})},t.prototype.ar=function(){},t.prototype.auth=function(){var e=this;this.state=1;var n=this.hr(this.Yi),r=this.Yi;this.Ji.getToken().then(function(o){e.Yi===r&&e.lr(o)},function(o){n(function(){var s=new P(N.UNKNOWN,"Fetching auth token failed: "+o.message);return e.dr(s)})})},t.prototype.lr=function(e){var n=this,r=this.hr(this.Yi);this.stream=this.wr(e),this.stream.Ii(function(){r(function(){return n.state=2,n.listener.Ii()})}),this.stream.Ri(function(o){r(function(){return n.dr(o)})}),this.stream.onMessage(function(o){r(function(){return n.onMessage(o)})})},t.prototype.nr=function(){var e=this;this.state=4,this.Zi.ji(function(){return A(e,void 0,void 0,function(){return C(this,function(n){return this.state=0,this.start(),[2]})})})},t.prototype.dr=function(e){return U("PersistentStream","close with error: "+e),this.stream=null,this.close(3,e)},t.prototype.hr=function(e){var n=this;return function(r){n.Se.enqueueAndForget(function(){return n.Yi===e?r():(U("PersistentStream","stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve())})}},t}(),RL=function(t){function e(n,r,o,s,u){var l=this;return(l=t.call(this,n,"listen_stream_connection_backoff","listen_stream_idle",r,o,u)||this).R=s,l}return V(e,t),e.prototype.wr=function(n){return this.Hi.Oi("Listen",n)},e.prototype.onMessage=function(n){this.Zi.reset();var r=function(s,u){var l;if("targetChange"in u){u.targetChange;var h=function(T){return T==="NO_CHANGE"?0:T==="ADD"?1:T==="REMOVE"?2:T==="CURRENT"?3:T==="RESET"?4:W()}(u.targetChange.targetChangeType||"NO_CHANGE"),d=u.targetChange.targetIds||[],p=function(T,k){return T.I?(Y(k===void 0||typeof k=="string"),qt.fromBase64String(k||"")):(Y(k===void 0||k instanceof Uint8Array),qt.fromUint8Array(k||new Uint8Array))}(s,u.targetChange.resumeToken),g=(y=u.targetChange.cause)&&function(T){var k=T.code===void 0?N.UNKNOWN:gS(T.code);return new P(k,T.message||"")}(y);l=new yS(h,d,p,g||null)}else if("documentChange"in u){u.documentChange,(h=u.documentChange).document,h.document.name,h.document.updateTime,d=cr(s,h.document.name),p=Rt(h.document.updateTime);var y=new Xt({mapValue:{fields:h.document.fields}}),w=(g=wt.newFoundDocument(d,p,y),h.targetIds||[]),b=h.removedTargetIds||[];l=new nl(w,b,g.key,g)}else if("documentDelete"in u)u.documentDelete,(h=u.documentDelete).document,d=cr(s,h.document),p=h.readTime?Rt(h.readTime):se.min(),y=wt.newNoDocument(d,p),g=h.removedTargetIds||[],l=new nl([],g,y.key,y);else if("documentRemove"in u)u.documentRemove,(h=u.documentRemove).document,d=cr(s,h.document),p=h.removedTargetIds||[],l=new nl([],p,d,null);else{if(!("filter"in u))return W();u.filter;var E=u.filter;E.targetId,h=E.count||0,d=new Sx(h),p=E.targetId,l=new mS(p,d)}return l}(this.R,n),o=function(s){if(!("targetChange"in s))return se.min();var u=s.targetChange;return u.targetIds&&u.targetIds.length?se.min():u.readTime?Rt(u.readTime):se.min()}(n);return this.listener._r(r,o)},e.prototype.mr=function(n){var r={};r.database=Qa(this.R),r.addTarget=function(s,u){var l,h=u.target;return(l=wl(h)?{documents:ES(s,h)}:{query:TS(s,h)}).targetId=u.targetId,u.resumeToken.approximateByteSize()>0?l.resumeToken=_S(s,u.resumeToken):u.snapshotVersion.compareTo(se.min())>0&&(l.readTime=za(s,u.snapshotVersion.toTimestamp())),l}(this.R,n);var o=function(s,u){var l=function(h,d){switch(d){case 0:return null;case 1:return"existence-filter-mismatch";case 2:return"limbo-document";default:return W()}}(0,u.purpose);return l==null?null:{"goog-listen-tags":l}}(this.R,n);o&&(r.labels=o),this.cr(r)},e.prototype.yr=function(n){var r={};r.database=Qa(this.R),r.removeTarget=n,this.cr(r)},e}($S),DL=function(t){function e(n,r,o,s,u){var l=this;return(l=t.call(this,n,"write_stream_connection_backoff","write_stream_idle",r,o,u)||this).R=s,l.gr=!1,l}return V(e,t),Object.defineProperty(e.prototype,"pr",{get:function(){return this.gr},enumerable:!1,configurable:!0}),e.prototype.start=function(){this.gr=!1,this.lastStreamToken=void 0,t.prototype.start.call(this)},e.prototype.ar=function(){this.gr&&this.Er([])},e.prototype.wr=function(n){return this.Hi.Oi("Write",n)},e.prototype.onMessage=function(n){if(Y(!!n.streamToken),this.lastStreamToken=n.streamToken,this.gr){this.Zi.reset();var r=function(s,u){return s&&s.length>0?(Y(u!==void 0),s.map(function(l){return function(h,d){var p=h.updateTime?Rt(h.updateTime):Rt(d);return p.isEqual(se.min())&&(p=Rt(d)),new Ix(p,h.transformResults||[])}(l,u)})):[]}(n.writeResults,n.commitTime),o=Rt(n.commitTime);return this.listener.Tr(o,r)}return Y(!n.writeResults||n.writeResults.length===0),this.gr=!0,this.listener.Ir()},e.prototype.Ar=function(){var n={};n.database=Qa(this.R),this.cr(n)},e.prototype.Er=function(n){var r=this,o={streamToken:this.lastStreamToken,writes:n.map(function(s){return El(r.R,s)})};this.cr(o)},e}($S),OL=function(t){function e(n,r,o){var s=this;return(s=t.call(this)||this).credentials=n,s.Hi=r,s.R=o,s.Rr=!1,s}return V(e,t),e.prototype.br=function(){if(this.Rr)throw new P(N.FAILED_PRECONDITION,"The client has already been terminated.")},e.prototype.Ni=function(n,r,o){var s=this;return this.br(),this.credentials.getToken().then(function(u){return s.Hi.Ni(n,r,o,u)}).catch(function(u){throw u.name==="FirebaseError"?(u.code===N.UNAUTHENTICATED&&s.credentials.invalidateToken(),u):new P(N.UNKNOWN,u.toString())})},e.prototype.$i=function(n,r,o){var s=this;return this.br(),this.credentials.getToken().then(function(u){return s.Hi.$i(n,r,o,u)}).catch(function(u){throw u.name==="FirebaseError"?(u.code===N.UNAUTHENTICATED&&s.credentials.invalidateToken(),u):new P(N.UNKNOWN,u.toString())})},e.prototype.terminate=function(){this.Rr=!0},e}(function(){}),PL=function(){function t(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this.vr=0,this.Pr=null,this.Vr=!0}return t.prototype.Sr=function(){var e=this;this.vr===0&&(this.Dr("Unknown"),this.Pr=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,function(){return e.Pr=null,e.Cr("Backend didn't respond within 10 seconds."),e.Dr("Offline"),Promise.resolve()}))},t.prototype.Nr=function(e){this.state==="Online"?this.Dr("Unknown"):(this.vr++,this.vr>=1&&(this.kr(),this.Cr("Connection failed 1 times. Most recent error: "+e.toString()),this.Dr("Offline")))},t.prototype.set=function(e){this.kr(),this.vr=0,e==="Online"&&(this.Vr=!1),this.Dr(e)},t.prototype.Dr=function(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))},t.prototype.Cr=function(e){var n="Could not reach Cloud Firestore backend. "+e+`
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.Vr?(We(n),this.Vr=!1):U("OnlineStateTracker",n)},t.prototype.kr=function(){this.Pr!==null&&(this.Pr.cancel(),this.Pr=null)},t}(),xL=function(t,e,n,r,o){var s=this;this.localStore=t,this.datastore=e,this.asyncQueue=n,this.remoteSyncer={},this.Fr=[],this.$r=new Map,this.Or=new Set,this.Mr=[],this.Lr=o,this.Lr.di(function(u){n.enqueueAndForget(function(){return A(s,void 0,void 0,function(){return C(this,function(l){switch(l.label){case 0:return Yr(this)?(U("RemoteStore","Restarting streams for network reachability change."),[4,function(h){return A(this,void 0,void 0,function(){var d;return C(this,function(p){switch(p.label){case 0:return(d=j(h)).Or.add(4),[4,ws(d)];case 1:return p.sent(),d.Br.set("Unknown"),d.Or.delete(4),[4,Iu(d)];case 2:return p.sent(),[2]}})})}(this)]):[3,2];case 1:l.sent(),l.label=2;case 2:return[2]}})})})}),this.Br=new PL(n,r)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Iu(t){return A(this,void 0,void 0,function(){var e,n;return C(this,function(r){switch(r.label){case 0:if(!Yr(t))return[3,4];e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!0)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function ws(t){return A(this,void 0,void 0,function(){var e,n;return C(this,function(r){switch(r.label){case 0:e=0,n=t.Mr,r.label=1;case 1:return e<n.length?[4,(0,n[e])(!1)]:[3,4];case 2:r.sent(),r.label=3;case 3:return e++,[3,1];case 4:return[2]}})})}function _h(t,e){var n=j(t);n.$r.has(e.targetId)||(n.$r.set(e.targetId,e),nm(n)?tm(n):Is(n).er()&&em(n,e))}function Ya(t,e){var n=j(t),r=Is(n);n.$r.delete(e),r.er()&&QS(n,e),n.$r.size===0&&(r.er()?r.ir():Yr(n)&&n.Br.set("Unknown"))}function em(t,e){t.qr.U(e.targetId),Is(t).mr(e)}function QS(t,e){t.qr.U(e),Is(t).yr(e)}function tm(t){t.qr=new Ox({getRemoteKeysForTarget:function(e){return t.remoteSyncer.getRemoteKeysForTarget(e)},lt:function(e){return t.$r.get(e)||null}}),Is(t).start(),t.Br.Sr()}function nm(t){return Yr(t)&&!Is(t).tr()&&t.$r.size>0}function Yr(t){return j(t).Or.size===0}function YS(t){t.qr=void 0}function LL(t){return A(this,void 0,void 0,function(){return C(this,function(e){return t.$r.forEach(function(n,r){em(t,n)}),[2]})})}function ML(t,e){return A(this,void 0,void 0,function(){return C(this,function(n){return YS(t),nm(t)?(t.Br.Nr(e),tm(t)):t.Br.set("Unknown"),[2]})})}function FL(t,e,n){return A(this,void 0,void 0,function(){var r,o,s;return C(this,function(u){switch(u.label){case 0:if(t.Br.set("Online"),!(e instanceof yS&&e.state===2&&e.cause))return[3,6];u.label=1;case 1:return u.trys.push([1,3,,5]),[4,function(l,h){return A(this,void 0,void 0,function(){var d,p,g,y;return C(this,function(w){switch(w.label){case 0:d=h.cause,p=0,g=h.targetIds,w.label=1;case 1:return p<g.length?(y=g[p],l.$r.has(y)?[4,l.remoteSyncer.rejectListen(y,d)]:[3,3]):[3,5];case 2:w.sent(),l.$r.delete(y),l.qr.removeTarget(y),w.label=3;case 3:w.label=4;case 4:return p++,[3,1];case 5:return[2]}})})}(t,e)];case 2:return u.sent(),[3,5];case 3:return r=u.sent(),U("RemoteStore","Failed to remove targets %s: %s ",e.targetIds.join(","),r),[4,kl(t,r)];case 4:return u.sent(),[3,5];case 5:return[3,13];case 6:if(e instanceof nl?t.qr.X(e):e instanceof mS?t.qr.rt(e):t.qr.et(e),n.isEqual(se.min()))return[3,13];u.label=7;case 7:return u.trys.push([7,11,,13]),[4,GS(t.localStore)];case 8:return o=u.sent(),n.compareTo(o)>=0?[4,function(l,h){var d=l.qr.ut(h);return d.targetChanges.forEach(function(p,g){if(p.resumeToken.approximateByteSize()>0){var y=l.$r.get(g);y&&l.$r.set(g,y.withResumeToken(p.resumeToken,h))}}),d.targetMismatches.forEach(function(p){var g=l.$r.get(p);if(g){l.$r.set(p,g.withResumeToken(qt.EMPTY_BYTE_STRING,g.snapshotVersion)),QS(l,p);var y=new mh(g.target,p,1,g.sequenceNumber);em(l,y)}}),l.remoteSyncer.applyRemoteEvent(d)}(t,n)]:[3,10];case 9:u.sent(),u.label=10;case 10:return[3,13];case 11:return U("RemoteStore","Failed to raise snapshot:",s=u.sent()),[4,kl(t,s)];case 12:return u.sent(),[3,13];case 13:return[2]}})})}function kl(t,e,n){return A(this,void 0,void 0,function(){var r=this;return C(this,function(o){switch(o.label){case 0:if(!Zi(e))throw e;return t.Or.add(1),[4,ws(t)];case 1:return o.sent(),t.Br.set("Offline"),n||(n=function(){return GS(t.localStore)}),t.asyncQueue.enqueueRetryable(function(){return A(r,void 0,void 0,function(){return C(this,function(s){switch(s.label){case 0:return U("RemoteStore","Retrying IndexedDB access"),[4,n()];case 1:return s.sent(),t.Or.delete(1),[4,Iu(t)];case 2:return s.sent(),[2]}})})}),[2]}})})}function XS(t,e){return e().catch(function(n){return kl(t,n,e)})}function bs(t){return A(this,void 0,void 0,function(){var e,n,r,o,s;return C(this,function(u){switch(u.label){case 0:e=j(t),n=qr(e),r=e.Fr.length>0?e.Fr[e.Fr.length-1].batchId:-1,u.label=1;case 1:if(!function(l){return Yr(l)&&l.Fr.length<10}(e))return[3,7];u.label=2;case 2:return u.trys.push([2,4,,6]),[4,vL(e.localStore,r)];case 3:return(o=u.sent())===null?(e.Fr.length===0&&n.ir(),[3,7]):(r=o.batchId,function(l,h){l.Fr.push(h);var d=qr(l);d.er()&&d.pr&&d.Er(h.mutations)}(e,o),[3,6]);case 4:return s=u.sent(),[4,kl(e,s)];case 5:return u.sent(),[3,6];case 6:return[3,1];case 7:return JS(e)&&ZS(e),[2]}})})}function JS(t){return Yr(t)&&!qr(t).tr()&&t.Fr.length>0}function ZS(t){qr(t).start()}function UL(t){return A(this,void 0,void 0,function(){return C(this,function(e){return qr(t).Ar(),[2]})})}function VL(t){return A(this,void 0,void 0,function(){var e,n,r,o;return C(this,function(s){for(e=qr(t),n=0,r=t.Fr;n<r.length;n++)o=r[n],e.Er(o.mutations);return[2]})})}function jL(t,e,n){return A(this,void 0,void 0,function(){var r,o;return C(this,function(s){switch(s.label){case 0:return r=t.Fr.shift(),o=Yx.from(r,e,n),[4,XS(t,function(){return t.remoteSyncer.applySuccessfulWrite(o)})];case 1:return s.sent(),[4,bs(t)];case 2:return s.sent(),[2]}})})}function BL(t,e){return A(this,void 0,void 0,function(){return C(this,function(n){switch(n.label){case 0:return e&&qr(t).pr?[4,function(r,o){return A(this,void 0,void 0,function(){var s,u;return C(this,function(l){switch(l.label){case 0:return vS(u=o.code)&&u!==N.ABORTED?(s=r.Fr.shift(),qr(r).sr(),[4,XS(r,function(){return r.remoteSyncer.rejectFailedWrite(s.batchId,o)})]):[3,3];case 1:return l.sent(),[4,bs(r)];case 2:l.sent(),l.label=3;case 3:return[2]}})})}(t,e)]:[3,2];case 1:n.sent(),n.label=2;case 2:return JS(t)&&ZS(t),[2]}})})}function Rv(t,e){return A(this,void 0,void 0,function(){var n;return C(this,function(r){switch(r.label){case 0:return n=j(t),e?(n.Or.delete(2),[4,Iu(n)]):[3,2];case 1:return r.sent(),[3,5];case 2:return e?[3,4]:(n.Or.add(2),[4,ws(n)]);case 3:r.sent(),n.Br.set("Unknown"),r.label=4;case 4:r.label=5;case 5:return[2]}})})}function Is(t){var e=this;return t.Ur||(t.Ur=function(n,r,o){var s=j(n);return s.br(),new RL(r,s.Hi,s.credentials,s.R,o)}(t.datastore,t.asyncQueue,{Ii:LL.bind(null,t),Ri:ML.bind(null,t),_r:FL.bind(null,t)}),t.Mr.push(function(n){return A(e,void 0,void 0,function(){return C(this,function(r){switch(r.label){case 0:return n?(t.Ur.sr(),nm(t)?tm(t):t.Br.set("Unknown"),[3,3]):[3,1];case 1:return[4,t.Ur.stop()];case 2:r.sent(),YS(t),r.label=3;case 3:return[2]}})})})),t.Ur}function qr(t){var e=this;return t.Kr||(t.Kr=function(n,r,o){var s=j(n);return s.br(),new DL(r,s.Hi,s.credentials,s.R,o)}(t.datastore,t.asyncQueue,{Ii:UL.bind(null,t),Ri:BL.bind(null,t),Ir:VL.bind(null,t),Tr:jL.bind(null,t)}),t.Mr.push(function(n){return A(e,void 0,void 0,function(){return C(this,function(r){switch(r.label){case 0:return n?(t.Kr.sr(),[4,bs(t)]):[3,2];case 1:return r.sent(),[3,4];case 2:return[4,t.Kr.stop()];case 3:r.sent(),t.Fr.length>0&&(U("RemoteStore","Stopping write stream with "+t.Fr.length+" pending writes"),t.Fr=[]),r.label=4;case 4:return[2]}})})})),t.Kr}var qL=function(){function t(e,n,r,o,s){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=o,this.removalCallback=s,this.deferred=new Gt,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(function(u){})}return t.createAndSchedule=function(e,n,r,o,s){var u=new t(e,n,Date.now()+r,o,s);return u.start(r),u},t.prototype.start=function(e){var n=this;this.timerHandle=setTimeout(function(){return n.handleDelayElapsed()},e)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new P(N.CANCELLED,"Operation cancelled"+(e?": "+e:""))))},t.prototype.handleDelayElapsed=function(){var e=this;this.asyncQueue.enqueueAndForget(function(){return e.timerHandle!==null?(e.clearTimeout(),e.op().then(function(n){return e.deferred.resolve(n)})):Promise.resolve()})},t.prototype.clearTimeout=function(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}();function Es(t,e){if(We("AsyncQueue",e+": "+t),Zi(t))return new P(N.UNAVAILABLE,e+": "+t);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var eC=function(){function t(e){this.comparator=e?function(n,r){return e(n,r)||K.comparator(n.key,r.key)}:function(n,r){return K.comparator(n.key,r.key)},this.keyedMap=Cv(),this.sortedSet=new bt(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(e){return this.keyedMap.get(e)!=null},t.prototype.get=function(e){return this.keyedMap.get(e)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(e){var n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!1,configurable:!0}),t.prototype.forEach=function(e){this.sortedSet.inorderTraversal(function(n,r){return e(n),!1})},t.prototype.add=function(e){var n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))},t.prototype.delete=function(e){var n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this},t.prototype.isEqual=function(e){if(!(e instanceof t)||this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var o=n.getNext().key,s=r.getNext().key;if(!o.isEqual(s))return!1}return!0},t.prototype.toString=function(){var e=[];return this.forEach(function(n){e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),lI=function(){function t(){this.Qr=new bt(K.comparator)}return t.prototype.track=function(e){var n=e.doc.key,r=this.Qr.get(n);r?e.type!==0&&r.type===3?this.Qr=this.Qr.insert(n,e):e.type===3&&r.type!==1?this.Qr=this.Qr.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.Qr=this.Qr.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.Qr=this.Qr.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.Qr=this.Qr.remove(n):e.type===1&&r.type===2?this.Qr=this.Qr.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.Qr=this.Qr.insert(n,{type:2,doc:e.doc}):W():this.Qr=this.Qr.insert(n,e)},t.prototype.jr=function(){var e=[];return this.Qr.inorderTraversal(function(n,r){e.push(r)}),e},t}(),Nl=function(){function t(e,n,r,o,s,u,l,h){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=o,this.mutatedKeys=s,this.fromCache=u,this.syncStateChanged=l,this.excludesMetadataChanges=h}return t.fromInitialDocuments=function(e,n,r,o){var s=[];return n.forEach(function(u){s.push({type:0,doc:u})}),new t(e,n,eC.emptySet(n),s,r,o,!0,!1)},Object.defineProperty(t.prototype,"hasPendingWrites",{get:function(){return!this.mutatedKeys.isEmpty()},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){if(!(this.fromCache===e.fromCache&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&mu(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;var n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(var o=0;o<n.length;o++)if(n[o].type!==r[o].type||!n[o].doc.isEqual(r[o].doc))return!1;return!0},t}(),GL=function(){this.Wr=void 0,this.listeners=[]},WL=function(){this.queries=new _s(function(t){return oS(t)},mu),this.onlineState="Unknown",this.Gr=new Set};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rm(t,e){return A(this,void 0,void 0,function(){var n,r,o,s,u,l,h;return C(this,function(d){switch(d.label){case 0:if(n=j(t),r=e.query,o=!1,(s=n.queries.get(r))||(o=!0,s=new GL),!o)return[3,4];d.label=1;case 1:return d.trys.push([1,3,,4]),u=s,[4,n.onListen(r)];case 2:return u.Wr=d.sent(),[3,4];case 3:return l=d.sent(),h=Es(l,"Initialization of query '"+Tv(e.query)+"' failed"),[2,void e.onError(h)];case 4:return n.queries.set(r,s),s.listeners.push(e),e.zr(n.onlineState),s.Wr&&e.Hr(s.Wr)&&om(n),[2]}})})}function im(t,e){return A(this,void 0,void 0,function(){var n,r,o,s,u;return C(this,function(l){return n=j(t),r=e.query,o=!1,(s=n.queries.get(r))&&(u=s.listeners.indexOf(e))>=0&&(s.listeners.splice(u,1),o=s.listeners.length===0),o?[2,(n.queries.delete(r),n.onUnlisten(r))]:[2]})})}function HL(t,e){for(var n=j(t),r=!1,o=0,s=e;o<s.length;o++){var u=s[o],l=u.query,h=n.queries.get(l);if(h){for(var d=0,p=h.listeners;d<p.length;d++)p[d].Hr(u)&&(r=!0);h.Wr=u}}r&&om(n)}function KL(t,e,n){var r=j(t),o=r.queries.get(e);if(o)for(var s=0,u=o.listeners;s<u.length;s++)u[s].onError(n);r.queries.delete(e)}function om(t){t.Gr.forEach(function(e){e.next()})}var sm=function(){function t(e,n,r){this.query=e,this.Jr=n,this.Yr=!1,this.Xr=null,this.onlineState="Unknown",this.options=r||{}}return t.prototype.Hr=function(e){if(!this.options.includeMetadataChanges){for(var n=[],r=0,o=e.docChanges;r<o.length;r++){var s=o[r];s.type!==3&&n.push(s)}e=new Nl(e.query,e.docs,e.oldDocs,n,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0)}var u=!1;return this.Yr?this.Zr(e)&&(this.Jr.next(e),u=!0):this.eo(e,this.onlineState)&&(this.no(e),u=!0),this.Xr=e,u},t.prototype.onError=function(e){this.Jr.error(e)},t.prototype.zr=function(e){this.onlineState=e;var n=!1;return this.Xr&&!this.Yr&&this.eo(this.Xr,e)&&(this.no(this.Xr),n=!0),n},t.prototype.eo=function(e,n){if(!e.fromCache)return!0;var r=n!=="Offline";return!(this.options.so&&r||e.docs.isEmpty()&&n!=="Offline")},t.prototype.Zr=function(e){if(e.docChanges.length>0)return!0;var n=this.Xr&&this.Xr.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0},t.prototype.no=function(e){e=Nl.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache),this.Yr=!0,this.Jr.next(e)},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tC=function(t){this.key=t},nC=function(t){this.key=t},rC=function(){function t(e,n){this.query=e,this.uo=n,this.ao=null,this.current=!1,this.ho=Te(),this.mutatedKeys=Te(),this.lo=sS(e),this.fo=new eC(this.lo)}return Object.defineProperty(t.prototype,"wo",{get:function(){return this.uo},enumerable:!1,configurable:!0}),t.prototype._o=function(e,n){var r=this,o=n?n.mo:new lI,s=n?n.fo:this.fo,u=n?n.mutatedKeys:this.mutatedKeys,l=s,h=!1,d=el(this.query)&&s.size===this.query.limit?s.last():null,p=Il(this.query)&&s.size===this.query.limit?s.first():null;if(e.inorderTraversal(function(y,w){var b=s.get(y),E=yu(r.query,w)?w:null,T=!!b&&r.mutatedKeys.has(b.key),k=!!E&&(E.hasLocalMutations||r.mutatedKeys.has(E.key)&&E.hasCommittedMutations),O=!1;b&&E?b.data.isEqual(E.data)?T!==k&&(o.track({type:3,doc:E}),O=!0):r.yo(b,E)||(o.track({type:2,doc:E}),O=!0,(d&&r.lo(E,d)>0||p&&r.lo(E,p)<0)&&(h=!0)):!b&&E?(o.track({type:0,doc:E}),O=!0):b&&!E&&(o.track({type:1,doc:b}),O=!0,(d||p)&&(h=!0)),O&&(E?(l=l.add(E),u=k?u.add(y):u.delete(y)):(l=l.delete(y),u=u.delete(y)))}),el(this.query)||Il(this.query))for(;l.size>this.query.limit;){var g=el(this.query)?l.last():l.first();l=l.delete(g.key),u=u.delete(g.key),o.track({type:1,doc:g})}return{fo:l,mo:o,Nn:h,mutatedKeys:u}},t.prototype.yo=function(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations},t.prototype.applyChanges=function(e,n,r){var o=this,s=this.fo;this.fo=e.fo,this.mutatedKeys=e.mutatedKeys;var u=e.mo.jr();u.sort(function(p,g){return function(y,w){var b=function(E){switch(E){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return W()}};return b(y)-b(w)}(p.type,g.type)||o.lo(p.doc,g.doc)}),this.po(r);var l=n?this.Eo():[],h=this.ho.size===0&&this.current?1:0,d=h!==this.ao;return this.ao=h,u.length!==0||d?{snapshot:new Nl(this.query,e.fo,s,u,e.mutatedKeys,h===0,d,!1),To:l}:{To:l}},t.prototype.zr=function(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({fo:this.fo,mo:new lI,mutatedKeys:this.mutatedKeys,Nn:!1},!1)):{To:[]}},t.prototype.Io=function(e){return!this.uo.has(e)&&!!this.fo.has(e)&&!this.fo.get(e).hasLocalMutations},t.prototype.po=function(e){var n=this;e&&(e.addedDocuments.forEach(function(r){return n.uo=n.uo.add(r)}),e.modifiedDocuments.forEach(function(r){}),e.removedDocuments.forEach(function(r){return n.uo=n.uo.delete(r)}),this.current=e.current)},t.prototype.Eo=function(){var e=this;if(!this.current)return[];var n=this.ho;this.ho=Te(),this.fo.forEach(function(o){e.Io(o.key)&&(e.ho=e.ho.add(o.key))});var r=[];return n.forEach(function(o){e.ho.has(o)||r.push(new nC(o))}),this.ho.forEach(function(o){n.has(o)||r.push(new tC(o))}),r},t.prototype.Ao=function(e){this.uo=e.Bn,this.ho=Te();var n=this._o(e.documents);return this.applyChanges(n,!0)},t.prototype.Ro=function(){return Nl.fromInitialDocuments(this.query,this.fo,this.mutatedKeys,this.ao===0)},t}(),zL=function(t,e,n){this.query=t,this.targetId=e,this.view=n},$L=function(t){this.key=t,this.bo=!1},QL=function(){function t(e,n,r,o,s,u){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=o,this.currentUser=s,this.maxConcurrentLimboResolutions=u,this.vo={},this.Po=new _s(function(l){return oS(l)},mu),this.Vo=new Map,this.So=new Set,this.Do=new bt(K.comparator),this.Co=new Map,this.No=new Jg,this.xo={},this.ko=new Map,this.Fo=Sl.Yt(),this.onlineState="Unknown",this.$o=void 0}return Object.defineProperty(t.prototype,"isPrimaryClient",{get:function(){return this.$o===!0},enumerable:!1,configurable:!0}),t}();function YL(t,e){return A(this,void 0,void 0,function(){var n,r,o,s,u,l;return C(this,function(h){switch(h.label){case 0:return n=hm(t),(s=n.Po.get(e))?(r=s.targetId,n.sharedClientState.addLocalQueryTarget(r),o=s.view.Ro(),[3,4]):[3,1];case 1:return[4,Cl(n.localStore,$n(e))];case 2:return u=h.sent(),l=n.sharedClientState.addLocalQueryTarget(u.targetId),r=u.targetId,[4,am(n,e,r,l==="current")];case 3:o=h.sent(),n.isPrimaryClient&&_h(n.remoteStore,u),h.label=4;case 4:return[2,o]}})})}function am(t,e,n,r){return A(this,void 0,void 0,function(){var o,s,u,l,h,d;return C(this,function(p){switch(p.label){case 0:return t.Oo=function(g,y,w){return function(b,E,T,k){return A(this,void 0,void 0,function(){var O,M,H;return C(this,function(X){switch(X.label){case 0:return O=E.view._o(T),O.Nn?[4,Al(b.localStore,E.query,!1).then(function(F){var me=F.documents;return E.view._o(me,O)})]:[3,2];case 1:O=X.sent(),X.label=2;case 2:return M=k&&k.targetChanges.get(E.targetId),H=E.view.applyChanges(O,b.isPrimaryClient,M),[2,(Dv(b,E.targetId,H.To),H.snapshot)]}})})}(t,g,y,w)},[4,Al(t.localStore,e,!0)];case 1:return o=p.sent(),s=new rC(e,o.Bn),u=s._o(o.documents),l=Hg.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline"),h=s.applyChanges(u,t.isPrimaryClient,l),Dv(t,n,h.To),d=new zL(e,n,s),[2,(t.Po.set(e,d),t.Vo.has(n)?t.Vo.get(n).push(e):t.Vo.set(n,[e]),h.snapshot)]}})})}function XL(t,e){return A(this,void 0,void 0,function(){var n,r,o;return C(this,function(s){switch(s.label){case 0:return n=j(t),r=n.Po.get(e),(o=n.Vo.get(r.targetId)).length>1?[2,(n.Vo.set(r.targetId,o.filter(function(u){return!mu(u,e)})),void n.Po.delete(e))]:n.isPrimaryClient?(n.sharedClientState.removeLocalQueryTarget(r.targetId),n.sharedClientState.isActiveQueryTarget(r.targetId)?[3,2]:[4,os(n.localStore,r.targetId,!1).then(function(){n.sharedClientState.clearQueryState(r.targetId),Ya(n.remoteStore,r.targetId),ss(n,r.targetId)}).catch(eo)]):[3,3];case 1:s.sent(),s.label=2;case 2:return[3,5];case 3:return ss(n,r.targetId),[4,os(n.localStore,r.targetId,!0)];case 4:s.sent(),s.label=5;case 5:return[2]}})})}function JL(t,e,n){return A(this,void 0,void 0,function(){var r,o,s,u;return C(this,function(l){switch(l.label){case 0:r=fm(t),l.label=1;case 1:return l.trys.push([1,5,,6]),[4,function(h,d){var p,g=j(h),y=Bt.now(),w=d.reduce(function(b,E){return b.add(E.key)},Te());return g.persistence.runTransaction("Locally write mutations","readwrite",function(b){return g.Mn.pn(b,w).next(function(E){p=E;for(var T=[],k=0,O=d;k<O.length;k++){var M=O[k],H=Tx(M,p.get(M.key));H!=null&&T.push(new Qr(M.key,H,tS(H.value.mapValue),mt.exists(!0)))}return g._n.addMutationBatch(b,y,T,d)})}).then(function(b){return b.applyToLocalDocumentSet(p),{batchId:b.batchId,changes:p}})}(r.localStore,e)];case 2:return o=l.sent(),r.sharedClientState.addPendingMutation(o.batchId),function(h,d,p){var g=h.xo[h.currentUser.toKey()];g||(g=new bt(ce)),g=g.insert(d,p),h.xo[h.currentUser.toKey()]=g}(r,o.batchId,n),[4,Xr(r,o.changes)];case 3:return l.sent(),[4,bs(r.remoteStore)];case 4:return l.sent(),[3,6];case 5:return s=l.sent(),u=Es(s,"Failed to persist write"),n.reject(u),[3,6];case 6:return[2]}})})}function iC(t,e){return A(this,void 0,void 0,function(){var n,r;return C(this,function(o){switch(o.label){case 0:n=j(t),o.label=1;case 1:return o.trys.push([1,4,,6]),[4,dL(n.localStore,e)];case 2:return r=o.sent(),e.targetChanges.forEach(function(s,u){var l=n.Co.get(u);l&&(Y(s.addedDocuments.size+s.modifiedDocuments.size+s.removedDocuments.size<=1),s.addedDocuments.size>0?l.bo=!0:s.modifiedDocuments.size>0?Y(l.bo):s.removedDocuments.size>0&&(Y(l.bo),l.bo=!1))}),[4,Xr(n,r,e)];case 3:return o.sent(),[3,6];case 4:return[4,eo(o.sent())];case 5:return o.sent(),[3,6];case 6:return[2]}})})}function hI(t,e,n){var r=j(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){var o=[];r.Po.forEach(function(s,u){var l=u.view.zr(e);l.snapshot&&o.push(l.snapshot)}),function(s,u){var l=j(s);l.onlineState=u;var h=!1;l.queries.forEach(function(d,p){for(var g=0,y=p.listeners;g<y.length;g++)y[g].zr(u)&&(h=!0)}),h&&om(l)}(r.eventManager,e),o.length&&r.vo._r(o),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}function ZL(t,e,n){return A(this,void 0,void 0,function(){var r,o,s,u,l,h;return C(this,function(d){switch(d.label){case 0:return(r=j(t)).sharedClientState.updateQueryState(e,"rejected",n),o=r.Co.get(e),(s=o&&o.key)?(u=(u=new bt(K.comparator)).insert(s,wt.newNoDocument(s,se.min())),l=Te().add(s),h=new Wg(se.min(),new Map,new Xe(ce),u,l),[4,iC(r,h)]):[3,2];case 1:return d.sent(),r.Do=r.Do.remove(s),r.Co.delete(e),lm(r),[3,4];case 2:return[4,os(r.localStore,e,!1).then(function(){return ss(r,e,n)}).catch(eo)];case 3:d.sent(),d.label=4;case 4:return[2]}})})}function eM(t,e){return A(this,void 0,void 0,function(){var n,r,o;return C(this,function(s){switch(s.label){case 0:n=j(t),r=e.batch.batchId,s.label=1;case 1:return s.trys.push([1,4,,6]),[4,fL(n.localStore,e)];case 2:return o=s.sent(),cm(n,r,null),um(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),[4,Xr(n,o)];case 3:return s.sent(),[3,6];case 4:return[4,eo(s.sent())];case 5:return s.sent(),[3,6];case 6:return[2]}})})}function tM(t,e,n){return A(this,void 0,void 0,function(){var r,o;return C(this,function(s){switch(s.label){case 0:r=j(t),s.label=1;case 1:return s.trys.push([1,4,,6]),[4,function(u,l){var h=j(u);return h.persistence.runTransaction("Reject batch","readwrite-primary",function(d){var p;return h._n.lookupMutationBatch(d,l).next(function(g){return Y(g!==null),p=g.keys(),h._n.removeMutationBatch(d,g)}).next(function(){return h._n.performConsistencyCheck(d)}).next(function(){return h.Mn.pn(d,p)})})}(r.localStore,e)];case 2:return o=s.sent(),cm(r,e,n),um(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),[4,Xr(r,o)];case 3:return s.sent(),[3,6];case 4:return[4,eo(s.sent())];case 5:return s.sent(),[3,6];case 6:return[2]}})})}function nM(t,e){return A(this,void 0,void 0,function(){var n,r,o,s,u;return C(this,function(l){switch(l.label){case 0:Yr((n=j(t)).remoteStore)||U("SyncEngine","The network is disabled. The task returned by 'awaitPendingWrites()' will not complete until the network is enabled."),l.label=1;case 1:return l.trys.push([1,3,,4]),[4,function(h){var d=j(h);return d.persistence.runTransaction("Get highest unacknowledged batch id","readonly",function(p){return d._n.getHighestUnacknowledgedBatchId(p)})}(n.localStore)];case 2:return(r=l.sent())===-1?[2,void e.resolve()]:((o=n.ko.get(r)||[]).push(e),n.ko.set(r,o),[3,4]);case 3:return s=l.sent(),u=Es(s,"Initialization of waitForPendingWrites() operation failed"),e.reject(u),[3,4];case 4:return[2]}})})}function um(t,e){(t.ko.get(e)||[]).forEach(function(n){n.resolve()}),t.ko.delete(e)}function cm(t,e,n){var r=j(t),o=r.xo[r.currentUser.toKey()];if(o){var s=o.get(e);s&&(n?s.reject(n):s.resolve(),o=o.remove(e)),r.xo[r.currentUser.toKey()]=o}}function ss(t,e,n){n===void 0&&(n=null),t.sharedClientState.removeLocalQueryTarget(e);for(var r=0,o=t.Vo.get(e);r<o.length;r++){var s=o[r];t.Po.delete(s),n&&t.vo.Mo(s,n)}t.Vo.delete(e),t.isPrimaryClient&&t.No.Zn(e).forEach(function(u){t.No.containsKey(u)||oC(t,u)})}function oC(t,e){t.So.delete(e.path.canonicalString());var n=t.Do.get(e);n!==null&&(Ya(t.remoteStore,n),t.Do=t.Do.remove(e),t.Co.delete(n),lm(t))}function Dv(t,e,n){for(var r=0,o=n;r<o.length;r++){var s=o[r];s instanceof tC?(t.No.addReference(s.key,e),rM(t,s)):s instanceof nC?(U("SyncEngine","Document no longer in limbo: "+s.key),t.No.removeReference(s.key,e),t.No.containsKey(s.key)||oC(t,s.key)):W()}}function rM(t,e){var n=e.key,r=n.path.canonicalString();t.Do.get(n)||t.So.has(r)||(U("SyncEngine","New document in limbo: "+n),t.So.add(r),lm(t))}function lm(t){for(;t.So.size>0&&t.Do.size<t.maxConcurrentLimboResolutions;){var e=t.So.values().next().value;t.So.delete(e);var n=new K(ge.fromString(e)),r=t.Fo.next();t.Co.set(r,new $L(n)),t.Do=t.Do.insert(n,r),_h(t.remoteStore,new mh($n(gu(n.path)),r,2,Jt.o))}}function Xr(t,e,n){return A(this,void 0,void 0,function(){var r,o,s,u;return C(this,function(l){switch(l.label){case 0:return r=j(t),o=[],s=[],u=[],r.Po.isEmpty()?[3,3]:(r.Po.forEach(function(h,d){u.push(r.Oo(d,e,n).then(function(p){if(p){r.isPrimaryClient&&r.sharedClientState.updateQueryState(d.targetId,p.fromCache?"not-current":"current"),o.push(p);var g=lL.Pn(d.targetId,p);s.push(g)}}))}),[4,Promise.all(u)]);case 1:return l.sent(),r.vo._r(o),[4,function(h,d){return A(this,void 0,void 0,function(){var p,g,y,w,b,E,T,k,O;return C(this,function(M){switch(M.label){case 0:p=j(h),M.label=1;case 1:return M.trys.push([1,3,,4]),[4,p.persistence.runTransaction("notifyLocalViewChanges","readwrite",function(H){return x.forEach(d,function(X){return x.forEach(X.bn,function(F){return p.persistence.referenceDelegate.addReference(H,X.targetId,F)}).next(function(){return x.forEach(X.vn,function(F){return p.persistence.referenceDelegate.removeReference(H,X.targetId,F)})})})})];case 2:return M.sent(),[3,4];case 3:if(!Zi(g=M.sent()))throw g;return U("LocalStore","Failed to update sequence numbers: "+g),[3,4];case 4:for(y=0,w=d;y<w.length;y++)b=w[y],E=b.targetId,b.fromCache||(T=p.kn.get(E),k=T.snapshotVersion,O=T.withLastLimboFreeSnapshotVersion(k),p.kn=p.kn.insert(E,O));return[2]}})})}(r.localStore,s)];case 2:l.sent(),l.label=3;case 3:return[2]}})})}function iM(t,e){return A(this,void 0,void 0,function(){var n,r;return C(this,function(o){switch(o.label){case 0:return(n=j(t)).currentUser.isEqual(e)?[3,3]:(U("SyncEngine","User change. New user:",e.toKey()),[4,qS(n.localStore,e)]);case 1:return r=o.sent(),n.currentUser=e,function(s,u){s.ko.forEach(function(l){l.forEach(function(h){h.reject(new P(N.CANCELLED,"'waitForPendingWrites' promise is rejected due to a user change."))})}),s.ko.clear()}(n),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),[4,Xr(n,r.Ln)];case 2:o.sent(),o.label=3;case 3:return[2]}})})}function oM(t,e){var n=j(t),r=n.Co.get(e);if(r&&r.bo)return Te().add(r.key);var o=Te(),s=n.Vo.get(e);if(!s)return o;for(var u=0,l=s;u<l.length;u++){var h=l[u],d=n.Po.get(h);o=o.unionWith(d.view.wo)}return o}function sM(t,e){return A(this,void 0,void 0,function(){var n,r,o;return C(this,function(s){switch(s.label){case 0:return[4,Al((n=j(t)).localStore,e.query,!0)];case 1:return r=s.sent(),o=e.view.Ao(r),[2,(n.isPrimaryClient&&Dv(n,e.targetId,o.To),o)]}})})}function aM(t){return A(this,void 0,void 0,function(){var e;return C(this,function(n){return[2,HS((e=j(t)).localStore).then(function(r){return Xr(e,r)})]})})}function uM(t,e,n,r){return A(this,void 0,void 0,function(){var o,s;return C(this,function(u){switch(u.label){case 0:return[4,function(l,h){var d=j(l),p=j(d._n);return d.persistence.runTransaction("Lookup mutation documents","readonly",function(g){return p.jt(g,h).next(function(y){return y?d.Mn.pn(g,y):x.resolve(null)})})}((o=j(t)).localStore,e)];case 1:return(s=u.sent())===null?[3,6]:n!=="pending"?[3,3]:[4,bs(o.remoteStore)];case 2:return u.sent(),[3,4];case 3:n==="acknowledged"||n==="rejected"?(cm(o,e,r||null),um(o,e),function(l,h){j(j(l)._n).Gt(h)}(o.localStore,e)):W(),u.label=4;case 4:return[4,Xr(o,s)];case 5:return u.sent(),[3,7];case 6:U("SyncEngine","Cannot apply mutation batch with id: "+e),u.label=7;case 7:return[2]}})})}function cM(t,e){return A(this,void 0,void 0,function(){var n,r,o,s,u,l,h,d;return C(this,function(p){switch(p.label){case 0:return hm(n=j(t)),fm(n),e!==!0||n.$o===!0?[3,3]:(r=n.sharedClientState.getAllActiveQueryTargets(),[4,fI(n,r.toArray())]);case 1:return o=p.sent(),n.$o=!0,[4,Rv(n.remoteStore,!0)];case 2:for(p.sent(),s=0,u=o;s<u.length;s++)l=u[s],_h(n.remoteStore,l);return[3,7];case 3:return e!==!1||n.$o===!1?[3,7]:(h=[],d=Promise.resolve(),n.Vo.forEach(function(g,y){n.sharedClientState.isLocalQueryTarget(y)?h.push(y):d=d.then(function(){return ss(n,y),os(n.localStore,y,!0)}),Ya(n.remoteStore,y)}),[4,d]);case 4:return p.sent(),[4,fI(n,h)];case 5:return p.sent(),function(g){var y=j(g);y.Co.forEach(function(w,b){Ya(y.remoteStore,b)}),y.No.ts(),y.Co=new Map,y.Do=new bt(K.comparator)}(n),n.$o=!1,[4,Rv(n.remoteStore,!1)];case 6:p.sent(),p.label=7;case 7:return[2]}})})}function fI(t,e,n){return A(this,void 0,void 0,function(){var r,o,s,u,l,h,d,p,g,y,w,b,E,T;return C(this,function(k){switch(k.label){case 0:r=j(t),o=[],s=[],u=0,l=e,k.label=1;case 1:return u<l.length?(h=l[u],d=void 0,(p=r.Vo.get(h))&&p.length!==0?[4,Cl(r.localStore,$n(p[0]))]:[3,7]):[3,13];case 2:d=k.sent(),g=0,y=p,k.label=3;case 3:return g<y.length?(w=y[g],b=r.Po.get(w),[4,sM(r,b)]):[3,6];case 4:(E=k.sent()).snapshot&&s.push(E.snapshot),k.label=5;case 5:return g++,[3,3];case 6:return[3,11];case 7:return[4,WS(r.localStore,h)];case 8:return T=k.sent(),[4,Cl(r.localStore,T)];case 9:return d=k.sent(),[4,am(r,sC(T),h,!1)];case 10:k.sent(),k.label=11;case 11:o.push(d),k.label=12;case 12:return u++,[3,1];case 13:return[2,(r.vo._r(s),o)]}})})}function sC(t){return rS(t.path,t.collectionGroup,t.orderBy,t.filters,t.limit,"F",t.startAt,t.endAt)}function lM(t){var e=j(t);return j(j(e.localStore).persistence).fn()}function hM(t,e,n,r){return A(this,void 0,void 0,function(){var o,s,u;return C(this,function(l){switch(l.label){case 0:return(o=j(t)).$o?(U("SyncEngine","Ignoring unexpected query state notification."),[3,8]):[3,1];case 1:if(!o.Vo.has(e))return[3,8];switch(n){case"current":case"not-current":return[3,2];case"rejected":return[3,5]}return[3,7];case 2:return[4,HS(o.localStore)];case 3:return s=l.sent(),u=Wg.createSynthesizedRemoteEventForCurrentChange(e,n==="current"),[4,Xr(o,s,u)];case 4:return l.sent(),[3,8];case 5:return[4,os(o.localStore,e,!0)];case 6:return l.sent(),ss(o,e,r),[3,8];case 7:W(),l.label=8;case 8:return[2]}})})}function fM(t,e,n){return A(this,void 0,void 0,function(){var r,o,s,u,l,h,d,p,g,y;return C(this,function(w){switch(w.label){case 0:if(!(r=hm(t)).$o)return[3,10];o=0,s=e,w.label=1;case 1:return o<s.length?(u=s[o],r.Vo.has(u)?(U("SyncEngine","Adding an already active target "+u),[3,5]):[4,WS(r.localStore,u)]):[3,6];case 2:return l=w.sent(),[4,Cl(r.localStore,l)];case 3:return h=w.sent(),[4,am(r,sC(l),h.targetId,!1)];case 4:w.sent(),_h(r.remoteStore,h),w.label=5;case 5:return o++,[3,1];case 6:d=function(b){return C(this,function(E){switch(E.label){case 0:return r.Vo.has(b)?[4,os(r.localStore,b,!1).then(function(){Ya(r.remoteStore,b),ss(r,b)}).catch(eo)]:[3,2];case 1:E.sent(),E.label=2;case 2:return[2]}})},p=0,g=n,w.label=7;case 7:return p<g.length?(y=g[p],[5,d(y)]):[3,10];case 8:w.sent(),w.label=9;case 9:return p++,[3,7];case 10:return[2]}})})}function hm(t){var e=j(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=iC.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=oM.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=ZL.bind(null,e),e.vo._r=HL.bind(null,e.eventManager),e.vo.Mo=KL.bind(null,e.eventManager),e}function fm(t){var e=j(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=eM.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=tM.bind(null,e),e}var aC=function(){function t(){this.synchronizeTabs=!1}return t.prototype.initialize=function(e){return A(this,void 0,void 0,function(){return C(this,function(n){switch(n.label){case 0:return this.R=yh(e.databaseInfo.databaseId),this.sharedClientState=this.Bo(e),this.persistence=this.qo(e),[4,this.persistence.start()];case 1:return n.sent(),this.gcScheduler=this.Uo(e),this.localStore=this.Ko(e),[2]}})})},t.prototype.Uo=function(e){return null},t.prototype.Ko=function(e){return BS(this.persistence,new jS,e.initialUser,this.R)},t.prototype.qo=function(e){return new IL(TL.bs,this.R)},t.prototype.Bo=function(e){return new KS},t.prototype.terminate=function(){return A(this,void 0,void 0,function(){return C(this,function(e){switch(e.label){case 0:return this.gcScheduler&&this.gcScheduler.stop(),[4,this.sharedClientState.shutdown()];case 1:return e.sent(),[4,this.persistence.shutdown()];case 2:return e.sent(),[2]}})})},t}(),uC=function(t){function e(n,r,o){var s=this;return(s=t.call(this)||this).Qo=n,s.cacheSizeBytes=r,s.forceOwnership=o,s.synchronizeTabs=!1,s}return V(e,t),e.prototype.initialize=function(n){return A(this,void 0,void 0,function(){var r=this;return C(this,function(o){switch(o.label){case 0:return[4,t.prototype.initialize.call(this,n)];case 1:return o.sent(),[4,gL(this.localStore)];case 2:return o.sent(),[4,this.Qo.initialize(this,n)];case 3:return o.sent(),[4,fm(this.Qo.syncEngine)];case 4:return o.sent(),[4,bs(this.Qo.remoteStore)];case 5:return o.sent(),[4,this.persistence.He(function(){return r.gcScheduler&&!r.gcScheduler.started&&r.gcScheduler.start(r.localStore),Promise.resolve()})];case 6:return o.sent(),[2]}})})},e.prototype.Ko=function(n){return BS(this.persistence,new jS,n.initialUser,this.R)},e.prototype.Uo=function(n){var r=this.persistence.referenceDelegate.garbageCollector;return new rL(r,n.asyncQueue)},e.prototype.qo=function(n){var r=Xg(n.databaseInfo.databaseId,n.databaseInfo.persistenceKey),o=this.cacheSizeBytes!==void 0?Bn.withCacheSize(this.cacheSizeBytes):Bn.DEFAULT;return new cL(this.synchronizeTabs,r,n.clientId,o,n.asyncQueue,zS(),rl(),this.R,this.sharedClientState,!!this.forceOwnership)},e.prototype.Bo=function(n){return new KS},e}(aC),dM=function(t){function e(n,r){var o=this;return(o=t.call(this,n,r,!1)||this).Qo=n,o.cacheSizeBytes=r,o.synchronizeTabs=!0,o}return V(e,t),e.prototype.initialize=function(n){return A(this,void 0,void 0,function(){var r,o=this;return C(this,function(s){switch(s.label){case 0:return[4,t.prototype.initialize.call(this,n)];case 1:return s.sent(),r=this.Qo.syncEngine,this.sharedClientState instanceof $p?(this.sharedClientState.syncEngine={ui:uM.bind(null,r),ai:hM.bind(null,r),hi:fM.bind(null,r),fn:lM.bind(null,r),ci:aM.bind(null,r)},[4,this.sharedClientState.start()]):[3,3];case 2:s.sent(),s.label=3;case 3:return[4,this.persistence.He(function(u){return A(o,void 0,void 0,function(){return C(this,function(l){switch(l.label){case 0:return[4,cM(this.Qo.syncEngine,u)];case 1:return l.sent(),this.gcScheduler&&(u&&!this.gcScheduler.started?this.gcScheduler.start(this.localStore):u||this.gcScheduler.stop()),[2]}})})})];case 4:return s.sent(),[2]}})})},e.prototype.Bo=function(n){var r=zS();if(!$p.yt(r))throw new P(N.UNIMPLEMENTED,"IndexedDB persistence is only available on platforms that support LocalStorage.");var o=Xg(n.databaseInfo.databaseId,n.databaseInfo.persistenceKey);return new $p(r,n.asyncQueue,o,n.clientId,n.initialUser)},e}(uC),Ov=function(){function t(){}return t.prototype.initialize=function(e,n){return A(this,void 0,void 0,function(){var r=this;return C(this,function(o){switch(o.label){case 0:return this.localStore?[3,2]:(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=function(s){return hI(r.syncEngine,s,1)},this.remoteStore.remoteSyncer.handleCredentialChange=iM.bind(null,this.syncEngine),[4,Rv(this.remoteStore,this.syncEngine.isPrimaryClient)]);case 1:o.sent(),o.label=2;case 2:return[2]}})})},t.prototype.createEventManager=function(e){return new WL},t.prototype.createDatastore=function(e){var n,r=yh(e.databaseInfo.databaseId),o=(n=e.databaseInfo,new NL(n));return function(s,u,l){return new OL(s,u,l)}(e.credentials,o,r)},t.prototype.createRemoteStore=function(e){var n,r,o,s,u,l=this;return n=this.localStore,r=this.datastore,o=e.asyncQueue,s=function(h){return hI(l.syncEngine,h,0)},u=cI.yt()?new cI:new CL,new xL(n,r,o,s,u)},t.prototype.createSyncEngine=function(e,n){return function(r,o,s,u,l,h,d){var p=new QL(r,o,s,u,l,h);return d&&(p.$o=!0),p}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)},t.prototype.terminate=function(){return function(e){return A(this,void 0,void 0,function(){var n;return C(this,function(r){switch(r.label){case 0:return n=j(e),U("RemoteStore","RemoteStore shutting down."),n.Or.add(5),[4,ws(n)];case 1:return r.sent(),n.Lr.shutdown(),n.Br.set("Unknown"),[2]}})})}(this.remoteStore)},t}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wh=function(){function t(e){this.observer=e,this.muted=!1}return t.prototype.next=function(e){this.observer.next&&this.jo(this.observer.next,e)},t.prototype.error=function(e){this.observer.error?this.jo(this.observer.error,e):console.error("Uncaught Error in snapshot listener:",e)},t.prototype.Wo=function(){this.muted=!0},t.prototype.jo=function(e,n){var r=this;this.muted||setTimeout(function(){r.muted||e(n)},0)},t}(),pM=function(){function t(e){this.datastore=e,this.readVersions=new Map,this.mutations=[],this.committed=!1,this.lastWriteError=null,this.writtenDocs=new Set}return t.prototype.lookup=function(e){return A(this,void 0,void 0,function(){var n,r=this;return C(this,function(o){switch(o.label){case 0:if(this.ensureCommitNotCalled(),this.mutations.length>0)throw new P(N.INVALID_ARGUMENT,"Firestore transactions require all reads to be executed before all writes.");return[4,function(s,u){return A(this,void 0,void 0,function(){var l,h,d,p,g,y;return C(this,function(w){switch(w.label){case 0:return l=j(s),h=Qa(l.R)+"/documents",d={documents:u.map(function(b){return $a(l.R,b)})},[4,l.$i("BatchGetDocuments",h,d)];case 1:return p=w.sent(),g=new Map,p.forEach(function(b){var E=function(T,k){return"found"in k?function(O,M){Y(!!M.found),M.found.name,M.found.updateTime;var H=cr(O,M.found.name),X=Rt(M.found.updateTime),F=new Xt({mapValue:{fields:M.found.fields}});return wt.newFoundDocument(H,X,F)}(T,k):"missing"in k?function(O,M){Y(!!M.missing),Y(!!M.readTime);var H=cr(O,M.missing),X=Rt(M.readTime);return wt.newNoDocument(H,X)}(T,k):W()}(l.R,b);g.set(E.key.toString(),E)}),y=[],[2,(u.forEach(function(b){var E=g.get(b.toString());Y(!!E),y.push(E)}),y)]}})})}(this.datastore,e)];case 1:return[2,((n=o.sent()).forEach(function(s){return r.recordVersion(s)}),n)]}})})},t.prototype.set=function(e,n){this.write(n.toMutation(e,this.precondition(e))),this.writtenDocs.add(e.toString())},t.prototype.update=function(e,n){try{this.write(n.toMutation(e,this.preconditionForUpdate(e)))}catch(r){this.lastWriteError=r}this.writtenDocs.add(e.toString())},t.prototype.delete=function(e){this.write(new bu(e,this.precondition(e))),this.writtenDocs.add(e.toString())},t.prototype.commit=function(){return A(this,void 0,void 0,function(){var e,n=this;return C(this,function(r){switch(r.label){case 0:if(this.ensureCommitNotCalled(),this.lastWriteError)throw this.lastWriteError;return e=this.readVersions,this.mutations.forEach(function(o){e.delete(o.key.toString())}),e.forEach(function(o,s){var u=K.fromPath(s);n.mutations.push(new Gg(u,n.precondition(u)))}),[4,function(o,s){return A(this,void 0,void 0,function(){var u,l,h;return C(this,function(d){switch(d.label){case 0:return u=j(o),l=Qa(u.R)+"/documents",h={writes:s.map(function(p){return El(u.R,p)})},[4,u.Ni("Commit",l,h)];case 1:return d.sent(),[2]}})})}(this.datastore,this.mutations)];case 1:return r.sent(),this.committed=!0,[2]}})})},t.prototype.recordVersion=function(e){var n;if(e.isFoundDocument())n=e.version;else{if(!e.isNoDocument())throw W();n=se.min()}var r=this.readVersions.get(e.key.toString());if(r){if(!n.isEqual(r))throw new P(N.ABORTED,"Document version changed between two reads.")}else this.readVersions.set(e.key.toString(),n)},t.prototype.precondition=function(e){var n=this.readVersions.get(e.toString());return!this.writtenDocs.has(e.toString())&&n?mt.updateTime(n):mt.none()},t.prototype.preconditionForUpdate=function(e){var n=this.readVersions.get(e.toString());if(!this.writtenDocs.has(e.toString())&&n){if(n.isEqual(se.min()))throw new P(N.INVALID_ARGUMENT,"Can't update a document that doesn't exist.");return mt.updateTime(n)}return mt.exists(!0)},t.prototype.write=function(e){this.ensureCommitNotCalled(),this.mutations.push(e)},t.prototype.ensureCommitNotCalled=function(){},t}(),vM=function(){function t(e,n,r,o){this.asyncQueue=e,this.datastore=n,this.updateFunction=r,this.deferred=o,this.ec=5,this.Zi=new Zg(this.asyncQueue,"transaction_retry")}return t.prototype.run=function(){this.ec-=1,this.nc()},t.prototype.nc=function(){var e=this;this.Zi.ji(function(){return A(e,void 0,void 0,function(){var n,r,o=this;return C(this,function(s){return n=new pM(this.datastore),(r=this.sc(n))&&r.then(function(u){o.asyncQueue.enqueueAndForget(function(){return n.commit().then(function(){o.deferred.resolve(u)}).catch(function(l){o.ic(l)})})}).catch(function(u){o.ic(u)}),[2]})})})},t.prototype.sc=function(e){try{var n=this.updateFunction(e);return!Ji(n)&&n.catch&&n.then?n:(this.deferred.reject(Error("Transaction callback must return a Promise")),null)}catch(r){return this.deferred.reject(r),null}},t.prototype.ic=function(e){var n=this;this.ec>0&&this.rc(e)?(this.ec-=1,this.asyncQueue.enqueueAndForget(function(){return n.nc(),Promise.resolve()})):this.deferred.reject(e)},t.prototype.rc=function(e){if(e.name==="FirebaseError"){var n=e.code;return n==="aborted"||n==="failed-precondition"||!vS(n)}return!1},t}(),gM=function(){function t(e,n,r){var o=this;this.credentials=e,this.asyncQueue=n,this.databaseInfo=r,this.user=ot.UNAUTHENTICATED,this.clientId=QT.u(),this.credentialListener=function(){return Promise.resolve()},this.credentials.setChangeListener(n,function(s){return A(o,void 0,void 0,function(){return C(this,function(u){switch(u.label){case 0:return U("FirestoreClient","Received user=",s.uid),[4,this.credentialListener(s)];case 1:return u.sent(),this.user=s,[2]}})})})}return t.prototype.getConfiguration=function(){return A(this,void 0,void 0,function(){return C(this,function(e){return[2,{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,credentials:this.credentials,initialUser:this.user,maxConcurrentLimboResolutions:100}]})})},t.prototype.setCredentialChangeListener=function(e){this.credentialListener=e},t.prototype.verifyNotTerminated=function(){if(this.asyncQueue.isShuttingDown)throw new P(N.FAILED_PRECONDITION,"The client has already been terminated.")},t.prototype.terminate=function(){var e=this;this.asyncQueue.enterRestrictedMode();var n=new Gt;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(function(){return A(e,void 0,void 0,function(){var r,o;return C(this,function(s){switch(s.label){case 0:return s.trys.push([0,5,,6]),this.onlineComponents?[4,this.onlineComponents.terminate()]:[3,2];case 1:s.sent(),s.label=2;case 2:return this.offlineComponents?[4,this.offlineComponents.terminate()]:[3,4];case 3:s.sent(),s.label=4;case 4:return this.credentials.removeChangeListener(),n.resolve(),[3,6];case 5:return r=s.sent(),o=Es(r,"Failed to shutdown persistence"),n.reject(o),[3,6];case 6:return[2]}})})}),n.promise},t}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cC(t,e){return A(this,void 0,void 0,function(){var n,r,o=this;return C(this,function(s){switch(s.label){case 0:return t.asyncQueue.verifyOperationInProgress(),U("FirestoreClient","Initializing OfflineComponentProvider"),[4,t.getConfiguration()];case 1:return n=s.sent(),[4,e.initialize(n)];case 2:return s.sent(),r=n.initialUser,t.setCredentialChangeListener(function(u){return A(o,void 0,void 0,function(){return C(this,function(l){switch(l.label){case 0:return r.isEqual(u)?[3,2]:[4,qS(e.localStore,u)];case 1:l.sent(),r=u,l.label=2;case 2:return[2]}})})}),e.persistence.setDatabaseDeletedListener(function(){return t.terminate()}),t.offlineComponents=e,[2]}})})}function lC(t,e){return A(this,void 0,void 0,function(){var n,r;return C(this,function(o){switch(o.label){case 0:return t.asyncQueue.verifyOperationInProgress(),[4,dm(t)];case 1:return n=o.sent(),U("FirestoreClient","Initializing OnlineComponentProvider"),[4,t.getConfiguration()];case 2:return r=o.sent(),[4,e.initialize(n,r)];case 3:return o.sent(),t.setCredentialChangeListener(function(s){return function(u,l){return A(this,void 0,void 0,function(){var h,d;return C(this,function(p){switch(p.label){case 0:return(h=j(u)).asyncQueue.verifyOperationInProgress(),U("RemoteStore","RemoteStore received new credentials"),d=Yr(h),h.Or.add(3),[4,ws(h)];case 1:return p.sent(),d&&h.Br.set("Unknown"),[4,h.remoteSyncer.handleCredentialChange(l)];case 2:return p.sent(),h.Or.delete(3),[4,Iu(h)];case 3:return p.sent(),[2]}})})}(e.remoteStore,s)}),t.onlineComponents=e,[2]}})})}function dm(t){return A(this,void 0,void 0,function(){return C(this,function(e){switch(e.label){case 0:return t.offlineComponents?[3,2]:(U("FirestoreClient","Using default OfflineComponentProvider"),[4,cC(t,new aC)]);case 1:e.sent(),e.label=2;case 2:return[2,t.offlineComponents]}})})}function bh(t){return A(this,void 0,void 0,function(){return C(this,function(e){switch(e.label){case 0:return t.onlineComponents?[3,2]:(U("FirestoreClient","Using default OnlineComponentProvider"),[4,lC(t,new Ov)]);case 1:e.sent(),e.label=2;case 2:return[2,t.onlineComponents]}})})}function dI(t){return dm(t).then(function(e){return e.persistence})}function hC(t){return dm(t).then(function(e){return e.localStore})}function pI(t){return bh(t).then(function(e){return e.remoteStore})}function fC(t){return bh(t).then(function(e){return e.syncEngine})}function as(t){return A(this,void 0,void 0,function(){var e,n;return C(this,function(r){switch(r.label){case 0:return[4,bh(t)];case 1:return e=r.sent(),[2,((n=e.eventManager).onListen=YL.bind(null,e.syncEngine),n.onUnlisten=XL.bind(null,e.syncEngine),n)]}})})}function vI(t,e,n){var r=this;n===void 0&&(n={});var o=new Gt;return t.asyncQueue.enqueueAndForget(function(){return A(r,void 0,void 0,function(){var s;return C(this,function(u){switch(u.label){case 0:return s=function(l,h,d,p,g){var y=new wh({next:function(b){h.enqueueAndForget(function(){return im(l,w)});var E=b.docs.has(d);!E&&b.fromCache?g.reject(new P(N.UNAVAILABLE,"Failed to get document because the client is offline.")):E&&b.fromCache&&p&&p.source==="server"?g.reject(new P(N.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):g.resolve(b)},error:function(b){return g.reject(b)}}),w=new sm(gu(d.path),y,{includeMetadataChanges:!0,so:!0});return rm(l,w)},[4,as(t)];case 1:return[2,s.apply(void 0,[u.sent(),t.asyncQueue,e,n,o])]}})})}),o.promise}function gI(t,e,n){var r=this;n===void 0&&(n={});var o=new Gt;return t.asyncQueue.enqueueAndForget(function(){return A(r,void 0,void 0,function(){var s;return C(this,function(u){switch(u.label){case 0:return s=function(l,h,d,p,g){var y=new wh({next:function(b){h.enqueueAndForget(function(){return im(l,w)}),b.fromCache&&p.source==="server"?g.reject(new P(N.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):g.resolve(b)},error:function(b){return g.reject(b)}}),w=new sm(d,y,{includeMetadataChanges:!0,so:!0});return rm(l,w)},[4,as(t)];case 1:return[2,s.apply(void 0,[u.sent(),t.asyncQueue,e,n,o])]}})})}),o.promise}var mM=function(t,e,n,r,o,s,u,l){this.databaseId=t,this.appId=e,this.persistenceKey=n,this.host=r,this.ssl=o,this.forceLongPolling=s,this.autoDetectLongPolling=u,this.useFetchStreams=l},Rl=function(){function t(e,n){this.projectId=e,this.database=n||"(default)"}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return this.database==="(default)"},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t}(),mI=new Map,dC=function(t,e){this.user=e,this.type="OAuth",this.authHeaders={},this.authHeaders.Authorization="Bearer "+t},yI=function(){function t(){this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(null)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(e,n){this.changeListener=n,e.enqueueRetryable(function(){return n(ot.UNAUTHENTICATED)})},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),yM=function(){function t(e){this.token=e,this.changeListener=null}return t.prototype.getToken=function(){return Promise.resolve(this.token)},t.prototype.invalidateToken=function(){},t.prototype.setChangeListener=function(e,n){var r=this;this.changeListener=n,e.enqueueRetryable(function(){return n(r.token.user)})},t.prototype.removeChangeListener=function(){this.changeListener=null},t}(),_M=function(){function t(e){var n=this;this.currentUser=ot.UNAUTHENTICATED,this.oc=new Gt,this.cc=0,this.forceRefresh=!1,this.auth=null,this.asyncQueue=null,this.uc=function(){n.cc++,n.currentUser=n.ac(),n.oc.resolve(),n.changeListener&&n.asyncQueue.enqueueRetryable(function(){return n.changeListener(n.currentUser)})};var r=function(o){U("FirebaseCredentialsProvider","Auth detected"),n.auth=o,n.auth.addAuthTokenListener(n.uc)};e.onInit(function(o){return r(o)}),setTimeout(function(){if(!n.auth){var o=e.getImmediate({optional:!0});o?r(o):(U("FirebaseCredentialsProvider","Auth not yet detected"),n.oc.resolve())}},0)}return t.prototype.getToken=function(){var e=this,n=this.cc,r=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(r).then(function(o){return e.cc!==n?(U("FirebaseCredentialsProvider","getToken aborted due to token change."),e.getToken()):o?(Y(typeof o.accessToken=="string"),new dC(o.accessToken,e.currentUser)):null}):Promise.resolve(null)},t.prototype.invalidateToken=function(){this.forceRefresh=!0},t.prototype.setChangeListener=function(e,n){var r=this;this.asyncQueue=e,this.asyncQueue.enqueueRetryable(function(){return A(r,void 0,void 0,function(){return C(this,function(o){switch(o.label){case 0:return[4,this.oc.promise];case 1:return o.sent(),[4,n(this.currentUser)];case 2:return o.sent(),this.changeListener=n,[2]}})})})},t.prototype.removeChangeListener=function(){this.auth&&this.auth.removeAuthTokenListener(this.uc),this.changeListener=function(){return Promise.resolve()}},t.prototype.ac=function(){var e=this.auth&&this.auth.getUid();return Y(e===null||typeof e=="string"),new ot(e)},t}(),wM=function(){function t(e,n,r){this.hc=e,this.lc=n,this.fc=r,this.type="FirstParty",this.user=ot.FIRST_PARTY}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){var e={"X-Goog-AuthUser":this.lc},n=this.hc.auth.getAuthHeaderValueForFirstParty([]);return n&&(e.Authorization=n),this.fc&&(e["X-Goog-Iam-Authorization-Token"]=this.fc),e},enumerable:!1,configurable:!0}),t}(),bM=function(){function t(e,n,r){this.hc=e,this.lc=n,this.fc=r}return t.prototype.getToken=function(){return Promise.resolve(new wM(this.hc,this.lc,this.fc))},t.prototype.setChangeListener=function(e,n){e.enqueueRetryable(function(){return n(ot.FIRST_PARTY)})},t.prototype.removeChangeListener=function(){},t.prototype.invalidateToken=function(){},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function pm(t,e,n){if(!n)throw new P(N.INVALID_ARGUMENT,"Function "+t+"() cannot be called with an empty "+e+".")}function vm(t,e){if(e===void 0)return{merge:!1};if(e.mergeFields!==void 0&&e.merge!==void 0)throw new P(N.INVALID_ARGUMENT,"Invalid options passed to function "+t+'(): You cannot specify both "merge" and "mergeFields".');return e}function pC(t,e,n,r){if(e===!0&&r===!0)throw new P(N.INVALID_ARGUMENT,t+" and "+n+" cannot be used together.")}function _I(t){if(!K.isDocumentKey(t))throw new P(N.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+t+" has "+t.length+".")}function wI(t){if(K.isDocumentKey(t))throw new P(N.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+t+" has "+t.length+".")}function Ih(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";var e=function(n){if(n.constructor){var r=/function\s+([^\s(]+)\s*\(/.exec(n.constructor.toString());if(r&&r.length>1)return r[1]}return null}(t);return e?"a custom "+e+" object":"an object"}return typeof t=="function"?"a function":W()}function ye(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new P(N.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");var n=Ih(t);throw new P(N.INVALID_ARGUMENT,"Expected type '"+e.name+"', but it was: "+n)}return t}function bI(t,e){if(e<=0)throw new P(N.INVALID_ARGUMENT,"Function "+t+"() requires a positive number, but it was: "+e+".")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var II=function(){function t(e){var n;if(e.host===void 0){if(e.ssl!==void 0)throw new P(N.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host="firestore.googleapis.com",this.ssl=!0}else this.host=e.host,this.ssl=(n=e.ssl)===null||n===void 0||n;if(this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,e.cacheSizeBytes===void 0)this.cacheSizeBytes=41943040;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<1048576)throw new P(N.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.useFetchStreams=!!e.useFetchStreams,pC("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling)}return t.prototype.isEqual=function(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams},t}(),Xa=function(){function t(e,n){this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new II({}),this._settingsFrozen=!1,e instanceof Rl?(this._databaseId=e,this._credentials=new yI):(this._app=e,this._databaseId=function(r){if(!Object.prototype.hasOwnProperty.apply(r.options,["projectId"]))throw new P(N.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new Rl(r.options.projectId)}(e),this._credentials=new _M(n))}return Object.defineProperty(t.prototype,"app",{get:function(){if(!this._app)throw new P(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_initialized",{get:function(){return this._settingsFrozen},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_terminated",{get:function(){return this._terminateTask!==void 0},enumerable:!1,configurable:!0}),t.prototype._setSettings=function(e){if(this._settingsFrozen)throw new P(N.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new II(e),e.credentials!==void 0&&(this._credentials=function(n){if(!n)return new yI;switch(n.type){case"gapi":var r=n.client;return Y(!(typeof r!="object"||r===null||!r.auth||!r.auth.getAuthHeaderValueForFirstParty)),new bM(r,n.sessionIndex||"0",n.iamToken||null);case"provider":return n.client;default:throw new P(N.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}(e.credentials))},t.prototype._getSettings=function(){return this._settings},t.prototype._freezeSettings=function(){return this._settingsFrozen=!0,this._settings},t.prototype._delete=function(){return this._terminateTask||(this._terminateTask=this._terminate()),this._terminateTask},t.prototype.toJSON=function(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}},t.prototype._terminate=function(){return e=this,(n=mI.get(e))&&(U("ComponentProvider","Removing Datastore"),mI.delete(e),n.terminate()),Promise.resolve();var e,n},t}(),Pe=function(){function t(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}return Object.defineProperty(t.prototype,"_path",{get:function(){return this._key.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Ur(this.firestore,this.converter,this._key.path.popLast())},enumerable:!1,configurable:!0}),t.prototype.withConverter=function(e){return new t(this.firestore,e,this._key)},t}(),en=function(){function t(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}return t.prototype.withConverter=function(e){return new t(this.firestore,e,this._query)},t}(),Ur=function(t){function e(n,r,o){var s=this;return(s=t.call(this,n,r,gu(o))||this)._path=o,s.type="collection",s}return V(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var n=this._path.popLast();return n.isEmpty()?null:new Pe(this.firestore,null,new K(n))},enumerable:!1,configurable:!0}),e.prototype.withConverter=function(n){return new e(this.firestore,n,this._path)},e}(en);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vC(t,e){for(var n,r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];if(t=re(t),pm("collection","path",e),t instanceof Xa)return wI(n=ge.fromString.apply(ge,ve([e],r))),new Ur(t,null,n);if(!(t instanceof Pe||t instanceof Ur))throw new P(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return wI(n=ge.fromString.apply(ge,ve([t.path],r)).child(ge.fromString(e))),new Ur(t.firestore,null,n)}function il(t,e){for(var n,r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];if(t=re(t),arguments.length===1&&(e=QT.u()),pm("doc","path",e),t instanceof Xa)return _I(n=ge.fromString.apply(ge,ve([e],r))),new Pe(t,null,new K(n));if(!(t instanceof Pe||t instanceof Ur))throw new P(N.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");return _I(n=t._path.child(ge.fromString.apply(ge,ve([e],r)))),new Pe(t.firestore,t instanceof Ur?t.converter:null,new K(n))}function gC(t,e){return t=re(t),e=re(e),(t instanceof Pe||t instanceof Ur)&&(e instanceof Pe||e instanceof Ur)&&t.firestore===e.firestore&&t.path===e.path&&t.converter===e.converter}function mC(t,e){return t=re(t),e=re(e),t instanceof en&&e instanceof en&&t.firestore===e.firestore&&mu(t._query,e._query)&&t.converter===e.converter}var IM=function(){function t(){var e=this;this.dc=Promise.resolve(),this.wc=[],this._c=!1,this.mc=[],this.yc=null,this.gc=!1,this.Ec=!1,this.Tc=[],this.Zi=new Zg(this,"async_queue_retry"),this.Ic=function(){var r=rl();r&&U("AsyncQueue","Visibility state changed to "+r.visibilityState),e.Zi.Gi()};var n=rl();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.Ic)}return Object.defineProperty(t.prototype,"isShuttingDown",{get:function(){return this._c},enumerable:!1,configurable:!0}),t.prototype.enqueueAndForget=function(e){this.enqueue(e)},t.prototype.enqueueAndForgetEvenWhileRestricted=function(e){this.Ac(),this.Rc(e)},t.prototype.enterRestrictedMode=function(e){if(!this._c){this._c=!0,this.Ec=e||!1;var n=rl();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.Ic)}},t.prototype.enqueue=function(e){var n=this;if(this.Ac(),this._c)return new Promise(function(){});var r=new Gt;return this.Rc(function(){return n._c&&n.Ec?Promise.resolve():(e().then(r.resolve,r.reject),r.promise)}).then(function(){return r.promise})},t.prototype.enqueueRetryable=function(e){var n=this;this.enqueueAndForget(function(){return n.wc.push(e),n.bc()})},t.prototype.bc=function(){return A(this,void 0,void 0,function(){var e,n=this;return C(this,function(r){switch(r.label){case 0:if(this.wc.length===0)return[3,5];r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.wc[0]()];case 2:return r.sent(),this.wc.shift(),this.Zi.reset(),[3,4];case 3:if(!Zi(e=r.sent()))throw e;return U("AsyncQueue","Operation failed with retryable error: "+e),[3,4];case 4:this.wc.length>0&&this.Zi.ji(function(){return n.bc()}),r.label=5;case 5:return[2]}})})},t.prototype.Rc=function(e){var n=this,r=this.dc.then(function(){return n.gc=!0,e().catch(function(o){throw n.yc=o,n.gc=!1,We("INTERNAL UNHANDLED ERROR: ",function(s){var u=s.message||"";return s.stack&&(u=s.stack.includes(s.message)?s.stack:s.message+`
`+s.stack),u}(o)),o}).then(function(o){return n.gc=!1,o})});return this.dc=r,r},t.prototype.enqueueAfterDelay=function(e,n,r){var o=this;this.Ac(),this.Tc.indexOf(e)>-1&&(n=0);var s=qL.createAndSchedule(this,e,n,r,function(u){return o.vc(u)});return this.mc.push(s),s},t.prototype.Ac=function(){this.yc&&W()},t.prototype.verifyOperationInProgress=function(){},t.prototype.Pc=function(){return A(this,void 0,void 0,function(){var e;return C(this,function(n){switch(n.label){case 0:return[4,e=this.dc];case 1:n.sent(),n.label=2;case 2:if(e!==this.dc)return[3,0];n.label=3;case 3:return[2]}})})},t.prototype.Vc=function(e){for(var n=0,r=this.mc;n<r.length;n++)if(r[n].timerId===e)return!0;return!1},t.prototype.Sc=function(e){var n=this;return this.Pc().then(function(){n.mc.sort(function(u,l){return u.targetTimeMs-l.targetTimeMs});for(var r=0,o=n.mc;r<o.length;r++){var s=o[r];if(s.skipDelay(),e!=="all"&&s.timerId===e)break}return n.Pc()})},t.prototype.Dc=function(e){this.Tc.push(e)},t.prototype.vc=function(e){var n=this.mc.indexOf(e);this.mc.splice(n,1)},t}();function us(t){return function(e,n){if(typeof e!="object"||e===null)return!1;for(var r=e,o=0,s=["next","error","complete"];o<s.length;o++){var u=s[o];if(u in r&&typeof r[u]=="function")return!0}return!1}(t)}var EM=-1,Ye=function(t){function e(n,r){var o=this;return(o=t.call(this,n,r)||this).type="firestore",o._queue=new IM,o._persistenceKey="name"in n?n.name:"[DEFAULT]",o}return V(e,t),e.prototype._terminate=function(){return this._firestoreClient||yC(this),this._firestoreClient.terminate()},e}(Xa);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vt(t){return t._firestoreClient||yC(t),t._firestoreClient.verifyNotTerminated(),t._firestoreClient}function yC(t){var e,n=t._freezeSettings(),r=function(o,s,u,l){return new mM(o,s,u,l.host,l.ssl,l.experimentalForceLongPolling,l.experimentalAutoDetectLongPolling,l.useFetchStreams)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,n);t._firestoreClient=new gM(t._credentials,t._queue,r)}function EI(t,e,n){var r=this,o=new Gt;return t.asyncQueue.enqueue(function(){return A(r,void 0,void 0,function(){var s;return C(this,function(u){switch(u.label){case 0:return u.trys.push([0,3,,4]),[4,cC(t,n)];case 1:return u.sent(),[4,lC(t,e)];case 2:return u.sent(),o.resolve(),[3,4];case 3:if(!function(l){return l.name==="FirebaseError"?l.code===N.FAILED_PRECONDITION||l.code===N.UNIMPLEMENTED:!(typeof DOMException<"u"&&l instanceof DOMException)||l.code===22||l.code===20||l.code===11}(s=u.sent()))throw s;return console.warn("Error enabling offline persistence. Falling back to persistence disabled: "+s),o.reject(s),[3,4];case 4:return[2]}})})}).then(function(){return o.promise})}function TI(t){if(t._initialized||t._terminated)throw new P(N.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only enable persistence before calling any other methods on a Firestore object.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gn=function(){function t(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];for(var r=0;r<e.length;++r)if(e[r].length===0)throw new P(N.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Dn(e)}return t.prototype.isEqual=function(e){return this._internalPath.isEqual(e._internalPath)},t}(),Ki=function(){function t(e){this._byteString=e}return t.fromBase64String=function(e){try{return new t(qt.fromBase64String(e))}catch(n){throw new P(N.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}},t.fromUint8Array=function(e){return new t(qt.fromUint8Array(e))},t.prototype.toBase64=function(){return this._byteString.toBase64()},t.prototype.toUint8Array=function(){return this._byteString.toUint8Array()},t.prototype.toString=function(){return"Bytes(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(e){return this._byteString.isEqual(e._byteString)},t}(),to=function(t){this._methodName=t},Eh=function(){function t(e,n){if(!isFinite(e)||e<-90||e>90)throw new P(N.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new P(N.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){return this._lat===e._lat&&this._long===e._long},t.prototype.toJSON=function(){return{latitude:this._lat,longitude:this._long}},t.prototype._compareTo=function(e){return ce(this._lat,e._lat)||ce(this._long,e._long)},t}(),TM=/^__.*__$/,SM=function(){function t(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}return t.prototype.toMutation=function(e,n){return this.fieldMask!==null?new Qr(e,this.data,this.fieldMask,n,this.fieldTransforms):new wu(e,this.data,n,this.fieldTransforms)},t}(),_C=function(){function t(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}return t.prototype.toMutation=function(e,n){return new Qr(e,this.data,this.fieldMask,n,this.fieldTransforms)},t}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wC(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw W()}}var bC=function(){function t(e,n,r,o,s,u){this.settings=e,this.databaseId=n,this.R=r,this.ignoreUndefinedProperties=o,s===void 0&&this.Cc(),this.fieldTransforms=s||[],this.fieldMask=u||[]}return Object.defineProperty(t.prototype,"path",{get:function(){return this.settings.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"Nc",{get:function(){return this.settings.Nc},enumerable:!1,configurable:!0}),t.prototype.xc=function(e){return new t(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.R,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)},t.prototype.kc=function(e){var n,r=(n=this.path)===null||n===void 0?void 0:n.child(e),o=this.xc({path:r,Fc:!1});return o.$c(e),o},t.prototype.Oc=function(e){var n,r=(n=this.path)===null||n===void 0?void 0:n.child(e),o=this.xc({path:r,Fc:!1});return o.Cc(),o},t.prototype.Mc=function(e){return this.xc({path:void 0,Fc:!0})},t.prototype.Lc=function(e){return Dl(e,this.settings.methodName,this.settings.Bc||!1,this.path,this.settings.qc)},t.prototype.contains=function(e){return this.fieldMask.find(function(n){return e.isPrefixOf(n)})!==void 0||this.fieldTransforms.find(function(n){return e.isPrefixOf(n.field)})!==void 0},t.prototype.Cc=function(){if(this.path)for(var e=0;e<this.path.length;e++)this.$c(this.path.get(e))},t.prototype.$c=function(e){if(e.length===0)throw this.Lc("Document fields must not be empty");if(wC(this.Nc)&&TM.test(e))throw this.Lc('Document fields cannot begin and end with "__"')},t}(),CM=function(){function t(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.R=r||yh(e)}return t.prototype.Uc=function(e,n,r,o){return o===void 0&&(o=!1),new bC({Nc:e,methodName:n,qc:r,path:Dn.emptyPath(),Fc:!1,Bc:o},this.databaseId,this.R,this.ignoreUndefinedProperties)},t}();function no(t){var e=t._freezeSettings(),n=yh(t._databaseId);return new CM(t._databaseId,!!e.ignoreUndefinedProperties,n)}function Th(t,e,n,r,o,s){s===void 0&&(s={});var u=t.Uc(s.merge||s.mergeFields?2:0,e,n,o);_m("Data must be an object, but it was:",u,r);var l,h,d=TC(r,u);if(s.merge)l=new $o(u.fieldMask),h=u.fieldTransforms;else if(s.mergeFields){for(var p=[],g=0,y=s.mergeFields;g<y.length;g++){var w=Pv(e,y[g],n);if(!u.contains(w))throw new P(N.INVALID_ARGUMENT,"Field '"+w+"' is specified in your field mask but missing from your input data.");CC(p,w)||p.push(w)}l=new $o(p),h=u.fieldTransforms.filter(function(b){return l.covers(b.field)})}else l=null,h=u.fieldTransforms;return new SM(new Xt(d),l,h)}var gm=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return V(e,t),e.prototype._toFieldTransform=function(n){if(n.Nc!==2)throw n.Nc===1?n.Lc(this._methodName+"() can only appear at the top level of your update data"):n.Lc(this._methodName+"() cannot be used with set() unless you pass {merge:true}");return n.fieldMask.push(n.path),null},e.prototype.isEqual=function(n){return n instanceof e},e}(to);function IC(t,e,n){return new bC({Nc:3,qc:e.settings.qc,methodName:t._methodName,Fc:n},e.databaseId,e.R,e.ignoreUndefinedProperties)}var AM=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return V(e,t),e.prototype._toFieldTransform=function(n){return new _u(n.path,new Jo)},e.prototype.isEqual=function(n){return n instanceof e},e}(to),kM=function(t){function e(n,r){var o=this;return(o=t.call(this,n)||this).Kc=r,o}return V(e,t),e.prototype._toFieldTransform=function(n){var r=IC(this,n,!0),o=this.Kc.map(function(u){return ro(u,r)}),s=new Wi(o);return new _u(n.path,s)},e.prototype.isEqual=function(n){return this===n},e}(to),NM=function(t){function e(n,r){var o=this;return(o=t.call(this,n)||this).Kc=r,o}return V(e,t),e.prototype._toFieldTransform=function(n){var r=IC(this,n,!0),o=this.Kc.map(function(u){return ro(u,r)}),s=new Hi(o);return new _u(n.path,s)},e.prototype.isEqual=function(n){return this===n},e}(to),RM=function(t){function e(n,r){var o=this;return(o=t.call(this,n)||this).Qc=r,o}return V(e,t),e.prototype._toFieldTransform=function(n){var r=new Zo(n.R,cS(n.R,this.Qc));return new _u(n.path,r)},e.prototype.isEqual=function(n){return this===n},e}(to);function mm(t,e,n,r){var o=t.Uc(1,e,n);_m("Data must be an object, but it was:",o,r);var s=[],u=Xt.empty();Xi(r,function(h,d){var p=wm(e,h,n);d=re(d);var g=o.Oc(p);if(d instanceof gm)s.push(p);else{var y=ro(d,g);y!=null&&(s.push(p),u.set(p,y))}});var l=new $o(s);return new _C(u,l,o.fieldTransforms)}function ym(t,e,n,r,o,s){var u=t.Uc(1,e,n),l=[Pv(e,r,n)],h=[o];if(s.length%2!=0)throw new P(N.INVALID_ARGUMENT,"Function "+e+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var d=0;d<s.length;d+=2)l.push(Pv(e,s[d])),h.push(s[d+1]);for(var p=[],g=Xt.empty(),y=l.length-1;y>=0;--y)if(!CC(p,l[y])){var w=l[y],b=h[y];b=re(b);var E=u.Oc(w);if(b instanceof gm)p.push(w);else{var T=ro(b,E);T!=null&&(p.push(w),g.set(w,T))}}var k=new $o(p);return new _C(g,k,u.fieldTransforms)}function EC(t,e,n,r){return r===void 0&&(r=!1),ro(n,t.Uc(r?4:3,e))}function ro(t,e){if(SC(t=re(t)))return _m("Unsupported field value:",e,t),TC(t,e);if(t instanceof to)return function(n,r){if(!wC(r.Nc))throw r.Lc(n._methodName+"() can only be used with update() and set()");if(!r.path)throw r.Lc(n._methodName+"() is not currently supported inside arrays");var o=n._toFieldTransform(r);o&&r.fieldTransforms.push(o)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Fc&&e.Nc!==4)throw e.Lc("Nested arrays are not supported");return function(n,r){for(var o=[],s=0,u=0,l=n;u<l.length;u++){var h=ro(l[u],r.Mc(s));h==null&&(h={nullValue:"NULL_VALUE"}),o.push(h),s++}return{arrayValue:{values:o}}}(t,e)}return function(n,r){if((n=re(n))===null)return{nullValue:"NULL_VALUE"};if(typeof n=="number")return cS(r.R,n);if(typeof n=="boolean")return{booleanValue:n};if(typeof n=="string")return{stringValue:n};if(n instanceof Date){var o=Bt.fromDate(n);return{timestampValue:za(r.R,o)}}if(n instanceof Bt)return o=new Bt(n.seconds,1e3*Math.floor(n.nanoseconds/1e3)),{timestampValue:za(r.R,o)};if(n instanceof Eh)return{geoPointValue:{latitude:n.latitude,longitude:n.longitude}};if(n instanceof Ki)return{bytesValue:_S(r.R,n._byteString)};if(n instanceof Pe){o=r.databaseId;var s=n.firestore._databaseId;if(!s.isEqual(o))throw r.Lc("Document reference is for database "+s.projectId+"/"+s.database+" but should be for database "+o.projectId+"/"+o.database);return{referenceValue:Kg(n.firestore._databaseId||r.databaseId,n._key.path)}}throw r.Lc("Unsupported field value: "+Ih(n))}(t,e)}function TC(t,e){var n={};return XT(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):Xi(t,function(r,o){var s=ro(o,e.kc(r));s!=null&&(n[r]=s)}),{mapValue:{fields:n}}}function SC(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof Bt||t instanceof Eh||t instanceof Ki||t instanceof Pe||t instanceof to)}function _m(t,e,n){if(!SC(n)||!function(o){return typeof o=="object"&&o!==null&&(Object.getPrototypeOf(o)===Object.prototype||Object.getPrototypeOf(o)===null)}(n)){var r=Ih(n);throw r==="an object"?e.Lc(t+" a custom object"):e.Lc(t+" "+r)}}function Pv(t,e,n){if((e=re(e))instanceof Gn)return e._internalPath;if(typeof e=="string")return wm(t,e);throw Dl("Field path arguments must be of type string or FieldPath.",t,!1,void 0,n)}var DM=new RegExp("[~\\*/\\[\\]]");function wm(t,e,n){if(e.search(DM)>=0)throw Dl("Invalid field path ("+e+"). Paths must not contain '~', '*', '/', '[', or ']'",t,!1,void 0,n);try{return new(Gn.bind.apply(Gn,ve([void 0],e.split("."))))()._internalPath}catch{throw Dl("Invalid field path ("+e+"). Paths must not be empty, begin with '.', end with '.', or contain '..'",t,!1,void 0,n)}}function Dl(t,e,n,r,o){var s=r&&!r.isEmpty(),u=o!==void 0,l="Function "+e+"() called with invalid data";n&&(l+=" (via `toFirestore()`)");var h="";return(s||u)&&(h+=" (found",s&&(h+=" in field "+r),u&&(h+=" in document "+o),h+=")"),new P(N.INVALID_ARGUMENT,(l+=". ")+t+h)}function CC(t,e){return t.some(function(n){return n.isEqual(e)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ja=function(){function t(e,n,r,o,s){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=o,this._converter=s}return Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Pe(this._firestore,this._converter,this._key)},enumerable:!1,configurable:!0}),t.prototype.exists=function(){return this._document!==null},t.prototype.data=function(){if(this._document){if(this._converter){var e=new OM(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}},t.prototype.get=function(e){if(this._document){var n=this._document.data.field(Ol("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}},t}(),OM=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return V(e,t),e.prototype.data=function(){return t.prototype.data.call(this)},e}(Ja);function Ol(t,e){return typeof e=="string"?wm(t,e):e instanceof Gn?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ki=function(){function t(e,n){this.hasPendingWrites=e,this.fromCache=n}return t.prototype.isEqual=function(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache},t}(),hr=function(t){function e(n,r,o,s,u,l){var h=this;return(h=t.call(this,n,r,o,s,l)||this)._firestore=n,h._firestoreImpl=n,h.metadata=u,h}return V(e,t),e.prototype.exists=function(){return t.prototype.exists.call(this)},e.prototype.data=function(n){if(n===void 0&&(n={}),this._document){if(this._converter){var r=new Na(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(r,n)}return this._userDataWriter.convertValue(this._document.data.value,n.serverTimestamps)}},e.prototype.get=function(n,r){if(r===void 0&&(r={}),this._document){var o=this._document.data.field(Ol("DocumentSnapshot.get",n));if(o!==null)return this._userDataWriter.convertValue(o,r.serverTimestamps)}},e}(Ja),Na=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return V(e,t),e.prototype.data=function(n){return n===void 0&&(n={}),t.prototype.data.call(this,n)},e}(hr),xr=function(){function t(e,n,r,o){this._firestore=e,this._userDataWriter=n,this._snapshot=o,this.metadata=new ki(o.hasPendingWrites,o.fromCache),this.query=r}return Object.defineProperty(t.prototype,"docs",{get:function(){var e=[];return this.forEach(function(n){return e.push(n)}),e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this.size===0},enumerable:!1,configurable:!0}),t.prototype.forEach=function(e,n){var r=this;this._snapshot.docs.forEach(function(o){e.call(n,new Na(r._firestore,r._userDataWriter,o.key,o,new ki(r._snapshot.mutatedKeys.has(o.key),r._snapshot.fromCache),r.query.converter))})},t.prototype.docChanges=function(e){e===void 0&&(e={});var n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new P(N.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(r,o){if(r._snapshot.oldDocs.isEmpty()){var s=0;return r._snapshot.docChanges.map(function(l){return{type:"added",doc:new Na(r._firestore,r._userDataWriter,l.doc.key,l.doc,new ki(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter),oldIndex:-1,newIndex:s++}})}var u=r._snapshot.oldDocs;return r._snapshot.docChanges.filter(function(l){return o||l.type!==3}).map(function(l){var h=new Na(r._firestore,r._userDataWriter,l.doc.key,l.doc,new ki(r._snapshot.mutatedKeys.has(l.doc.key),r._snapshot.fromCache),r.query.converter),d=-1,p=-1;return l.type!==0&&(d=u.indexOf(l.doc.key),u=u.delete(l.doc.key)),l.type!==1&&(p=(u=u.add(l.doc)).indexOf(l.doc.key)),{type:PM(l.type),doc:h,oldIndex:d,newIndex:p}})}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges},t}();function PM(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return W()}}function AC(t,e){return t instanceof hr&&e instanceof hr?t._firestore===e._firestore&&t._key.isEqual(e._key)&&(t._document===null?e._document===null:t._document.isEqual(e._document))&&t._converter===e._converter:t instanceof xr&&e instanceof xr&&t._firestore===e._firestore&&mC(t.query,e.query)&&t.metadata.isEqual(e.metadata)&&t._snapshot.isEqual(e._snapshot)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kC(t){if(Il(t)&&t.explicitOrderBy.length===0)throw new P(N.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}var Eu=function(){};function Nr(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];for(var r=0,o=e;r<o.length;r++){var s=o[r];t=s._apply(t)}return t}var xM=function(t){function e(n,r,o){var s=this;return(s=t.call(this)||this).jc=n,s.Wc=r,s.Gc=o,s.type="where",s}return V(e,t),e.prototype._apply=function(n){var r=no(n.firestore),o=function(s,u,l,h,d,p,g){var y;if(d.isKeyField()){if(p==="array-contains"||p==="array-contains-any")throw new P(N.INVALID_ARGUMENT,"Invalid Query. You can't perform '"+p+"' queries on FieldPath.documentId().");if(p==="in"||p==="not-in"){NI(g,p);for(var w=[],b=0,E=g;b<E.length;b++){var T=E[b];w.push(kI(h,s,T))}y={arrayValue:{values:w}}}else y=kI(h,s,g)}else p!=="in"&&p!=="not-in"&&p!=="array-contains-any"||NI(g,p),y=EC(l,"where",g,p==="in"||p==="not-in");var k=Zt.create(d,p,y);return function(O,M){if(M.g()){var H=Bg(O);if(H!==null&&!H.isEqual(M.field))throw new P(N.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, !=, not-in, >, or >=) must be on the same field. But you have inequality filters on '"+H.toString()+"' and '"+M.field.toString()+"'");var X=jg(O);X!==null&&RC(O,M.field,X)}var F=function(me,$){for(var Fe=0,S=me.filters;Fe<S.length;Fe++){var Rs=S[Fe];if($.indexOf(Rs.op)>=0)return Rs.op}return null}(O,function(me){switch(me){case"!=":return["!=","not-in"];case"array-contains":return["array-contains","array-contains-any","not-in"];case"in":return["array-contains-any","in","not-in"];case"array-contains-any":return["array-contains","array-contains-any","in","not-in"];case"not-in":return["array-contains","array-contains-any","in","not-in","!="];default:return[]}}(M.op));if(F!==null)throw F===M.op?new P(N.INVALID_ARGUMENT,"Invalid query. You cannot use more than one '"+M.op.toString()+"' filter."):new P(N.INVALID_ARGUMENT,"Invalid query. You cannot use '"+M.op.toString()+"' filters with '"+F.toString()+"' filters.")}(s,k),k}(n._query,0,r,n.firestore._databaseId,this.jc,this.Wc,this.Gc);return new en(n.firestore,n.converter,function(s,u){var l=s.filters.concat([u]);return new gr(s.path,s.collectionGroup,s.explicitOrderBy.slice(),l,s.limit,s.limitType,s.startAt,s.endAt)}(n._query,o))},e}(Eu),LM=function(t){function e(n,r){var o=this;return(o=t.call(this)||this).jc=n,o.zc=r,o.type="orderBy",o}return V(e,t),e.prototype._apply=function(n){var r=function(o,s,u){if(o.startAt!==null)throw new P(N.INVALID_ARGUMENT,"Invalid query. You must not call startAt() or startAfter() before calling orderBy().");if(o.endAt!==null)throw new P(N.INVALID_ARGUMENT,"Invalid query. You must not call endAt() or endBefore() before calling orderBy().");var l=new qo(s,u);return function(h,d){if(jg(h)===null){var p=Bg(h);p!==null&&RC(h,p,d.field)}}(o,l),l}(n._query,this.jc,this.zc);return new en(n.firestore,n.converter,function(o,s){var u=o.explicitOrderBy.concat([s]);return new gr(o.path,o.collectionGroup,u,o.filters.slice(),o.limit,o.limitType,o.startAt,o.endAt)}(n._query,r))},e}(Eu),SI=function(t){function e(n,r,o){var s=this;return(s=t.call(this)||this).type=n,s.Hc=r,s.Jc=o,s}return V(e,t),e.prototype._apply=function(n){return new en(n.firestore,n.converter,iS(n._query,this.Hc,this.Jc))},e}(Eu),CI=function(t){function e(n,r,o){var s=this;return(s=t.call(this)||this).type=n,s.Yc=r,s.Xc=o,s}return V(e,t),e.prototype._apply=function(n){var r=NC(n,this.type,this.Yc,this.Xc);return new en(n.firestore,n.converter,function(o,s){return new gr(o.path,o.collectionGroup,o.explicitOrderBy.slice(),o.filters.slice(),o.limit,o.limitType,s,o.endAt)}(n._query,r))},e}(Eu),AI=function(t){function e(n,r,o){var s=this;return(s=t.call(this)||this).type=n,s.Yc=r,s.Xc=o,s}return V(e,t),e.prototype._apply=function(n){var r=NC(n,this.type,this.Yc,this.Xc);return new en(n.firestore,n.converter,function(o,s){return new gr(o.path,o.collectionGroup,o.explicitOrderBy.slice(),o.filters.slice(),o.limit,o.limitType,o.startAt,s)}(n._query,r))},e}(Eu);function NC(t,e,n,r){if(n[0]=re(n[0]),n[0]instanceof Ja)return function(s,u,l,h,d){if(!h)throw new P(N.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+l+"().");for(var p=[],g=0,y=Xo(s);g<y.length;g++){var w=y[g];if(w.field.isKeyField())p.push(_l(u,h.key));else{var b=h.data.field(w.field);if(Fg(b))throw new P(N.INVALID_ARGUMENT,'Invalid query. You are trying to start or end a query using a document for which the field "'+w.field+'" is an uncommitted server timestamp. (Since the value of this field is unknown, you cannot start/end a query with it.)');if(b===null){var E=w.field.canonicalString();throw new P(N.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+E+"' (used as the orderBy) does not exist.")}p.push(b)}}return new Ka(p,d)}(t._query,t.firestore._databaseId,e,n[0]._document,r);var o=no(t.firestore);return function(s,u,l,h,d,p){var g=s.explicitOrderBy;if(d.length>g.length)throw new P(N.INVALID_ARGUMENT,"Too many arguments provided to "+h+"(). The number of arguments must be less than or equal to the number of orderBy() clauses");for(var y=[],w=0;w<d.length;w++){var b=d[w];if(g[w].field.isKeyField()){if(typeof b!="string")throw new P(N.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+h+"(), but got a "+typeof b);if(!qg(s)&&b.indexOf("/")!==-1)throw new P(N.INVALID_ARGUMENT,"Invalid query. When querying a collection and ordering by FieldPath.documentId(), the value passed to "+h+"() must be a plain document ID, but '"+b+"' contains a slash.");var E=s.path.child(ge.fromString(b));if(!K.isDocumentKey(E))throw new P(N.INVALID_ARGUMENT,"Invalid query. When querying a collection group and ordering by FieldPath.documentId(), the value passed to "+h+"() must result in a valid document path, but '"+E+"' is not because it contains an odd number of segments.");var T=new K(E);y.push(_l(u,T))}else{var k=EC(l,h,b);y.push(k)}}return new Ka(y,p)}(t._query,t.firestore._databaseId,o,e,n,r)}function kI(t,e,n){if(typeof(n=re(n))=="string"){if(n==="")throw new P(N.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid document ID, but it was an empty string.");if(!qg(e)&&n.indexOf("/")!==-1)throw new P(N.INVALID_ARGUMENT,"Invalid query. When querying a collection by FieldPath.documentId(), you must provide a plain document ID, but '"+n+"' contains a '/' character.");var r=e.path.child(ge.fromString(n));if(!K.isDocumentKey(r))throw new P(N.INVALID_ARGUMENT,"Invalid query. When querying a collection group by FieldPath.documentId(), the value provided must result in a valid document path, but '"+r+"' is not because it has an odd number of segments ("+r.length+").");return _l(t,new K(r))}if(n instanceof Pe)return _l(t,n._key);throw new P(N.INVALID_ARGUMENT,"Invalid query. When querying with FieldPath.documentId(), you must provide a valid string or a DocumentReference, but it was: "+Ih(n)+".")}function NI(t,e){if(!Array.isArray(t)||t.length===0)throw new P(N.INVALID_ARGUMENT,"Invalid Query. A non-empty array is required for '"+e.toString()+"' filters.");if(t.length>10)throw new P(N.INVALID_ARGUMENT,"Invalid Query. '"+e.toString()+"' filters support a maximum of 10 elements in the value array.")}function RC(t,e,n){if(!n.isEqual(e))throw new P(N.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, !=, not-in, >, or >=) on field '"+e.toString()+"' and so you must also use '"+e.toString()+"' as your first argument to orderBy(), but your first orderBy() is on field '"+n.toString()+"' instead.")}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bm=function(){function t(){}return t.prototype.convertValue=function(e,n){switch(n===void 0&&(n="none"),Gi(e)){case 0:return null;case 1:return e.booleanValue;case 2:return Ge(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Qo(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 10:return this.convertObject(e.mapValue,n);default:throw W()}},t.prototype.convertObject=function(e,n){var r=this,o={};return Xi(e.fields,function(s,u){o[s]=r.convertValue(u,n)}),o},t.prototype.convertGeoPoint=function(e){return new Eh(Ge(e.latitude),Ge(e.longitude))},t.prototype.convertArray=function(e,n){var r=this;return(e.values||[]).map(function(o){return r.convertValue(o,n)})},t.prototype.convertServerTimestamp=function(e,n){switch(n){case"previous":var r=ZT(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(Wa(e));default:return null}},t.prototype.convertTimestamp=function(e){var n=Br(e);return new Bt(n.seconds,n.nanos)},t.prototype.convertDocumentKey=function(e,n){var r=ge.fromString(e);Y(AS(r));var o=new Rl(r.get(1),r.get(3)),s=new K(r.popFirst(5));return o.isEqual(n)||We("Document "+s+" contains a document reference within a different database ("+o.projectId+"/"+o.database+") which is not supported. It will be treated as a reference in the current database ("+n.projectId+"/"+n.database+") instead."),s},t}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Sh(t,e,n){return t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e}var MM=function(t){function e(n){var r=this;return(r=t.call(this)||this).firestore=n,r}return V(e,t),e.prototype.convertBytes=function(n){return new Ki(n)},e.prototype.convertReference=function(n){var r=this.convertDocumentKey(n,this.firestore._databaseId);return new Pe(this.firestore,null,r)},e}(bm),FM=function(){function t(e,n){this._firestore=e,this._commitHandler=n,this._mutations=[],this._committed=!1,this._dataReader=no(e)}return t.prototype.set=function(e,n,r){this._verifyNotCommitted();var o=Lr(e,this._firestore),s=Sh(o.converter,n,r),u=Th(this._dataReader,"WriteBatch.set",o._key,s,o.converter!==null,r);return this._mutations.push(u.toMutation(o._key,mt.none())),this},t.prototype.update=function(e,n,r){for(var o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];this._verifyNotCommitted();var u,l=Lr(e,this._firestore);return u=typeof(n=re(n))=="string"||n instanceof Gn?ym(this._dataReader,"WriteBatch.update",l._key,n,r,o):mm(this._dataReader,"WriteBatch.update",l._key,n),this._mutations.push(u.toMutation(l._key,mt.exists(!0))),this},t.prototype.delete=function(e){this._verifyNotCommitted();var n=Lr(e,this._firestore);return this._mutations=this._mutations.concat(new bu(n._key,mt.none())),this},t.prototype.commit=function(){return this._verifyNotCommitted(),this._committed=!0,this._mutations.length>0?this._commitHandler(this._mutations):Promise.resolve()},t.prototype._verifyNotCommitted=function(){if(this._committed)throw new P(N.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Lr(t,e){if((t=re(t)).firestore!==e)throw new P(N.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var xi=function(t){function e(n){var r=this;return(r=t.call(this)||this).firestore=n,r}return V(e,t),e.prototype.convertBytes=function(n){return new Ki(n)},e.prototype.convertReference=function(n){var r=this.convertDocumentKey(n,this.firestore._databaseId);return new Pe(this.firestore,null,r)},e}(bm);function RI(t,e,n){t=ye(t,Pe);var r=ye(t.firestore,Ye),o=Sh(t.converter,e,n);return Tu(r,[Th(no(r),"setDoc",t._key,o,t.converter!==null,n).toMutation(t._key,mt.none())])}function DI(t,e,n){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];t=ye(t,Pe);var s=ye(t.firestore,Ye),u=no(s);return Tu(s,[(typeof(e=re(e))=="string"||e instanceof Gn?ym(u,"updateDoc",t._key,e,n,r):mm(u,"updateDoc",t._key,e)).toMutation(t._key,mt.exists(!0))])}function DC(t){for(var e,n,r,o=[],s=1;s<arguments.length;s++)o[s-1]=arguments[s];t=re(t);var u={includeMetadataChanges:!1},l=0;typeof o[l]!="object"||us(o[l])||(u=o[l],l++);var h,d,p,g={includeMetadataChanges:u.includeMetadataChanges};if(us(o[l])){var y=o[l];o[l]=(e=y.next)===null||e===void 0?void 0:e.bind(y),o[l+1]=(n=y.error)===null||n===void 0?void 0:n.bind(y),o[l+2]=(r=y.complete)===null||r===void 0?void 0:r.bind(y)}if(t instanceof Pe)d=ye(t.firestore,Ye),p=gu(t._key.path),h={next:function(E){o[l]&&o[l](xv(d,t,E))},error:o[l+1],complete:o[l+2]};else{var w=ye(t,en);d=ye(w.firestore,Ye),p=w._query;var b=new xi(d);h={next:function(E){o[l]&&o[l](new xr(d,b,w,E))},error:o[l+1],complete:o[l+2]},kC(t._query)}return function(E,T,k,O){var M=this,H=new wh(O),X=new sm(T,H,k);return E.asyncQueue.enqueueAndForget(function(){return A(M,void 0,void 0,function(){var F;return C(this,function(me){switch(me.label){case 0:return F=rm,[4,as(E)];case 1:return[2,F.apply(void 0,[me.sent(),X])]}})})}),function(){H.Wo(),E.asyncQueue.enqueueAndForget(function(){return A(M,void 0,void 0,function(){var F;return C(this,function(me){switch(me.label){case 0:return F=im,[4,as(E)];case 1:return[2,F.apply(void 0,[me.sent(),X])]}})})})}}(vt(d),p,g,h)}function Tu(t,e){return function(n,r){var o=this,s=new Gt;return n.asyncQueue.enqueueAndForget(function(){return A(o,void 0,void 0,function(){var u;return C(this,function(l){switch(l.label){case 0:return u=JL,[4,fC(n)];case 1:return[2,u.apply(void 0,[l.sent(),r,s])]}})})}),s.promise}(vt(t),e)}function xv(t,e,n){var r=n.docs.get(e._key),o=new xi(t);return new hr(t,o,e._key,r,new ki(n.hasPendingWrites,n.fromCache),e.converter)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var UM=function(t){function e(n,r){var o=this;return(o=t.call(this,n,r)||this)._firestore=n,o}return V(e,t),e.prototype.get=function(n){var r=this,o=Lr(n,this._firestore),s=new xi(this._firestore);return t.prototype.get.call(this,n).then(function(u){return new hr(r._firestore,s,o._key,u._document,new ki(!1,!1),o.converter)})},e}(function(){function t(e,n){this._firestore=e,this._transaction=n,this._dataReader=no(e)}return t.prototype.get=function(e){var n=this,r=Lr(e,this._firestore),o=new MM(this._firestore);return this._transaction.lookup([r._key]).then(function(s){if(!s||s.length!==1)return W();var u=s[0];if(u.isFoundDocument())return new Ja(n._firestore,o,u.key,u,r.converter);if(u.isNoDocument())return new Ja(n._firestore,o,r._key,null,r.converter);throw W()})},t.prototype.set=function(e,n,r){var o=Lr(e,this._firestore),s=Sh(o.converter,n,r),u=Th(this._dataReader,"Transaction.set",o._key,s,o.converter!==null,r);return this._transaction.set(o._key,u),this},t.prototype.update=function(e,n,r){for(var o=[],s=3;s<arguments.length;s++)o[s-3]=arguments[s];var u,l=Lr(e,this._firestore);return u=typeof(n=re(n))=="string"||n instanceof Gn?ym(this._dataReader,"Transaction.update",l._key,n,r,o):mm(this._dataReader,"Transaction.update",l._key,n),this._transaction.update(l._key,u),this},t.prototype.delete=function(e){var n=Lr(e,this._firestore);return this._transaction.delete(n._key),this},t}());/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function OI(){if(typeof Uint8Array>"u")throw new P(N.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function PI(){if(typeof atob>"u")throw new P(N.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}var OC=function(){function t(e){this._delegate=e}return t.fromBase64String=function(e){return PI(),new t(Ki.fromBase64String(e))},t.fromUint8Array=function(e){return OI(),new t(Ki.fromUint8Array(e))},t.prototype.toBase64=function(){return PI(),this._delegate.toBase64()},t.prototype.toUint8Array=function(){return OI(),this._delegate.toUint8Array()},t.prototype.isEqual=function(e){return this._delegate.isEqual(e._delegate)},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t}(),VM=function(){function t(){}return t.prototype.enableIndexedDbPersistence=function(e,n){return function(r,o){TI(r=ye(r,Ye));var s=vt(r),u=r._freezeSettings(),l=new Ov;return EI(s,l,new uC(l,u.cacheSizeBytes,o==null?void 0:o.forceOwnership))}(e._delegate,{forceOwnership:n})},t.prototype.enableMultiTabIndexedDbPersistence=function(e){return function(n){TI(n=ye(n,Ye));var r=vt(n),o=n._freezeSettings(),s=new Ov;return EI(r,s,new dM(s,o.cacheSizeBytes))}(e._delegate)},t.prototype.clearIndexedDbPersistence=function(e){return function(n){var r=this;if(n._initialized&&!n._terminated)throw new P(N.FAILED_PRECONDITION,"Persistence can only be cleared before a Firestore instance is initialized or after it is terminated.");var o=new Gt;return n._queue.enqueueAndForgetEvenWhileRestricted(function(){return A(r,void 0,void 0,function(){var s;return C(this,function(u){switch(u.label){case 0:return u.trys.push([0,2,,3]),[4,function(l){return A(this,void 0,void 0,function(){var h;return C(this,function(d){switch(d.label){case 0:return ns.yt()?(h=l+"main",[4,ns.delete(h)]):[2,Promise.resolve()];case 1:return d.sent(),[2]}})})}(Xg(n._databaseId,n._persistenceKey))];case 1:return u.sent(),o.resolve(),[3,3];case 2:return s=u.sent(),o.reject(s),[3,3];case 3:return[2]}})})}),o.promise}(e._delegate)},t}(),PC=function(){function t(e,n,r){var o=this;this._delegate=n,this.Zc=r,this.INTERNAL={delete:function(){return o.terminate()}},e instanceof Rl||(this.tu=e)}return Object.defineProperty(t.prototype,"_databaseId",{get:function(){return this._delegate._databaseId},enumerable:!1,configurable:!0}),t.prototype.settings=function(e){var n=this._delegate._getSettings();e.merge||n.host===e.host||ml("You are overriding the original host. If you did not intend to override your settings, use {merge: true}."),e.merge&&delete(e=Object.assign(Object.assign({},n),e)).merge,this._delegate._setSettings(e)},t.prototype.useEmulator=function(e,n,r){r===void 0&&(r={}),function(o,s,u,l){var h;l===void 0&&(l={});var d=(o=ye(o,Xa))._getSettings();if(d.host!=="firestore.googleapis.com"&&d.host!==s&&ml("Host has been set in both settings() and useEmulator(), emulator host will be used"),o._setSettings(Object.assign(Object.assign({},d),{host:s+":"+u,ssl:!1})),l.mockUserToken){var p,g;if(typeof l.mockUserToken=="string")p=l.mockUserToken,g=ot.MOCK_USER;else{p=ug(l.mockUserToken,(h=o._app)===null||h===void 0?void 0:h.options.projectId);var y=l.mockUserToken.sub||l.mockUserToken.user_id;if(!y)throw new P(N.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");g=new ot(y)}o._credentials=new yM(new dC(p,g))}}(this._delegate,e,n,r)},t.prototype.enableNetwork=function(){return function(e){var n=this;return e.asyncQueue.enqueue(function(){return A(n,void 0,void 0,function(){var r,o;return C(this,function(s){switch(s.label){case 0:return[4,dI(e)];case 1:return r=s.sent(),[4,pI(e)];case 2:return o=s.sent(),[2,(r.setNetworkEnabled(!0),function(u){var l=j(u);return l.Or.delete(0),Iu(l)}(o))]}})})})}(vt(ye(this._delegate,Ye)))},t.prototype.disableNetwork=function(){return function(e){var n=this;return e.asyncQueue.enqueue(function(){return A(n,void 0,void 0,function(){var r,o;return C(this,function(s){switch(s.label){case 0:return[4,dI(e)];case 1:return r=s.sent(),[4,pI(e)];case 2:return o=s.sent(),[2,(r.setNetworkEnabled(!1),function(u){return A(this,void 0,void 0,function(){var l;return C(this,function(h){switch(h.label){case 0:return(l=j(u)).Or.add(0),[4,ws(l)];case 1:return h.sent(),l.Br.set("Offline"),[2]}})})}(o))]}})})})}(vt(ye(this._delegate,Ye)))},t.prototype.enablePersistence=function(e){var n=!1,r=!1;return e&&pC("synchronizeTabs",n=!!e.synchronizeTabs,"experimentalForceOwningTab",r=!!e.experimentalForceOwningTab),n?this.Zc.enableMultiTabIndexedDbPersistence(this):this.Zc.enableIndexedDbPersistence(this,r)},t.prototype.clearPersistence=function(){return this.Zc.clearIndexedDbPersistence(this)},t.prototype.terminate=function(){return this.tu&&(this.tu._removeServiceInstance("firestore"),this.tu._removeServiceInstance("firestore-exp")),this._delegate._delete()},t.prototype.waitForPendingWrites=function(){return function(e){var n=this,r=new Gt;return e.asyncQueue.enqueueAndForget(function(){return A(n,void 0,void 0,function(){var o;return C(this,function(s){switch(s.label){case 0:return o=nM,[4,fC(e)];case 1:return[2,o.apply(void 0,[s.sent(),r])]}})})}),r.promise}(vt(ye(this._delegate,Ye)))},t.prototype.onSnapshotsInSync=function(e){return function(n,r){return function(o,s){var u=this,l=new wh(s);return o.asyncQueue.enqueueAndForget(function(){return A(u,void 0,void 0,function(){var h;return C(this,function(d){switch(d.label){case 0:return h=function(p,g){j(p).Gr.add(g),g.next()},[4,as(o)];case 1:return[2,h.apply(void 0,[d.sent(),l])]}})})}),function(){l.Wo(),o.asyncQueue.enqueueAndForget(function(){return A(u,void 0,void 0,function(){var h;return C(this,function(d){switch(d.label){case 0:return h=function(p,g){j(p).Gr.delete(g)},[4,as(o)];case 1:return[2,h.apply(void 0,[d.sent(),l])]}})})})}}(vt(n=ye(n,Ye)),us(r)?r:{next:r})}(this._delegate,e)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this.tu)throw new P(N.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this.tu},enumerable:!1,configurable:!0}),t.prototype.collection=function(e){try{return new Pl(this,vC(this._delegate,e))}catch(n){throw St(n,"collection()","Firestore.collection()")}},t.prototype.doc=function(e){try{return new Li(this,il(this._delegate,e))}catch(n){throw St(n,"doc()","Firestore.doc()")}},t.prototype.collectionGroup=function(e){try{return new kh(this,function(n,r){if(n=ye(n,Xa),pm("collectionGroup","collection id",r),r.indexOf("/")>=0)throw new P(N.INVALID_ARGUMENT,"Invalid collection ID '"+r+"' passed to function collectionGroup(). Collection IDs must not contain '/'.");return new en(n,null,function(o){return new gr(ge.emptyPath(),o)}(r))}(this._delegate,e))}catch(n){throw St(n,"collectionGroup()","Firestore.collectionGroup()")}},t.prototype.runTransaction=function(e){var n=this;return function(r,o){return function(s,u){var l=this,h=new Gt;return s.asyncQueue.enqueueAndForget(function(){return A(l,void 0,void 0,function(){var d;return C(this,function(p){switch(p.label){case 0:return[4,function(g){return bh(g).then(function(y){return y.datastore})}(s)];case 1:return d=p.sent(),new vM(s.asyncQueue,d,u,h).run(),[2]}})})}),h.promise}(vt(r),function(s){return o(new UM(r,s))})}(this._delegate,function(r){return e(new xC(n,r))})},t.prototype.batch=function(){var e=this;return vt(this._delegate),new LC(new FM(this._delegate,function(n){return Tu(e._delegate,n)}))},t.prototype.loadBundle=function(e){throw new P(N.FAILED_PRECONDITION,'"loadBundle()" does not exist, have you imported "firebase/firestore/bundle"?')},t.prototype.namedQuery=function(e){throw new P(N.FAILED_PRECONDITION,'"namedQuery()" does not exist, have you imported "firebase/firestore/bundle"?')},t}(),Ch=function(t){function e(n){var r=this;return(r=t.call(this)||this).firestore=n,r}return V(e,t),e.prototype.convertBytes=function(n){return new OC(new Ki(n))},e.prototype.convertReference=function(n){var r=this.convertDocumentKey(n,this.firestore._databaseId);return Li.eu(r,this.firestore,null)},e}(bm);function jM(t){var e;e=t,kn.setLogLevel(e)}var xC=function(){function t(e,n){this._firestore=e,this._delegate=n,this._userDataWriter=new Ch(e)}return t.prototype.get=function(e){var n=this,r=Ni(e);return this._delegate.get(r).then(function(o){return new Za(n._firestore,new hr(n._firestore._delegate,n._userDataWriter,o._key,o._document,o.metadata,r.converter))})},t.prototype.set=function(e,n,r){var o=Ni(e);return r?(vm("Transaction.set",r),this._delegate.set(o,n,r)):this._delegate.set(o,n),this},t.prototype.update=function(e,n,r){for(var o,s=[],u=3;u<arguments.length;u++)s[u-3]=arguments[u];var l=Ni(e);return arguments.length===2?this._delegate.update(l,n):(o=this._delegate).update.apply(o,ve([l,n,r],s)),this},t.prototype.delete=function(e){var n=Ni(e);return this._delegate.delete(n),this},t}(),LC=function(){function t(e){this._delegate=e}return t.prototype.set=function(e,n,r){var o=Ni(e);return r?(vm("WriteBatch.set",r),this._delegate.set(o,n,r)):this._delegate.set(o,n),this},t.prototype.update=function(e,n,r){for(var o,s=[],u=3;u<arguments.length;u++)s[u-3]=arguments[u];var l=Ni(e);return arguments.length===2?this._delegate.update(l,n):(o=this._delegate).update.apply(o,ve([l,n,r],s)),this},t.prototype.delete=function(e){var n=Ni(e);return this._delegate.delete(n),this},t.prototype.commit=function(){return this._delegate.commit()},t}(),Ah=function(){function t(e,n,r){this._firestore=e,this._userDataWriter=n,this._delegate=r}return t.prototype.fromFirestore=function(e,n){var r=new Na(this._firestore._delegate,this._userDataWriter,e._key,e._document,e.metadata,null);return this._delegate.fromFirestore(new eu(this._firestore,r),n??{})},t.prototype.toFirestore=function(e,n){return n?this._delegate.toFirestore(e,n):this._delegate.toFirestore(e)},t.nu=function(e,n){var r=t.su,o=r.get(e);o||(o=new WeakMap,r.set(e,o));var s=o.get(n);return s||(s=new t(e,new Ch(e),n),o.set(n,s)),s},t}();Ah.su=new WeakMap;var Li=function(){function t(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Ch(e)}return t.iu=function(e,n,r){if(e.length%2!=0)throw new P(N.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(n,new Pe(n._delegate,r,new K(e)))},t.eu=function(e,n,r){return new t(n,new Pe(n._delegate,r,e))},Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Pl(this.firestore,this._delegate.parent)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),t.prototype.collection=function(e){try{return new Pl(this.firestore,vC(this._delegate,e))}catch(n){throw St(n,"collection()","DocumentReference.collection()")}},t.prototype.isEqual=function(e){return(e=re(e))instanceof Pe&&gC(this._delegate,e)},t.prototype.set=function(e,n){n=vm("DocumentReference.set",n);try{return n?RI(this._delegate,e,n):RI(this._delegate,e)}catch(r){throw St(r,"setDoc()","DocumentReference.set()")}},t.prototype.update=function(e,n){for(var r=[],o=2;o<arguments.length;o++)r[o-2]=arguments[o];try{return arguments.length===1?DI(this._delegate,e):DI.apply(void 0,ve([this._delegate,e,n],r))}catch(s){throw St(s,"updateDoc()","DocumentReference.update()")}},t.prototype.delete=function(){return Tu(ye((e=this._delegate).firestore,Ye),[new bu(e._key,mt.none())]);var e},t.prototype.onSnapshot=function(){for(var e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=MC(n),s=FC(n,function(u){return new Za(e.firestore,new hr(e.firestore._delegate,e._userDataWriter,u._key,u._document,u.metadata,e._delegate.converter))});return DC(this._delegate,o,s)},t.prototype.get=function(e){var n=this;return((e==null?void 0:e.source)==="cache"?function(r){r=ye(r,Pe);var o=ye(r.firestore,Ye),s=vt(o),u=new xi(o);return function(l,h){var d=this,p=new Gt;return l.asyncQueue.enqueueAndForget(function(){return A(d,void 0,void 0,function(){var g;return C(this,function(y){switch(y.label){case 0:return g=function(w,b,E){return A(this,void 0,void 0,function(){var T,k;return C(this,function(O){switch(O.label){case 0:return O.trys.push([0,2,,3]),[4,function(M,H){var X=j(M);return X.persistence.runTransaction("read document","readonly",function(F){return X.Mn.mn(F,H)})}(w,b)];case 1:return(k=O.sent()).isFoundDocument()?E.resolve(k):k.isNoDocument()?E.resolve(null):E.reject(new P(N.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")),[3,3];case 2:return T=O.sent(),k=Es(T,"Failed to get document '"+b+" from cache"),E.reject(k),[3,3];case 3:return[2]}})})},[4,hC(l)];case 1:return[2,g.apply(void 0,[y.sent(),h,p])]}})})}),p.promise}(s,r._key).then(function(l){return new hr(o,u,r._key,l,new ki(l!==null&&l.hasLocalMutations,!0),r.converter)})}(this._delegate):(e==null?void 0:e.source)==="server"?function(r){r=ye(r,Pe);var o=ye(r.firestore,Ye);return vI(vt(o),r._key,{source:"server"}).then(function(s){return xv(o,r,s)})}(this._delegate):function(r){r=ye(r,Pe);var o=ye(r.firestore,Ye);return vI(vt(o),r._key).then(function(s){return xv(o,r,s)})}(this._delegate)).then(function(r){return new Za(n.firestore,new hr(n.firestore._delegate,n._userDataWriter,r._key,r._document,r.metadata,n._delegate.converter))})},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Ah.nu(this.firestore,e)):this._delegate.withConverter(null))},t}();function St(t,e,n){return t.message=t.message.replace(e,n),t}function MC(t){for(var e=0,n=t;e<n.length;e++){var r=n[e];if(typeof r=="object"&&!us(r))return r}return{}}function FC(t,e){var n,r,o;return{next:function(s){o.next&&o.next(e(s))},error:(n=(o=us(t[0])?t[0]:us(t[1])?t[1]:typeof t[0]=="function"?{next:t[0],error:t[1],complete:t[2]}:{next:t[1],error:t[2],complete:t[3]}).error)===null||n===void 0?void 0:n.bind(o),complete:(r=o.complete)===null||r===void 0?void 0:r.bind(o)}}var Za=function(){function t(e,n){this._firestore=e,this._delegate=n}return Object.defineProperty(t.prototype,"ref",{get:function(){return new Li(this._firestore,this._delegate.ref)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return this._delegate.exists()},enumerable:!1,configurable:!0}),t.prototype.data=function(e){return this._delegate.data(e)},t.prototype.get=function(e,n){return this._delegate.get(e,n)},t.prototype.isEqual=function(e){return AC(this._delegate,e._delegate)},t}(),eu=function(t){function e(){return t!==null&&t.apply(this,arguments)||this}return V(e,t),e.prototype.data=function(n){return this._delegate.data(n)},e}(Za),kh=function(){function t(e,n){this.firestore=e,this._delegate=n,this._userDataWriter=new Ch(e)}return t.prototype.where=function(e,n,r){try{return new t(this.firestore,Nr(this._delegate,function(o,s,u){var l=s,h=Ol("where",o);return new xM(h,l,u)}(e,n,r)))}catch(o){throw St(o,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.orderBy=function(e,n){try{return new t(this.firestore,Nr(this._delegate,function(r,o){o===void 0&&(o="asc");var s=o,u=Ol("orderBy",r);return new LM(u,s)}(e,n)))}catch(r){throw St(r,/(orderBy|where)\(\)/,"Query.$1()")}},t.prototype.limit=function(e){try{return new t(this.firestore,Nr(this._delegate,function(n){return bI("limit",n),new SI("limit",n,"F")}(e)))}catch(n){throw St(n,"limit()","Query.limit()")}},t.prototype.limitToLast=function(e){try{return new t(this.firestore,Nr(this._delegate,function(n){return bI("limitToLast",n),new SI("limitToLast",n,"L")}(e)))}catch(n){throw St(n,"limitToLast()","Query.limitToLast()")}},t.prototype.startAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Nr(this._delegate,(function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return new CI("startAt",r,!0)}).apply(void 0,e)))}catch(r){throw St(r,"startAt()","Query.startAt()")}},t.prototype.startAfter=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Nr(this._delegate,(function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return new CI("startAfter",r,!1)}).apply(void 0,e)))}catch(r){throw St(r,"startAfter()","Query.startAfter()")}},t.prototype.endBefore=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Nr(this._delegate,(function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return new AI("endBefore",r,!0)}).apply(void 0,e)))}catch(r){throw St(r,"endBefore()","Query.endBefore()")}},t.prototype.endAt=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];try{return new t(this.firestore,Nr(this._delegate,(function(){for(var r=[],o=0;o<arguments.length;o++)r[o]=arguments[o];return new AI("endAt",r,!1)}).apply(void 0,e)))}catch(r){throw St(r,"endAt()","Query.endAt()")}},t.prototype.isEqual=function(e){return mC(this._delegate,e._delegate)},t.prototype.get=function(e){var n=this;return((e==null?void 0:e.source)==="cache"?function(r){r=ye(r,en);var o=ye(r.firestore,Ye),s=vt(o),u=new xi(o);return function(l,h){var d=this,p=new Gt;return l.asyncQueue.enqueueAndForget(function(){return A(d,void 0,void 0,function(){var g;return C(this,function(y){switch(y.label){case 0:return g=function(w,b,E){return A(this,void 0,void 0,function(){var T,k,O,M,H;return C(this,function(X){switch(X.label){case 0:return X.trys.push([0,2,,3]),[4,Al(w,b,!0)];case 1:return H=X.sent(),T=new rC(b,H.Bn),k=T._o(H.documents),O=T.applyChanges(k,!1),E.resolve(O.snapshot),[3,3];case 2:return M=X.sent(),H=Es(M,"Failed to execute query '"+b+" against cache"),E.reject(H),[3,3];case 3:return[2]}})})},[4,hC(l)];case 1:return[2,g.apply(void 0,[y.sent(),h,p])]}})})}),p.promise}(s,r._query).then(function(l){return new xr(o,u,r,l)})}(this._delegate):(e==null?void 0:e.source)==="server"?function(r){r=ye(r,en);var o=ye(r.firestore,Ye),s=vt(o),u=new xi(o);return gI(s,r._query,{source:"server"}).then(function(l){return new xr(o,u,r,l)})}(this._delegate):function(r){r=ye(r,en);var o=ye(r.firestore,Ye),s=vt(o),u=new xi(o);return kC(r._query),gI(s,r._query).then(function(l){return new xr(o,u,r,l)})}(this._delegate)).then(function(r){return new Lv(n.firestore,new xr(n.firestore._delegate,n._userDataWriter,n._delegate,r._snapshot))})},t.prototype.onSnapshot=function(){for(var e=this,n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];var o=MC(n),s=FC(n,function(u){return new Lv(e.firestore,new xr(e.firestore._delegate,e._userDataWriter,e._delegate,u._snapshot))});return DC(this._delegate,o,s)},t.prototype.withConverter=function(e){return new t(this.firestore,e?this._delegate.withConverter(Ah.nu(this.firestore,e)):this._delegate.withConverter(null))},t}(),BM=function(){function t(e,n){this._firestore=e,this._delegate=n}return Object.defineProperty(t.prototype,"type",{get:function(){return this._delegate.type},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"doc",{get:function(){return new eu(this._firestore,this._delegate.doc)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"oldIndex",{get:function(){return this._delegate.oldIndex},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"newIndex",{get:function(){return this._delegate.newIndex},enumerable:!1,configurable:!0}),t}(),Lv=function(){function t(e,n){this._firestore=e,this._delegate=n}return Object.defineProperty(t.prototype,"query",{get:function(){return new kh(this._firestore,this._delegate.query)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._delegate.size},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._delegate.empty},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"docs",{get:function(){var e=this;return this._delegate.docs.map(function(n){return new eu(e._firestore,n)})},enumerable:!1,configurable:!0}),t.prototype.docChanges=function(e){var n=this;return this._delegate.docChanges(e).map(function(r){return new BM(n._firestore,r)})},t.prototype.forEach=function(e,n){var r=this;this._delegate.forEach(function(o){e.call(n,new eu(r._firestore,o))})},t.prototype.isEqual=function(e){return AC(this._delegate,e._delegate)},t}(),Pl=function(t){function e(n,r){var o=this;return(o=t.call(this,n,r)||this).firestore=n,o._delegate=r,o}return V(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._delegate.id},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._delegate.path},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var n=this._delegate.parent;return n?new Li(this.firestore,n):null},enumerable:!1,configurable:!0}),e.prototype.doc=function(n){try{return new Li(this.firestore,n===void 0?il(this._delegate):il(this._delegate,n))}catch(r){throw St(r,"doc()","CollectionReference.doc()")}},e.prototype.add=function(n){var r=this;return function(o,s){var u=ye(o.firestore,Ye),l=il(o),h=Sh(o.converter,s);return Tu(u,[Th(no(o.firestore),"addDoc",l._key,h,o.converter!==null,{}).toMutation(l._key,mt.exists(!1))]).then(function(){return l})}(this._delegate,n).then(function(o){return new Li(r.firestore,o)})},e.prototype.isEqual=function(n){return gC(this._delegate,n._delegate)},e.prototype.withConverter=function(n){return new e(this.firestore,n?this._delegate.withConverter(Ah.nu(this.firestore,n)):this._delegate.withConverter(null))},e}(kh);function Ni(t){return ye(t,Pe)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qM=function(){function t(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];this._delegate=new(Gn.bind.apply(Gn,ve([void 0],e)))}return t.documentId=function(){return new t(Dn.keyField().canonicalString())},t.prototype.isEqual=function(e){return(e=re(e))instanceof Gn&&this._delegate._internalPath.isEqual(e._internalPath)},t}(),GM=function(){function t(e){this._delegate=e}return t.serverTimestamp=function(){var e=new AM("serverTimestamp");return e._methodName="FieldValue.serverTimestamp",new t(e)},t.delete=function(){var e=new gm("deleteField");return e._methodName="FieldValue.delete",new t(e)},t.arrayUnion=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return new kM("arrayUnion",o)}).apply(void 0,e);return r._methodName="FieldValue.arrayUnion",new t(r)},t.arrayRemove=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];var r=(function(){for(var o=[],s=0;s<arguments.length;s++)o[s]=arguments[s];return new NM("arrayRemove",o)}).apply(void 0,e);return r._methodName="FieldValue.arrayRemove",new t(r)},t.increment=function(e){var n=function(r){return new RM("increment",r)}(e);return n._methodName="FieldValue.increment",new t(n)},t.prototype.isEqual=function(e){return this._delegate.isEqual(e._delegate)},t}(),WM={Firestore:PC,GeoPoint:Eh,Timestamp:Bt,Blob:OC,Transaction:xC,WriteBatch:LC,DocumentReference:Li,DocumentSnapshot:Za,Query:kh,QueryDocumentSnapshot:eu,QuerySnapshot:Lv,CollectionReference:Pl,FieldPath:qM,FieldValue:GM,setLogLevel:jM,CACHE_SIZE_UNLIMITED:EM};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HM(t){(function(e,n){e.INTERNAL.registerComponent(new Kn("firestore",function(r){var o=r.getProvider("app").getImmediate();return n(o,r.getProvider("auth-internal"))},"PUBLIC").setServiceProps(Object.assign({},WM)))})(t,function(e,n){return new PC(e,new Ye(e,n),new VM)}),t.registerVersion("@firebase/firestore","2.4.1")}HM(J);var KM={},zM="@firebase/database",$M="0.11.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var UC="";function VC(t){UC=t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var QM=function(){function t(e){this.domStorage_=e,this.prefix_="firebase:"}return t.prototype.set=function(e,n){n==null?this.domStorage_.removeItem(this.prefixedName_(e)):this.domStorage_.setItem(this.prefixedName_(e),Qe(n))},t.prototype.get=function(e){var n=this.domStorage_.getItem(this.prefixedName_(e));return n==null?null:Ua(n)},t.prototype.remove=function(e){this.domStorage_.removeItem(this.prefixedName_(e))},t.prototype.prefixedName_=function(e){return this.prefix_+e},t.prototype.toString=function(){return this.domStorage_.toString()},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var YM=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(e,n){n==null?delete this.cache_[e]:this.cache_[e]=n},t.prototype.get=function(e){return tn(this.cache_,e)?this.cache_[e]:null},t.prototype.remove=function(e){delete this.cache_[e]},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var jC=function(t){try{if(typeof window<"u"&&typeof window[t]<"u"){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new QM(e)}}catch{}return new YM},Ri=jC("localStorage"),Mv=jC("sessionStorage");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Go=new Xl("@firebase/database"),BC=function(){var t=1;return function(){return t++}}(),qC=function(t){var e=_O(t),n=new vO;n.update(e);var r=n.digest();return ag.encodeByteArray(r)},Su=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++){var o=t[r];Array.isArray(o)||o&&typeof o=="object"&&typeof o.length=="number"?n+=Su.apply(null,o):typeof o=="object"?n+=Qe(o):n+=o,n+=" "}return n},Mi=null,xI=!0,GC=function(t,e){L(!e||t===!0||t===!1,"Can't turn on custom loggers persistently."),t===!0?(Go.logLevel=fe.VERBOSE,Mi=Go.log.bind(Go),e&&Mv.set("logging_enabled",!0)):typeof t=="function"?Mi=t:(Mi=null,Mv.remove("logging_enabled"))},nt=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(xI===!0&&(xI=!1,Mi===null&&Mv.get("logging_enabled")===!0&&GC(!0)),Mi){var n=Su.apply(null,t);Mi(n)}},Cu=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];nt.apply(void 0,ve([t],gt(e)))}},Fv=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+Su.apply(void 0,ve([],gt(t)));Go.error(n)},Qn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+Su.apply(void 0,ve([],gt(t)));throw Go.error(n),new Error(n)},ht=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+Su.apply(void 0,ve([],gt(t)));Go.warn(n)},XM=function(){typeof window<"u"&&window.location&&window.location.protocol&&window.location.protocol.indexOf("https:")!==-1&&ht("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},Nh=function(t){return typeof t=="number"&&(t!==t||t===Number.POSITIVE_INFINITY||t===Number.NEGATIVE_INFINITY)},JM=function(t){if(document.readyState==="complete")t();else{var e=!1,n=function(){if(!document.body){setTimeout(n,Math.floor(10));return}e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){document.readyState==="complete"&&n()}),window.attachEvent("onload",n))}},pr="[MIN_NAME]",Yn="[MAX_NAME]",io=function(t,e){if(t===e)return 0;if(t===pr||e===Yn)return-1;if(e===pr||t===Yn)return 1;var n=xl(t),r=xl(e);return n!==null?r!==null?n-r===0?t.length-e.length:n-r:-1:r!==null?1:t<e?-1:1},ZM=function(t,e){return t===e?0:t<e?-1:1},ya=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+Qe(e))},Im=function(t){if(typeof t!="object"||t===null)return Qe(t);var e=[];for(var n in t)e.push(n);e.sort();for(var r="{",o=0;o<e.length;o++)o!==0&&(r+=","),r+=Qe(e[o]),r+=":",r+=Im(t[e[o]]);return r+="}",r},WC=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],o=0;o<n;o+=e)o+e>n?r.push(t.substring(o,n)):r.push(t.substring(o,o+e));return r};function Je(t,e){for(var n in t)t.hasOwnProperty(n)&&e(n,t[n])}var HC=function(t){L(!Nh(t),"Invalid JSON number");var e=11,n=52,r=(1<<e-1)-1,o,s,u,l,h;t===0?(s=0,u=0,o=1/t===-1/0?1:0):(o=t<0,t=Math.abs(t),t>=Math.pow(2,1-r)?(l=Math.min(Math.floor(Math.log(t)/Math.LN2),r),s=l+r,u=Math.round(t*Math.pow(2,n-l)-Math.pow(2,n))):(s=0,u=Math.round(t/Math.pow(2,1-r-n))));var d=[];for(h=n;h;h-=1)d.push(u%2?1:0),u=Math.floor(u/2);for(h=e;h;h-=1)d.push(s%2?1:0),s=Math.floor(s/2);d.push(o?1:0),d.reverse();var p=d.join(""),g="";for(h=0;h<64;h+=8){var y=parseInt(p.substr(h,8),2).toString(16);y.length===1&&(y="0"+y),g=g+y}return g.toLowerCase()},eF=function(){return!!(typeof window=="object"&&window.chrome&&window.chrome.extension&&!/^chrome/.test(window.location.href))},tF=function(){return typeof Windows=="object"&&typeof Windows.UI=="object"};function nF(t,e){var n="Unknown Error";t==="too_big"?n="The data requested exceeds the maximum size that can be accessed with a single request.":t==="permission_denied"?n="Client doesn't have permission to access the desired data.":t==="unavailable"&&(n="The service is unavailable");var r=new Error(t+" at "+e._path.toString()+": "+n);return r.code=t.toUpperCase(),r}var rF=new RegExp("^-?(0*)\\d{1,10}$"),KC=-2147483648,Em=2147483647,xl=function(t){if(rF.test(t)){var e=Number(t);if(e>=KC&&e<=Em)return e}return null},Ts=function(t){try{t()}catch(e){setTimeout(function(){var n=e.stack||"";throw ht("Exception was thrown by user callback.",n),e},Math.floor(0))}},iF=function(){var t=typeof window=="object"&&window.navigator&&window.navigator.userAgent||"";return t.search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},Ra=function(t,e){var n=setTimeout(t,e);return typeof n=="object"&&n.unref&&n.unref(),n};/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var oF=function(){function t(e,n){var r=this;this.appName_=e,this.appCheckProvider=n,this.appCheck=n==null?void 0:n.getImmediate({optional:!0}),this.appCheck||n==null||n.get().then(function(o){return r.appCheck=o})}return t.prototype.getToken=function(e){var n=this;return this.appCheck?this.appCheck.getToken(e):new Promise(function(r,o){setTimeout(function(){n.appCheck?n.getToken(e).then(r,o):r(null)},0)})},t.prototype.addTokenChangeListener=function(e){var n;(n=this.appCheckProvider)===null||n===void 0||n.get().then(function(r){return r.addTokenListener(e)})},t.prototype.notifyForInvalidToken=function(){ht('Provided AppCheck credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly.')},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var sF=function(){function t(e,n,r){var o=this;this.appName_=e,this.firebaseOptions_=n,this.authProvider_=r,this.auth_=null,this.auth_=r.getImmediate({optional:!0}),this.auth_||r.onInit(function(s){return o.auth_=s})}return t.prototype.getToken=function(e){var n=this;return this.auth_?this.auth_.getToken(e).catch(function(r){return r&&r.code==="auth/token-not-initialized"?(nt("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(r)}):new Promise(function(r,o){setTimeout(function(){n.auth_?n.getToken(e).then(r,o):r(null)},0)})},t.prototype.addTokenChangeListener=function(e){this.auth_?this.auth_.addAuthTokenListener(e):this.authProvider_.get().then(function(n){return n.addAuthTokenListener(e)})},t.prototype.removeTokenChangeListener=function(e){this.authProvider_.get().then(function(n){return n.removeAuthTokenListener(e)})},t.prototype.notifyForInvalidToken=function(){var e='Provided authentication credentials for the app named "'+this.appName_+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.firebaseOptions_?e+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.firebaseOptions_?e+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':e+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',ht(e)},t}(),Da=function(){function t(e){this.accessToken=e}return t.prototype.getToken=function(e){return Promise.resolve({accessToken:this.accessToken})},t.prototype.addTokenChangeListener=function(e){e(this.accessToken)},t.prototype.removeTokenChangeListener=function(e){},t.prototype.notifyForInvalidToken=function(){},t.OWNER="owner",t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Tm="5",zC="v",$C="s",QC="r",YC="f",XC=/(console\.firebase|firebase-console-\w+\.corp|firebase\.corp)\.google\.com/,JC="ls",aF="p",Uv="ac",ZC="websocket",eA="long_polling";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Sm=function(){function t(e,n,r,o,s,u,l){s===void 0&&(s=!1),u===void 0&&(u=""),l===void 0&&(l=!1),this.secure=n,this.namespace=r,this.webSocketOnly=o,this.nodeAdmin=s,this.persistenceKey=u,this.includeNamespaceInQueryParams=l,this._host=e.toLowerCase(),this._domain=this._host.substr(this._host.indexOf(".")+1),this.internalHost=Ri.get("host:"+e)||this._host}return t.prototype.isCacheableHost=function(){return this.internalHost.substr(0,2)==="s-"},t.prototype.isCustomHost=function(){return this._domain!=="firebaseio.com"&&this._domain!=="firebaseio-demo.com"},Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(e){e!==this.internalHost&&(this.internalHost=e,this.isCacheableHost()&&Ri.set("host:"+this._host,this.internalHost))},enumerable:!1,configurable:!0}),t.prototype.toString=function(){var e=this.toURLString();return this.persistenceKey&&(e+="<"+this.persistenceKey+">"),e},t.prototype.toURLString=function(){var e=this.secure?"https://":"http://",n=this.includeNamespaceInQueryParams?"?ns="+this.namespace:"";return""+e+this.host+"/"+n},t}();function uF(t){return t.host!==t.internalHost||t.isCustomHost()||t.includeNamespaceInQueryParams}function tA(t,e,n){L(typeof e=="string","typeof type must == string"),L(typeof n=="object","typeof params must == object");var r;if(e===ZC)r=(t.secure?"wss://":"ws://")+t.internalHost+"/.ws?";else if(e===eA)r=(t.secure?"https://":"http://")+t.internalHost+"/.lp?";else throw new Error("Unknown connection type: "+e);uF(t)&&(n.ns=t.namespace);var o=[];return Je(n,function(s,u){o.push(s+"="+u)}),r+o.join("&")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cF=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(e,n){n===void 0&&(n=1),tn(this.counters_,e)||(this.counters_[e]=0),this.counters_[e]+=n},t.prototype.get=function(){return ME(this.counters_)},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Qp={},Yp={};function Cm(t){var e=t.toString();return Qp[e]||(Qp[e]=new cF),Qp[e]}function lF(t,e){var n=t.toString();return Yp[n]||(Yp[n]=e()),Yp[n]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hF=function(){function t(e){this.onMessage_=e,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(e,n){this.closeAfterResponse=e,this.onClose=n,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(e,n){var r=this;this.pendingResponses[e]=n;for(var o=function(){var l=s.pendingResponses[s.currentResponseNum];delete s.pendingResponses[s.currentResponseNum];for(var h=function(p){l[p]&&Ts(function(){r.onMessage_(l[p])})},d=0;d<l.length;++d)h(d);if(s.currentResponseNum===s.closeAfterResponse)return s.onClose&&(s.onClose(),s.onClose=null),"break";s.currentResponseNum++},s=this;this.pendingResponses[this.currentResponseNum];){var u=o();if(u==="break")break}},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var LI="start",fF="close",dF="pLPCommand",pF="pRTLPCB",nA="id",rA="pw",iA="ser",vF="cb",gF="seg",mF="ts",yF="d",_F="dframe",oA=1870,sA=30,wF=oA-sA,bF=25e3,IF=3e4,Am=function(){function t(e,n,r,o,s,u,l){var h=this;this.connId=e,this.repoInfo=n,this.applicationId=r,this.appCheckToken=o,this.authToken=s,this.transportSessionId=u,this.lastSessionId=l,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=Cu(e),this.stats_=Cm(n),this.urlFn=function(d){return h.appCheckToken&&(d[Uv]=h.appCheckToken),tA(n,eA,d)}}return t.prototype.open=function(e,n){var r=this;this.curSegmentNum=0,this.onDisconnect_=n,this.myPacketOrderer=new hF(e),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){r.log_("Timed out trying to connect."),r.onClosed_(),r.connectTimeoutTimer_=null},Math.floor(IF)),JM(function(){if(!r.isClosed_){r.scriptTagHolder=new EF(function(){for(var u=[],l=0;l<arguments.length;l++)u[l]=arguments[l];var h=gt(u,5),d=h[0],p=h[1],g=h[2];if(h[3],h[4],r.incrementIncomingBytes_(u),!!r.scriptTagHolder)if(r.connectTimeoutTimer_&&(clearTimeout(r.connectTimeoutTimer_),r.connectTimeoutTimer_=null),r.everConnected_=!0,d===LI)r.id=p,r.password=g;else if(d===fF)p?(r.scriptTagHolder.sendNewPolls=!1,r.myPacketOrderer.closeAfter(p,function(){r.onClosed_()})):r.onClosed_();else throw new Error("Unrecognized command received: "+d)},function(){for(var u=[],l=0;l<arguments.length;l++)u[l]=arguments[l];var h=gt(u,2),d=h[0],p=h[1];r.incrementIncomingBytes_(u),r.myPacketOrderer.handleResponse(d,p)},function(){r.onClosed_()},r.urlFn);var o={};o[LI]="t",o[iA]=Math.floor(Math.random()*1e8),r.scriptTagHolder.uniqueCallbackIdentifier&&(o[vF]=r.scriptTagHolder.uniqueCallbackIdentifier),o[zC]=Tm,r.transportSessionId&&(o[$C]=r.transportSessionId),r.lastSessionId&&(o[JC]=r.lastSessionId),r.applicationId&&(o[aF]=r.applicationId),r.appCheckToken&&(o[Uv]=r.appCheckToken),typeof location<"u"&&location.hostname&&XC.test(location.hostname)&&(o[QC]=YC);var s=r.urlFn(o);r.log_("Connecting via long-poll to "+s),r.scriptTagHolder.addTag(s,function(){})}})},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return t.forceAllow_?!0:!t.forceDisallow_&&typeof document<"u"&&document.createElement!=null&&!eF()&&!tF()},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(e){var n=Qe(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);for(var r=LE(n),o=WC(r,wF),s=0;s<o.length;s++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,o.length,o[s]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(e,n){this.myDisconnFrame=document.createElement("iframe");var r={};r[_F]="t",r[nA]=e,r[rA]=n,this.myDisconnFrame.src=this.urlFn(r),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)},t.prototype.incrementIncomingBytes_=function(e){var n=Qe(e).length;this.bytesReceived+=n,this.stats_.incrementCounter("bytes_received",n)},t}(),EF=function(){function t(e,n,r,o){this.onDisconnect=r,this.urlFn=o,this.outstandingRequests=new Set,this.pendingSegs=[],this.currentSerial=Math.floor(Math.random()*1e8),this.sendNewPolls=!0;{this.uniqueCallbackIdentifier=BC(),window[dF+this.uniqueCallbackIdentifier]=e,window[pF+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var s="";if(this.myIFrame.src&&this.myIFrame.src.substr(0,11)==="javascript:"){var u=document.domain;s='<script>document.domain="'+u+'";<\/script>'}var l="<html><body>"+s+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(l),this.myIFrame.doc.close()}catch(h){nt("frame writing exception"),h.stack&&nt(h.stack),nt(h)}}}return t.createIFrame_=function(){var e=document.createElement("iframe");if(e.style.display="none",document.body){document.body.appendChild(e);try{var n=e.contentWindow.document;n||nt("No IE domain setting required")}catch{var r=document.domain;e.src="javascript:void((function(){document.open();document.domain='"+r+"';document.close();})())"}}else throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";return e.contentDocument?e.doc=e.contentDocument:e.contentWindow?e.doc=e.contentWindow.document:e.document&&(e.doc=e.document),e},t.prototype.close=function(){var e=this;this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){e.myIFrame!==null&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)},Math.floor(0)));var n=this.onDisconnect;n&&(this.onDisconnect=null,n())},t.prototype.startLongPoll=function(e,n){for(this.myID=e,this.myPW=n,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.size<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var e={};e[nA]=this.myID,e[rA]=this.myPW,e[iA]=this.currentSerial;for(var n=this.urlFn(e),r="",o=0;this.pendingSegs.length>0;){var s=this.pendingSegs[0];if(s.d.length+sA+r.length<=oA){var u=this.pendingSegs.shift();r=r+"&"+gF+o+"="+u.seg+"&"+mF+o+"="+u.ts+"&"+yF+o+"="+u.d,o++}else break}return n=n+r,this.addLongPollTag_(n,this.currentSerial),!0}else return!1},t.prototype.enqueueSegment=function(e,n,r){this.pendingSegs.push({seg:e,ts:n,d:r}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(e,n){var r=this;this.outstandingRequests.add(n);var o=function(){r.outstandingRequests.delete(n),r.newRequest_()},s=setTimeout(o,Math.floor(bF)),u=function(){clearTimeout(s),o()};this.addTag(e,u)},t.prototype.addTag=function(e,n){var r=this;setTimeout(function(){try{if(!r.sendNewPolls)return;var o=r.myIFrame.doc.createElement("script");o.type="text/javascript",o.async=!0,o.src=e,o.onload=o.onreadystatechange=function(){var s=o.readyState;(!s||s==="loaded"||s==="complete")&&(o.onload=o.onreadystatechange=null,o.parentNode&&o.parentNode.removeChild(o),n())},o.onerror=function(){nt("Long-poll script failed to load: "+e),r.sendNewPolls=!1,r.close()},r.myIFrame.doc.body.appendChild(o)}catch{}},Math.floor(1))},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var TF=16384,SF=45e3,Ll=null;typeof MozWebSocket<"u"?Ll=MozWebSocket:typeof WebSocket<"u"&&(Ll=WebSocket);var Si=function(){function t(e,n,r,o,s,u,l){this.connId=e,this.applicationId=r,this.appCheckToken=o,this.authToken=s,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=Cu(this.connId),this.stats_=Cm(n),this.connURL=t.connectionURL_(n,u,l,o),this.nodeAdmin=n.nodeAdmin}return t.connectionURL_=function(e,n,r,o){var s={};return s[zC]=Tm,typeof location<"u"&&location.hostname&&XC.test(location.hostname)&&(s[QC]=YC),n&&(s[$C]=n),r&&(s[JC]=r),o&&(s[Uv]=o),tA(e,ZC,s)},t.prototype.open=function(e,n){var r=this;this.onDisconnect=n,this.onMessage=e,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,Ri.set("previous_websocket_failure",!0);try{var o,s,u,l;if(!VE()){var s={headers:{"X-Firebase-GMPID":this.applicationId||"","X-Firebase-AppCheck":this.appCheckToken||""}};this.mySock=new Ll(this.connURL,[],s)}}catch(d){this.log_("Error instantiating WebSocket.");var h=d.message||d.data;h&&this.log_(h),this.onClosed_();return}this.mySock.onopen=function(){r.log_("Websocket connected."),r.everConnected_=!0},this.mySock.onclose=function(){r.log_("Websocket connection was disconnected."),r.mySock=null,r.onClosed_()},this.mySock.onmessage=function(d){r.handleIncomingFrame(d)},this.mySock.onerror=function(d){r.log_("WebSocket error.  Closing connection.");var p=d.message||d.data;p&&r.log_(p),r.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if(typeof navigator<"u"&&navigator.userAgent){var n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&Ll!==null&&!t.forceDisallow_},t.previouslyFailed=function(){return Ri.isInMemoryStorage||Ri.get("previous_websocket_failure")===!0},t.prototype.markConnectionHealthy=function(){Ri.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(e){if(this.frames.push(e),this.frames.length===this.totalFrames){var n=this.frames.join("");this.frames=null;var r=Ua(n);this.onMessage(r)}},t.prototype.handleNewFrameCount_=function(e){this.totalFrames=e,this.frames=[]},t.prototype.extractFrameCount_=function(e){if(L(this.frames===null,"We already have a frame buffer"),e.length<=6){var n=Number(e);if(!isNaN(n))return this.handleNewFrameCount_(n),null}return this.handleNewFrameCount_(1),e},t.prototype.handleIncomingFrame=function(e){if(this.mySock!==null){var n=e.data;if(this.bytesReceived+=n.length,this.stats_.incrementCounter("bytes_received",n.length),this.resetKeepAlive(),this.frames!==null)this.appendFrame_(n);else{var r=this.extractFrameCount_(n);r!==null&&this.appendFrame_(r)}}},t.prototype.send=function(e){this.resetKeepAlive();var n=Qe(e);this.bytesSent+=n.length,this.stats_.incrementCounter("bytes_sent",n.length);var r=WC(n,TF);r.length>1&&this.sendString_(String(r.length));for(var o=0;o<r.length;o++)this.sendString_(r[o])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var e=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){e.mySock&&e.sendString_("0"),e.resetKeepAlive()},Math.floor(SF))},t.prototype.sendString_=function(e){try{this.mySock.send(e)}catch(n){this.log_("Exception thrown from WebSocket.send():",n.message||n.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var CF=function(){function t(e){this.initTransports_(e)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[Am,Si]},enumerable:!1,configurable:!0}),t.prototype.initTransports_=function(e){var n,r,o=Si&&Si.isAvailable(),s=o&&!Si.previouslyFailed();if(e.webSocketOnly&&(o||ht("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),s=!0),s)this.transports_=[Si];else{var u=this.transports_=[];try{for(var l=Ot(t.ALL_TRANSPORTS),h=l.next();!h.done;h=l.next()){var d=h.value;d&&d.isAvailable()&&u.push(d)}}catch(p){n={error:p}}finally{try{h&&!h.done&&(r=l.return)&&r.call(l)}finally{if(n)throw n.error}}}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var AF=6e4,kF=5e3,NF=10*1024,RF=100*1024,Xp="t",MI="d",DF="s",FI="r",OF="e",UI="o",VI="a",jI="n",BI="p",PF="h",aA=function(){function t(e,n,r,o,s,u,l,h,d,p){this.id=e,this.repoInfo_=n,this.applicationId_=r,this.appCheckToken_=o,this.authToken_=s,this.onMessage_=u,this.onReady_=l,this.onDisconnect_=h,this.onKill_=d,this.lastSessionId=p,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=Cu("c:"+this.id+":"),this.transportManager_=new CF(n),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var e=this,n=this.transportManager_.initialTransport();this.conn_=new n(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,null,this.lastSessionId),this.primaryResponsesRequired_=n.responsesRequiredToBeHealthy||0;var r=this.connReceiver_(this.conn_),o=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){e.conn_&&e.conn_.open(r,o)},Math.floor(0));var s=n.healthyTimeout||0;s>0&&(this.healthyTimeout_=Ra(function(){e.healthyTimeout_=null,e.isHealthy_||(e.conn_&&e.conn_.bytesReceived>RF?(e.log_("Connection exceeded healthy timeout but has received "+e.conn_.bytesReceived+" bytes.  Marking connection healthy."),e.isHealthy_=!0,e.conn_.markConnectionHealthy()):e.conn_&&e.conn_.bytesSent>NF?e.log_("Connection exceeded healthy timeout but has sent "+e.conn_.bytesSent+" bytes.  Leaving connection alive."):(e.log_("Closing unhealthy connection after timeout."),e.close()))},Math.floor(s)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(e){var n=this;return function(r){e===n.conn_?n.onConnectionLost_(r):e===n.secondaryConn_?(n.log_("Secondary connection lost."),n.onSecondaryConnectionLost_()):n.log_("closing an old connection")}},t.prototype.connReceiver_=function(e){var n=this;return function(r){n.state_!==2&&(e===n.rx_?n.onPrimaryMessageReceived_(r):e===n.secondaryConn_?n.onSecondaryMessageReceived_(r):n.log_("message on old connection"))}},t.prototype.sendRequest=function(e){var n={t:"d",d:e};this.sendData_(n)},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(e){if(Xp in e){var n=e[Xp];n===VI?this.upgradeIfSecondaryHealthy_():n===FI?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),(this.tx_===this.secondaryConn_||this.rx_===this.secondaryConn_)&&this.close()):n===UI&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(e){var n=ya("t",e),r=ya("d",e);if(n==="c")this.onSecondaryControl_(r);else if(n==="d")this.pendingDataMessages.push(r);else throw new Error("Unknown protocol layer: "+n)},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:BI,d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:VI,d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:jI,d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(e){var n=ya("t",e),r=ya("d",e);n==="c"?this.onControl_(r):n==="d"&&this.onDataMessage_(r)},t.prototype.onDataMessage_=function(e){this.onPrimaryResponse_(),this.onMessage_(e)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||(this.primaryResponsesRequired_--,this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy()))},t.prototype.onControl_=function(e){var n=ya(Xp,e);if(MI in e){var r=e[MI];if(n===PF)this.onHandshake_(r);else if(n===jI){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var o=0;o<this.pendingDataMessages.length;++o)this.onDataMessage_(this.pendingDataMessages[o]);this.pendingDataMessages=[],this.tryCleanupConnection()}else n===DF?this.onConnectionShutdown_(r):n===FI?this.onReset_(r):n===OF?Fv("Server Error: "+r):n===UI?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):Fv("Unknown control packet command: "+n)}},t.prototype.onHandshake_=function(e){var n=e.ts,r=e.v,o=e.h;this.sessionId=e.s,this.repoInfo_.host=o,this.state_===0&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,n),Tm!==r&&ht("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var e=this.transportManager_.upgradeTransport();e&&this.startUpgrade_(e)},t.prototype.startUpgrade_=function(e){var n=this;this.secondaryConn_=new e(this.nextTransportId_(),this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,this.sessionId),this.secondaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var r=this.connReceiver_(this.secondaryConn_),o=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(r,o),Ra(function(){n.secondaryConn_&&(n.log_("Timed out trying to upgrade."),n.secondaryConn_.close())},Math.floor(AF))},t.prototype.onReset_=function(e){this.log_("Reset packet received.  New host: "+e),this.repoInfo_.host=e,this.state_===1?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(e,n){var r=this;this.log_("Realtime connection established."),this.conn_=e,this.state_=1,this.onReady_&&(this.onReady_(n,this.sessionId),this.onReady_=null),this.primaryResponsesRequired_===0?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):Ra(function(){r.sendPingOnPrimaryIfNecessary_()},Math.floor(kF))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){!this.isHealthy_&&this.state_===1&&(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:BI,d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var e=this.secondaryConn_;this.secondaryConn_=null,(this.tx_===e||this.rx_===e)&&this.close()},t.prototype.onConnectionLost_=function(e){this.conn_=null,!e&&this.state_===0?(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(Ri.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)):this.state_===1&&this.log_("Realtime connection lost."),this.close()},t.prototype.onConnectionShutdown_=function(e){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(e),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(e){if(this.state_!==1)throw"Connection is not connected";this.tx_.send(e)},t.prototype.close=function(){this.state_!==2&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var uA=function(){function t(){}return t.prototype.put=function(e,n,r,o){},t.prototype.merge=function(e,n,r,o){},t.prototype.refreshAuthToken=function(e){},t.prototype.refreshAppCheckToken=function(e){},t.prototype.onDisconnectPut=function(e,n,r){},t.prototype.onDisconnectMerge=function(e,n,r){},t.prototype.onDisconnectCancel=function(e,n){},t.prototype.reportStats=function(e){},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var cA=function(){function t(e){this.allowedEvents_=e,this.listeners_={},L(Array.isArray(e)&&e.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];if(Array.isArray(this.listeners_[e]))for(var o=ve([],gt(this.listeners_[e])),s=0;s<o.length;s++)o[s].callback.apply(o[s].context,n)},t.prototype.on=function(e,n,r){this.validateEventType_(e),this.listeners_[e]=this.listeners_[e]||[],this.listeners_[e].push({callback:n,context:r});var o=this.getInitialEvent(e);o&&n.apply(r,o)},t.prototype.off=function(e,n,r){this.validateEventType_(e);for(var o=this.listeners_[e]||[],s=0;s<o.length;s++)if(o[s].callback===n&&(!r||r===o[s].context)){o.splice(s,1);return}},t.prototype.validateEventType_=function(e){L(this.allowedEvents_.find(function(n){return n===e}),"Unknown event: "+e)},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var qI=function(t){V(e,t);function e(){var n=t.call(this,["online"])||this;return n.online_=!0,typeof window<"u"&&typeof window.addEventListener<"u"&&!cg()&&(window.addEventListener("online",function(){n.online_||(n.online_=!0,n.trigger("online",!0))},!1),window.addEventListener("offline",function(){n.online_&&(n.online_=!1,n.trigger("online",!1))},!1)),n}return e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(n){return L(n==="online","Unknown event type: "+n),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(cA);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var GI=32,WI=768,_e=function(){function t(e,n){if(n===void 0){this.pieces_=e.split("/");for(var r=0,o=0;o<this.pieces_.length;o++)this.pieces_[o].length>0&&(this.pieces_[r]=this.pieces_[o],r++);this.pieces_.length=r,this.pieceNum_=0}else this.pieces_=e,this.pieceNum_=n}return t.prototype.toString=function(){for(var e="",n=this.pieceNum_;n<this.pieces_.length;n++)this.pieces_[n]!==""&&(e+="/"+this.pieces_[n]);return e||"/"},t}();function pe(){return new _e("")}function ie(t){return t.pieceNum_>=t.pieces_.length?null:t.pieces_[t.pieceNum_]}function Gr(t){return t.pieces_.length-t.pieceNum_}function Ie(t){var e=t.pieceNum_;return e<t.pieces_.length&&e++,new _e(t.pieces_,e)}function km(t){return t.pieceNum_<t.pieces_.length?t.pieces_[t.pieces_.length-1]:null}function xF(t){for(var e="",n=t.pieceNum_;n<t.pieces_.length;n++)t.pieces_[n]!==""&&(e+="/"+encodeURIComponent(String(t.pieces_[n])));return e||"/"}function tu(t,e){return e===void 0&&(e=0),t.pieces_.slice(t.pieceNum_+e)}function lA(t){if(t.pieceNum_>=t.pieces_.length)return null;for(var e=[],n=t.pieceNum_;n<t.pieces_.length-1;n++)e.push(t.pieces_[n]);return new _e(e,0)}function Re(t,e){for(var n=[],r=t.pieceNum_;r<t.pieces_.length;r++)n.push(t.pieces_[r]);if(e instanceof _e)for(var r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else for(var o=e.split("/"),r=0;r<o.length;r++)o[r].length>0&&n.push(o[r]);return new _e(n,0)}function oe(t){return t.pieceNum_>=t.pieces_.length}function Dt(t,e){var n=ie(t),r=ie(e);if(n===null)return e;if(n===r)return Dt(Ie(t),Ie(e));throw new Error("INTERNAL ERROR: innerPath ("+e+") is not within outerPath ("+t+")")}function LF(t,e){for(var n=tu(t,0),r=tu(e,0),o=0;o<n.length&&o<r.length;o++){var s=io(n[o],r[o]);if(s!==0)return s}return n.length===r.length?0:n.length<r.length?-1:1}function Nm(t,e){if(Gr(t)!==Gr(e))return!1;for(var n=t.pieceNum_,r=e.pieceNum_;n<=t.pieces_.length;n++,r++)if(t.pieces_[n]!==e.pieces_[r])return!1;return!0}function cn(t,e){var n=t.pieceNum_,r=e.pieceNum_;if(Gr(t)>Gr(e))return!1;for(;n<t.pieces_.length;){if(t.pieces_[n]!==e.pieces_[r])return!1;++n,++r}return!0}var MF=function(){function t(e,n){this.errorPrefix_=n,this.parts_=tu(e,0),this.byteLength_=Math.max(1,this.parts_.length);for(var r=0;r<this.parts_.length;r++)this.byteLength_+=Yl(this.parts_[r]);hA(this)}return t}();function FF(t,e){t.parts_.length>0&&(t.byteLength_+=1),t.parts_.push(e),t.byteLength_+=Yl(e),hA(t)}function UF(t){var e=t.parts_.pop();t.byteLength_-=Yl(e),t.parts_.length>0&&(t.byteLength_-=1)}function hA(t){if(t.byteLength_>WI)throw new Error(t.errorPrefix_+"has a key path longer than "+WI+" bytes ("+t.byteLength_+").");if(t.parts_.length>GI)throw new Error(t.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+GI+") or object contains a cycle "+Ei(t))}function Ei(t){return t.parts_.length===0?"":"in property '"+t.parts_.join(".")+"'"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var VF=function(t){V(e,t);function e(){var n=t.call(this,["visible"])||this,r,o;return typeof document<"u"&&typeof document.addEventListener<"u"&&(typeof document.hidden<"u"?(o="visibilitychange",r="hidden"):typeof document.mozHidden<"u"?(o="mozvisibilitychange",r="mozHidden"):typeof document.msHidden<"u"?(o="msvisibilitychange",r="msHidden"):typeof document.webkitHidden<"u"&&(o="webkitvisibilitychange",r="webkitHidden")),n.visible_=!0,o&&document.addEventListener(o,function(){var s=!document[r];s!==n.visible_&&(n.visible_=s,n.trigger("visible",s))},!1),n}return e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(n){return L(n==="visible","Unknown event type: "+n),[this.visible_]},e}(cA);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var _a=1e3,jF=60*5*1e3,BF=3*1e3,HI=30*1e3,qF=1.3,GF=3e4,WF="server_kill",KI=3,Fi=function(t){V(e,t);function e(n,r,o,s,u,l,h,d){var p=t.call(this)||this;if(p.repoInfo_=n,p.applicationId_=r,p.onDataUpdate_=o,p.onConnectStatus_=s,p.onServerInfoUpdate_=u,p.authTokenProvider_=l,p.appCheckTokenProvider_=h,p.authOverride_=d,p.id=e.nextPersistentConnectionId_++,p.log_=Cu("p:"+p.id+":"),p.interruptReasons_={},p.listens=new Map,p.outstandingPuts_=[],p.outstandingGets_=[],p.outstandingPutCount_=0,p.outstandingGetCount_=0,p.onDisconnectRequestQueue_=[],p.connected_=!1,p.reconnectDelay_=_a,p.maxReconnectDelay_=jF,p.securityDebugCallback_=null,p.lastSessionId=null,p.establishConnectionTimer_=null,p.visible_=!1,p.requestCBHash_={},p.requestNumber_=0,p.realtime_=null,p.authToken_=null,p.appCheckToken_=null,p.forceTokenRefresh_=!1,p.invalidAuthTokenCount_=0,p.invalidAppCheckTokenCount_=0,p.firstConnection_=!0,p.lastConnectionAttemptTime_=null,p.lastConnectionEstablishedTime_=null,d&&!VE())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return VF.getInstance().on("visible",p.onVisible_,p),n.host.indexOf("fblocal")===-1&&qI.getInstance().on("online",p.onOnline_,p),p}return e.prototype.sendRequest=function(n,r,o){var s=++this.requestNumber_,u={r:s,a:n,b:r};this.log_(Qe(u)),L(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(u),o&&(this.requestCBHash_[s]=o)},e.prototype.get=function(n){var r=this;this.initConnection_();var o=new Ut,s={p:n._path.toString(),q:n._queryObject},u={action:"g",request:s,onComplete:function(h){var d=h.d;h.s==="ok"?(r.onDataUpdate_(s.p,d,!1,null),o.resolve(d)):o.reject(d)}};this.outstandingGets_.push(u),this.outstandingGetCount_++;var l=this.outstandingGets_.length-1;return this.connected_||setTimeout(function(){var h=r.outstandingGets_[l];h===void 0||u!==h||(delete r.outstandingGets_[l],r.outstandingGetCount_--,r.outstandingGetCount_===0&&(r.outstandingGets_=[]),r.log_("get "+l+" timed out on connection"),o.reject(new Error("Client is offline.")))},BF),this.connected_&&this.sendGet_(l),o.promise},e.prototype.listen=function(n,r,o,s){this.initConnection_();var u=n._queryIdentifier,l=n._path.toString();this.log_("Listen called for "+l+" "+u),this.listens.has(l)||this.listens.set(l,new Map),L(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"listen() called for non-default but complete query"),L(!this.listens.get(l).has(u),"listen() called twice for same path/queryId.");var h={onComplete:s,hashFn:r,query:n,tag:o};this.listens.get(l).set(u,h),this.connected_&&this.sendListen_(h)},e.prototype.sendGet_=function(n){var r=this,o=this.outstandingGets_[n];this.sendRequest("g",o.request,function(s){delete r.outstandingGets_[n],r.outstandingGetCount_--,r.outstandingGetCount_===0&&(r.outstandingGets_=[]),o.onComplete&&o.onComplete(s)})},e.prototype.sendListen_=function(n){var r=this,o=n.query,s=o._path.toString(),u=o._queryIdentifier;this.log_("Listen on "+s+" for "+u);var l={p:s},h="q";n.tag&&(l.q=o._queryObject,l.t=n.tag),l.h=n.hashFn(),this.sendRequest(h,l,function(d){var p=d.d,g=d.s;e.warnOnListenWarnings_(p,o);var y=r.listens.get(s)&&r.listens.get(s).get(u);y===n&&(r.log_("listen response",d),g!=="ok"&&r.removeListen_(s,u),n.onComplete&&n.onComplete(g,p))})},e.warnOnListenWarnings_=function(n,r){if(n&&typeof n=="object"&&tn(n,"w")){var o=ji(n,"w");if(Array.isArray(o)&&~o.indexOf("no_index")){var s='".indexOn": "'+r._queryParams.getIndex().toString()+'"',u=r._path.toString();ht("Using an unspecified index. Your data will be downloaded and "+("filtered on the client. Consider adding "+s+" at ")+(u+" to your security rules for better performance."))}}},e.prototype.refreshAuthToken=function(n){this.authToken_=n,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(n)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(n){var r=n&&n.length===40;(r||dO(n))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=HI)},e.prototype.refreshAppCheckToken=function(n){this.appCheckToken_=n,this.log_("App check token refreshed"),this.appCheckToken_?this.tryAppCheck():this.connected_&&this.sendRequest("unappeck",{},function(){})},e.prototype.tryAuth=function(){var n=this;if(this.connected_&&this.authToken_){var r=this.authToken_,o=fO(r)?"auth":"gauth",s={cred:r};this.authOverride_===null?s.noauth=!0:typeof this.authOverride_=="object"&&(s.authvar=this.authOverride_),this.sendRequest(o,s,function(u){var l=u.s,h=u.d||"error";n.authToken_===r&&(l==="ok"?n.invalidAuthTokenCount_=0:n.onAuthRevoked_(l,h))})}},e.prototype.tryAppCheck=function(){var n=this;this.connected_&&this.appCheckToken_&&this.sendRequest("appcheck",{token:this.appCheckToken_},function(r){var o=r.s,s=r.d||"error";o==="ok"?n.invalidAppCheckTokenCount_=0:n.onAppCheckRevoked_(o,s)})},e.prototype.unlisten=function(n,r){var o=n._path.toString(),s=n._queryIdentifier;this.log_("Unlisten called for "+o+" "+s),L(n._queryParams.isDefault()||!n._queryParams.loadsAllData(),"unlisten() called for non-default but complete query");var u=this.removeListen_(o,s);u&&this.connected_&&this.sendUnlisten_(o,s,n._queryObject,r)},e.prototype.sendUnlisten_=function(n,r,o,s){this.log_("Unlisten on "+n+" for "+r);var u={p:n},l="n";s&&(u.q=o,u.t=s),this.sendRequest(l,u)},e.prototype.onDisconnectPut=function(n,r,o){this.initConnection_(),this.connected_?this.sendOnDisconnect_("o",n,r,o):this.onDisconnectRequestQueue_.push({pathString:n,action:"o",data:r,onComplete:o})},e.prototype.onDisconnectMerge=function(n,r,o){this.initConnection_(),this.connected_?this.sendOnDisconnect_("om",n,r,o):this.onDisconnectRequestQueue_.push({pathString:n,action:"om",data:r,onComplete:o})},e.prototype.onDisconnectCancel=function(n,r){this.initConnection_(),this.connected_?this.sendOnDisconnect_("oc",n,null,r):this.onDisconnectRequestQueue_.push({pathString:n,action:"oc",data:null,onComplete:r})},e.prototype.sendOnDisconnect_=function(n,r,o,s){var u={p:r,d:o};this.log_("onDisconnect "+n,u),this.sendRequest(n,u,function(l){s&&setTimeout(function(){s(l.s,l.d)},Math.floor(0))})},e.prototype.put=function(n,r,o,s){this.putInternal("p",n,r,o,s)},e.prototype.merge=function(n,r,o,s){this.putInternal("m",n,r,o,s)},e.prototype.putInternal=function(n,r,o,s,u){this.initConnection_();var l={p:r,d:o};u!==void 0&&(l.h=u),this.outstandingPuts_.push({action:n,request:l,onComplete:s}),this.outstandingPutCount_++;var h=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(h):this.log_("Buffering put: "+r)},e.prototype.sendPut_=function(n){var r=this,o=this.outstandingPuts_[n].action,s=this.outstandingPuts_[n].request,u=this.outstandingPuts_[n].onComplete;this.outstandingPuts_[n].queued=this.connected_,this.sendRequest(o,s,function(l){r.log_(o+" response",l),delete r.outstandingPuts_[n],r.outstandingPutCount_--,r.outstandingPutCount_===0&&(r.outstandingPuts_=[]),u&&u(l.s,l.d)})},e.prototype.reportStats=function(n){var r=this;if(this.connected_){var o={c:n};this.log_("reportStats",o),this.sendRequest("s",o,function(s){var u=s.s;if(u!=="ok"){var l=s.d;r.log_("reportStats","Error sending stats: "+l)}})}},e.prototype.onDataMessage_=function(n){if("r"in n){this.log_("from server: "+Qe(n));var r=n.r,o=this.requestCBHash_[r];o&&(delete this.requestCBHash_[r],o(n.b))}else{if("error"in n)throw"A server-side error has occurred: "+n.error;"a"in n&&this.onDataPush_(n.a,n.b)}},e.prototype.onDataPush_=function(n,r){this.log_("handleServerMessage",n,r),n==="d"?this.onDataUpdate_(r.p,r.d,!1,r.t):n==="m"?this.onDataUpdate_(r.p,r.d,!0,r.t):n==="c"?this.onListenRevoked_(r.p,r.q):n==="ac"?this.onAuthRevoked_(r.s,r.d):n==="apc"?this.onAppCheckRevoked_(r.s,r.d):n==="sd"?this.onSecurityDebugPacket_(r):Fv("Unrecognized action received from server: "+Qe(n)+`
Are you using the latest client?`)},e.prototype.onReady_=function(n,r){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=new Date().getTime(),this.handleTimestamp_(n),this.lastSessionId=r,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(n){var r=this;L(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){r.establishConnectionTimer_=null,r.establishConnection_()},Math.floor(n))},e.prototype.initConnection_=function(){!this.realtime_&&this.firstConnection_&&this.scheduleConnect_(0)},e.prototype.onVisible_=function(n){n&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=_a,this.realtime_||this.scheduleConnect_(0)),this.visible_=n},e.prototype.onOnline_=function(n){n?(this.log_("Browser went online."),this.reconnectDelay_=_a,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(!this.visible_)this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=new Date().getTime();else if(this.lastConnectionEstablishedTime_){var n=new Date().getTime()-this.lastConnectionEstablishedTime_;n>GF&&(this.reconnectDelay_=_a),this.lastConnectionEstablishedTime_=null}var r=new Date().getTime()-this.lastConnectionAttemptTime_,o=Math.max(0,this.reconnectDelay_-r);o=Math.random()*o,this.log_("Trying to reconnect in "+o+"ms"),this.scheduleConnect_(o),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,this.reconnectDelay_*qF)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){return A(this,void 0,void 0,function(){var n,r,o,s,u,l,h,d,p,g,y,w,b,E,T=this;return C(this,function(k){switch(k.label){case 0:if(!this.shouldReconnect_())return[3,4];this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=new Date().getTime(),this.lastConnectionEstablishedTime_=null,n=this.onDataMessage_.bind(this),r=this.onReady_.bind(this),o=this.onRealtimeDisconnect_.bind(this),s=this.id+":"+e.nextConnectionId_++,u=this.lastSessionId,l=!1,h=null,d=function(){h?h.close():(l=!0,o())},p=function(O){L(h,"sendRequest call when we're not connected not allowed."),h.sendRequest(O)},this.realtime_={close:d,sendRequest:p},g=this.forceTokenRefresh_,this.forceTokenRefresh_=!1,k.label=1;case 1:return k.trys.push([1,3,,4]),[4,Promise.all([this.authTokenProvider_.getToken(g),this.appCheckTokenProvider_.getToken(g)])];case 2:return y=gt.apply(void 0,[k.sent(),2]),w=y[0],b=y[1],l?nt("getToken() completed but was canceled"):(nt("getToken() completed. Creating connection."),this.authToken_=w&&w.accessToken,this.appCheckToken_=b&&b.token,h=new aA(s,this.repoInfo_,this.applicationId_,this.appCheckToken_,this.authToken_,n,r,o,function(O){ht(O+" ("+T.repoInfo_.toString()+")"),T.interrupt(WF)},u)),[3,4];case 3:return E=k.sent(),this.log_("Failed to get token: "+E),l||(this.repoInfo_.nodeAdmin&&ht(E),d()),[3,4];case 4:return[2]}})})},e.prototype.interrupt=function(n){nt("Interrupting connection for reason: "+n),this.interruptReasons_[n]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(n){nt("Resuming connection for reason: "+n),delete this.interruptReasons_[n],av(this.interruptReasons_)&&(this.reconnectDelay_=_a,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(n){var r=n-new Date().getTime();this.onServerInfoUpdate_({serverTimeOffset:r})},e.prototype.cancelSentTransactions_=function(){for(var n=0;n<this.outstandingPuts_.length;n++){var r=this.outstandingPuts_[n];r&&"h"in r.request&&r.queued&&(r.onComplete&&r.onComplete("disconnect"),delete this.outstandingPuts_[n],this.outstandingPutCount_--)}this.outstandingPutCount_===0&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(n,r){var o;r?o=r.map(function(u){return Im(u)}).join("$"):o="default";var s=this.removeListen_(n,o);s&&s.onComplete&&s.onComplete("permission_denied")},e.prototype.removeListen_=function(n,r){var o=new _e(n).toString(),s;if(this.listens.has(o)){var u=this.listens.get(o);s=u.get(r),u.delete(r),u.size===0&&this.listens.delete(o)}else s=void 0;return s},e.prototype.onAuthRevoked_=function(n,r){nt("Auth token revoked: "+n+"/"+r),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),(n==="invalid_token"||n==="permission_denied")&&(this.invalidAuthTokenCount_++,this.invalidAuthTokenCount_>=KI&&(this.reconnectDelay_=HI,this.authTokenProvider_.notifyForInvalidToken()))},e.prototype.onAppCheckRevoked_=function(n,r){nt("App check token revoked: "+n+"/"+r),this.appCheckToken_=null,this.forceTokenRefresh_=!0,(n==="invalid_token"||n==="permission_denied")&&(this.invalidAppCheckTokenCount_++,this.invalidAppCheckTokenCount_>=KI&&this.appCheckTokenProvider_.notifyForInvalidToken())},e.prototype.onSecurityDebugPacket_=function(n){this.securityDebugCallback_?this.securityDebugCallback_(n):"msg"in n&&console.log("FIREBASE: "+n.msg.replace(`
`,`
FIREBASE: `))},e.prototype.restoreState_=function(){var n,r,o,s;this.tryAuth(),this.tryAppCheck();try{for(var u=Ot(this.listens.values()),l=u.next();!l.done;l=u.next()){var h=l.value;try{for(var d=(o=void 0,Ot(h.values())),p=d.next();!p.done;p=d.next()){var g=p.value;this.sendListen_(g)}}catch(b){o={error:b}}finally{try{p&&!p.done&&(s=d.return)&&s.call(d)}finally{if(o)throw o.error}}}}catch(b){n={error:b}}finally{try{l&&!l.done&&(r=u.return)&&r.call(u)}finally{if(n)throw n.error}}for(var y=0;y<this.outstandingPuts_.length;y++)this.outstandingPuts_[y]&&this.sendPut_(y);for(;this.onDisconnectRequestQueue_.length;){var w=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(w.action,w.pathString,w.data,w.onComplete)}for(var y=0;y<this.outstandingGets_.length;y++)this.outstandingGets_[y]&&this.sendGet_(y)},e.prototype.sendConnectStats_=function(){var n={},r="js";n["sdk."+r+"."+UC.replace(/\./g,"-")]=1,cg()?n["framework.cordova"]=1:UE()&&(n["framework.reactnative"]=1),this.reportStats(n)},e.prototype.shouldReconnect_=function(){var n=qI.getInstance().currentlyOnline();return av(this.interruptReasons_)&&n},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(uA);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var le=function(){function t(e,n){this.name=e,this.node=n}return t.Wrap=function(e,n){return new t(e,n)},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rh=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(e,n){var r=new le(pr,e),o=new le(pr,n);return this.compare(r,o)!==0},t.prototype.minPost=function(){return le.MIN},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Kc,fA=function(t){V(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return Kc},set:function(n){Kc=n},enumerable:!1,configurable:!0}),e.prototype.compare=function(n,r){return io(n.name,r.name)},e.prototype.isDefinedOn=function(n){throw vs("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(n,r){return!1},e.prototype.minPost=function(){return le.MIN},e.prototype.maxPost=function(){return new le(Yn,Kc)},e.prototype.makePost=function(n,r){return L(typeof n=="string","KeyIndex indexValue must always be a string."),new le(n,Kc)},e.prototype.toString=function(){return".key"},e}(Rh),Wn=new fA;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zc=function(){function t(e,n,r,o,s){s===void 0&&(s=null),this.isReverse_=o,this.resultGenerator_=s,this.nodeStack_=[];for(var u=1;!e.isEmpty();)if(e=e,u=n?r(e.key,n):1,o&&(u*=-1),u<0)this.isReverse_?e=e.left:e=e.right;else if(u===0){this.nodeStack_.push(e);break}else this.nodeStack_.push(e),this.isReverse_?e=e.right:e=e.left}return t.prototype.getNext=function(){if(this.nodeStack_.length===0)return null;var e=this.nodeStack_.pop(),n;if(this.resultGenerator_?n=this.resultGenerator_(e.key,e.value):n={key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return n},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(this.nodeStack_.length===0)return null;var e=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value}},t}(),Cn=function(){function t(e,n,r,o,s){this.key=e,this.value=n,this.color=r??t.RED,this.left=o??ur.EMPTY_NODE,this.right=s??ur.EMPTY_NODE}return t.prototype.copy=function(e,n,r,o,s){return new t(e??this.key,n??this.value,r??this.color,o??this.left,s??this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(e){return this.left.inorderTraversal(e)||!!e(this.key,this.value)||this.right.inorderTraversal(e)},t.prototype.reverseTraversal=function(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(e,n,r){var o=this,s=r(e,o.key);return s<0?o=o.copy(null,null,null,o.left.insert(e,n,r),null):s===0?o=o.copy(null,n,null,null,null):o=o.copy(null,null,null,null,o.right.insert(e,n,r)),o.fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return ur.EMPTY_NODE;var e=this;return!e.left.isRed_()&&!e.left.left.isRed_()&&(e=e.moveRedLeft_()),e=e.copy(null,null,null,e.left.removeMin_(),null),e.fixUp_()},t.prototype.remove=function(e,n){var r,o;if(r=this,n(e,r.key)<0)!r.left.isEmpty()&&!r.left.isRed_()&&!r.left.left.isRed_()&&(r=r.moveRedLeft_()),r=r.copy(null,null,null,r.left.remove(e,n),null);else{if(r.left.isRed_()&&(r=r.rotateRight_()),!r.right.isEmpty()&&!r.right.isRed_()&&!r.right.left.isRed_()&&(r=r.moveRedRight_()),n(e,r.key)===0){if(r.right.isEmpty())return ur.EMPTY_NODE;o=r.right.min_(),r=r.copy(o.key,o.value,null,null,r.right.removeMin_())}r=r.copy(null,null,null,null,r.right.remove(e,n))}return r.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var e=this;return e.right.isRed_()&&!e.left.isRed_()&&(e=e.rotateLeft_()),e.left.isRed_()&&e.left.left.isRed_()&&(e=e.rotateRight_()),e.left.isRed_()&&e.right.isRed_()&&(e=e.colorFlip_()),e},t.prototype.moveRedLeft_=function(){var e=this.colorFlip_();return e.right.left.isRed_()&&(e=e.copy(null,null,null,null,e.right.rotateRight_()),e=e.rotateLeft_(),e=e.colorFlip_()),e},t.prototype.moveRedRight_=function(){var e=this.colorFlip_();return e.left.left.isRed_()&&(e=e.rotateRight_(),e=e.colorFlip_()),e},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)},t.prototype.checkMaxDepth_=function(){var e=this.check_();return Math.pow(2,e)<=this.count()+1},t.prototype.check_=function(){if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");var e=this.left.check_();if(e!==this.right.check_())throw new Error("Black depths differ");return e+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),HF=function(){function t(){}return t.prototype.copy=function(e,n,r,o,s){return this},t.prototype.insert=function(e,n,r){return new Cn(e,n,null)},t.prototype.remove=function(e,n){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(e){return!1},t.prototype.reverseTraversal=function(e){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),ur=function(){function t(e,n){n===void 0&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,Cn.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,Cn.BLACK,null,null))},t.prototype.get=function(e){for(var n,r=this.root_;!r.isEmpty();){if(n=this.comparator_(e,r.key),n===0)return r.value;n<0?r=r.left:n>0&&(r=r.right)}return null},t.prototype.getPredecessorKey=function(e){for(var n,r=this.root_,o=null;!r.isEmpty();)if(n=this.comparator_(e,r.key),n===0){if(r.left.isEmpty())return o?o.key:null;for(r=r.left;!r.right.isEmpty();)r=r.right;return r.key}else n<0?r=r.left:n>0&&(o=r,r=r.right);throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(e){return this.root_.inorderTraversal(e)},t.prototype.reverseTraversal=function(e){return this.root_.reverseTraversal(e)},t.prototype.getIterator=function(e){return new zc(this.root_,null,this.comparator_,!1,e)},t.prototype.getIteratorFrom=function(e,n){return new zc(this.root_,e,this.comparator_,!1,n)},t.prototype.getReverseIteratorFrom=function(e,n){return new zc(this.root_,e,this.comparator_,!0,n)},t.prototype.getReverseIterator=function(e){return new zc(this.root_,null,this.comparator_,!0,e)},t.EMPTY_NODE=new HF,t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KF(t,e){return io(t.name,e.name)}function Rm(t,e){return io(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Vv;function zF(t){Vv=t}var dA=function(t){return typeof t=="number"?"number:"+HC(t):"string:"+t},pA=function(t){if(t.isLeafNode()){var e=t.val();L(typeof e=="string"||typeof e=="number"||typeof e=="object"&&tn(e,".sv"),"Priority must be a string or number.")}else L(t===Vv||t.isEmpty(),"priority of unexpected type.");L(t===Vv||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zI,cs=function(){function t(e,n){n===void 0&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,L(this.value_!==void 0&&this.value_!==null,"LeafNode shouldn't be created with null/undefined value."),pA(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return zI},set:function(e){zI=e},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return e===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return oe(e)?this:ie(e)===".priority"?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(e,n){return null},t.prototype.updateImmediateChild=function(e,n){return e===".priority"?this.updatePriority(n):n.isEmpty()&&e!==".priority"?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=ie(e);return r===null?n:n.isEmpty()&&r!==".priority"?this:(L(r!==".priority"||Gr(e)===1,".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(Ie(e),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(e,n){return!1},t.prototype.val=function(e){return e&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(this.lazyHash_===null){var e="";this.priorityNode_.isEmpty()||(e+="priority:"+dA(this.priorityNode_.val())+":");var n=typeof this.value_;e+=n+":",n==="number"?e+=HC(this.value_):e+=this.value_,this.lazyHash_=qC(e)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:(L(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,o=t.VALUE_TYPE_ORDER.indexOf(n),s=t.VALUE_TYPE_ORDER.indexOf(r);return L(o>=0,"Unknown leaf type: "+n),L(s>=0,"Unknown leaf type: "+r),o===s?r==="object"?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:s-o},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode()){var n=e;return this.value_===n.value_&&this.priorityNode_.equals(n.priorityNode_)}else return!1},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vA,gA;function $F(t){vA=t}function QF(t){gA=t}var YF=function(t){V(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.compare=function(n,r){var o=n.node.getPriority(),s=r.node.getPriority(),u=o.compareTo(s);return u===0?io(n.name,r.name):u},e.prototype.isDefinedOn=function(n){return!n.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(n,r){return!n.getPriority().equals(r.getPriority())},e.prototype.minPost=function(){return le.MIN},e.prototype.maxPost=function(){return new le(Yn,new cs("[PRIORITY-POST]",gA))},e.prototype.makePost=function(n,r){var o=vA(n);return new le(r,new cs("[PRIORITY-POST]",o))},e.prototype.toString=function(){return".priority"},e}(Rh),Se=new YF;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var XF=Math.log(2),JF=function(){function t(e){var n=function(s){return parseInt(Math.log(s)/XF,10)},r=function(s){return parseInt(Array(s+1).join("1"),2)};this.count=n(e+1),this.current_=this.count-1;var o=r(this.count);this.bits_=e+1&o}return t.prototype.nextBitIsOne=function(){var e=!(this.bits_&1<<this.current_);return this.current_--,e},t}(),Ml=function(t,e,n,r){t.sort(e);var o=function(h,d){var p=d-h,g,y;if(p===0)return null;if(p===1)return g=t[h],y=n?n(g):g,new Cn(y,g.node,Cn.BLACK,null,null);var w=parseInt(p/2,10)+h,b=o(h,w),E=o(w+1,d);return g=t[w],y=n?n(g):g,new Cn(y,g.node,Cn.BLACK,b,E)},s=function(h){for(var d=null,p=null,g=t.length,y=function(k,O){var M=g-k,H=g;g-=k;var X=o(M+1,H),F=t[M],me=n?n(F):F;w(new Cn(me,F.node,O,null,X))},w=function(k){d?(d.left=k,d=k):(p=k,d=k)},b=0;b<h.count;++b){var E=h.nextBitIsOne(),T=Math.pow(2,h.count-(b+1));E?y(T,Cn.BLACK):(y(T,Cn.BLACK),y(T,Cn.RED))}return p},u=new JF(t.length),l=s(u);return new ur(r||e,l)};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jp,Lo={},Fl=function(){function t(e,n){this.indexes_=e,this.indexSet_=n}return Object.defineProperty(t,"Default",{get:function(){return L(Lo&&Se,"ChildrenNode.ts has not been loaded"),Jp=Jp||new t({".priority":Lo},{".priority":Se}),Jp},enumerable:!1,configurable:!0}),t.prototype.get=function(e){var n=ji(this.indexes_,e);if(!n)throw new Error("No index defined for "+e);return n instanceof ur?n:null},t.prototype.hasIndex=function(e){return tn(this.indexSet_,e.toString())},t.prototype.addIndex=function(e,n){L(e!==Wn,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r=[],o=!1,s=n.getIterator(le.Wrap),u=s.getNext();u;)o=o||e.isDefinedOn(u.node),r.push(u),u=s.getNext();var l;o?l=Ml(r,e.getCompare()):l=Lo;var h=e.toString(),d=at({},this.indexSet_);d[h]=e;var p=at({},this.indexes_);return p[h]=l,new t(p,d)},t.prototype.addToIndexes=function(e,n){var r=this,o=sl(this.indexes_,function(s,u){var l=ji(r.indexSet_,u);if(L(l,"Missing index implementation for "+u),s===Lo)if(l.isDefinedOn(e.node)){for(var h=[],d=n.getIterator(le.Wrap),p=d.getNext();p;)p.name!==e.name&&h.push(p),p=d.getNext();return h.push(e),Ml(h,l.getCompare())}else return Lo;else{var g=n.get(e.name),y=s;return g&&(y=y.remove(new le(e.name,g))),y.insert(e,e.node)}});return new t(o,this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){var r=sl(this.indexes_,function(o){if(o===Lo)return o;var s=n.get(e.name);return s?o.remove(new le(e.name,s)):o});return new t(r,this.indexSet_)},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wa,te=function(){function t(e,n,r){this.children_=e,this.priorityNode_=n,this.indexMap_=r,this.lazyHash_=null,this.priorityNode_&&pA(this.priorityNode_),this.children_.isEmpty()&&L(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return wa||(wa=new t(new ur(Rm),null,Fl.Default))},enumerable:!1,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||wa},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(e){if(e===".priority")return this.getPriority();var n=this.children_.get(e);return n===null?wa:n},t.prototype.getChild=function(e){var n=ie(e);return n===null?this:this.getImmediateChild(n).getChild(Ie(e))},t.prototype.hasChild=function(e){return this.children_.get(e)!==null},t.prototype.updateImmediateChild=function(e,n){if(L(n,"We should always be passing snapshot nodes"),e===".priority")return this.updatePriority(n);var r=new le(e,n),o=void 0,s=void 0;n.isEmpty()?(o=this.children_.remove(e),s=this.indexMap_.removeFromIndexes(r,this.children_)):(o=this.children_.insert(e,n),s=this.indexMap_.addToIndexes(r,this.children_));var u=o.isEmpty()?wa:this.priorityNode_;return new t(o,u,s)},t.prototype.updateChild=function(e,n){var r=ie(e);if(r===null)return n;L(ie(e)!==".priority"||Gr(e)===1,".priority must be the last token in a path");var o=this.getImmediateChild(r).updateChild(Ie(e),n);return this.updateImmediateChild(r,o)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,o=0,s=!0;if(this.forEachChild(Se,function(h,d){n[h]=d.val(e),r++,s&&t.INTEGER_REGEXP_.test(h)?o=Math.max(o,Number(h)):s=!1}),!e&&s&&o<2*r){var u=[];for(var l in n)u[l]=n[l];return u}else return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(this.lazyHash_===null){var e="";this.getPriority().isEmpty()||(e+="priority:"+dA(this.getPriority().val())+":"),this.forEachChild(Se,function(n,r){var o=r.hash();o!==""&&(e+=":"+n+":"+o)}),this.lazyHash_=e===""?"":qC(e)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(e,n,r){var o=this.resolveIndex_(r);if(o){var s=o.getPredecessorKey(new le(e,n));return s?s.name:null}else return this.children_.getPredecessorKey(e)},t.prototype.getFirstChildName=function(e){var n=this.resolveIndex_(e);if(n){var r=n.minKey();return r&&r.name}else return this.children_.minKey()},t.prototype.getFirstChild=function(e){var n=this.getFirstChildName(e);return n?new le(n,this.children_.get(n)):null},t.prototype.getLastChildName=function(e){var n=this.resolveIndex_(e);if(n){var r=n.maxKey();return r&&r.name}else return this.children_.maxKey()},t.prototype.getLastChild=function(e){var n=this.getLastChildName(e);return n?new le(n,this.children_.get(n)):null},t.prototype.forEachChild=function(e,n){var r=this.resolveIndex_(e);return r?r.inorderTraversal(function(o){return n(o.name,o.node)}):this.children_.inorderTraversal(n)},t.prototype.getIterator=function(e){return this.getIteratorFrom(e.minPost(),e)},t.prototype.getIteratorFrom=function(e,n){var r=this.resolveIndex_(n);if(r)return r.getIteratorFrom(e,function(u){return u});for(var o=this.children_.getIteratorFrom(e.name,le.Wrap),s=o.peek();s!=null&&n.compare(s,e)<0;)o.getNext(),s=o.peek();return o},t.prototype.getReverseIterator=function(e){return this.getReverseIteratorFrom(e.maxPost(),e)},t.prototype.getReverseIteratorFrom=function(e,n){var r=this.resolveIndex_(n);if(r)return r.getReverseIteratorFrom(e,function(u){return u});for(var o=this.children_.getReverseIteratorFrom(e.name,le.Wrap),s=o.peek();s!=null&&n.compare(s,e)>0;)o.getNext(),s=o.peek();return o},t.prototype.compareTo=function(e){return this.isEmpty()?e.isEmpty()?0:-1:e.isLeafNode()||e.isEmpty()?1:e===Au?-1:0},t.prototype.withIndex=function(e){if(e===Wn||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(e){return e===Wn||this.indexMap_.hasIndex(e)},t.prototype.equals=function(e){if(e===this)return!0;if(e.isLeafNode())return!1;var n=e;if(this.getPriority().equals(n.getPriority()))if(this.children_.count()===n.children_.count()){for(var r=this.getIterator(Se),o=n.getIterator(Se),s=r.getNext(),u=o.getNext();s&&u;){if(s.name!==u.name||!s.node.equals(u.node))return!1;s=r.getNext(),u=o.getNext()}return s===null&&u===null}else return!1;else return!1},t.prototype.resolveIndex_=function(e){return e===Wn?null:this.indexMap_.get(e.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),ZF=function(t){V(e,t);function e(){return t.call(this,new ur(Rm),te.EMPTY_NODE,Fl.Default)||this}return e.prototype.compareTo=function(n){return n===this?0:1},e.prototype.equals=function(n){return n===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(n){return te.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(te),Au=new ZF;Object.defineProperties(le,{MIN:{value:new le(pr,te.EMPTY_NODE)},MAX:{value:new le(Yn,Au)}});fA.__EMPTY_NODE=te.EMPTY_NODE;cs.__childrenNodeConstructor=te;zF(Au);QF(Au);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var eU=!0;function xe(t,e){if(e===void 0&&(e=null),t===null)return te.EMPTY_NODE;if(typeof t=="object"&&".priority"in t&&(e=t[".priority"]),L(e===null||typeof e=="string"||typeof e=="number"||typeof e=="object"&&".sv"in e,"Invalid priority type found: "+typeof e),typeof t=="object"&&".value"in t&&t[".value"]!==null&&(t=t[".value"]),typeof t!="object"||".sv"in t){var n=t;return new cs(n,xe(e))}if(!(t instanceof Array)&&eU){var r=[],o=!1,s=t;if(Je(s,function(d,p){if(d.substring(0,1)!=="."){var g=xe(p);g.isEmpty()||(o=o||!g.getPriority().isEmpty(),r.push(new le(d,g)))}}),r.length===0)return te.EMPTY_NODE;var u=Ml(r,KF,function(d){return d.name},Rm);if(o){var l=Ml(r,Se.getCompare());return new te(u,xe(e),new Fl({".priority":l},{".priority":Se}))}else return new te(u,xe(e),Fl.Default)}else{var h=te.EMPTY_NODE;return Je(t,function(d,p){if(tn(t,d)&&d.substring(0,1)!=="."){var g=xe(p);(g.isLeafNode()||!g.isEmpty())&&(h=h.updateImmediateChild(d,g))}}),h.updatePriority(xe(e))}}$F(xe);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Dm=function(t){V(e,t);function e(n){var r=t.call(this)||this;return r.indexPath_=n,L(!oe(n)&&ie(n)!==".priority","Can't create PathIndex with empty path or .priority key"),r}return e.prototype.extractChild=function(n){return n.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(n){return!n.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(n,r){var o=this.extractChild(n.node),s=this.extractChild(r.node),u=o.compareTo(s);return u===0?io(n.name,r.name):u},e.prototype.makePost=function(n,r){var o=xe(n),s=te.EMPTY_NODE.updateChild(this.indexPath_,o);return new le(r,s)},e.prototype.maxPost=function(){var n=te.EMPTY_NODE.updateChild(this.indexPath_,Au);return new le(Yn,n)},e.prototype.toString=function(){return tu(this.indexPath_,0).join("/")},e}(Rh);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tU=function(t){V(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype.compare=function(n,r){var o=n.node.compareTo(r.node);return o===0?io(n.name,r.name):o},e.prototype.isDefinedOn=function(n){return!0},e.prototype.indexedValueChanged=function(n,r){return!n.equals(r)},e.prototype.minPost=function(){return le.MIN},e.prototype.maxPost=function(){return le.MAX},e.prototype.makePost=function(n,r){var o=xe(n);return new le(r,o)},e.prototype.toString=function(){return".value"},e}(Rh),Om=new tU;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ls="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",jv="-",mA="z",yA=786,nU=function(){var t=0,e=[];return function(n){var r=n===t;t=n;var o,s=new Array(8);for(o=7;o>=0;o--)s[o]=ls.charAt(n%64),n=Math.floor(n/64);L(n===0,"Cannot push at time == 0");var u=s.join("");if(r){for(o=11;o>=0&&e[o]===63;o--)e[o]=0;e[o]++}else for(o=0;o<12;o++)e[o]=Math.floor(Math.random()*64);for(o=0;o<12;o++)u+=ls.charAt(e[o]);return L(u.length===20,"nextPushId: Length should be 20."),u}}(),$I=function(t){if(t===""+Em)return jv;var e=xl(t);if(e!=null)return""+(e+1);for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);if(n.length<yA)return n.push(jv),n.join("");for(var o=n.length-1;o>=0&&n[o]===mA;)o--;if(o===-1)return Yn;var s=n[o],u=ls.charAt(ls.indexOf(s)+1);return n[o]=u,n.slice(0,o+1).join("")},QI=function(t){if(t===""+KC)return pr;var e=xl(t);if(e!=null)return""+(e-1);for(var n=new Array(t.length),r=0;r<n.length;r++)n[r]=t.charAt(r);return n[n.length-1]===jv?n.length===1?""+Em:(delete n[n.length-1],n.join("")):(n[n.length-1]=ls.charAt(ls.indexOf(n[n.length-1])-1),n.join("")+mA.repeat(yA-n.length))};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _A(t){return{type:"value",snapshotNode:t}}function hs(t,e){return{type:"child_added",snapshotNode:e,childName:t}}function nu(t,e){return{type:"child_removed",snapshotNode:e,childName:t}}function ru(t,e,n){return{type:"child_changed",snapshotNode:e,childName:t,oldSnap:n}}function rU(t,e){return{type:"child_moved",snapshotNode:e,childName:t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Pm=function(){function t(e){this.index_=e}return t.prototype.updateChild=function(e,n,r,o,s,u){L(e.isIndexed(this.index_),"A node must be indexed if only a child is updated");var l=e.getImmediateChild(n);return l.getChild(o).equals(r.getChild(o))&&l.isEmpty()===r.isEmpty()||(u!=null&&(r.isEmpty()?e.hasChild(n)?u.trackChildChange(nu(n,l)):L(e.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):l.isEmpty()?u.trackChildChange(hs(n,r)):u.trackChildChange(ru(n,r,l))),e.isLeafNode()&&r.isEmpty())?e:e.updateImmediateChild(n,r).withIndex(this.index_)},t.prototype.updateFullNode=function(e,n,r){return r!=null&&(e.isLeafNode()||e.forEachChild(Se,function(o,s){n.hasChild(o)||r.trackChildChange(nu(o,s))}),n.isLeafNode()||n.forEachChild(Se,function(o,s){if(e.hasChild(o)){var u=e.getImmediateChild(o);u.equals(s)||r.trackChildChange(ru(o,s,u))}else r.trackChildChange(hs(o,s))})),n.withIndex(this.index_)},t.prototype.updatePriority=function(e,n){return e.isEmpty()?te.EMPTY_NODE:e.updatePriority(n)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wA=function(){function t(e){this.indexedFilter_=new Pm(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(e){return this.index_.compare(this.getStartPost(),e)<=0&&this.index_.compare(e,this.getEndPost())<=0},t.prototype.updateChild=function(e,n,r,o,s,u){return this.matches(new le(n,r))||(r=te.EMPTY_NODE),this.indexedFilter_.updateChild(e,n,r,o,s,u)},t.prototype.updateFullNode=function(e,n,r){n.isLeafNode()&&(n=te.EMPTY_NODE);var o=n.withIndex(this.index_);o=o.updatePriority(te.EMPTY_NODE);var s=this;return n.forEachChild(Se,function(u,l){s.matches(new le(u,l))||(o=o.updateImmediateChild(u,te.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(e,o,r)},t.prototype.updatePriority=function(e,n){return e},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(e){if(e.hasStart()){var n=e.getIndexStartName();return e.getIndex().makePost(e.getIndexStartValue(),n)}else return e.getIndex().minPost()},t.getEndPost_=function(e){if(e.hasEnd()){var n=e.getIndexEndName();return e.getIndex().makePost(e.getIndexEndValue(),n)}else return e.getIndex().maxPost()},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var iU=function(){function t(e){this.rangedFilter_=new wA(e),this.index_=e.getIndex(),this.limit_=e.getLimit(),this.reverse_=!e.isViewFromLeft()}return t.prototype.updateChild=function(e,n,r,o,s,u){return this.rangedFilter_.matches(new le(n,r))||(r=te.EMPTY_NODE),e.getImmediateChild(n).equals(r)?e:e.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(e,n,r,o,s,u):this.fullLimitUpdateChild_(e,n,r,s,u)},t.prototype.updateFullNode=function(e,n,r){var o;if(n.isLeafNode()||n.isEmpty())o=te.EMPTY_NODE.withIndex(this.index_);else if(this.limit_*2<n.numChildren()&&n.isIndexed(this.index_)){o=te.EMPTY_NODE.withIndex(this.index_);var s=void 0;this.reverse_?s=n.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):s=n.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var u=0;s.hasNext()&&u<this.limit_;){var l=s.getNext(),h=void 0;if(this.reverse_?h=this.index_.compare(this.rangedFilter_.getStartPost(),l)<=0:h=this.index_.compare(l,this.rangedFilter_.getEndPost())<=0,h)o=o.updateImmediateChild(l.name,l.node),u++;else break}}else{o=n.withIndex(this.index_),o=o.updatePriority(te.EMPTY_NODE);var d=void 0,p=void 0,g=void 0,s=void 0;if(this.reverse_){s=o.getReverseIterator(this.index_),d=this.rangedFilter_.getEndPost(),p=this.rangedFilter_.getStartPost();var y=this.index_.getCompare();g=function(T,k){return y(k,T)}}else s=o.getIterator(this.index_),d=this.rangedFilter_.getStartPost(),p=this.rangedFilter_.getEndPost(),g=this.index_.getCompare();for(var u=0,w=!1;s.hasNext();){var l=s.getNext();!w&&g(d,l)<=0&&(w=!0);var h=w&&u<this.limit_&&g(l,p)<=0;h?u++:o=o.updateImmediateChild(l.name,te.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(e,o,r)},t.prototype.updatePriority=function(e,n){return e},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(e,n,r,o,s){var u;if(this.reverse_){var l=this.index_.getCompare();u=function(O,M){return l(M,O)}}else u=this.index_.getCompare();var h=e;L(h.numChildren()===this.limit_,"");var d=new le(n,r),p=this.reverse_?h.getFirstChild(this.index_):h.getLastChild(this.index_),g=this.rangedFilter_.matches(d);if(h.hasChild(n)){for(var y=h.getImmediateChild(n),w=o.getChildAfterChild(this.index_,p,this.reverse_);w!=null&&(w.name===n||h.hasChild(w.name));)w=o.getChildAfterChild(this.index_,w,this.reverse_);var b=w==null?1:u(w,d),E=g&&!r.isEmpty()&&b>=0;if(E)return s!=null&&s.trackChildChange(ru(n,r,y)),h.updateImmediateChild(n,r);s!=null&&s.trackChildChange(nu(n,y));var T=h.updateImmediateChild(n,te.EMPTY_NODE),k=w!=null&&this.rangedFilter_.matches(w);return k?(s!=null&&s.trackChildChange(hs(w.name,w.node)),T.updateImmediateChild(w.name,w.node)):T}else return r.isEmpty()?e:g&&u(p,d)>=0?(s!=null&&(s.trackChildChange(nu(p.name,p.node)),s.trackChildChange(hs(n,r))),h.updateImmediateChild(n,r).updateImmediateChild(p.name,te.EMPTY_NODE)):e},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var bA=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.startAfterSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.endBeforeSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Se}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.hasStartAfter=function(){return this.startAfterSet_},t.prototype.hasEndBefore=function(){return this.endBeforeSet_},t.prototype.isViewFromLeft=function(){return this.viewFrom_===""?this.startSet_:this.viewFrom_==="l"},t.prototype.getIndexStartValue=function(){return L(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return L(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:pr},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return L(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return L(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:Yn},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&this.viewFrom_!==""},t.prototype.getLimit=function(){return L(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_===Se},t.prototype.copy=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t}();function oU(t){return t.loadsAllData()?new Pm(t.getIndex()):t.hasLimit()?new iU(t):new wA(t)}function sU(t,e){var n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="l",n}function aU(t,e){var n=t.copy();return n.limitSet_=!0,n.limit_=e,n.viewFrom_="r",n}function Bv(t,e,n){var r=t.copy();return r.startSet_=!0,e===void 0&&(e=null),r.indexStartValue_=e,n!=null?(r.startNameSet_=!0,r.indexStartName_=n):(r.startNameSet_=!1,r.indexStartName_=""),r}function uU(t,e,n){var r;if(t.index_===Wn)typeof e=="string"&&(e=$I(e)),r=Bv(t,e,n);else{var o=void 0;n==null?o=Yn:o=$I(n),r=Bv(t,e,o)}return r.startAfterSet_=!0,r}function qv(t,e,n){var r=t.copy();return r.endSet_=!0,e===void 0&&(e=null),r.indexEndValue_=e,n!==void 0?(r.endNameSet_=!0,r.indexEndName_=n):(r.endNameSet_=!1,r.indexEndName_=""),r}function cU(t,e,n){var r,o;return t.index_===Wn?(typeof e=="string"&&(e=QI(e)),o=qv(t,e,n)):(n==null?r=pr:r=QI(n),o=qv(t,e,r)),o.endBeforeSet_=!0,o}function Dh(t,e){var n=t.copy();return n.index_=e,n}function YI(t){var e={};if(t.isDefault())return e;var n;return t.index_===Se?n="$priority":t.index_===Om?n="$value":t.index_===Wn?n="$key":(L(t.index_ instanceof Dm,"Unrecognized index type!"),n=t.index_.toString()),e.orderBy=Qe(n),t.startSet_&&(e.startAt=Qe(t.indexStartValue_),t.startNameSet_&&(e.startAt+=","+Qe(t.indexStartName_))),t.endSet_&&(e.endAt=Qe(t.indexEndValue_),t.endNameSet_&&(e.endAt+=","+Qe(t.indexEndName_))),t.limitSet_&&(t.isViewFromLeft()?e.limitToFirst=t.limit_:e.limitToLast=t.limit_),e}function XI(t){var e={};if(t.startSet_&&(e.sp=t.indexStartValue_,t.startNameSet_&&(e.sn=t.indexStartName_)),t.endSet_&&(e.ep=t.indexEndValue_,t.endNameSet_&&(e.en=t.indexEndName_)),t.limitSet_){e.l=t.limit_;var n=t.viewFrom_;n===""&&(t.isViewFromLeft()?n="l":n="r"),e.vf=n}return t.index_!==Se&&(e.i=t.index_.toString()),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var lU=function(t){V(e,t);function e(n,r,o,s){var u=t.call(this)||this;return u.repoInfo_=n,u.onDataUpdate_=r,u.authTokenProvider_=o,u.appCheckTokenProvider_=s,u.log_=Cu("p:rest:"),u.listens_={},u}return e.prototype.reportStats=function(n){throw new Error("Method not implemented.")},e.getListenId_=function(n,r){return r!==void 0?"tag$"+r:(L(n._queryParams.isDefault(),"should have a tag if it's not a default query."),n._path.toString())},e.prototype.listen=function(n,r,o,s){var u=this,l=n._path.toString();this.log_("Listen called for "+l+" "+n._queryIdentifier);var h=e.getListenId_(n,o),d={};this.listens_[h]=d;var p=YI(n._queryParams);this.restRequest_(l+".json",p,function(g,y){var w=y;if(g===404&&(w=null,g=null),g===null&&u.onDataUpdate_(l,w,!1,o),ji(u.listens_,h)===d){var b;g?g===401?b="permission_denied":b="rest_error:"+g:b="ok",s(b,null)}})},e.prototype.unlisten=function(n,r){var o=e.getListenId_(n,r);delete this.listens_[o]},e.prototype.get=function(n){var r=this,o=YI(n._queryParams),s=n._path.toString(),u=new Ut;return this.restRequest_(s+".json",o,function(l,h){var d=h;l===404&&(d=null,l=null),l===null?(r.onDataUpdate_(s,d,!1,null),u.resolve(d)):u.reject(new Error(d))}),u.promise},e.prototype.refreshAuthToken=function(n){},e.prototype.restRequest_=function(n,r,o){var s=this;return r===void 0&&(r={}),r.format="export",Promise.all([this.authTokenProvider_.getToken(!1),this.appCheckTokenProvider_.getToken(!1)]).then(function(u){var l=gt(u,2),h=l[0],d=l[1];h&&h.accessToken&&(r.auth=h.accessToken),d&&d.token&&(r.ac=d.token);var p=(s.repoInfo_.secure?"https://":"http://")+s.repoInfo_.host+n+"?ns="+s.repoInfo_.namespace+pO(r);s.log_("Sending REST request for "+p);var g=new XMLHttpRequest;g.onreadystatechange=function(){if(o&&g.readyState===4){s.log_("REST Response for "+p+" received. status:",g.status,"response:",g.responseText);var y=null;if(g.status>=200&&g.status<300){try{y=Ua(g.responseText)}catch{ht("Failed to parse JSON response for "+p+": "+g.responseText)}o(null,y)}else g.status!==401&&g.status!==404&&ht("Got unsuccessful REST response for "+p+" Status: "+g.status),o(g.status);o=null}},g.open("GET",p,!0),g.send()})},e}(uA);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hU=function(){function t(){this.rootNode_=te.EMPTY_NODE}return t.prototype.getNode=function(e){return this.rootNode_.getChild(e)},t.prototype.updateSnapshot=function(e,n){this.rootNode_=this.rootNode_.updateChild(e,n)},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ul(){return{value:null,children:new Map}}function Ss(t,e,n){if(oe(e))t.value=n,t.children.clear();else if(t.value!==null)t.value=t.value.updateChild(e,n);else{var r=ie(e);t.children.has(r)||t.children.set(r,Ul());var o=t.children.get(r);e=Ie(e),Ss(o,e,n)}}function Gv(t,e){if(oe(e))return t.value=null,t.children.clear(),!0;if(t.value!==null){if(t.value.isLeafNode())return!1;var n=t.value;return t.value=null,n.forEachChild(Se,function(s,u){Ss(t,new _e(s),u)}),Gv(t,e)}else if(t.children.size>0){var r=ie(e);if(e=Ie(e),t.children.has(r)){var o=Gv(t.children.get(r),e);o&&t.children.delete(r)}return t.children.size===0}else return!0}function Wv(t,e,n){t.value!==null?n(e,t.value):fU(t,function(r,o){var s=new _e(e.toString()+"/"+r);Wv(o,s,n)})}function fU(t,e){t.children.forEach(function(n,r){e(r,n)})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var IA=function(){function t(e){this.collection_=e,this.last_=null}return t.prototype.get=function(){var e=this.collection_.get(),n=at({},e);return this.last_&&Je(this.last_,function(r,o){n[r]=n[r]-o}),this.last_=e,n},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var JI=10*1e3,dU=30*1e3,pU=5*60*1e3,vU=function(){function t(e,n){this.server_=n,this.statsToReport_={},this.statsListener_=new IA(e);var r=JI+(dU-JI)*Math.random();Ra(this.reportStats_.bind(this),Math.floor(r))}return t.prototype.reportStats_=function(){var e=this,n=this.statsListener_.get(),r={},o=!1;Je(n,function(s,u){u>0&&tn(e.statsToReport_,s)&&(r[s]=u,o=!0)}),o&&this.server_.reportStats(r),Ra(this.reportStats_.bind(this),Math.floor(Math.random()*2*pU))},t}();function gU(t,e){t.statsToReport_[e]=!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var An;(function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"})(An||(An={}));function xm(){return{fromUser:!0,fromServer:!1,queryId:null,tagged:!1}}function Lm(){return{fromUser:!1,fromServer:!0,queryId:null,tagged:!1}}function Mm(t){return{fromUser:!1,fromServer:!0,queryId:t,tagged:!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var mU=function(){function t(e,n,r){this.path=e,this.affectedTree=n,this.revert=r,this.type=An.ACK_USER_WRITE,this.source=xm()}return t.prototype.operationForChild=function(e){if(oe(this.path)){if(this.affectedTree.value!=null)return L(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new _e(e));return new t(pe(),n,this.revert)}else return L(ie(this.path)===e,"operationForChild called for unrelated child."),new t(Ie(this.path),this.affectedTree,this.revert)},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var EA=function(){function t(e,n){this.source=e,this.path=n,this.type=An.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return oe(this.path)?new t(this.source,pe()):new t(this.source,Ie(this.path))},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Oh=function(){function t(e,n,r){this.source=e,this.path=n,this.snap=r,this.type=An.OVERWRITE}return t.prototype.operationForChild=function(e){return oe(this.path)?new t(this.source,pe(),this.snap.getImmediateChild(e)):new t(this.source,Ie(this.path),this.snap)},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Fm=function(){function t(e,n,r){this.source=e,this.path=n,this.children=r,this.type=An.MERGE}return t.prototype.operationForChild=function(e){if(oe(this.path)){var n=this.children.subtree(new _e(e));return n.isEmpty()?null:n.value?new Oh(this.source,pe(),n.value):new t(this.source,pe(),n)}else return L(ie(this.path)===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,Ie(this.path),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wr=function(){function t(e,n,r){this.node_=e,this.fullyInitialized_=n,this.filtered_=r}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(e){if(oe(e))return this.isFullyInitialized()&&!this.filtered_;var n=ie(e);return this.isCompleteForChild(n)},t.prototype.isCompleteForChild=function(e){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(e)},t.prototype.getNode=function(){return this.node_},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yU=function(){function t(e){this.query_=e,this.index_=this.query_._queryParams.getIndex()}return t}();function _U(t,e,n,r){var o=[],s=[];return e.forEach(function(u){u.type==="child_changed"&&t.index_.indexedValueChanged(u.oldSnap,u.snapshotNode)&&s.push(rU(u.childName,u.snapshotNode))}),ba(t,o,"child_removed",e,r,n),ba(t,o,"child_added",e,r,n),ba(t,o,"child_moved",s,r,n),ba(t,o,"child_changed",e,r,n),ba(t,o,"value",e,r,n),o}function ba(t,e,n,r,o,s){var u=r.filter(function(l){return l.type===n});u.sort(function(l,h){return bU(t,l,h)}),u.forEach(function(l){var h=wU(t,l,s);o.forEach(function(d){d.respondsTo(l.type)&&e.push(d.createEvent(h,t.query_))})})}function wU(t,e,n){return e.type==="value"||e.type==="child_removed"||(e.prevName=n.getPredecessorChildName(e.childName,e.snapshotNode,t.index_)),e}function bU(t,e,n){if(e.childName==null||n.childName==null)throw vs("Should only compare child_ events.");var r=new le(e.childName,e.snapshotNode),o=new le(n.childName,n.snapshotNode);return t.index_.compare(r,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ph(t,e){return{eventCache:t,serverCache:e}}function Oa(t,e,n,r){return Ph(new Wr(e,n,r),t.serverCache)}function TA(t,e,n,r){return Ph(t.eventCache,new Wr(e,n,r))}function Vl(t){return t.eventCache.isFullyInitialized()?t.eventCache.getNode():null}function zi(t){return t.serverCache.isFullyInitialized()?t.serverCache.getNode():null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Zp,IU=function(){return Zp||(Zp=new ur(ZM)),Zp},rn=function(){function t(e,n){n===void 0&&(n=IU()),this.value=e,this.children=n}return t.fromObject=function(e){var n=new t(null);return Je(e,function(r,o){n=n.set(new _e(r),o)}),n},t.prototype.isEmpty=function(){return this.value===null&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(e,n){if(this.value!=null&&n(this.value))return{path:pe(),value:this.value};if(oe(e))return null;var r=ie(e),o=this.children.get(r);if(o!==null){var s=o.findRootMostMatchingPathAndValue(Ie(e),n);if(s!=null){var u=Re(new _e(r),s.path);return{path:u,value:s.value}}else return null}else return null},t.prototype.findRootMostValueAndPath=function(e){return this.findRootMostMatchingPathAndValue(e,function(){return!0})},t.prototype.subtree=function(e){if(oe(e))return this;var n=ie(e),r=this.children.get(n);return r!==null?r.subtree(Ie(e)):new t(null)},t.prototype.set=function(e,n){if(oe(e))return new t(n,this.children);var r=ie(e),o=this.children.get(r)||new t(null),s=o.set(Ie(e),n),u=this.children.insert(r,s);return new t(this.value,u)},t.prototype.remove=function(e){if(oe(e))return this.children.isEmpty()?new t(null):new t(null,this.children);var n=ie(e),r=this.children.get(n);if(r){var o=r.remove(Ie(e)),s=void 0;return o.isEmpty()?s=this.children.remove(n):s=this.children.insert(n,o),this.value===null&&s.isEmpty()?new t(null):new t(this.value,s)}else return this},t.prototype.get=function(e){if(oe(e))return this.value;var n=ie(e),r=this.children.get(n);return r?r.get(Ie(e)):null},t.prototype.setTree=function(e,n){if(oe(e))return n;var r=ie(e),o=this.children.get(r)||new t(null),s=o.setTree(Ie(e),n),u=void 0;return s.isEmpty()?u=this.children.remove(r):u=this.children.insert(r,s),new t(this.value,u)},t.prototype.fold=function(e){return this.fold_(pe(),e)},t.prototype.fold_=function(e,n){var r={};return this.children.inorderTraversal(function(o,s){r[o]=s.fold_(Re(e,o),n)}),n(e,this.value,r)},t.prototype.findOnPath=function(e,n){return this.findOnPath_(e,pe(),n)},t.prototype.findOnPath_=function(e,n,r){var o=this.value?r(n,this.value):!1;if(o)return o;if(oe(e))return null;var s=ie(e),u=this.children.get(s);return u?u.findOnPath_(Ie(e),Re(n,s),r):null},t.prototype.foreachOnPath=function(e,n){return this.foreachOnPath_(e,pe(),n)},t.prototype.foreachOnPath_=function(e,n,r){if(oe(e))return this;this.value&&r(n,this.value);var o=ie(e),s=this.children.get(o);return s?s.foreachOnPath_(Ie(e),Re(n,o),r):new t(null)},t.prototype.foreach=function(e){this.foreach_(pe(),e)},t.prototype.foreach_=function(e,n){this.children.inorderTraversal(function(r,o){o.foreach_(Re(e,r),n)}),this.value&&n(e,this.value)},t.prototype.foreachChild=function(e){this.children.inorderTraversal(function(n,r){r.value&&e(n,r.value)})},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fr=function(){function t(e){this.writeTree_=e}return t.empty=function(){return new t(new rn(null))},t}();function Pa(t,e,n){if(oe(e))return new fr(new rn(n));var r=t.writeTree_.findRootMostValueAndPath(e);if(r!=null){var o=r.path,s=r.value,u=Dt(o,e);return s=s.updateChild(u,n),new fr(t.writeTree_.set(o,s))}else{var l=new rn(n),h=t.writeTree_.setTree(e,l);return new fr(h)}}function Hv(t,e,n){var r=t;return Je(n,function(o,s){r=Pa(r,Re(e,o),s)}),r}function ZI(t,e){if(oe(e))return fr.empty();var n=t.writeTree_.setTree(e,new rn(null));return new fr(n)}function Kv(t,e){return oo(t,e)!=null}function oo(t,e){var n=t.writeTree_.findRootMostValueAndPath(e);return n!=null?t.writeTree_.get(n.path).getChild(Dt(n.path,e)):null}function eE(t){var e=[],n=t.writeTree_.value;return n!=null?n.isLeafNode()||n.forEachChild(Se,function(r,o){e.push(new le(r,o))}):t.writeTree_.children.inorderTraversal(function(r,o){o.value!=null&&e.push(new le(r,o.value))}),e}function Vr(t,e){if(oe(e))return t;var n=oo(t,e);return n!=null?new fr(new rn(n)):new fr(t.writeTree_.subtree(e))}function zv(t){return t.writeTree_.isEmpty()}function fs(t,e){return SA(pe(),t.writeTree_,e)}function SA(t,e,n){if(e.value!=null)return n.updateChild(t,e.value);var r=null;return e.children.inorderTraversal(function(o,s){o===".priority"?(L(s.value!==null,"Priority writes must always be leaf nodes"),r=s.value):n=SA(Re(t,o),s,n)}),!n.getChild(t).isEmpty()&&r!==null&&(n=n.updateChild(Re(t,".priority"),r)),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function xh(t,e){return NA(e,t)}function EU(t,e,n,r,o){L(r>t.lastWriteId,"Stacking an older write on top of newer ones"),o===void 0&&(o=!0),t.allWrites.push({path:e,snap:n,writeId:r,visible:o}),o&&(t.visibleWrites=Pa(t.visibleWrites,e,n)),t.lastWriteId=r}function TU(t,e,n,r){L(r>t.lastWriteId,"Stacking an older merge on top of newer ones"),t.allWrites.push({path:e,children:n,writeId:r,visible:!0}),t.visibleWrites=Hv(t.visibleWrites,e,n),t.lastWriteId=r}function SU(t,e){for(var n=0;n<t.allWrites.length;n++){var r=t.allWrites[n];if(r.writeId===e)return r}return null}function CU(t,e){var n=t.allWrites.findIndex(function(d){return d.writeId===e});L(n>=0,"removeWrite called with nonexistent writeId.");var r=t.allWrites[n];t.allWrites.splice(n,1);for(var o=r.visible,s=!1,u=t.allWrites.length-1;o&&u>=0;){var l=t.allWrites[u];l.visible&&(u>=n&&AU(l,r.path)?o=!1:cn(r.path,l.path)&&(s=!0)),u--}if(o){if(s)return kU(t),!0;if(r.snap)t.visibleWrites=ZI(t.visibleWrites,r.path);else{var h=r.children;Je(h,function(d){t.visibleWrites=ZI(t.visibleWrites,Re(r.path,d))})}return!0}else return!1}function AU(t,e){if(t.snap)return cn(t.path,e);for(var n in t.children)if(t.children.hasOwnProperty(n)&&cn(Re(t.path,n),e))return!0;return!1}function kU(t){t.visibleWrites=CA(t.allWrites,NU,pe()),t.allWrites.length>0?t.lastWriteId=t.allWrites[t.allWrites.length-1].writeId:t.lastWriteId=-1}function NU(t){return t.visible}function CA(t,e,n){for(var r=fr.empty(),o=0;o<t.length;++o){var s=t[o];if(e(s)){var u=s.path,l=void 0;if(s.snap)cn(n,u)?(l=Dt(n,u),r=Pa(r,l,s.snap)):cn(u,n)&&(l=Dt(u,n),r=Pa(r,pe(),s.snap.getChild(l)));else if(s.children){if(cn(n,u))l=Dt(n,u),r=Hv(r,l,s.children);else if(cn(u,n))if(l=Dt(u,n),oe(l))r=Hv(r,pe(),s.children);else{var h=ji(s.children,ie(l));if(h){var d=h.getChild(Ie(l));r=Pa(r,pe(),d)}}}else throw vs("WriteRecord should have .snap or .children")}}return r}function AA(t,e,n,r,o){if(!r&&!o){var s=oo(t.visibleWrites,e);if(s!=null)return s;var u=Vr(t.visibleWrites,e);if(zv(u))return n;if(n==null&&!Kv(u,pe()))return null;var l=n||te.EMPTY_NODE;return fs(u,l)}else{var h=Vr(t.visibleWrites,e);if(!o&&zv(h))return n;if(!o&&n==null&&!Kv(h,pe()))return null;var d=function(y){return(y.visible||o)&&(!r||!~r.indexOf(y.writeId))&&(cn(y.path,e)||cn(e,y.path))},p=CA(t.allWrites,d,e),l=n||te.EMPTY_NODE;return fs(p,l)}}function RU(t,e,n){var r=te.EMPTY_NODE,o=oo(t.visibleWrites,e);if(o)return o.isLeafNode()||o.forEachChild(Se,function(l,h){r=r.updateImmediateChild(l,h)}),r;if(n){var s=Vr(t.visibleWrites,e);return n.forEachChild(Se,function(l,h){var d=fs(Vr(s,new _e(l)),h);r=r.updateImmediateChild(l,d)}),eE(s).forEach(function(l){r=r.updateImmediateChild(l.name,l.node)}),r}else{var u=Vr(t.visibleWrites,e);return eE(u).forEach(function(l){r=r.updateImmediateChild(l.name,l.node)}),r}}function DU(t,e,n,r,o){L(r||o,"Either existingEventSnap or existingServerSnap must exist");var s=Re(e,n);if(Kv(t.visibleWrites,s))return null;var u=Vr(t.visibleWrites,s);return zv(u)?o.getChild(n):fs(u,o.getChild(n))}function OU(t,e,n,r){var o=Re(e,n),s=oo(t.visibleWrites,o);if(s!=null)return s;if(r.isCompleteForChild(n)){var u=Vr(t.visibleWrites,o);return fs(u,r.getNode().getImmediateChild(n))}else return null}function PU(t,e){return oo(t.visibleWrites,e)}function xU(t,e,n,r,o,s,u){var l,h=Vr(t.visibleWrites,e),d=oo(h,pe());if(d!=null)l=d;else if(n!=null)l=fs(h,n);else return[];if(l=l.withIndex(u),!l.isEmpty()&&!l.isLeafNode()){for(var p=[],g=u.getCompare(),y=s?l.getReverseIteratorFrom(r,u):l.getIteratorFrom(r,u),w=y.getNext();w&&p.length<o;)g(w,r)!==0&&p.push(w),w=y.getNext();return p}else return[]}function LU(){return{visibleWrites:fr.empty(),allWrites:[],lastWriteId:-1}}function jl(t,e,n,r){return AA(t.writeTree,t.treePath,e,n,r)}function Um(t,e){return RU(t.writeTree,t.treePath,e)}function tE(t,e,n,r){return DU(t.writeTree,t.treePath,e,n,r)}function Bl(t,e){return PU(t.writeTree,Re(t.treePath,e))}function MU(t,e,n,r,o,s){return xU(t.writeTree,t.treePath,e,n,r,o,s)}function Vm(t,e,n){return OU(t.writeTree,t.treePath,e,n)}function kA(t,e){return NA(Re(t.treePath,e),t.writeTree)}function NA(t,e){return{treePath:t,writeTree:e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var FU=function(){function t(){this.changeMap=new Map}return t.prototype.trackChildChange=function(e){var n=e.type,r=e.childName;L(n==="child_added"||n==="child_changed"||n==="child_removed","Only child changes supported for tracking"),L(r!==".priority","Only non-priority child changes can be tracked.");var o=this.changeMap.get(r);if(o){var s=o.type;if(n==="child_added"&&s==="child_removed")this.changeMap.set(r,ru(r,e.snapshotNode,o.snapshotNode));else if(n==="child_removed"&&s==="child_added")this.changeMap.delete(r);else if(n==="child_removed"&&s==="child_changed")this.changeMap.set(r,nu(r,o.oldSnap));else if(n==="child_changed"&&s==="child_added")this.changeMap.set(r,hs(r,e.snapshotNode));else if(n==="child_changed"&&s==="child_changed")this.changeMap.set(r,ru(r,e.snapshotNode,o.oldSnap));else throw vs("Illegal combination of changes: "+e+" occurred after "+o)}else this.changeMap.set(r,e)},t.prototype.getChanges=function(){return Array.from(this.changeMap.values())},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var UU=function(){function t(){}return t.prototype.getCompleteChild=function(e){return null},t.prototype.getChildAfterChild=function(e,n,r){return null},t}(),RA=new UU,jm=function(){function t(e,n,r){r===void 0&&(r=null),this.writes_=e,this.viewCache_=n,this.optCompleteServerCache_=r}return t.prototype.getCompleteChild=function(e){var n=this.viewCache_.eventCache;if(n.isCompleteForChild(e))return n.getNode().getImmediateChild(e);var r=this.optCompleteServerCache_!=null?new Wr(this.optCompleteServerCache_,!0,!1):this.viewCache_.serverCache;return Vm(this.writes_,e,r)},t.prototype.getChildAfterChild=function(e,n,r){var o=this.optCompleteServerCache_!=null?this.optCompleteServerCache_:zi(this.viewCache_),s=MU(this.writes_,o,n,1,r,e);return s.length===0?null:s[0]},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function VU(t){return{filter:t}}function jU(t,e){L(e.eventCache.getNode().isIndexed(t.filter.getIndex()),"Event snap not indexed"),L(e.serverCache.getNode().isIndexed(t.filter.getIndex()),"Server snap not indexed")}function BU(t,e,n,r,o){var s=new FU,u,l;if(n.type===An.OVERWRITE){var h=n;h.source.fromUser?u=$v(t,e,h.path,h.snap,r,o,s):(L(h.source.fromServer,"Unknown source."),l=h.source.tagged||e.serverCache.isFiltered()&&!oe(h.path),u=ql(t,e,h.path,h.snap,r,o,l,s))}else if(n.type===An.MERGE){var d=n;d.source.fromUser?u=GU(t,e,d.path,d.children,r,o,s):(L(d.source.fromServer,"Unknown source."),l=d.source.tagged||e.serverCache.isFiltered(),u=Qv(t,e,d.path,d.children,r,o,l,s))}else if(n.type===An.ACK_USER_WRITE){var p=n;p.revert?u=KU(t,e,p.path,r,o,s):u=WU(t,e,p.path,p.affectedTree,r,o,s)}else if(n.type===An.LISTEN_COMPLETE)u=HU(t,e,n.path,r,s);else throw vs("Unknown operation type: "+n.type);var g=s.getChanges();return qU(e,u,g),{viewCache:u,changes:g}}function qU(t,e,n){var r=e.eventCache;if(r.isFullyInitialized()){var o=r.getNode().isLeafNode()||r.getNode().isEmpty(),s=Vl(t);(n.length>0||!t.eventCache.isFullyInitialized()||o&&!r.getNode().equals(s)||!r.getNode().getPriority().equals(s.getPriority()))&&n.push(_A(Vl(e)))}}function DA(t,e,n,r,o,s){var u=e.eventCache;if(Bl(r,n)!=null)return e;var l=void 0,h=void 0;if(oe(n))if(L(e.serverCache.isFullyInitialized(),"If change path is empty, we must have complete server data"),e.serverCache.isFiltered()){var d=zi(e),p=d instanceof te?d:te.EMPTY_NODE,g=Um(r,p);l=t.filter.updateFullNode(e.eventCache.getNode(),g,s)}else{var y=jl(r,zi(e));l=t.filter.updateFullNode(e.eventCache.getNode(),y,s)}else{var w=ie(n);if(w===".priority"){L(Gr(n)===1,"Can't have a priority with additional path components");var b=u.getNode();h=e.serverCache.getNode();var E=tE(r,n,b,h);E!=null?l=t.filter.updatePriority(b,E):l=u.getNode()}else{var T=Ie(n),k=void 0;if(u.isCompleteForChild(w)){h=e.serverCache.getNode();var O=tE(r,n,u.getNode(),h);O!=null?k=u.getNode().getImmediateChild(w).updateChild(T,O):k=u.getNode().getImmediateChild(w)}else k=Vm(r,w,e.serverCache);k!=null?l=t.filter.updateChild(u.getNode(),w,k,T,o,s):l=u.getNode()}}return Oa(e,l,u.isFullyInitialized()||oe(n),t.filter.filtersNodes())}function ql(t,e,n,r,o,s,u,l){var h=e.serverCache,d,p=u?t.filter:t.filter.getIndexedFilter();if(oe(n))d=p.updateFullNode(h.getNode(),r,null);else if(p.filtersNodes()&&!h.isFiltered()){var g=h.getNode().updateChild(n,r);d=p.updateFullNode(h.getNode(),g,null)}else{var y=ie(n);if(!h.isCompleteForPath(n)&&Gr(n)>1)return e;var w=Ie(n),b=h.getNode().getImmediateChild(y),E=b.updateChild(w,r);y===".priority"?d=p.updatePriority(h.getNode(),E):d=p.updateChild(h.getNode(),y,E,w,RA,null)}var T=TA(e,d,h.isFullyInitialized()||oe(n),p.filtersNodes()),k=new jm(o,T,s);return DA(t,T,n,o,k,l)}function $v(t,e,n,r,o,s,u){var l=e.eventCache,h,d,p=new jm(o,e,s);if(oe(n))d=t.filter.updateFullNode(e.eventCache.getNode(),r,u),h=Oa(e,d,!0,t.filter.filtersNodes());else{var g=ie(n);if(g===".priority")d=t.filter.updatePriority(e.eventCache.getNode(),r),h=Oa(e,d,l.isFullyInitialized(),l.isFiltered());else{var y=Ie(n),w=l.getNode().getImmediateChild(g),b=void 0;if(oe(y))b=r;else{var E=p.getCompleteChild(g);E!=null?km(y)===".priority"&&E.getChild(lA(y)).isEmpty()?b=E:b=E.updateChild(y,r):b=te.EMPTY_NODE}if(w.equals(b))h=e;else{var T=t.filter.updateChild(l.getNode(),g,b,y,p,u);h=Oa(e,T,l.isFullyInitialized(),t.filter.filtersNodes())}}}return h}function nE(t,e){return t.eventCache.isCompleteForChild(e)}function GU(t,e,n,r,o,s,u){var l=e;return r.foreach(function(h,d){var p=Re(n,h);nE(e,ie(p))&&(l=$v(t,l,p,d,o,s,u))}),r.foreach(function(h,d){var p=Re(n,h);nE(e,ie(p))||(l=$v(t,l,p,d,o,s,u))}),l}function rE(t,e,n){return n.foreach(function(r,o){e=e.updateChild(r,o)}),e}function Qv(t,e,n,r,o,s,u,l){if(e.serverCache.getNode().isEmpty()&&!e.serverCache.isFullyInitialized())return e;var h=e,d;oe(n)?d=r:d=new rn(null).setTree(n,r);var p=e.serverCache.getNode();return d.children.inorderTraversal(function(g,y){if(p.hasChild(g)){var w=e.serverCache.getNode().getImmediateChild(g),b=rE(t,w,y);h=ql(t,h,new _e(g),b,o,s,u,l)}}),d.children.inorderTraversal(function(g,y){var w=!e.serverCache.isCompleteForChild(g)&&y.value===void 0;if(!p.hasChild(g)&&!w){var b=e.serverCache.getNode().getImmediateChild(g),E=rE(t,b,y);h=ql(t,h,new _e(g),E,o,s,u,l)}}),h}function WU(t,e,n,r,o,s,u){if(Bl(o,n)!=null)return e;var l=e.serverCache.isFiltered(),h=e.serverCache;if(r.value!=null){if(oe(n)&&h.isFullyInitialized()||h.isCompleteForPath(n))return ql(t,e,n,h.getNode().getChild(n),o,s,l,u);if(oe(n)){var d=new rn(null);return h.getNode().forEachChild(Wn,function(g,y){d=d.set(new _e(g),y)}),Qv(t,e,n,d,o,s,l,u)}else return e}else{var p=new rn(null);return r.foreach(function(g,y){var w=Re(n,g);h.isCompleteForPath(w)&&(p=p.set(g,h.getNode().getChild(w)))}),Qv(t,e,n,p,o,s,l,u)}}function HU(t,e,n,r,o){var s=e.serverCache,u=TA(e,s.getNode(),s.isFullyInitialized()||oe(n),s.isFiltered());return DA(t,u,n,r,RA,o)}function KU(t,e,n,r,o,s){var u;if(Bl(r,n)!=null)return e;var l=new jm(r,e,o),h=e.eventCache.getNode(),d=void 0;if(oe(n)||ie(n)===".priority"){var p=void 0;if(e.serverCache.isFullyInitialized())p=jl(r,zi(e));else{var g=e.serverCache.getNode();L(g instanceof te,"serverChildren would be complete if leaf node"),p=Um(r,g)}p=p,d=t.filter.updateFullNode(h,p,s)}else{var y=ie(n),w=Vm(r,y,e.serverCache);w==null&&e.serverCache.isCompleteForChild(y)&&(w=h.getImmediateChild(y)),w!=null?d=t.filter.updateChild(h,y,w,Ie(n),l,s):e.eventCache.getNode().hasChild(y)?d=t.filter.updateChild(h,y,te.EMPTY_NODE,Ie(n),l,s):d=h,d.isEmpty()&&e.serverCache.isFullyInitialized()&&(u=jl(r,zi(e)),u.isLeafNode()&&(d=t.filter.updateFullNode(d,u,s)))}return u=e.serverCache.isFullyInitialized()||Bl(r,pe())!=null,Oa(e,d,u,t.filter.filtersNodes())}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var zU=function(){function t(e,n){this.query_=e,this.eventRegistrations_=[];var r=this.query_._queryParams,o=new Pm(r.getIndex()),s=oU(r);this.processor_=VU(s);var u=n.serverCache,l=n.eventCache,h=o.updateFullNode(te.EMPTY_NODE,u.getNode(),null),d=s.updateFullNode(te.EMPTY_NODE,l.getNode(),null),p=new Wr(h,u.isFullyInitialized(),o.filtersNodes()),g=new Wr(d,l.isFullyInitialized(),s.filtersNodes());this.viewCache_=Ph(g,p),this.eventGenerator_=new yU(this.query_)}return Object.defineProperty(t.prototype,"query",{get:function(){return this.query_},enumerable:!1,configurable:!0}),t}();function $U(t){return t.viewCache_.serverCache.getNode()}function QU(t){return Vl(t.viewCache_)}function YU(t,e){var n=zi(t.viewCache_);return n&&(t.query._queryParams.loadsAllData()||!oe(e)&&!n.getImmediateChild(ie(e)).isEmpty())?n.getChild(e):null}function iE(t){return t.eventRegistrations_.length===0}function XU(t,e){t.eventRegistrations_.push(e)}function oE(t,e,n){var r=[];if(n){L(e==null,"A cancel should cancel all event registrations.");var o=t.query._path;t.eventRegistrations_.forEach(function(h){var d=h.createCancelEvent(n,o);d&&r.push(d)})}if(e){for(var s=[],u=0;u<t.eventRegistrations_.length;++u){var l=t.eventRegistrations_[u];if(!l.matches(e))s.push(l);else if(e.hasAnyCallback()){s=s.concat(t.eventRegistrations_.slice(u+1));break}}t.eventRegistrations_=s}else t.eventRegistrations_=[];return r}function sE(t,e,n,r){e.type===An.MERGE&&e.source.queryId!==null&&(L(zi(t.viewCache_),"We should always have a full cache before handling merges"),L(Vl(t.viewCache_),"Missing event cache, even though we have a server cache"));var o=t.viewCache_,s=BU(t.processor_,o,e,n,r);return jU(t.processor_,s.viewCache),L(s.viewCache.serverCache.isFullyInitialized()||!o.serverCache.isFullyInitialized(),"Once a server snap is complete, it should never go back"),t.viewCache_=s.viewCache,OA(t,s.changes,s.viewCache.eventCache.getNode(),null)}function JU(t,e){var n=t.viewCache_.eventCache,r=[];if(!n.getNode().isLeafNode()){var o=n.getNode();o.forEachChild(Se,function(s,u){r.push(hs(s,u))})}return n.isFullyInitialized()&&r.push(_A(n.getNode())),OA(t,r,n.getNode(),e)}function OA(t,e,n,r){var o=r?[r]:t.eventRegistrations_;return _U(t.eventGenerator_,e,n,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gl,PA=function(){function t(){this.views=new Map}return t}();function ZU(t){L(!Gl,"__referenceConstructor has already been defined"),Gl=t}function eV(){return L(Gl,"Reference.ts has not been loaded"),Gl}function tV(t){return t.views.size===0}function Bm(t,e,n,r){var o,s,u=e.source.queryId;if(u!==null){var l=t.views.get(u);return L(l!=null,"SyncTree gave us an op for an invalid query."),sE(l,e,n,r)}else{var h=[];try{for(var d=Ot(t.views.values()),p=d.next();!p.done;p=d.next()){var l=p.value;h=h.concat(sE(l,e,n,r))}}catch(g){o={error:g}}finally{try{p&&!p.done&&(s=d.return)&&s.call(d)}finally{if(o)throw o.error}}return h}}function xA(t,e,n,r,o){var s=e._queryIdentifier,u=t.views.get(s);if(!u){var l=jl(n,o?r:null),h=!1;l?h=!0:r instanceof te?(l=Um(n,r),h=!1):(l=te.EMPTY_NODE,h=!1);var d=Ph(new Wr(l,h,!1),new Wr(r,o,!1));return new zU(e,d)}return u}function nV(t,e,n,r,o,s){var u=xA(t,e,r,o,s);return t.views.has(e._queryIdentifier)||t.views.set(e._queryIdentifier,u),XU(u,n),JU(u,n)}function rV(t,e,n,r){var o,s,u=e._queryIdentifier,l=[],h=[],d=Hr(t);if(u==="default")try{for(var p=Ot(t.views.entries()),g=p.next();!g.done;g=p.next()){var y=gt(g.value,2),w=y[0],b=y[1];h=h.concat(oE(b,n,r)),iE(b)&&(t.views.delete(w),b.query._queryParams.loadsAllData()||l.push(b.query))}}catch(E){o={error:E}}finally{try{g&&!g.done&&(s=p.return)&&s.call(p)}finally{if(o)throw o.error}}else{var b=t.views.get(u);b&&(h=h.concat(oE(b,n,r)),iE(b)&&(t.views.delete(u),b.query._queryParams.loadsAllData()||l.push(b.query)))}return d&&!Hr(t)&&l.push(new(eV())(e._repo,e._path)),{removed:l,events:h}}function LA(t){var e,n,r=[];try{for(var o=Ot(t.views.values()),s=o.next();!s.done;s=o.next()){var u=s.value;u.query._queryParams.loadsAllData()||r.push(u)}}catch(l){e={error:l}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r}function jr(t,e){var n,r,o=null;try{for(var s=Ot(t.views.values()),u=s.next();!u.done;u=s.next()){var l=u.value;o=o||YU(l,e)}}catch(h){n={error:h}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}return o}function MA(t,e){var n=e._queryParams;if(n.loadsAllData())return Lh(t);var r=e._queryIdentifier;return t.views.get(r)}function FA(t,e){return MA(t,e)!=null}function Hr(t){return Lh(t)!=null}function Lh(t){var e,n;try{for(var r=Ot(t.views.values()),o=r.next();!o.done;o=r.next()){var s=o.value;if(s.query._queryParams.loadsAllData())return s}}catch(u){e={error:u}}finally{try{o&&!o.done&&(n=r.return)&&n.call(r)}finally{if(e)throw e.error}}return null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wl;function iV(t){L(!Wl,"__referenceConstructor has already been defined"),Wl=t}function oV(){return L(Wl,"Reference.ts has not been loaded"),Wl}var sV=1,aE=function(){function t(e){this.listenProvider_=e,this.syncPointTree_=new rn(null),this.pendingWriteTree_=LU(),this.tagToQueryMap=new Map,this.queryToTagMap=new Map}return t}();function qm(t,e,n,r,o){return EU(t.pendingWriteTree_,e,n,r,o),o?Cs(t,new Oh(xm(),e,n)):[]}function aV(t,e,n,r){TU(t.pendingWriteTree_,e,n,r);var o=rn.fromObject(n);return Cs(t,new Fm(xm(),e,o))}function Mr(t,e,n){n===void 0&&(n=!1);var r=SU(t.pendingWriteTree_,e),o=CU(t.pendingWriteTree_,e);if(o){var s=new rn(null);return r.snap!=null?s=s.set(pe(),!0):Je(r.children,function(u){s=s.set(new _e(u),!0)}),Cs(t,new mU(r.path,s,n))}else return[]}function ku(t,e,n){return Cs(t,new Oh(Lm(),e,n))}function uV(t,e,n){var r=rn.fromObject(n);return Cs(t,new Fm(Lm(),e,r))}function cV(t,e){return Cs(t,new EA(Lm(),e))}function lV(t,e,n){var r=Gm(t,n);if(r){var o=Wm(r),s=o.path,u=o.queryId,l=Dt(s,e),h=new EA(Mm(u),l);return Hm(t,s,h)}else return[]}function Yv(t,e,n,r){var o=e._path,s=t.syncPointTree_.get(o),u=[];if(s&&(e._queryIdentifier==="default"||FA(s,e))){var l=rV(s,e,n,r);tV(s)&&(t.syncPointTree_=t.syncPointTree_.remove(o));var h=l.removed;u=l.events;var d=h.findIndex(function(O){return O._queryParams.loadsAllData()})!==-1,p=t.syncPointTree_.findOnPath(o,function(O,M){return Hr(M)});if(d&&!p){var g=t.syncPointTree_.subtree(o);if(!g.isEmpty())for(var y=pV(g),w=0;w<y.length;++w){var b=y[w],E=b.query,T=jA(t,b);t.listenProvider_.startListening(xa(E),Hl(t,E),T.hashFn,T.onComplete)}}if(!p&&h.length>0&&!r)if(d){var k=null;t.listenProvider_.stopListening(xa(e),k)}else h.forEach(function(O){var M=t.queryToTagMap.get(Fh(O));t.listenProvider_.stopListening(xa(O),M)});vV(t,h)}return u}function hV(t,e,n,r){var o=Gm(t,r);if(o!=null){var s=Wm(o),u=s.path,l=s.queryId,h=Dt(u,e),d=new Oh(Mm(l),h,n);return Hm(t,u,d)}else return[]}function fV(t,e,n,r){var o=Gm(t,r);if(o){var s=Wm(o),u=s.path,l=s.queryId,h=Dt(u,e),d=rn.fromObject(n),p=new Fm(Mm(l),h,d);return Hm(t,u,p)}else return[]}function uE(t,e,n){var r=e._path,o=null,s=!1;t.syncPointTree_.foreachOnPath(r,function(E,T){var k=Dt(E,r);o=o||jr(T,k),s=s||Hr(T)});var u=t.syncPointTree_.get(r);u?(s=s||Hr(u),o=o||jr(u,pe())):(u=new PA,t.syncPointTree_=t.syncPointTree_.set(r,u));var l;if(o!=null)l=!0;else{l=!1,o=te.EMPTY_NODE;var h=t.syncPointTree_.subtree(r);h.foreachChild(function(E,T){var k=jr(T,pe());k&&(o=o.updateImmediateChild(E,k))})}var d=FA(u,e);if(!d&&!e._queryParams.loadsAllData()){var p=Fh(e);L(!t.queryToTagMap.has(p),"View does not exist, but we have a tag");var g=gV();t.queryToTagMap.set(p,g),t.tagToQueryMap.set(g,p)}var y=xh(t.pendingWriteTree_,r),w=nV(u,e,n,y,o,l);if(!d&&!s){var b=MA(u,e);w=w.concat(mV(t,e,b))}return w}function Mh(t,e,n){var r=!0,o=t.pendingWriteTree_,s=t.syncPointTree_.findOnPath(e,function(u,l){var h=Dt(u,e),d=jr(l,h);if(d)return d});return AA(o,e,s,n,r)}function dV(t,e){var n=e._path,r=null;t.syncPointTree_.foreachOnPath(n,function(d,p){var g=Dt(d,n);r=r||jr(p,g)});var o=t.syncPointTree_.get(n);o?r=r||jr(o,pe()):(o=new PA,t.syncPointTree_=t.syncPointTree_.set(n,o));var s=r!=null,u=s?new Wr(r,!0,!1):null,l=xh(t.pendingWriteTree_,e._path),h=xA(o,e,l,s?u.getNode():te.EMPTY_NODE,s);return QU(h)}function Cs(t,e){return UA(e,t.syncPointTree_,null,xh(t.pendingWriteTree_,pe()))}function UA(t,e,n,r){if(oe(t.path))return VA(t,e,n,r);var o=e.get(pe());n==null&&o!=null&&(n=jr(o,pe()));var s=[],u=ie(t.path),l=t.operationForChild(u),h=e.children.get(u);if(h&&l){var d=n?n.getImmediateChild(u):null,p=kA(r,u);s=s.concat(UA(l,h,d,p))}return o&&(s=s.concat(Bm(o,t,r,n))),s}function VA(t,e,n,r){var o=e.get(pe());n==null&&o!=null&&(n=jr(o,pe()));var s=[];return e.children.inorderTraversal(function(u,l){var h=n?n.getImmediateChild(u):null,d=kA(r,u),p=t.operationForChild(u);p&&(s=s.concat(VA(p,l,h,d)))}),o&&(s=s.concat(Bm(o,t,r,n))),s}function jA(t,e){var n=e.query,r=Hl(t,n);return{hashFn:function(){var o=$U(e)||te.EMPTY_NODE;return o.hash()},onComplete:function(o){if(o==="ok")return r?lV(t,n._path,r):cV(t,n._path);var s=nF(o,n);return Yv(t,n,null,s)}}}function Hl(t,e){var n=Fh(e);return t.queryToTagMap.get(n)}function Fh(t){return t._path.toString()+"$"+t._queryIdentifier}function Gm(t,e){return t.tagToQueryMap.get(e)}function Wm(t){var e=t.indexOf("$");return L(e!==-1&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new _e(t.substr(0,e))}}function Hm(t,e,n){var r=t.syncPointTree_.get(e);L(r,"Missing sync point for query tag that we're tracking");var o=xh(t.pendingWriteTree_,e);return Bm(r,n,o,null)}function pV(t){return t.fold(function(e,n,r){if(n&&Hr(n)){var o=Lh(n);return[o]}else{var s=[];return n&&(s=LA(n)),Je(r,function(u,l){s=s.concat(l)}),s}})}function xa(t){return t._queryParams.loadsAllData()&&!t._queryParams.isDefault()?new(oV())(t._repo,t._path):t}function vV(t,e){for(var n=0;n<e.length;++n){var r=e[n];if(!r._queryParams.loadsAllData()){var o=Fh(r),s=t.queryToTagMap.get(o);t.queryToTagMap.delete(o),t.tagToQueryMap.delete(s)}}}function gV(){return sV++}function mV(t,e,n){var r=e._path,o=Hl(t,e),s=jA(t,n),u=t.listenProvider_.startListening(xa(e),o,s.hashFn,s.onComplete),l=t.syncPointTree_.subtree(r);if(o)L(!Hr(l.value),"If we're adding a query, it shouldn't be shadowed");else for(var h=l.fold(function(g,y,w){if(!oe(g)&&y&&Hr(y))return[Lh(y).query];var b=[];return y&&(b=b.concat(LA(y).map(function(E){return E.query}))),Je(w,function(E,T){b=b.concat(T)}),b}),d=0;d<h.length;++d){var p=h[d];t.listenProvider_.stopListening(xa(p),Hl(t,p))}return u}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var yV=function(){function t(e){this.node_=e}return t.prototype.getImmediateChild=function(e){var n=this.node_.getImmediateChild(e);return new t(n)},t.prototype.node=function(){return this.node_},t}(),_V=function(){function t(e,n){this.syncTree_=e,this.path_=n}return t.prototype.getImmediateChild=function(e){var n=Re(this.path_,e);return new t(this.syncTree_,n)},t.prototype.node=function(){return Mh(this.syncTree_,this.path_)},t}(),wV=function(t){return t=t||{},t.timestamp=t.timestamp||new Date().getTime(),t},cE=function(t,e,n){if(!t||typeof t!="object")return t;if(L(".sv"in t,"Unexpected leaf node or priority contents"),typeof t[".sv"]=="string")return bV(t[".sv"],e,n);if(typeof t[".sv"]=="object")return IV(t[".sv"],e);L(!1,"Unexpected server value: "+JSON.stringify(t,null,2))},bV=function(t,e,n){switch(t){case"timestamp":return n.timestamp;default:L(!1,"Unexpected server value: "+t)}},IV=function(t,e,n){t.hasOwnProperty("increment")||L(!1,"Unexpected server value: "+JSON.stringify(t,null,2));var r=t.increment;typeof r!="number"&&L(!1,"Unexpected increment value: "+r);var o=e.node();if(L(o!==null&&typeof o<"u","Expected ChildrenNode.EMPTY_NODE for nulls"),!o.isLeafNode())return r;var s=o,u=s.getValue();return typeof u!="number"?r:u+r},BA=function(t,e,n,r){return zm(e,new _V(n,t),r)},Km=function(t,e,n){return zm(t,new yV(e),n)};function zm(t,e,n){var r=t.getPriority().val(),o=cE(r,e.getImmediateChild(".priority"),n),s;if(t.isLeafNode()){var u=t,l=cE(u.getValue(),e,n);return l!==u.getValue()||o!==u.getPriority().val()?new cs(l,xe(o)):t}else{var h=t;return s=h,o!==h.getPriority().val()&&(s=s.updatePriority(new cs(o))),h.forEachChild(Se,function(d,p){var g=zm(p,e.getImmediateChild(d),n);g!==p&&(s=s.updateImmediateChild(d,g))}),s}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $m=function(){function t(e,n,r){e===void 0&&(e=""),n===void 0&&(n=null),r===void 0&&(r={children:{},childCount:0}),this.name=e,this.parent=n,this.node=r}return t}();function Uh(t,e){for(var n=e instanceof _e?e:new _e(e),r=t,o=ie(n);o!==null;){var s=ji(r.node.children,o)||{children:{},childCount:0};r=new $m(o,r,s),n=Ie(n),o=ie(n)}return r}function so(t){return t.node.value}function Qm(t,e){t.node.value=e,Xv(t)}function qA(t){return t.node.childCount>0}function EV(t){return so(t)===void 0&&!qA(t)}function Vh(t,e){Je(t.node.children,function(n,r){e(new $m(n,t,r))})}function GA(t,e,n,r){n&&!r&&e(t),Vh(t,function(o){GA(o,e,!0,r)}),n&&r&&e(t)}function TV(t,e,n){for(var r=t.parent;r!==null;){if(e(r))return!0;r=r.parent}return!1}function Nu(t){return new _e(t.parent===null?t.name:Nu(t.parent)+"/"+t.name)}function Xv(t){t.parent!==null&&SV(t.parent,t.name,t)}function SV(t,e,n){var r=EV(n),o=tn(t.node.children,e);r&&o?(delete t.node.children[e],t.node.childCount--,Xv(t)):!r&&!o&&(t.node.children[e]=n.node,t.node.childCount++,Xv(t))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var CV=/[\[\].#$\/\u0000-\u001F\u007F]/,AV=/[\[\].#$\u0000-\u001F\u007F]/,ev=10*1024*1024,jh=function(t){return typeof t=="string"&&t.length!==0&&!CV.test(t)},WA=function(t){return typeof t=="string"&&t.length!==0&&!AV.test(t)},kV=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),WA(t)},iu=function(t){return t===null||typeof t=="string"||typeof t=="number"&&!Nh(t)||t&&typeof t=="object"&&tn(t,".sv")},Xn=function(t,e,n,r){r&&e===void 0||Ru(jt(t,"value"),e,n)},Ru=function(t,e,n){var r=n instanceof _e?new MF(n,t):n;if(e===void 0)throw new Error(t+"contains undefined "+Ei(r));if(typeof e=="function")throw new Error(t+"contains a function "+Ei(r)+" with contents = "+e.toString());if(Nh(e))throw new Error(t+"contains "+e.toString()+" "+Ei(r));if(typeof e=="string"&&e.length>ev/3&&Yl(e)>ev)throw new Error(t+"contains a string greater than "+ev+" utf8 bytes "+Ei(r)+" ('"+e.substring(0,50)+"...')");if(e&&typeof e=="object"){var o=!1,s=!1;if(Je(e,function(u,l){if(u===".value")o=!0;else if(u!==".priority"&&u!==".sv"&&(s=!0,!jh(u)))throw new Error(t+" contains an invalid key ("+u+") "+Ei(r)+`.  Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`);FF(r,u),Ru(t,l,r),UF(r)}),o&&s)throw new Error(t+' contains ".value" child '+Ei(r)+" in addition to actual children.")}},NV=function(t,e){var n,r;for(n=0;n<e.length;n++){r=e[n];for(var o=tu(r),s=0;s<o.length;s++)if(!(o[s]===".priority"&&s===o.length-1)){if(!jh(o[s]))throw new Error(t+"contains an invalid key ("+o[s]+") in path "+r.toString()+`. Keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]"`)}}e.sort(LF);var u=null;for(n=0;n<e.length;n++){if(r=e[n],u!==null&&cn(u,r))throw new Error(t+"contains a path "+u.toString()+" that is ancestor of another path "+r.toString());u=r}},HA=function(t,e,n,r){var o=jt(t,"values");if(!(e&&typeof e=="object")||Array.isArray(e))throw new Error(o+" must be an object containing the children to replace.");var s=[];Je(e,function(u,l){var h=new _e(u);if(Ru(o,l,Re(n,h)),km(h)===".priority"&&!iu(l))throw new Error(o+"contains an invalid value for '"+h.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");s.push(h)}),NV(o,s)},Ym=function(t,e,n){if(Nh(e))throw new Error(jt(t,"priority")+"is "+e.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!iu(e))throw new Error(jt(t,"priority")+"must be a valid Firebase priority (a string, finite number, server value, or null).")},RV=function(t,e,n){if(e!==void 0)switch(e){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(jt(t,"eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},Du=function(t,e,n,r){if(n!==void 0&&!jh(n))throw new Error(jt(t,e)+'was an invalid key = "'+n+`".  Firebase keys must be non-empty strings and can't contain ".", "#", "$", "/", "[", or "]").`)},ou=function(t,e,n,r){if(!WA(n))throw new Error(jt(t,e)+'was an invalid path = "'+n+`". Paths must be non-empty strings and can't contain ".", "#", "$", "[", or "]"`)},DV=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),ou(t,e,n)},ln=function(t,e){if(ie(e)===".info")throw new Error(t+" failed = Can't modify data under /.info/")},KA=function(t,e){var n=e.path.toString();if(typeof e.repoInfo.host!="string"||e.repoInfo.host.length===0||!jh(e.repoInfo.namespace)&&e.repoInfo.host.split(":")[0]!=="localhost"||n.length!==0&&!kV(n))throw new Error(jt(t,"url")+`must be a valid firebase URL and the path can't contain ".", "#", "$", "[", or "]".`)},OV=function(t,e,n,r){if(n!==void 0&&typeof n!="boolean")throw new Error(jt(t,e)+"must be a boolean.")};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var PV=function(){function t(){this.eventLists_=[],this.recursionDepth_=0}return t}();function Bh(t,e){for(var n=null,r=0;r<e.length;r++){var o=e[r],s=o.getPath();n!==null&&!Nm(s,n.path)&&(t.eventLists_.push(n),n=null),n===null&&(n={events:[],path:s}),n.events.push(o)}n&&t.eventLists_.push(n)}function Xm(t,e,n){Bh(t,n),zA(t,function(r){return Nm(r,e)})}function pn(t,e,n){Bh(t,n),zA(t,function(r){return cn(r,e)||cn(e,r)})}function zA(t,e){t.recursionDepth_++;for(var n=!0,r=0;r<t.eventLists_.length;r++){var o=t.eventLists_[r];if(o){var s=o.path;e(s)?(xV(t.eventLists_[r]),t.eventLists_[r]=null):n=!1}}n&&(t.eventLists_=[]),t.recursionDepth_--}function xV(t){for(var e=0;e<t.events.length;e++){var n=t.events[e];if(n!==null){t.events[e]=null;var r=n.getEventRunner();Mi&&nt("event: "+n.toString()),Ts(r)}}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $A="repo_interrupt",LV=25,MV=function(){function t(e,n,r,o){this.repoInfo_=e,this.forceRestClient_=n,this.authTokenProvider_=r,this.appCheckProvider_=o,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new PV,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=Ul(),this.transactionQueueTree_=new $m,this.persistentConnection_=null,this.key=this.repoInfo_.toURLString()}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t}();function FV(t,e,n){if(t.stats_=Cm(t.repoInfo_),t.forceRestClient_||iF())t.server_=new lU(t.repoInfo_,function(r,o,s,u){lE(t,r,o,s,u)},t.authTokenProvider_,t.appCheckProvider_),setTimeout(function(){return hE(t,!0)},0);else{if(typeof n<"u"&&n!==null){if(typeof n!="object")throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{Qe(n)}catch(r){throw new Error("Invalid authOverride provided: "+r)}}t.persistentConnection_=new Fi(t.repoInfo_,e,function(r,o,s,u){lE(t,r,o,s,u)},function(r){hE(t,r)},function(r){VV(t,r)},t.authTokenProvider_,t.appCheckProvider_,n),t.server_=t.persistentConnection_}t.authTokenProvider_.addTokenChangeListener(function(r){t.server_.refreshAuthToken(r)}),t.appCheckProvider_.addTokenChangeListener(function(r){t.server_.refreshAppCheckToken(r.token)}),t.statsReporter_=lF(t.repoInfo_,function(){return new vU(t.stats_,t.server_)}),t.infoData_=new hU,t.infoSyncTree_=new aE({startListening:function(r,o,s,u){var l=[],h=t.infoData_.getNode(r._path);return h.isEmpty()||(l=ku(t.infoSyncTree_,r._path,h),setTimeout(function(){u("ok")},0)),l},stopListening:function(){}}),Jm(t,"connected",!1),t.serverSyncTree_=new aE({startListening:function(r,o,s,u){return t.server_.listen(r,s,o,function(l,h){var d=u(l,h);pn(t.eventQueue_,r._path,d)}),[]},stopListening:function(r,o){t.server_.unlisten(r,o)}})}function QA(t){var e=t.infoData_.getNode(new _e(".info/serverTimeOffset")),n=e.val()||0;return new Date().getTime()+n}function Ou(t){return wV({timestamp:QA(t)})}function lE(t,e,n,r,o){t.dataUpdateCount++;var s=new _e(e);n=t.interceptServerDataCallback_?t.interceptServerDataCallback_(e,n):n;var u=[];if(o)if(r){var l=sl(n,function(y){return xe(y)});u=fV(t.serverSyncTree_,s,l,o)}else{var h=xe(n);u=hV(t.serverSyncTree_,s,h,o)}else if(r){var d=sl(n,function(y){return xe(y)});u=uV(t.serverSyncTree_,s,d)}else{var p=xe(n);u=ku(t.serverSyncTree_,s,p)}var g=s;u.length>0&&(g=ds(t,s)),pn(t.eventQueue_,g,u)}function UV(t,e){t.interceptServerDataCallback_=e}function hE(t,e){Jm(t,"connected",e),e===!1&&qV(t)}function VV(t,e){Je(e,function(n,r){Jm(t,n,r)})}function Jm(t,e,n){var r=new _e("/.info/"+e),o=xe(n);t.infoData_.updateSnapshot(r,o);var s=ku(t.infoSyncTree_,r,o);pn(t.eventQueue_,r,s)}function qh(t){return t.nextWriteId_++}function jV(t,e){var n=dV(t.serverSyncTree_,e);return n!=null?Promise.resolve(n):t.server_.get(e).then(function(r){var o=xe(r).withIndex(e._queryParams.getIndex()),s=ku(t.serverSyncTree_,e._path,o);return Xm(t.eventQueue_,e._path,s),Promise.resolve(o)},function(r){return As(t,"get for query "+Qe(e)+" failed: "+r),Promise.reject(new Error(r))})}function Zm(t,e,n,r,o){As(t,"set",{path:e.toString(),value:n,priority:r});var s=Ou(t),u=xe(n,r),l=Mh(t.serverSyncTree_,e),h=Km(u,l,s),d=qh(t),p=qm(t.serverSyncTree_,e,h,d,!0);Bh(t.eventQueue_,p),t.server_.put(e.toString(),u.val(!0),function(y,w){var b=y==="ok";b||ht("set at "+e+" failed: "+y);var E=Mr(t.serverSyncTree_,d,!b);pn(t.eventQueue_,e,E),Kr(t,o,y,w)});var g=ty(t,e);ds(t,g),pn(t.eventQueue_,g,[])}function BV(t,e,n,r){As(t,"update",{path:e.toString(),value:n});var o=!0,s=Ou(t),u={};if(Je(n,function(d,p){o=!1,u[d]=BA(Re(e,d),xe(p),t.serverSyncTree_,s)}),o)nt("update() called with empty data.  Don't do anything."),Kr(t,r,"ok",void 0);else{var l=qh(t),h=aV(t.serverSyncTree_,e,u,l);Bh(t.eventQueue_,h),t.server_.merge(e.toString(),n,function(d,p){var g=d==="ok";g||ht("update at "+e+" failed: "+d);var y=Mr(t.serverSyncTree_,l,!g),w=y.length>0?ds(t,e):e;pn(t.eventQueue_,w,y),Kr(t,r,d,p)}),Je(n,function(d){var p=ty(t,Re(e,d));ds(t,p)}),pn(t.eventQueue_,e,[])}}function qV(t){As(t,"onDisconnectEvents");var e=Ou(t),n=Ul();Wv(t.onDisconnect_,pe(),function(o,s){var u=BA(o,s,t.serverSyncTree_,e);Ss(n,o,u)});var r=[];Wv(n,pe(),function(o,s){r=r.concat(ku(t.serverSyncTree_,o,s));var u=ty(t,o);ds(t,u)}),t.onDisconnect_=Ul(),pn(t.eventQueue_,pe(),r)}function GV(t,e,n){t.server_.onDisconnectCancel(e.toString(),function(r,o){r==="ok"&&Gv(t.onDisconnect_,e),Kr(t,n,r,o)})}function fE(t,e,n,r){var o=xe(n);t.server_.onDisconnectPut(e.toString(),o.val(!0),function(s,u){s==="ok"&&Ss(t.onDisconnect_,e,o),Kr(t,r,s,u)})}function WV(t,e,n,r,o){var s=xe(n,r);t.server_.onDisconnectPut(e.toString(),s.val(!0),function(u,l){u==="ok"&&Ss(t.onDisconnect_,e,s),Kr(t,o,u,l)})}function HV(t,e,n,r){if(av(n)){nt("onDisconnect().update() called with empty data.  Don't do anything."),Kr(t,r,"ok",void 0);return}t.server_.onDisconnectMerge(e.toString(),n,function(o,s){o==="ok"&&Je(n,function(u,l){var h=xe(l);Ss(t.onDisconnect_,Re(e,u),h)}),Kr(t,r,o,s)})}function KV(t,e,n){var r;ie(e._path)===".info"?r=uE(t.infoSyncTree_,e,n):r=uE(t.serverSyncTree_,e,n),Xm(t.eventQueue_,e._path,r)}function Jv(t,e,n){var r;ie(e._path)===".info"?r=Yv(t.infoSyncTree_,e,n):r=Yv(t.serverSyncTree_,e,n),Xm(t.eventQueue_,e._path,r)}function YA(t){t.persistentConnection_&&t.persistentConnection_.interrupt($A)}function zV(t){t.persistentConnection_&&t.persistentConnection_.resume($A)}function $V(t,e){if(e===void 0&&(e=!1),!(typeof console>"u")){var n;e?(t.statsListener_||(t.statsListener_=new IA(t.stats_)),n=t.statsListener_.get()):n=t.stats_.get();var r=Object.keys(n).reduce(function(o,s){return Math.max(s.length,o)},0);Je(n,function(o,s){for(var u=o,l=o.length;l<r+2;l++)u+=" ";console.log(u+s)})}}function QV(t,e){t.stats_.incrementCounter(e),gU(t.statsReporter_,e)}function As(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];var r="";t.persistentConnection_&&(r=t.persistentConnection_.id+":"),nt.apply(void 0,ve([r],gt(e)))}function Kr(t,e,n,r){e&&Ts(function(){if(n==="ok")e(null);else{var o=(n||"error").toUpperCase(),s=o;r&&(s+=": "+r);var u=new Error(s);u.code=o,e(u)}})}function YV(t,e,n,r,o,s){As(t,"transaction on "+e);var u={path:e,update:n,onComplete:r,status:null,order:BC(),applyLocally:s,retryCount:0,unwatcher:o,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},l=ey(t,e,void 0);u.currentInputSnapshot=l;var h=u.update(l.val());if(h===void 0)u.unwatcher(),u.currentOutputSnapshotRaw=null,u.currentOutputSnapshotResolved=null,u.onComplete&&u.onComplete(null,!1,u.currentInputSnapshot);else{Ru("transaction failed: Data returned ",h,u.path),u.status=0;var d=Uh(t.transactionQueueTree_,e),p=so(d)||[];p.push(u),Qm(d,p);var g=void 0;if(typeof h=="object"&&h!==null&&tn(h,".priority"))g=ji(h,".priority"),L(iu(g),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else{var y=Mh(t.serverSyncTree_,e)||te.EMPTY_NODE;g=y.getPriority().val()}var w=Ou(t),b=xe(h,g),E=Km(b,l,w);u.currentOutputSnapshotRaw=b,u.currentOutputSnapshotResolved=E,u.currentWriteId=qh(t);var T=qm(t.serverSyncTree_,e,E,u.currentWriteId,u.applyLocally);pn(t.eventQueue_,e,T),Gh(t,t.transactionQueueTree_)}}function ey(t,e,n){return Mh(t.serverSyncTree_,e,n)||te.EMPTY_NODE}function Gh(t,e){if(e===void 0&&(e=t.transactionQueueTree_),e||Wh(t,e),so(e)){var n=JA(t,e);L(n.length>0,"Sending zero length transaction queue");var r=n.every(function(o){return o.status===0});r&&XV(t,Nu(e),n)}else qA(e)&&Vh(e,function(o){Gh(t,o)})}function XV(t,e,n){for(var r=n.map(function(y){return y.currentWriteId}),o=ey(t,e,r),s=o,u=o.hash(),l=0;l<n.length;l++){var h=n[l];L(h.status===0,"tryToSendTransactionQueue_: items in queue should all be run."),h.status=1,h.retryCount++;var d=Dt(e,h.path);s=s.updateChild(d,h.currentOutputSnapshotRaw)}var p=s.val(!0),g=e;t.server_.put(g.toString(),p,function(y){As(t,"transaction put response",{path:g.toString(),status:y});var w=[];if(y==="ok"){for(var b=[],E=function(k){n[k].status=2,w=w.concat(Mr(t.serverSyncTree_,n[k].currentWriteId)),n[k].onComplete&&b.push(function(){return n[k].onComplete(null,!0,n[k].currentOutputSnapshotResolved)}),n[k].unwatcher()},T=0;T<n.length;T++)E(T);Wh(t,Uh(t.transactionQueueTree_,e)),Gh(t,t.transactionQueueTree_),pn(t.eventQueue_,e,w);for(var T=0;T<b.length;T++)Ts(b[T])}else{if(y==="datastale")for(var T=0;T<n.length;T++)n[T].status===3?n[T].status=4:n[T].status=0;else{ht("transaction at "+g.toString()+" failed: "+y);for(var T=0;T<n.length;T++)n[T].status=4,n[T].abortReason=y}ds(t,e)}},u)}function ds(t,e){var n=XA(t,e),r=Nu(n),o=JA(t,n);return JV(t,o,r),r}function JV(t,e,n){if(e.length!==0){for(var r=[],o=[],s=e.filter(function(d){return d.status===0}),u=s.map(function(d){return d.currentWriteId}),l=function(d){var p=e[d],g=Dt(n,p.path),y=!1,w;if(L(g!==null,"rerunTransactionsUnderNode_: relativePath should not be null."),p.status===4)y=!0,w=p.abortReason,o=o.concat(Mr(t.serverSyncTree_,p.currentWriteId,!0));else if(p.status===0)if(p.retryCount>=LV)y=!0,w="maxretry",o=o.concat(Mr(t.serverSyncTree_,p.currentWriteId,!0));else{var b=ey(t,p.path,u);p.currentInputSnapshot=b;var E=e[d].update(b.val());if(E!==void 0){Ru("transaction failed: Data returned ",E,p.path);var T=xe(E),k=typeof E=="object"&&E!=null&&tn(E,".priority");k||(T=T.updatePriority(b.getPriority()));var O=p.currentWriteId,M=Ou(t),H=Km(T,b,M);p.currentOutputSnapshotRaw=T,p.currentOutputSnapshotResolved=H,p.currentWriteId=qh(t),u.splice(u.indexOf(O),1),o=o.concat(qm(t.serverSyncTree_,p.path,H,p.currentWriteId,p.applyLocally)),o=o.concat(Mr(t.serverSyncTree_,O,!0))}else y=!0,w="nodata",o=o.concat(Mr(t.serverSyncTree_,p.currentWriteId,!0))}pn(t.eventQueue_,n,o),o=[],y&&(e[d].status=2,function(X){setTimeout(X,Math.floor(0))}(e[d].unwatcher),e[d].onComplete&&(w==="nodata"?r.push(function(){return e[d].onComplete(null,!1,e[d].currentInputSnapshot)}):r.push(function(){return e[d].onComplete(new Error(w),!1,null)})))},h=0;h<e.length;h++)l(h);Wh(t,t.transactionQueueTree_);for(var h=0;h<r.length;h++)Ts(r[h]);Gh(t,t.transactionQueueTree_)}}function XA(t,e){var n,r=t.transactionQueueTree_;for(n=ie(e);n!==null&&so(r)===void 0;)r=Uh(r,n),e=Ie(e),n=ie(e);return r}function JA(t,e){var n=[];return ZA(t,e,n),n.sort(function(r,o){return r.order-o.order}),n}function ZA(t,e,n){var r=so(e);if(r)for(var o=0;o<r.length;o++)n.push(r[o]);Vh(e,function(s){ZA(t,s,n)})}function Wh(t,e){var n=so(e);if(n){for(var r=0,o=0;o<n.length;o++)n[o].status!==2&&(n[r]=n[o],r++);n.length=r,Qm(e,n.length>0?n:void 0)}Vh(e,function(s){Wh(t,s)})}function ty(t,e){var n=Nu(XA(t,e)),r=Uh(t.transactionQueueTree_,e);return TV(r,function(o){tv(t,o)}),tv(t,r),GA(r,function(o){tv(t,o)}),n}function tv(t,e){var n=so(e);if(n){for(var r=[],o=[],s=-1,u=0;u<n.length;u++)n[u].status===3||(n[u].status===1?(L(s===u-1,"All SENT items should be at beginning of queue."),s=u,n[u].status=3,n[u].abortReason="set"):(L(n[u].status===0,"Unexpected transaction status in abort"),n[u].unwatcher(),o=o.concat(Mr(t.serverSyncTree_,n[u].currentWriteId,!0)),n[u].onComplete&&r.push(n[u].onComplete.bind(null,new Error("set"),!1,null))));s===-1?Qm(e,void 0):n.length=s+1,pn(t.eventQueue_,Nu(e),o);for(var u=0;u<r.length;u++)Ts(r[u])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ZV(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var o=n[r];try{o=decodeURIComponent(o.replace(/\+/g," "))}catch{}e+="/"+o}return e}function ej(t){var e,n,r={};t.charAt(0)==="?"&&(t=t.substring(1));try{for(var o=Ot(t.split("&")),s=o.next();!s.done;s=o.next()){var u=s.value;if(u.length!==0){var l=u.split("=");l.length===2?r[decodeURIComponent(l[0])]=decodeURIComponent(l[1]):ht("Invalid query segment '"+u+"' in query '"+t+"'")}}}catch(h){e={error:h}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return r}var Zv=function(t,e){var n=tj(t),r=n.namespace;n.domain==="firebase.com"&&Qn(n.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),(!r||r==="undefined")&&n.domain!=="localhost"&&Qn("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),n.secure||XM();var o=n.scheme==="ws"||n.scheme==="wss";return{repoInfo:new Sm(n.host,n.secure,r,e,o,"",r!==n.subdomain),path:new _e(n.pathString)}},tj=function(t){var e="",n="",r="",o="",s="",u=!0,l="https",h=443;if(typeof t=="string"){var d=t.indexOf("//");d>=0&&(l=t.substring(0,d-1),t=t.substring(d+2));var p=t.indexOf("/");p===-1&&(p=t.length);var g=t.indexOf("?");g===-1&&(g=t.length),e=t.substring(0,Math.min(p,g)),p<g&&(o=ZV(t.substring(p,g)));var y=ej(t.substring(Math.min(t.length,g)));d=e.indexOf(":"),d>=0?(u=l==="https"||l==="wss",h=parseInt(e.substring(d+1),10)):d=e.length;var w=e.slice(0,d);if(w.toLowerCase()==="localhost")n="localhost";else if(w.split(".").length<=2)n=w;else{var b=e.indexOf(".");r=e.substring(0,b).toLowerCase(),n=e.substring(b+1),s=r}"ns"in y&&(s=y.ns)}return{host:e,port:h,domain:n,subdomain:r,secure:u,scheme:l,pathString:o,namespace:s}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ek=function(){function t(e,n,r,o){this.eventType=e,this.eventRegistration=n,this.snapshot=r,this.prevName=o}return t.prototype.getPath=function(){var e=this.snapshot.ref;return this.eventType==="value"?e._path:e.parent._path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+Qe(this.snapshot.exportVal())},t}(),tk=function(){function t(e,n,r){this.eventRegistration=e,this.error=n,this.path=r}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nk=function(){function t(e,n){this.snapshotCallback=e,this.cancelCallback=n}return t.prototype.onValue=function(e,n){this.snapshotCallback.call(null,e,n)},t.prototype.onCancel=function(e){return L(this.hasCancelCallback,"Raising a cancel event on a listener with no cancel callback"),this.cancelCallback.call(null,e)},Object.defineProperty(t.prototype,"hasCancelCallback",{get:function(){return!!this.cancelCallback},enumerable:!1,configurable:!0}),t.prototype.matches=function(e){return this.snapshotCallback===e.snapshotCallback||this.snapshotCallback.userCallback!==void 0&&this.snapshotCallback.userCallback===e.snapshotCallback.userCallback&&this.snapshotCallback.context===e.snapshotCallback.context},t}();/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var nj=function(){function t(e,n){this._repo=e,this._path=n}return t.prototype.cancel=function(){var e=new Ut;return GV(this._repo,this._path,e.wrapCallback(function(){})),e.promise},t.prototype.remove=function(){ln("OnDisconnect.remove",this._path);var e=new Ut;return fE(this._repo,this._path,null,e.wrapCallback(function(){})),e.promise},t.prototype.set=function(e){ln("OnDisconnect.set",this._path),Xn("OnDisconnect.set",e,this._path,!1);var n=new Ut;return fE(this._repo,this._path,e,n.wrapCallback(function(){})),n.promise},t.prototype.setWithPriority=function(e,n){ln("OnDisconnect.setWithPriority",this._path),Xn("OnDisconnect.setWithPriority",e,this._path,!1),Ym("OnDisconnect.setWithPriority",n);var r=new Ut;return WV(this._repo,this._path,e,n,r.wrapCallback(function(){})),r.promise},t.prototype.update=function(e){ln("OnDisconnect.update",this._path),HA("OnDisconnect.update",e,this._path);var n=new Ut;return HV(this._repo,this._path,e,n.wrapCallback(function(){})),n.promise},t}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var vn=function(){function t(e,n,r,o){this._repo=e,this._path=n,this._queryParams=r,this._orderByCalled=o}return Object.defineProperty(t.prototype,"key",{get:function(){return oe(this._path)?null:km(this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Jn(this._repo,this._path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryIdentifier",{get:function(){var e=XI(this._queryParams),n=Im(e);return n==="{}"?"default":n},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_queryObject",{get:function(){return XI(this._queryParams)},enumerable:!1,configurable:!0}),t.prototype.isEqual=function(e){if(e=re(e),!(e instanceof t))return!1;var n=this._repo===e._repo,r=Nm(this._path,e._path),o=this._queryIdentifier===e._queryIdentifier;return n&&r&&o},t.prototype.toJSON=function(){return this.toString()},t.prototype.toString=function(){return this._repo.toString()+xF(this._path)},t}();function Hh(t,e){if(t._orderByCalled===!0)throw new Error(e+": You can't combine multiple orderBy calls.")}function Jr(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Wn){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",o="Query: When ordering by key, the argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() must be a string.";if(t.hasStart()){var s=t.getIndexStartName();if(s!==pr)throw new Error(r);if(typeof e!="string")throw new Error(o)}if(t.hasEnd()){var u=t.getIndexEndName();if(u!==Yn)throw new Error(r);if(typeof n!="string")throw new Error(o)}}else if(t.getIndex()===Se){if(e!=null&&!iu(e)||n!=null&&!iu(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), startAfter() endAt(), endBefore(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(L(t.getIndex()instanceof Dm||t.getIndex()===Om,"unknown index type."),e!=null&&typeof e=="object"||n!=null&&typeof n=="object")throw new Error("Query: First argument passed to startAt(), startAfter(), endAt(), endBefore(), or equalTo() cannot be an object.")}function Kh(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), startAfter(), endAt(), endBefore(), and limit(). Use limitToFirst() or limitToLast() instead.")}var Jn=function(t){V(e,t);function e(n,r){return t.call(this,n,r,new bA,!1)||this}return Object.defineProperty(e.prototype,"parent",{get:function(){var n=lA(this._path);return n===null?null:new e(this._repo,n)},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){for(var n=this;n.parent!==null;)n=n.parent;return n},enumerable:!1,configurable:!0}),e}(vn),zh=function(){function t(e,n,r){this._node=e,this.ref=n,this._index=r}return Object.defineProperty(t.prototype,"priority",{get:function(){return this._node.getPriority().val()},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"key",{get:function(){return this.ref.key},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._node.numChildren()},enumerable:!1,configurable:!0}),t.prototype.child=function(e){var n=new _e(e),r=$i(this.ref,e);return new t(this._node.getChild(n),r,Se)},t.prototype.exists=function(){return!this._node.isEmpty()},t.prototype.exportVal=function(){return this._node.val(!0)},t.prototype.forEach=function(e){var n=this;if(this._node.isLeafNode())return!1;var r=this._node;return!!r.forEachChild(this._index,function(o,s){return e(new t(s,$i(n.ref,o),Se))})},t.prototype.hasChild=function(e){var n=new _e(e);return!this._node.getChild(n).isEmpty()},t.prototype.hasChildren=function(){return this._node.isLeafNode()?!1:!this._node.isEmpty()},t.prototype.toJSON=function(){return this.exportVal()},t.prototype.val=function(){return this._node.val()},t}();function rk(t,e){return t=re(t),t._checkNotDeleted("ref"),e!==void 0?$i(t._root,e):t._root}function dE(t,e){t=re(t),t._checkNotDeleted("refFromURL");var n=Zv(e,t._repo.repoInfo_.nodeAdmin);KA("refFromURL",n);var r=n.repoInfo;return!t._repo.repoInfo_.isCustomHost()&&r.host!==t._repo.repoInfo_.host&&Qn("refFromURL: Host name does not match the current database: (found "+r.host+" but expected "+t._repo.repoInfo_.host+")"),rk(t,n.path.toString())}function $i(t,e){return t=re(t),ie(t._path)===null?DV("child","path",e):ou("child","path",e),new Jn(t._repo,Re(t._path,e))}function rj(t,e){t=re(t),ln("push",t._path),Xn("push",e,t._path,!0);var n=QA(t._repo),r=nU(n),o=$i(t,r),s=$i(t,r),u;return e!=null?u=ny(s,e).then(function(){return s}):u=Promise.resolve(s),o.then=u.then.bind(u),o.catch=u.then.bind(u,void 0),o}function ij(t){return ln("remove",t._path),ny(t,null)}function ny(t,e){t=re(t),ln("set",t._path),Xn("set",e,t._path,!1);var n=new Ut;return Zm(t._repo,t._path,e,null,n.wrapCallback(function(){})),n.promise}function oj(t,e){t=re(t),ln("setPriority",t._path),Ym("setPriority",e);var n=new Ut;return Zm(t._repo,Re(t._path,".priority"),e,null,n.wrapCallback(function(){})),n.promise}function sj(t,e,n){if(ln("setWithPriority",t._path),Xn("setWithPriority",e,t._path,!1),Ym("setWithPriority",n),t.key===".length"||t.key===".keys")throw"setWithPriority failed: "+t.key+" is a read-only object.";var r=new Ut;return Zm(t._repo,t._path,e,n,r.wrapCallback(function(){})),r.promise}function aj(t,e){HA("update",e,t._path);var n=new Ut;return BV(t._repo,t._path,e,n.wrapCallback(function(){})),n.promise}function uj(t){return t=re(t),jV(t._repo,t).then(function(e){return new zh(e,new Jn(t._repo,t._path),t._queryParams.getIndex())})}var ik=function(){function t(e){this.callbackContext=e}return t.prototype.respondsTo=function(e){return e==="value"},t.prototype.createEvent=function(e,n){var r=n._queryParams.getIndex();return new ek("value",this,new zh(e.snapshotNode,new Jn(n._repo,n._path),r))},t.prototype.getEventRunner=function(e){var n=this;return e.getEventType()==="cancel"?function(){return n.callbackContext.onCancel(e.error)}:function(){return n.callbackContext.onValue(e.snapshot,null)}},t.prototype.createCancelEvent=function(e,n){return this.callbackContext.hasCancelCallback?new tk(this,e,n):null},t.prototype.matches=function(e){return e instanceof t?!e.callbackContext||!this.callbackContext?!0:e.callbackContext.matches(this.callbackContext):!1},t.prototype.hasAnyCallback=function(){return this.callbackContext!==null},t}(),ok=function(){function t(e,n){this.eventType=e,this.callbackContext=n}return t.prototype.respondsTo=function(e){var n=e==="children_added"?"child_added":e;return n=n==="children_removed"?"child_removed":n,this.eventType===n},t.prototype.createCancelEvent=function(e,n){return this.callbackContext.hasCancelCallback?new tk(this,e,n):null},t.prototype.createEvent=function(e,n){L(e.childName!=null,"Child events should have a childName.");var r=$i(new Jn(n._repo,n._path),e.childName),o=n._queryParams.getIndex();return new ek(e.type,this,new zh(e.snapshotNode,r,o),e.prevName)},t.prototype.getEventRunner=function(e){var n=this;return e.getEventType()==="cancel"?function(){return n.callbackContext.onCancel(e.error)}:function(){return n.callbackContext.onValue(e.snapshot,e.prevName)}},t.prototype.matches=function(e){return e instanceof t?this.eventType===e.eventType&&(!this.callbackContext||!e.callbackContext||this.callbackContext.matches(e.callbackContext)):!1},t.prototype.hasAnyCallback=function(){return!!this.callbackContext},t}();function Pu(t,e,n,r,o){var s;if(typeof r=="object"&&(s=void 0,o=r),typeof r=="function"&&(s=r),o&&o.onlyOnce){var u=n,l=function(p,g){Jv(t._repo,t,d),u(p,g)};l.userCallback=n.userCallback,l.context=n.context,n=l}var h=new nk(n,s||void 0),d=e==="value"?new ik(h):new ok(e,h);return KV(t._repo,t,d),function(){return Jv(t._repo,t,d)}}function eg(t,e,n,r){return Pu(t,"value",e,n,r)}function pE(t,e,n,r){return Pu(t,"child_added",e,n,r)}function vE(t,e,n,r){return Pu(t,"child_changed",e,n,r)}function gE(t,e,n,r){return Pu(t,"child_moved",e,n,r)}function mE(t,e,n,r){return Pu(t,"child_removed",e,n,r)}function yE(t,e,n){var r=null,o=n?new nk(n):null;e==="value"?r=new ik(o):e&&(r=new ok(e,o)),Jv(t._repo,t,r)}var On=function(){function t(){}return t}(),sk=function(t){V(e,t);function e(n,r){var o=t.call(this)||this;return o._value=n,o._key=r,o}return e.prototype._apply=function(n){Xn("endAt",this._value,n._path,!0);var r=qv(n._queryParams,this._value,this._key);if(Kh(r),Jr(r),n._queryParams.hasEnd())throw new Error("endAt: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new vn(n._repo,n._path,r,n._orderByCalled)},e}(On);function cj(t,e){return Du("endAt","key",e),new sk(t,e)}var lj=function(t){V(e,t);function e(n,r){var o=t.call(this)||this;return o._value=n,o._key=r,o}return e.prototype._apply=function(n){Xn("endBefore",this._value,n._path,!1);var r=cU(n._queryParams,this._value,this._key);if(Kh(r),Jr(r),n._queryParams.hasEnd())throw new Error("endBefore: Starting point was already set (by another call to endAt, endBefore or equalTo).");return new vn(n._repo,n._path,r,n._orderByCalled)},e}(On);function hj(t,e){return Du("endBefore","key",e),new lj(t,e)}var ak=function(t){V(e,t);function e(n,r){var o=t.call(this)||this;return o._value=n,o._key=r,o}return e.prototype._apply=function(n){Xn("startAt",this._value,n._path,!0);var r=Bv(n._queryParams,this._value,this._key);if(Kh(r),Jr(r),n._queryParams.hasStart())throw new Error("startAt: Starting point was already set (by another call to startAt, startBefore or equalTo).");return new vn(n._repo,n._path,r,n._orderByCalled)},e}(On);function fj(t,e){return t===void 0&&(t=null),Du("startAt","key",e),new ak(t,e)}var dj=function(t){V(e,t);function e(n,r){var o=t.call(this)||this;return o._value=n,o._key=r,o}return e.prototype._apply=function(n){Xn("startAfter",this._value,n._path,!1);var r=uU(n._queryParams,this._value,this._key);if(Kh(r),Jr(r),n._queryParams.hasStart())throw new Error("startAfter: Starting point was already set (by another call to startAt, startAfter, or equalTo).");return new vn(n._repo,n._path,r,n._orderByCalled)},e}(On);function pj(t,e){return Du("startAfter","key",e),new dj(t,e)}var vj=function(t){V(e,t);function e(n){var r=t.call(this)||this;return r._limit=n,r}return e.prototype._apply=function(n){if(n._queryParams.hasLimit())throw new Error("limitToFirst: Limit was already set (by another call to limitToFirst or limitToLast).");return new vn(n._repo,n._path,sU(n._queryParams,this._limit),n._orderByCalled)},e}(On);function gj(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToFirst: First argument must be a positive integer.");return new vj(t)}var mj=function(t){V(e,t);function e(n){var r=t.call(this)||this;return r._limit=n,r}return e.prototype._apply=function(n){if(n._queryParams.hasLimit())throw new Error("limitToLast: Limit was already set (by another call to limitToFirst or limitToLast).");return new vn(n._repo,n._path,aU(n._queryParams,this._limit),n._orderByCalled)},e}(On);function yj(t){if(typeof t!="number"||Math.floor(t)!==t||t<=0)throw new Error("limitToLast: First argument must be a positive integer.");return new mj(t)}var _j=function(t){V(e,t);function e(n){var r=t.call(this)||this;return r._path=n,r}return e.prototype._apply=function(n){Hh(n,"orderByChild");var r=new _e(this._path);if(oe(r))throw new Error("orderByChild: cannot pass in empty path. Use orderByValue() instead.");var o=new Dm(r),s=Dh(n._queryParams,o);return Jr(s),new vn(n._repo,n._path,s,!0)},e}(On);function wj(t){if(t==="$key")throw new Error('orderByChild: "$key" is invalid.  Use orderByKey() instead.');if(t==="$priority")throw new Error('orderByChild: "$priority" is invalid.  Use orderByPriority() instead.');if(t==="$value")throw new Error('orderByChild: "$value" is invalid.  Use orderByValue() instead.');return ou("orderByChild","path",t),new _j(t)}var bj=function(t){V(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype._apply=function(n){Hh(n,"orderByKey");var r=Dh(n._queryParams,Wn);return Jr(r),new vn(n._repo,n._path,r,!0)},e}(On);function Ij(){return new bj}var Ej=function(t){V(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype._apply=function(n){Hh(n,"orderByPriority");var r=Dh(n._queryParams,Se);return Jr(r),new vn(n._repo,n._path,r,!0)},e}(On);function Tj(){return new Ej}var Sj=function(t){V(e,t);function e(){return t!==null&&t.apply(this,arguments)||this}return e.prototype._apply=function(n){Hh(n,"orderByValue");var r=Dh(n._queryParams,Om);return Jr(r),new vn(n._repo,n._path,r,!0)},e}(On);function Cj(){return new Sj}var Aj=function(t){V(e,t);function e(n,r){var o=t.call(this)||this;return o._value=n,o._key=r,o}return e.prototype._apply=function(n){if(Xn("equalTo",this._value,n._path,!1),n._queryParams.hasStart())throw new Error("equalTo: Starting point was already set (by another call to startAt/startAfter or equalTo).");if(n._queryParams.hasEnd())throw new Error("equalTo: Ending point was already set (by another call to endAt/endBefore or equalTo).");return new sk(this._value,this._key)._apply(new ak(this._value,this._key)._apply(n))},e}(On);function kj(t,e){return Du("equalTo","key",e),new Aj(t,e)}function En(t){for(var e,n,r=[],o=1;o<arguments.length;o++)r[o-1]=arguments[o];var s=re(t);try{for(var u=Ot(r),l=u.next();!l.done;l=u.next()){var h=l.value;s=h._apply(s)}}catch(d){e={error:d}}finally{try{l&&!l.done&&(n=u.return)&&n.call(u)}finally{if(e)throw e.error}}return s}ZU(Jn);iV(Jn);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Nj="FIREBASE_DATABASE_EMULATOR_HOST",tg={},uk=!1;function Rj(t,e,n,r){t.repoInfo_=new Sm(e+":"+n,!1,t.repoInfo_.namespace,t.repoInfo_.webSocketOnly,t.repoInfo_.nodeAdmin,t.repoInfo_.persistenceKey,t.repoInfo_.includeNamespaceInQueryParams),r&&(t.authTokenProvider_=r)}function ck(t,e,n,r,o){var s=r||t.options.databaseURL;s===void 0&&(t.options.projectId||Qn("Can't determine Firebase Database URL. Be sure to include  a Project ID when calling firebase.initializeApp()."),nt("Using default host for project ",t.options.projectId),s=t.options.projectId+"-default-rtdb.firebaseio.com");var u=Zv(s,o),l=u.repoInfo,h,d=void 0;typeof process<"u"&&(d=KM[Nj]),d?(h=!0,s="http://"+d+"?ns="+l.namespace,u=Zv(s,o),l=u.repoInfo):h=!u.repoInfo.secure;var p=o&&h?new Da(Da.OWNER):new sF(t.name,t.options,e);KA("Invalid Firebase Database URL",u),oe(u.path)||Qn("Database URL must point to the root of a Firebase Database (not including a child path).");var g=Oj(l,t,p,new oF(t.name,n));return new xj(g,t)}function Dj(t,e){var n=tg[e];(!n||n[t.key]!==t)&&Qn("Database "+e+"("+t.repoInfo_+") has already been deleted."),YA(t),delete n[t.key]}function Oj(t,e,n,r){var o=tg[e.name];o||(o={},tg[e.name]=o);var s=o[t.toURLString()];return s&&Qn("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),s=new MV(t,uk,n,r),o[t.toURLString()]=s,s}function Pj(t){uk=t}var xj=function(){function t(e,n){this._repoInternal=e,this.app=n,this.type="database",this._instanceStarted=!1}return Object.defineProperty(t.prototype,"_repo",{get:function(){return this._instanceStarted||(FV(this._repoInternal,this.app.options.appId,this.app.options.databaseAuthVariableOverride),this._instanceStarted=!0),this._repoInternal},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"_root",{get:function(){return this._rootInternal||(this._rootInternal=new Jn(this._repo,pe())),this._rootInternal},enumerable:!1,configurable:!0}),t.prototype._delete=function(){return this._rootInternal!==null&&(Dj(this._repo,this.app.name),this._repoInternal=null,this._rootInternal=null),Promise.resolve()},t.prototype._checkNotDeleted=function(e){this._rootInternal===null&&Qn("Cannot call "+e+" on a deleted database.")},t}();function Lj(t,e,n,r){r===void 0&&(r={}),t=re(t),t._checkNotDeleted("useEmulator"),t._instanceStarted&&Qn("Cannot call useEmulator() after instance has already been initialized.");var o=t._repoInternal,s=void 0;if(o.repoInfo_.nodeAdmin)r.mockUserToken&&Qn('mockUserToken is not supported by the Admin SDK. For client access with mock users, please use the "firebase" package instead of "firebase-admin".'),s=new Da(Da.OWNER);else if(r.mockUserToken){var u=typeof r.mockUserToken=="string"?r.mockUserToken:ug(r.mockUserToken,t.app.options.projectId);s=new Da(u)}Rj(o,e,n,s)}function Mj(t){t=re(t),t._checkNotDeleted("goOffline"),YA(t._repo)}function Fj(t){t=re(t),t._checkNotDeleted("goOnline"),zV(t._repo)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Uj={".sv":"timestamp"};function Vj(){return Uj}function jj(t){return{".sv":{increment:t}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Bj=function(){function t(e,n){this.committed=e,this.snapshot=n}return t.prototype.toJSON=function(){return{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}();function qj(t,e,n){var r;if(t=re(t),ln("Reference.transaction",t._path),t.key===".length"||t.key===".keys")throw"Reference.transaction failed: "+t.key+" is a read-only object.";var o=(r=n==null?void 0:n.applyLocally)!==null&&r!==void 0?r:!0,s=new Ut,u=function(h,d,p){var g=null;h?s.reject(h):(g=new zh(p,new Jn(t._repo,t._path),Se),s.resolve(new Bj(d,g)))},l=eg(t,function(){});return YV(t._repo,t._path,e,u,l,o),s.promise}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Gj=function(){function t(e){this._delegate=e}return t.prototype.cancel=function(e){Q("OnDisconnect.cancel",0,1,arguments.length),tt("OnDisconnect.cancel","onComplete",e,!0);var n=this._delegate.cancel();return e&&n.then(function(){return e(null)},function(r){return e(r)}),n},t.prototype.remove=function(e){Q("OnDisconnect.remove",0,1,arguments.length),tt("OnDisconnect.remove","onComplete",e,!0);var n=this._delegate.remove();return e&&n.then(function(){return e(null)},function(r){return e(r)}),n},t.prototype.set=function(e,n){Q("OnDisconnect.set",1,2,arguments.length),tt("OnDisconnect.set","onComplete",n,!0);var r=this._delegate.set(e);return n&&r.then(function(){return n(null)},function(o){return n(o)}),r},t.prototype.setWithPriority=function(e,n,r){Q("OnDisconnect.setWithPriority",2,3,arguments.length),tt("OnDisconnect.setWithPriority","onComplete",r,!0);var o=this._delegate.setWithPriority(e,n);return r&&o.then(function(){return r(null)},function(s){return r(s)}),o},t.prototype.update=function(e,n){if(Q("OnDisconnect.update",1,2,arguments.length),Array.isArray(e)){for(var r={},o=0;o<e.length;++o)r[""+o]=e[o];e=r,ht("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}tt("OnDisconnect.update","onComplete",n,!0);var s=this._delegate.update(e);return n&&s.then(function(){return n(null)},function(u){return n(u)}),s},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Wj=function(){function t(e,n){this.committed=e,this.snapshot=n}return t.prototype.toJSON=function(){return Q("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var La=function(){function t(e,n){this._database=e,this._delegate=n}return t.prototype.val=function(){return Q("DataSnapshot.val",0,0,arguments.length),this._delegate.val()},t.prototype.exportVal=function(){return Q("DataSnapshot.exportVal",0,0,arguments.length),this._delegate.exportVal()},t.prototype.toJSON=function(){return Q("DataSnapshot.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.exists=function(){return Q("DataSnapshot.exists",0,0,arguments.length),this._delegate.exists()},t.prototype.child=function(e){return Q("DataSnapshot.child",0,1,arguments.length),e=String(e),ou("DataSnapshot.child","path",e),new t(this._database,this._delegate.child(e))},t.prototype.hasChild=function(e){return Q("DataSnapshot.hasChild",1,1,arguments.length),ou("DataSnapshot.hasChild","path",e),this._delegate.hasChild(e)},t.prototype.getPriority=function(){return Q("DataSnapshot.getPriority",0,0,arguments.length),this._delegate.priority},t.prototype.forEach=function(e){var n=this;return Q("DataSnapshot.forEach",1,1,arguments.length),tt("DataSnapshot.forEach","action",e,!1),this._delegate.forEach(function(r){return e(new t(n._database,r))})},t.prototype.hasChildren=function(){return Q("DataSnapshot.hasChildren",0,0,arguments.length),this._delegate.hasChildren()},Object.defineProperty(t.prototype,"key",{get:function(){return this._delegate.key},enumerable:!1,configurable:!0}),t.prototype.numChildren=function(){return Q("DataSnapshot.numChildren",0,0,arguments.length),this._delegate.size},t.prototype.getRef=function(){return Q("DataSnapshot.ref",0,0,arguments.length),new Di(this._database,this._delegate.ref)},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!1,configurable:!0}),t}(),lk=function(){function t(e,n){this.database=e,this._delegate=n}return t.prototype.on=function(e,n,r,o){var s=this,u;Q("Query.on",2,4,arguments.length),tt("Query.on","callback",n,!1);var l=t.getCancelAndContextArgs_("Query.on",r,o),h=function(p,g){n.call(l.context,new La(s.database,p),g)};h.userCallback=n,h.context=l.context;var d=(u=l.cancel)===null||u===void 0?void 0:u.bind(l.context);switch(e){case"value":return eg(this._delegate,h,d),n;case"child_added":return pE(this._delegate,h,d),n;case"child_removed":return mE(this._delegate,h,d),n;case"child_changed":return vE(this._delegate,h,d),n;case"child_moved":return gE(this._delegate,h,d),n;default:throw new Error(jt("Query.on","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},t.prototype.off=function(e,n,r){if(Q("Query.off",0,3,arguments.length),RV("Query.off",e),tt("Query.off","callback",n,!0),c0("Query.off","context",r),n){var o=function(){};o.userCallback=n,o.context=r,yE(this._delegate,e,o)}else yE(this._delegate,e)},t.prototype.get=function(){var e=this;return uj(this._delegate).then(function(n){return new La(e.database,n)})},t.prototype.once=function(e,n,r,o){var s=this;Q("Query.once",1,4,arguments.length),tt("Query.once","callback",n,!0);var u=t.getCancelAndContextArgs_("Query.once",r,o),l=new Ut,h=function(p,g){var y=new La(s.database,p);n&&n.call(u.context,y,g),l.resolve(y)};h.userCallback=n,h.context=u.context;var d=function(p){u.cancel&&u.cancel.call(u.context,p),l.reject(p)};switch(e){case"value":eg(this._delegate,h,d,{onlyOnce:!0});break;case"child_added":pE(this._delegate,h,d,{onlyOnce:!0});break;case"child_removed":mE(this._delegate,h,d,{onlyOnce:!0});break;case"child_changed":vE(this._delegate,h,d,{onlyOnce:!0});break;case"child_moved":gE(this._delegate,h,d,{onlyOnce:!0});break;default:throw new Error(jt("Query.once","eventType")+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}return l.promise},t.prototype.limitToFirst=function(e){return Q("Query.limitToFirst",1,1,arguments.length),new t(this.database,En(this._delegate,gj(e)))},t.prototype.limitToLast=function(e){return Q("Query.limitToLast",1,1,arguments.length),new t(this.database,En(this._delegate,yj(e)))},t.prototype.orderByChild=function(e){return Q("Query.orderByChild",1,1,arguments.length),new t(this.database,En(this._delegate,wj(e)))},t.prototype.orderByKey=function(){return Q("Query.orderByKey",0,0,arguments.length),new t(this.database,En(this._delegate,Ij()))},t.prototype.orderByPriority=function(){return Q("Query.orderByPriority",0,0,arguments.length),new t(this.database,En(this._delegate,Tj()))},t.prototype.orderByValue=function(){return Q("Query.orderByValue",0,0,arguments.length),new t(this.database,En(this._delegate,Cj()))},t.prototype.startAt=function(e,n){return e===void 0&&(e=null),Q("Query.startAt",0,2,arguments.length),new t(this.database,En(this._delegate,fj(e,n)))},t.prototype.startAfter=function(e,n){return e===void 0&&(e=null),Q("Query.startAfter",0,2,arguments.length),new t(this.database,En(this._delegate,pj(e,n)))},t.prototype.endAt=function(e,n){return e===void 0&&(e=null),Q("Query.endAt",0,2,arguments.length),new t(this.database,En(this._delegate,cj(e,n)))},t.prototype.endBefore=function(e,n){return e===void 0&&(e=null),Q("Query.endBefore",0,2,arguments.length),new t(this.database,En(this._delegate,hj(e,n)))},t.prototype.equalTo=function(e,n){return Q("Query.equalTo",1,2,arguments.length),new t(this.database,En(this._delegate,kj(e,n)))},t.prototype.toString=function(){return Q("Query.toString",0,0,arguments.length),this._delegate.toString()},t.prototype.toJSON=function(){return Q("Query.toJSON",0,1,arguments.length),this._delegate.toJSON()},t.prototype.isEqual=function(e){if(Q("Query.isEqual",1,1,arguments.length),!(e instanceof t)){var n="Query.isEqual failed: First argument must be an instance of firebase.database.Query.";throw new Error(n)}return this._delegate.isEqual(e._delegate)},t.getCancelAndContextArgs_=function(e,n,r){var o={cancel:void 0,context:void 0};if(n&&r)o.cancel=n,tt(e,"cancel",o.cancel,!0),o.context=r,c0(e,"context",o.context);else if(n)if(typeof n=="object"&&n!==null)o.context=n;else if(typeof n=="function")o.cancel=n;else throw new Error(jt(e,"cancelOrContext")+" must either be a cancel callback or a context object.");return o},Object.defineProperty(t.prototype,"ref",{get:function(){return new Di(this.database,new Jn(this._delegate._repo,this._delegate._path))},enumerable:!1,configurable:!0}),t}(),Di=function(t){V(e,t);function e(n,r){var o=t.call(this,n,new vn(r._repo,r._path,new bA,!1))||this;return o.database=n,o._delegate=r,o}return e.prototype.getKey=function(){return Q("Reference.key",0,0,arguments.length),this._delegate.key},e.prototype.child=function(n){return Q("Reference.child",1,1,arguments.length),typeof n=="number"&&(n=String(n)),new e(this.database,$i(this._delegate,n))},e.prototype.getParent=function(){Q("Reference.parent",0,0,arguments.length);var n=this._delegate.parent;return n?new e(this.database,n):null},e.prototype.getRoot=function(){return Q("Reference.root",0,0,arguments.length),new e(this.database,this._delegate.root)},e.prototype.set=function(n,r){Q("Reference.set",1,2,arguments.length),tt("Reference.set","onComplete",r,!0);var o=ny(this._delegate,n);return r&&o.then(function(){return r(null)},function(s){return r(s)}),o},e.prototype.update=function(n,r){if(Q("Reference.update",1,2,arguments.length),Array.isArray(n)){for(var o={},s=0;s<n.length;++s)o[""+s]=n[s];n=o,ht("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}ln("Reference.update",this._delegate._path),tt("Reference.update","onComplete",r,!0);var u=aj(this._delegate,n);return r&&u.then(function(){return r(null)},function(l){return r(l)}),u},e.prototype.setWithPriority=function(n,r,o){Q("Reference.setWithPriority",2,3,arguments.length),tt("Reference.setWithPriority","onComplete",o,!0);var s=sj(this._delegate,n,r);return o&&s.then(function(){return o(null)},function(u){return o(u)}),s},e.prototype.remove=function(n){Q("Reference.remove",0,1,arguments.length),tt("Reference.remove","onComplete",n,!0);var r=ij(this._delegate);return n&&r.then(function(){return n(null)},function(o){return n(o)}),r},e.prototype.transaction=function(n,r,o){var s=this;Q("Reference.transaction",1,3,arguments.length),tt("Reference.transaction","transactionUpdate",n,!1),tt("Reference.transaction","onComplete",r,!0),OV("Reference.transaction","applyLocally",o);var u=qj(this._delegate,n,{applyLocally:o}).then(function(l){return new Wj(l.committed,new La(s.database,l.snapshot))});return r&&u.then(function(l){return r(null,l.committed,l.snapshot)},function(l){return r(l,!1,null)}),u},e.prototype.setPriority=function(n,r){Q("Reference.setPriority",1,2,arguments.length),tt("Reference.setPriority","onComplete",r,!0);var o=oj(this._delegate,n);return r&&o.then(function(){return r(null)},function(s){return r(s)}),o},e.prototype.push=function(n,r){var o=this;Q("Reference.push",0,2,arguments.length),tt("Reference.push","onComplete",r,!0);var s=rj(this._delegate,n),u=s.then(function(h){return new e(o.database,h)});r&&u.then(function(){return r(null)},function(h){return r(h)});var l=new e(this.database,s);return l.then=u.then.bind(u),l.catch=u.catch.bind(u,void 0),l},e.prototype.onDisconnect=function(){return ln("Reference.onDisconnect",this._delegate._path),new Gj(new nj(this._delegate._repo,this._delegate._path))},Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!1,configurable:!0}),e}(lk);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Kl=function(){function t(e,n){var r=this;this._delegate=e,this.app=n,this.INTERNAL={delete:function(){return r._delegate._delete()}}}return t.prototype.useEmulator=function(e,n,r){r===void 0&&(r={}),Lj(this._delegate,e,n,r)},t.prototype.ref=function(e){if(Q("database.ref",0,1,arguments.length),e instanceof Di){var n=dE(this._delegate,e.toString());return new Di(this,n)}else{var n=rk(this._delegate,e);return new Di(this,n)}},t.prototype.refFromURL=function(e){var n="database.refFromURL";Q(n,1,1,arguments.length);var r=dE(this._delegate,e);return new Di(this,r)},t.prototype.goOffline=function(){return Q("database.goOffline",0,0,arguments.length),Mj(this._delegate)},t.prototype.goOnline=function(){return Q("database.goOnline",0,0,arguments.length),Fj(this._delegate)},t.ServerValue={TIMESTAMP:Vj(),increment:function(e){return jj(e)}},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Hj=function(){Si.forceDisallow(),Am.forceAllow()},Kj=function(){Am.forceDisallow()},zj=function(){return Si.isAvailable()},$j=function(t,e){var n=t._delegate._repo.persistentConnection_;n.securityDebugCallback_=e},Qj=function(t,e){$V(t._delegate._repo,e)},Yj=function(t,e){QV(t._delegate._repo,e)},Xj=function(t){return t._delegate._repo.dataUpdateCount},Jj=function(t,e){return UV(t._delegate._repo,e)};function Zj(t){var e=t.app,n=t.url,r=t.version,o=t.customAuthImpl,s=t.namespace,u=t.nodeAdmin,l=u===void 0?!1:u;VC(r);var h=new WE("auth-internal",new HE("database-standalone"));return h.setComponent(new Kn("auth-internal",function(){return o},"PRIVATE")),{instance:new Kl(ck(e,h,void 0,n,l),e),namespace:s}}var eB=Object.freeze({__proto__:null,forceLongPolling:Hj,forceWebSockets:Kj,isWebSocketsAvailable:zj,setSecurityDebugCallback:$j,stats:Qj,statsIncrementCounter:Yj,dataUpdateCount:Xj,interceptServerData:Jj,initStandalone:Zj});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var tB=Fi;Fi.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)};Fi.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var nB=aA,rB=function(t){var e=Fi.prototype.put;return Fi.prototype.put=function(n,r,o,s){s!==void 0&&(s=t()),e.call(this,n,r,o,s)},function(){Fi.prototype.put=e}},iB=Sm,oB=function(t){return t._delegate._queryIdentifier},sB=function(t){Pj(t)},aB=Object.freeze({__proto__:null,DataConnection:tB,RealTimeConnection:nB,hijackHash:rB,ConnectionTarget:iB,queryIdentifier:oB,forceRestClient:sB});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var uB=Kl.ServerValue;function cB(t){VC(t.SDK_VERSION),t.INTERNAL.registerComponent(new Kn("database",function(e,n){var r=n.instanceIdentifier,o=e.getProvider("app").getImmediate(),s=e.getProvider("auth-internal"),u=e.getProvider("app-check-internal");return new Kl(ck(o,s,u,r),o)},"PUBLIC").setServiceProps({Reference:Di,Query:lk,Database:Kl,DataSnapshot:La,enableLogging:GC,INTERNAL:eB,ServerValue:uB,TEST_ACCESS:aB}).setMultipleInstances(!0)),t.registerVersion(zM,$M)}cB(J);(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(i,a,c){i!=Array.prototype&&i!=Object.prototype&&(i[a]=c.value)};function n(i){i=[typeof window=="object"&&window,typeof self=="object"&&self,typeof global=="object"&&global,i];for(var a=0;a<i.length;++a){var c=i[a];if(c&&c.Math==Math)return c}return globalThis}var r=n(this);function o(i,a){if(a){var c=r;i=i.split(".");for(var f=0;f<i.length-1;f++){var v=i[f];v in c||(c[v]={}),c=c[v]}i=i[i.length-1],f=c[i],a=a(f),a!=f&&a!=null&&e(c,i,{configurable:!0,writable:!0,value:a})}}function s(i){var a=0;return function(){return a<i.length?{done:!1,value:i[a++]}:{done:!0}}}function u(i){var a=typeof Symbol<"u"&&Symbol.iterator&&i[Symbol.iterator];return a?a.call(i):{next:s(i)}}o("Promise",function(i){function a(_){this.b=0,this.c=void 0,this.a=[];var I=this.f();try{_(I.resolve,I.reject)}catch(R){I.reject(R)}}function c(){this.a=null}function f(_){return _ instanceof a?_:new a(function(I){I(_)})}if(i)return i;c.prototype.b=function(_){if(this.a==null){this.a=[];var I=this;this.c(function(){I.g()})}this.a.push(_)};var v=r.setTimeout;c.prototype.c=function(_){v(_,0)},c.prototype.g=function(){for(;this.a&&this.a.length;){var _=this.a;this.a=[];for(var I=0;I<_.length;++I){var R=_[I];_[I]=null;try{R()}catch(D){this.f(D)}}}this.a=null},c.prototype.f=function(_){this.c(function(){throw _})},a.prototype.f=function(){function _(D){return function(Z){R||(R=!0,D.call(I,Z))}}var I=this,R=!1;return{resolve:_(this.m),reject:_(this.g)}},a.prototype.m=function(_){if(_===this)this.g(new TypeError("A Promise cannot resolve to itself"));else if(_ instanceof a)this.s(_);else{e:switch(typeof _){case"object":var I=_!=null;break e;case"function":I=!0;break e;default:I=!1}I?this.v(_):this.h(_)}},a.prototype.v=function(_){var I=void 0;try{I=_.then}catch(R){this.g(R);return}typeof I=="function"?this.u(I,_):this.h(_)},a.prototype.g=function(_){this.i(2,_)},a.prototype.h=function(_){this.i(1,_)},a.prototype.i=function(_,I){if(this.b!=0)throw Error("Cannot settle("+_+", "+I+"): Promise already settled in state"+this.b);this.b=_,this.c=I,this.l()},a.prototype.l=function(){if(this.a!=null){for(var _=0;_<this.a.length;++_)m.b(this.a[_]);this.a=null}};var m=new c;return a.prototype.s=function(_){var I=this.f();_.Ra(I.resolve,I.reject)},a.prototype.u=function(_,I){var R=this.f();try{_.call(I,R.resolve,R.reject)}catch(D){R.reject(D)}},a.prototype.then=function(_,I){function R(de,Ze){return typeof de=="function"?function(ir){try{D(de(ir))}catch(xp){Z(xp)}}:Ze}var D,Z,we=new a(function(de,Ze){D=de,Z=Ze});return this.Ra(R(_,D),R(I,Z)),we},a.prototype.catch=function(_){return this.then(void 0,_)},a.prototype.Ra=function(_,I){function R(){switch(D.b){case 1:_(D.c);break;case 2:I(D.c);break;default:throw Error("Unexpected state: "+D.b)}}var D=this;this.a==null?m.b(R):this.a.push(R)},a.resolve=f,a.reject=function(_){return new a(function(I,R){R(_)})},a.race=function(_){return new a(function(I,R){for(var D=u(_),Z=D.next();!Z.done;Z=D.next())f(Z.value).Ra(I,R)})},a.all=function(_){var I=u(_),R=I.next();return R.done?f([]):new a(function(D,Z){function we(ir){return function(xp){de[ir]=xp,Ze--,Ze==0&&D(de)}}var de=[],Ze=0;do de.push(void 0),Ze++,f(R.value).Ra(we(de.length-1),Z),R=I.next();while(!R.done)})},a});var l=l||{},h=this||self,d=/^[\w+/_-]+[=]{0,2}$/,p=null;function g(i){return(i=i.querySelector&&i.querySelector("script[nonce]"))&&(i=i.nonce||i.getAttribute("nonce"))&&d.test(i)?i:""}function y(){}function w(i){var a=typeof i;return a!="object"?a:i?Array.isArray(i)?"array":a:"null"}function b(i){var a=w(i);return a=="array"||a=="object"&&typeof i.length=="number"}function E(i){return w(i)=="function"}function T(i){var a=typeof i;return a=="object"&&i!=null||a=="function"}function k(i){return Object.prototype.hasOwnProperty.call(i,O)&&i[O]||(i[O]=++M)}var O="closure_uid_"+(1e9*Math.random()>>>0),M=0;function H(i,a,c){return i.call.apply(i.bind,arguments)}function X(i,a,c){if(!i)throw Error();if(2<arguments.length){var f=Array.prototype.slice.call(arguments,2);return function(){var v=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(v,f),i.apply(a,v)}}return function(){return i.apply(a,arguments)}}function F(i,a,c){return Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?F=H:F=X,F.apply(null,arguments)}function me(i,a){var c=Array.prototype.slice.call(arguments,1);return function(){var f=c.slice();return f.push.apply(f,arguments),i.apply(this,f)}}function $(i,a){function c(){}c.prototype=a.prototype,i.bb=a.prototype,i.prototype=new c,i.prototype.constructor=i}function Fe(i){return i}function S(i,a,c){this.code=Ds+i,this.message=a||Yk[i]||"",this.a=c||null}$(S,Error),S.prototype.w=function(){var i={code:this.code,message:this.message};return this.a&&(i.serverResponse=this.a),i},S.prototype.toJSON=function(){return this.w()};function Rs(i){var a=i&&i.code;return a?new S(a.substring(Ds.length),i.message,i.serverResponse):null}var Ds="auth/",Yk={"admin-restricted-operation":"This operation is restricted to administrators only.","argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-change-needs-verification":"Multi-factor users must always have a verified email.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure to use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-dynamic-link-domain":"The provided dynamic link domain is not configured or authorized for the current project.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-multi-factor-session":"The request does not contain a valid proof of first factor successful sign-in.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-provider-id":"The specified provider ID is invalid.","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","invalid-tenant-id":"The Auth instance's tenant ID is invalid.","multi-factor-info-not-found":"The user does not have a second factor matching the identifier provided.","multi-factor-auth-required":"Proof of ownership of a second factor is required to complete sign-in.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-multi-factor-info":"No second factor identifier is provided.","missing-multi-factor-session":"The request is missing proof of first factor successful sign-in.","missing-or-invalid-nonce":"The request does not contain a valid nonce. This can occur if the SHA-256 hash of the provided raw nonce does not match the hashed nonce in the ID token payload.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","null-user":"A null user object was provided as the argument for an operation which requires a non-null user object.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.","rejected-credential":"The request contains malformed or mismatching credentials.","second-factor-already-in-use":"The second factor is already enrolled on this account.","maximum-second-factor-count-exceeded":"The maximum allowed number of second factors on a user has been exceeded.","tenant-id-mismatch":"The provided tenant ID does not match the Auth instance's tenant ID",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-first-factor":"Enrolling a second factor or signing in with a multi-factor account requires sign-in with a supported first factor.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","unsupported-tenant-operation":"This operation is not supported in a multi-tenant context.","unverified-email":"The operation requires a verified email.","user-cancelled":"The user did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},ef={ld:{Ua:"https://staging-identitytoolkit.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"b"},sd:{Ua:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://securetoken.googleapis.com/v1/token",Xa:"https://identitytoolkit.googleapis.com/v2/",id:"p"},ud:{Ua:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",$a:"https://staging-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://staging-identitytoolkit.sandbox.googleapis.com/v2/",id:"s"},vd:{Ua:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",$a:"https://test-securetoken.sandbox.googleapis.com/v1/token",Xa:"https://test-identitytoolkit.sandbox.googleapis.com/v2/",id:"t"}};function Os(i){for(var a in ef)if(ef[a].id===i)return i=ef[a],{firebaseEndpoint:i.Ua,secureTokenEndpoint:i.$a,identityPlatformEndpoint:i.Xa};return null}var Ps;Ps=Os("__EID__")?"__EID__":void 0;function gy(i){if(!i)return!1;try{return!!i.$goog_Thenable}catch{return!1}}function Ht(i){if(Error.captureStackTrace)Error.captureStackTrace(this,Ht);else{var a=Error().stack;a&&(this.stack=a)}i&&(this.message=String(i))}$(Ht,Error),Ht.prototype.name="CustomError";function tf(i,a){i=i.split("%s");for(var c="",f=i.length-1,v=0;v<f;v++)c+=i[v]+(v<a.length?a[v]:"%s");Ht.call(this,c+i[f])}$(tf,Ht),tf.prototype.name="AssertionError";function ao(i,a){throw new tf("Failure"+(i?": "+i:""),Array.prototype.slice.call(arguments,1))}function nf(i,a){this.c=i,this.f=a,this.b=0,this.a=null}nf.prototype.get=function(){if(0<this.b){this.b--;var i=this.a;this.a=i.next,i.next=null}else i=this.c();return i};function my(i,a){i.f(a),100>i.b&&(i.b++,a.next=i.a,i.a=a)}function yy(){this.b=this.a=null}var _y=new nf(function(){return new rf},function(i){i.reset()});yy.prototype.add=function(i,a){var c=_y.get();c.set(i,a),this.b?this.b.next=c:this.a=c,this.b=c};function Xk(){var i=Ky,a=null;return i.a&&(a=i.a,i.a=i.a.next,i.a||(i.b=null),a.next=null),a}function rf(){this.next=this.b=this.a=null}rf.prototype.set=function(i,a){this.a=i,this.b=a,this.next=null},rf.prototype.reset=function(){this.next=this.b=this.a=null};var wy=Array.prototype.indexOf?function(i,a){return Array.prototype.indexOf.call(i,a,void 0)}:function(i,a){if(typeof i=="string")return typeof a!="string"||a.length!=1?-1:i.indexOf(a,0);for(var c=0;c<i.length;c++)if(c in i&&i[c]===a)return c;return-1},De=Array.prototype.forEach?function(i,a,c){Array.prototype.forEach.call(i,a,c)}:function(i,a,c){for(var f=i.length,v=typeof i=="string"?i.split(""):i,m=0;m<f;m++)m in v&&a.call(c,v[m],m,i)};function Jk(i,a){for(var c=typeof i=="string"?i.split(""):i,f=i.length-1;0<=f;--f)f in c&&a.call(void 0,c[f],f,i)}var Zk=Array.prototype.filter?function(i,a){return Array.prototype.filter.call(i,a,void 0)}:function(i,a){for(var c=i.length,f=[],v=0,m=typeof i=="string"?i.split(""):i,_=0;_<c;_++)if(_ in m){var I=m[_];a.call(void 0,I,_,i)&&(f[v++]=I)}return f},Lu=Array.prototype.map?function(i,a){return Array.prototype.map.call(i,a,void 0)}:function(i,a){for(var c=i.length,f=Array(c),v=typeof i=="string"?i.split(""):i,m=0;m<c;m++)m in v&&(f[m]=a.call(void 0,v[m],m,i));return f},eN=Array.prototype.some?function(i,a){return Array.prototype.some.call(i,a,void 0)}:function(i,a){for(var c=i.length,f=typeof i=="string"?i.split(""):i,v=0;v<c;v++)if(v in f&&a.call(void 0,f[v],v,i))return!0;return!1};function tN(i){e:{for(var a=xR,c=i.length,f=typeof i=="string"?i.split(""):i,v=0;v<c;v++)if(v in f&&a.call(void 0,f[v],v,i)){a=v;break e}a=-1}return 0>a?null:typeof i=="string"?i.charAt(a):i[a]}function Zn(i,a){return 0<=wy(i,a)}function Mu(i,a){a=wy(i,a);var c;return(c=0<=a)&&Array.prototype.splice.call(i,a,1),c}function gn(i,a){var c=0;Jk(i,function(f,v){a.call(void 0,f,v,i)&&Array.prototype.splice.call(i,v,1).length==1&&c++})}function of(i){return Array.prototype.concat.apply([],arguments)}function ei(i){var a=i.length;if(0<a){for(var c=Array(a),f=0;f<a;f++)c[f]=i[f];return c}return[]}var by=String.prototype.trim?function(i){return i.trim()}:function(i){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(i)[1]},nN=/&/g,rN=/</g,iN=/>/g,oN=/"/g,sN=/'/g,aN=/\x00/g,uN=/[\x00&<>"']/;function Ee(i,a){return i.indexOf(a)!=-1}function sf(i,a){return i<a?-1:i>a?1:0}var uo;e:{var Iy=h.navigator;if(Iy){var Ey=Iy.userAgent;if(Ey){uo=Ey;break e}}uo=""}function ze(i){return Ee(uo,i)}function Ty(i,a){for(var c in i)a.call(void 0,i[c],c,i)}function ti(i){for(var a in i)return!1;return!0}function yr(i){var a={},c;for(c in i)a[c]=i[c];return a}var Sy="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function Pt(i,a){for(var c,f,v=1;v<arguments.length;v++){f=arguments[v];for(c in f)i[c]=f[c];for(var m=0;m<Sy.length;m++)c=Sy[m],Object.prototype.hasOwnProperty.call(f,c)&&(i[c]=f[c])}}function Cy(i,a){e:{try{var c=i&&i.ownerDocument,f=c&&(c.defaultView||c.parentWindow);if(f=f||h,f.Element&&f.Location){var v=f;break e}}catch{}v=null}if(v&&typeof v[a]<"u"&&(!i||!(i instanceof v[a])&&(i instanceof v.Location||i instanceof v.Element))){if(T(i))try{var m=i.constructor.displayName||i.constructor.name||Object.prototype.toString.call(i)}catch{m="<object could not be stringified>"}else m=i===void 0?"undefined":i===null?"null":typeof i;ao("Argument is not a %s (or a non-Element, non-Location mock); got: %s",a,m)}}function Pn(i,a){this.a=i===Fu&&a||"",this.b=Ay}Pn.prototype.ta=!0,Pn.prototype.sa=function(){return this.a},Pn.prototype.toString=function(){return"Const{"+this.a+"}"};function af(i){return i instanceof Pn&&i.constructor===Pn&&i.b===Ay?i.a:(ao("expected object of type Const, got '"+i+"'"),"type_error:Const")}var Ay={},Fu={},Uu;function ky(){if(Uu===void 0){var i=null,a=h.trustedTypes;if(a&&a.createPolicy){try{i=a.createPolicy("goog#html",{createHTML:Fe,createScript:Fe,createScriptURL:Fe})}catch(c){h.console&&h.console.error(c.message)}Uu=i}else Uu=i}return Uu}function co(i,a){this.a=a===Ry?i:""}co.prototype.ta=!0,co.prototype.sa=function(){return this.a.toString()},co.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};function Ny(i){return i instanceof co&&i.constructor===co?i.a:(ao("expected object of type TrustedResourceUrl, got '"+i+"' of type "+w(i)),"type_error:TrustedResourceUrl")}function uf(i,a){var c=af(i);if(!lN.test(c))throw Error("Invalid TrustedResourceUrl format: "+c);return i=c.replace(cN,function(f,v){if(!Object.prototype.hasOwnProperty.call(a,v))throw Error('Found marker, "'+v+'", in format string, "'+c+'", but no valid label mapping found in args: '+JSON.stringify(a));return f=a[v],f instanceof Pn?af(f):encodeURIComponent(String(f))}),hN(i)}var cN=/%{(\w+)}/g,lN=/^((https:)?\/\/[0-9a-z.:[\]-]+\/|\/[^/\\]|[^:/\\%]+\/|[^:/\\%]*[?#]|about:blank#)/i,Ry={};function hN(i){var a=ky();return i=a?a.createScriptURL(i):i,new co(i,Ry)}function xt(i,a){this.a=a===xs?i:""}xt.prototype.ta=!0,xt.prototype.sa=function(){return this.a.toString()},xt.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};function Vu(i){return i instanceof xt&&i.constructor===xt?i.a:(ao("expected object of type SafeUrl, got '"+i+"' of type "+w(i)),"type_error:SafeUrl")}var fN=/^(?:audio\/(?:3gpp2|3gpp|aac|L16|midi|mp3|mp4|mpeg|oga|ogg|opus|x-m4a|x-matroska|x-wav|wav|webm)|font\/\w+|image\/(?:bmp|gif|jpeg|jpg|png|tiff|webp|x-icon)|text\/csv|video\/(?:mpeg|mp4|ogg|webm|quicktime|x-matroska))(?:;\w+=(?:\w+|"[\w;,= ]+"))*$/i,dN=/^data:(.*);base64,[a-z0-9+\/]+=*$/i,Dy=/^(?:(?:https?|mailto|ftp):|[^:/?#]*(?:[/?#]|$))/i;function Oy(i){if(i instanceof xt)return i;if(i=typeof i=="object"&&i.ta?i.sa():String(i),Dy.test(i))i=new xt(i,xs);else{i=String(i),i=i.replace(/(%0A|%0D)/g,"");var a=i.match(dN);i=a&&fN.test(a[1])?new xt(i,xs):null}return i}function Py(i){return i instanceof xt?i:(i=typeof i=="object"&&i.ta?i.sa():String(i),Dy.test(i)||(i="about:invalid#zClosurez"),new xt(i,xs))}var xs={},xy=new xt("about:invalid#zClosurez",xs);function lo(i,a,c){this.a=c===Ly?i:""}lo.prototype.ta=!0,lo.prototype.sa=function(){return this.a.toString()},lo.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};function pN(i){return i instanceof lo&&i.constructor===lo?i.a:(ao("expected object of type SafeHtml, got '"+i+"' of type "+w(i)),"type_error:SafeHtml")}var Ly={};function vN(i,a){Cy(i,"HTMLScriptElement"),i.src=Ny(a),(a=i.ownerDocument&&i.ownerDocument.defaultView)&&a!=h?a=g(a.document):(p===null&&(p=g(h.document)),a=p),a&&i.setAttribute("nonce",a)}function My(i,a,c,f){return i=i instanceof xt?i:Py(i),a=a||h,c=c instanceof Pn?af(c):c||"",a.open(Vu(i),c,f,void 0)}function Fy(i,a){for(var c=i.split("%s"),f="",v=Array.prototype.slice.call(arguments,1);v.length&&1<c.length;)f+=c.shift()+v.shift();return f+c.join("%s")}function cf(i){return uN.test(i)&&(i.indexOf("&")!=-1&&(i=i.replace(nN,"&amp;")),i.indexOf("<")!=-1&&(i=i.replace(rN,"&lt;")),i.indexOf(">")!=-1&&(i=i.replace(iN,"&gt;")),i.indexOf('"')!=-1&&(i=i.replace(oN,"&quot;")),i.indexOf("'")!=-1&&(i=i.replace(sN,"&#39;")),i.indexOf("\0")!=-1&&(i=i.replace(aN,"&#0;"))),i}function lf(i){return lf[" "](i),i}lf[" "]=y;function gN(i,a){var c=wN;return Object.prototype.hasOwnProperty.call(c,i)?c[i]:c[i]=a(i)}var mN=ze("Opera"),mn=ze("Trident")||ze("MSIE"),Uy=ze("Edge"),yN=Uy||mn,Vy=ze("Gecko")&&!(Ee(uo.toLowerCase(),"webkit")&&!ze("Edge"))&&!(ze("Trident")||ze("MSIE"))&&!ze("Edge"),_N=Ee(uo.toLowerCase(),"webkit")&&!ze("Edge");function jy(){var i=h.document;return i?i.documentMode:void 0}var ju;e:{var hf="",ff=function(){var i=uo;if(Vy)return/rv:([^\);]+)(\)|;)/.exec(i);if(Uy)return/Edge\/([\d\.]+)/.exec(i);if(mn)return/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(i);if(_N)return/WebKit\/(\S+)/.exec(i);if(mN)return/(?:Version)[ \/]?(\S+)/.exec(i)}();if(ff&&(hf=ff?ff[1]:""),mn){var df=jy();if(df!=null&&df>parseFloat(hf)){ju=String(df);break e}}ju=hf}var wN={};function By(i){return gN(i,function(){for(var a=0,c=by(String(ju)).split("."),f=by(String(i)).split("."),v=Math.max(c.length,f.length),m=0;a==0&&m<v;m++){var _=c[m]||"",I=f[m]||"";do{if(_=/(\d*)(\D*)(.*)/.exec(_)||["","","",""],I=/(\d*)(\D*)(.*)/.exec(I)||["","","",""],_[0].length==0&&I[0].length==0)break;a=sf(_[1].length==0?0:parseInt(_[1],10),I[1].length==0?0:parseInt(I[1],10))||sf(_[2].length==0,I[2].length==0)||sf(_[2],I[2]),_=_[3],I=I[3]}while(a==0)}return 0<=a})}var pf;if(h.document&&mn){var qy=jy();pf=qy||parseInt(ju,10)||void 0}else pf=void 0;var _r=pf;try{new self.OffscreenCanvas(0,0).getContext("2d")}catch{}var bN=!mn||9<=Number(_r);function Ls(i){var a=document;return typeof i=="string"?a.getElementById(i):i}function Gy(i,a){Ty(a,function(c,f){c&&typeof c=="object"&&c.ta&&(c=c.sa()),f=="style"?i.style.cssText=c:f=="class"?i.className=c:f=="for"?i.htmlFor=c:Wy.hasOwnProperty(f)?i.setAttribute(Wy[f],c):f.lastIndexOf("aria-",0)==0||f.lastIndexOf("data-",0)==0?i.setAttribute(f,c):i[f]=c})}var Wy={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"};function IN(i,a,c){var f=arguments,v=document,m=String(f[0]),_=f[1];if(!bN&&_&&(_.name||_.type)){if(m=["<",m],_.name&&m.push(' name="',cf(_.name),'"'),_.type){m.push(' type="',cf(_.type),'"');var I={};Pt(I,_),delete I.type,_=I}m.push(">"),m=m.join("")}return m=Bu(v,m),_&&(typeof _=="string"?m.className=_:Array.isArray(_)?m.className=_.join(" "):Gy(m,_)),2<f.length&&EN(v,m,f),m}function EN(i,a,c){function f(I){I&&a.appendChild(typeof I=="string"?i.createTextNode(I):I)}for(var v=2;v<c.length;v++){var m=c[v];if(!b(m)||T(m)&&0<m.nodeType)f(m);else{e:{if(m&&typeof m.length=="number"){if(T(m)){var _=typeof m.item=="function"||typeof m.item=="string";break e}if(E(m)){_=typeof m.item=="function";break e}}_=!1}De(_?ei(m):m,f)}}}function Bu(i,a){return a=String(a),i.contentType==="application/xhtml+xml"&&(a=a.toLowerCase()),i.createElement(a)}function Hy(i){h.setTimeout(function(){throw i},0)}var vf;function TN(){var i=h.MessageChannel;if(typeof i>"u"&&typeof window<"u"&&window.postMessage&&window.addEventListener&&!ze("Presto")&&(i=function(){var v=Bu(document,"IFRAME");v.style.display="none",document.documentElement.appendChild(v);var m=v.contentWindow;v=m.document,v.open(),v.close();var _="callImmediate"+Math.random(),I=m.location.protocol=="file:"?"*":m.location.protocol+"//"+m.location.host;v=F(function(R){(I=="*"||R.origin==I)&&R.data==_&&this.port1.onmessage()},this),m.addEventListener("message",v,!1),this.port1={},this.port2={postMessage:function(){m.postMessage(_,I)}}}),typeof i<"u"&&!ze("Trident")&&!ze("MSIE")){var a=new i,c={},f=c;return a.port1.onmessage=function(){if(c.next!==void 0){c=c.next;var v=c.Hb;c.Hb=null,v()}},function(v){f.next={Hb:v},f=f.next,a.port2.postMessage(0)}}return function(v){h.setTimeout(v,0)}}function qu(i,a){Gu||SN(),gf||(Gu(),gf=!0),Ky.add(i,a)}var Gu;function SN(){if(h.Promise&&h.Promise.resolve){var i=h.Promise.resolve(void 0);Gu=function(){i.then(zy)}}else Gu=function(){var a=zy;!E(h.setImmediate)||h.Window&&h.Window.prototype&&!ze("Edge")&&h.Window.prototype.setImmediate==h.setImmediate?(vf||(vf=TN()),vf(a)):h.setImmediate(a)}}var gf=!1,Ky=new yy;function zy(){for(var i;i=Xk();){try{i.a.call(i.b)}catch(a){Hy(a)}my(_y,i)}gf=!1}function ae(i,a){if(this.a=ni,this.i=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,i!=y)try{var c=this;i.call(a,function(f){ri(c,Ms,f)},function(f){if(!(f instanceof ho))try{throw f instanceof Error?f:Error("Promise rejected.")}catch{}ri(c,er,f)})}catch(f){ri(this,er,f)}}var ni=0,Ms=2,er=3;function $y(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}$y.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Qy=new nf(function(){return new $y},function(i){i.reset()});function mf(i,a,c){var f=Qy.get();return f.g=i,f.b=a,f.f=c,f}function z(i){if(i instanceof ae)return i;var a=new ae(y);return ri(a,Ms,i),a}function Ae(i){return new ae(function(a,c){c(i)})}function Yy(i,a,c){e_(i,a,c,null)||qu(me(a,i))}function CN(i){return new ae(function(a,c){var f=i.length,v=[];if(f)for(var m=function(D,Z){f--,v[D]=Z,f==0&&a(v)},_=function(D){c(D)},I=0,R;I<i.length;I++)R=i[I],Yy(R,me(m,I),_);else a(v)})}function Xy(i){return new ae(function(a){var c=i.length,f=[];if(c)for(var v=function(I,R,D){c--,f[I]=R?{Qb:!0,value:D}:{Qb:!1,reason:D},c==0&&a(f)},m=0,_;m<i.length;m++)_=i[m],Yy(_,me(v,m,!0),me(v,m,!1));else a(f)})}ae.prototype.then=function(i,a,c){return Zy(this,E(i)?i:null,E(a)?a:null,c)},ae.prototype.$goog_Thenable=!0,t=ae.prototype,t.oa=function(i,a){return i=mf(i,i,a),i.c=!0,yf(this,i),this},t.o=function(i,a){return Zy(this,null,i,a)},t.cancel=function(i){if(this.a==ni){var a=new ho(i);qu(function(){Jy(this,a)},this)}};function Jy(i,a){if(i.a==ni)if(i.c){var c=i.c;if(c.b){for(var f=0,v=null,m=null,_=c.b;_&&(_.c||(f++,_.a==i&&(v=_),!(v&&1<f)));_=_.next)v||(m=_);v&&(c.a==ni&&f==1?Jy(c,a):(m?(f=m,f.next==c.f&&(c.f=f),f.next=f.next.next):n_(c),r_(c,v,er,a)))}i.c=null}else ri(i,er,a)}function yf(i,a){i.b||i.a!=Ms&&i.a!=er||t_(i),i.f?i.f.next=a:i.b=a,i.f=a}function Zy(i,a,c,f){var v=mf(null,null,null);return v.a=new ae(function(m,_){v.g=a?function(I){try{var R=a.call(f,I);m(R)}catch(D){_(D)}}:m,v.b=c?function(I){try{var R=c.call(f,I);R===void 0&&I instanceof ho?_(I):m(R)}catch(D){_(D)}}:_}),v.a.c=i,yf(i,v),v.a}t.$c=function(i){this.a=ni,ri(this,Ms,i)},t.ad=function(i){this.a=ni,ri(this,er,i)};function ri(i,a,c){i.a==ni&&(i===c&&(a=er,c=new TypeError("Promise cannot resolve to itself")),i.a=1,e_(c,i.$c,i.ad,i)||(i.i=c,i.a=a,i.c=null,t_(i),a!=er||c instanceof ho||kN(i,c)))}function e_(i,a,c,f){if(i instanceof ae)return yf(i,mf(a||y,c||null,f)),!0;if(gy(i))return i.then(a,c,f),!0;if(T(i))try{var v=i.then;if(E(v))return AN(i,v,a,c,f),!0}catch(m){return c.call(f,m),!0}return!1}function AN(i,a,c,f,v){function m(R){I||(I=!0,f.call(v,R))}function _(R){I||(I=!0,c.call(v,R))}var I=!1;try{a.call(i,_,m)}catch(R){m(R)}}function t_(i){i.h||(i.h=!0,qu(i.gc,i))}function n_(i){var a=null;return i.b&&(a=i.b,i.b=a.next,a.next=null),i.b||(i.f=null),a}t.gc=function(){for(var i;i=n_(this);)r_(this,i,this.a,this.i);this.h=!1};function r_(i,a,c,f){if(c==er&&a.b&&!a.c)for(;i&&i.g;i=i.c)i.g=!1;if(a.a)a.a.c=null,i_(a,c,f);else try{a.c?a.g.call(a.f):i_(a,c,f)}catch(v){o_.call(null,v)}my(Qy,a)}function i_(i,a,c){a==Ms?i.g.call(i.f,c):i.b&&i.b.call(i.f,c)}function kN(i,a){i.g=!0,qu(function(){i.g&&o_.call(null,a)})}var o_=Hy;function ho(i){Ht.call(this,i)}$(ho,Ht),ho.prototype.name="cancel";function Wu(){this.ya=this.ya,this.pa=this.pa}var NN=0;Wu.prototype.ya=!1;function s_(i){!i.ya&&(i.ya=!0,i.Da(),NN!=0)&&k(i)}Wu.prototype.Da=function(){if(this.pa)for(;this.pa.length;)this.pa.shift()()};var RN=Object.freeze||function(i){return i},a_=!mn||9<=Number(_r),DN=mn&&!By("9"),ON=function(){if(!h.addEventListener||!Object.defineProperty)return!1;var i=!1,a=Object.defineProperty({},"passive",{get:function(){i=!0}});try{h.addEventListener("test",y,a),h.removeEventListener("test",y,a)}catch{}return i}();function Lt(i,a){this.type=i,this.b=this.target=a,this.defaultPrevented=!1}Lt.prototype.preventDefault=function(){this.defaultPrevented=!0};function ii(i,a){if(Lt.call(this,i?i.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,i){var c=this.type=i.type,f=i.changedTouches&&i.changedTouches.length?i.changedTouches[0]:null;if(this.target=i.target||i.srcElement,this.b=a,a=i.relatedTarget){if(Vy){e:{try{lf(a.nodeName);var v=!0;break e}catch{}v=!1}v||(a=null)}}else c=="mouseover"?a=i.fromElement:c=="mouseout"&&(a=i.toElement);this.relatedTarget=a,f?(this.clientX=f.clientX!==void 0?f.clientX:f.pageX,this.clientY=f.clientY!==void 0?f.clientY:f.pageY,this.screenX=f.screenX||0,this.screenY=f.screenY||0):(this.clientX=i.clientX!==void 0?i.clientX:i.pageX,this.clientY=i.clientY!==void 0?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0),this.button=i.button,this.key=i.key||"",this.ctrlKey=i.ctrlKey,this.altKey=i.altKey,this.shiftKey=i.shiftKey,this.metaKey=i.metaKey,this.pointerId=i.pointerId||0,this.pointerType=typeof i.pointerType=="string"?i.pointerType:PN[i.pointerType]||"",this.a=i,i.defaultPrevented&&this.preventDefault()}}$(ii,Lt);var PN=RN({2:"touch",3:"pen",4:"mouse"});ii.prototype.preventDefault=function(){ii.bb.preventDefault.call(this);var i=this.a;if(i.preventDefault)i.preventDefault();else if(i.returnValue=!1,DN)try{(i.ctrlKey||112<=i.keyCode&&123>=i.keyCode)&&(i.keyCode=-1)}catch{}},ii.prototype.g=function(){return this.a};var Fs="closure_listenable_"+(1e6*Math.random()|0),xN=0;function LN(i,a,c,f,v){this.listener=i,this.proxy=null,this.src=a,this.type=c,this.capture=!!f,this.Wa=v,this.key=++xN,this.wa=this.Qa=!1}function Hu(i){i.wa=!0,i.listener=null,i.proxy=null,i.src=null,i.Wa=null}function Ku(i){this.src=i,this.a={},this.b=0}Ku.prototype.add=function(i,a,c,f,v){var m=i.toString();i=this.a[m],i||(i=this.a[m]=[],this.b++);var _=wf(i,a,f,v);return-1<_?(a=i[_],c||(a.Qa=!1)):(a=new LN(a,this.src,m,!!f,v),a.Qa=c,i.push(a)),a};function _f(i,a){var c=a.type;c in i.a&&Mu(i.a[c],a)&&(Hu(a),i.a[c].length==0&&(delete i.a[c],i.b--))}function wf(i,a,c,f){for(var v=0;v<i.length;++v){var m=i[v];if(!m.wa&&m.listener==a&&m.capture==!!c&&m.Wa==f)return v}return-1}var bf="closure_lm_"+(1e6*Math.random()|0),If={};function on(i,a,c,f,v){if(f&&f.once)Ef(i,a,c,f,v);else if(Array.isArray(a))for(var m=0;m<a.length;m++)on(i,a[m],c,f,v);else c=Sf(c),i&&i[Fs]?d_(i,a,c,T(f)?!!f.capture:!!f,v):u_(i,a,c,!1,f,v)}function u_(i,a,c,f,v,m){if(!a)throw Error("Invalid event type");var _=T(v)?!!v.capture:!!v,I=zu(i);if(I||(i[bf]=I=new Ku(i)),c=I.add(a,c,f,_,m),!c.proxy)if(f=MN(),c.proxy=f,f.src=i,f.listener=c,i.addEventListener)ON||(v=_),v===void 0&&(v=!1),i.addEventListener(a.toString(),f,v);else if(i.attachEvent)i.attachEvent(l_(a.toString()),f);else if(i.addListener&&i.removeListener)i.addListener(f);else throw Error("addEventListener and attachEvent are unavailable.")}function MN(){var i=FN,a=a_?function(c){return i.call(a.src,a.listener,c)}:function(c){if(c=i.call(a.src,a.listener,c),!c)return c};return a}function Ef(i,a,c,f,v){if(Array.isArray(a))for(var m=0;m<a.length;m++)Ef(i,a[m],c,f,v);else c=Sf(c),i&&i[Fs]?Cf(i,a,c,T(f)?!!f.capture:!!f,v):u_(i,a,c,!0,f,v)}function Kt(i,a,c,f,v){if(Array.isArray(a))for(var m=0;m<a.length;m++)Kt(i,a[m],c,f,v);else f=T(f)?!!f.capture:!!f,c=Sf(c),i&&i[Fs]?(i=i.v,a=String(a).toString(),a in i.a&&(m=i.a[a],c=wf(m,c,f,v),-1<c&&(Hu(m[c]),Array.prototype.splice.call(m,c,1),m.length==0&&(delete i.a[a],i.b--)))):i&&(i=zu(i))&&(a=i.a[a.toString()],i=-1,a&&(i=wf(a,c,f,v)),(c=-1<i?a[i]:null)&&c_(c))}function c_(i){if(typeof i!="number"&&i&&!i.wa){var a=i.src;if(a&&a[Fs])_f(a.v,i);else{var c=i.type,f=i.proxy;a.removeEventListener?a.removeEventListener(c,f,i.capture):a.detachEvent?a.detachEvent(l_(c),f):a.addListener&&a.removeListener&&a.removeListener(f),(c=zu(a))?(_f(c,i),c.b==0&&(c.src=null,a[bf]=null)):Hu(i)}}}function l_(i){return i in If?If[i]:If[i]="on"+i}function h_(i,a,c,f){var v=!0;if((i=zu(i))&&(a=i.a[a.toString()]))for(a=a.concat(),i=0;i<a.length;i++){var m=a[i];m&&m.capture==c&&!m.wa&&(m=f_(m,f),v=v&&m!==!1)}return v}function f_(i,a){var c=i.listener,f=i.Wa||i.src;return i.Qa&&c_(i),c.call(f,a)}function FN(i,a){if(i.wa)return!0;if(!a_){if(!a)e:{a=["window","event"];for(var c=h,f=0;f<a.length;f++)if(c=c[a[f]],c==null){a=null;break e}a=c}if(f=a,a=new ii(f,this),c=!0,!(0>f.keyCode||f.returnValue!=null)){e:{var v=!1;if(f.keyCode==0)try{f.keyCode=-1;break e}catch{v=!0}(v||f.returnValue==null)&&(f.returnValue=!0)}for(f=[],v=a.b;v;v=v.parentNode)f.push(v);for(i=i.type,v=f.length-1;0<=v;v--){a.b=f[v];var m=h_(f[v],i,!0,a);c=c&&m}for(v=0;v<f.length;v++)a.b=f[v],m=h_(f[v],i,!1,a),c=c&&m}return c}return f_(i,new ii(a,this))}function zu(i){return i=i[bf],i instanceof Ku?i:null}var Tf="__closure_events_fn_"+(1e9*Math.random()>>>0);function Sf(i){return E(i)?i:(i[Tf]||(i[Tf]=function(a){return i.handleEvent(a)}),i[Tf])}function It(){Wu.call(this),this.v=new Ku(this),this.bc=this,this.hb=null}$(It,Wu),It.prototype[Fs]=!0,It.prototype.addEventListener=function(i,a,c,f){on(this,i,a,c,f)},It.prototype.removeEventListener=function(i,a,c,f){Kt(this,i,a,c,f)},It.prototype.dispatchEvent=function(i){var a,c=this.hb;if(c)for(a=[];c;c=c.hb)a.push(c);c=this.bc;var f=i.type||i;if(typeof i=="string")i=new Lt(i,c);else if(i instanceof Lt)i.target=i.target||c;else{var v=i;i=new Lt(f,c),Pt(i,v)}if(v=!0,a)for(var m=a.length-1;0<=m;m--){var _=i.b=a[m];v=$u(_,f,!0,i)&&v}if(_=i.b=c,v=$u(_,f,!0,i)&&v,v=$u(_,f,!1,i)&&v,a)for(m=0;m<a.length;m++)_=i.b=a[m],v=$u(_,f,!1,i)&&v;return v},It.prototype.Da=function(){if(It.bb.Da.call(this),this.v){var i=this.v,a;for(a in i.a){for(var c=i.a[a],f=0;f<c.length;f++)Hu(c[f]);delete i.a[a],i.b--}}this.hb=null};function d_(i,a,c,f,v){i.v.add(String(a),c,!1,f,v)}function Cf(i,a,c,f,v){i.v.add(String(a),c,!0,f,v)}function $u(i,a,c,f){if(a=i.v.a[String(a)],!a)return!0;a=a.concat();for(var v=!0,m=0;m<a.length;++m){var _=a[m];if(_&&!_.wa&&_.capture==c){var I=_.listener,R=_.Wa||_.src;_.Qa&&_f(i.v,_),v=I.call(R,f)!==!1&&v}}return v&&!f.defaultPrevented}function Af(i,a,c){if(E(i))c&&(i=F(i,c));else if(i&&typeof i.handleEvent=="function")i=F(i.handleEvent,i);else throw Error("Invalid listener argument");return 2147483647<Number(a)?-1:h.setTimeout(i,a||0)}function fo(i){var a=null;return new ae(function(c,f){a=Af(function(){c(void 0)},i),a==-1&&f(Error("Failed to schedule timer."))}).o(function(c){throw h.clearTimeout(a),c})}function p_(i){if(i.X&&typeof i.X=="function")return i.X();if(typeof i=="string")return i.split("");if(b(i)){for(var a=[],c=i.length,f=0;f<c;f++)a.push(i[f]);return a}a=[],c=0;for(f in i)a[c++]=i[f];return a}function v_(i){if(i.Y&&typeof i.Y=="function")return i.Y();if(!i.X||typeof i.X!="function"){if(b(i)||typeof i=="string"){var a=[];i=i.length;for(var c=0;c<i;c++)a.push(c);return a}a=[],c=0;for(var f in i)a[c++]=f;return a}}function UN(i,a){if(i.forEach&&typeof i.forEach=="function")i.forEach(a,void 0);else if(b(i)||typeof i=="string")De(i,a,void 0);else for(var c=v_(i),f=p_(i),v=f.length,m=0;m<v;m++)a.call(void 0,f[m],c&&c[m],i)}function po(i,a){this.b={},this.a=[],this.c=0;var c=arguments.length;if(1<c){if(c%2)throw Error("Uneven number of arguments");for(var f=0;f<c;f+=2)this.set(arguments[f],arguments[f+1])}else if(i)if(i instanceof po)for(c=i.Y(),f=0;f<c.length;f++)this.set(c[f],i.get(c[f]));else for(f in i)this.set(f,i[f])}t=po.prototype,t.X=function(){kf(this);for(var i=[],a=0;a<this.a.length;a++)i.push(this.b[this.a[a]]);return i},t.Y=function(){return kf(this),this.a.concat()},t.clear=function(){this.b={},this.c=this.a.length=0};function kf(i){if(i.c!=i.a.length){for(var a=0,c=0;a<i.a.length;){var f=i.a[a];oi(i.b,f)&&(i.a[c++]=f),a++}i.a.length=c}if(i.c!=i.a.length){var v={};for(c=a=0;a<i.a.length;)f=i.a[a],oi(v,f)||(i.a[c++]=f,v[f]=1),a++;i.a.length=c}}t.get=function(i,a){return oi(this.b,i)?this.b[i]:a},t.set=function(i,a){oi(this.b,i)||(this.c++,this.a.push(i)),this.b[i]=a},t.forEach=function(i,a){for(var c=this.Y(),f=0;f<c.length;f++){var v=c[f],m=this.get(v);i.call(a,m,v,this)}};function oi(i,a){return Object.prototype.hasOwnProperty.call(i,a)}var g_=/^(?:([^:/?#.]+):)?(?:\/\/(?:([^\\/?#]*)@)?([^\\/?#]*?)(?::([0-9]+))?(?=[\\/?#]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;function VN(i,a){if(i){i=i.split("&");for(var c=0;c<i.length;c++){var f=i[c].indexOf("="),v=null;if(0<=f){var m=i[c].substring(0,f);v=i[c].substring(f+1)}else m=i[c];a(m,v?decodeURIComponent(v.replace(/\+/g," ")):"")}}}function wr(i,a){this.a=this.l=this.c="",this.g=null,this.h=this.f="",this.i=!1;var c;i instanceof wr?(this.i=a!==void 0?a:i.i,Us(this,i.c),this.l=i.l,this.a=i.a,Vs(this,i.g),this.f=i.f,Nf(this,w_(i.b)),this.h=i.h):i&&(c=String(i).match(g_))?(this.i=!!a,Us(this,c[1]||"",!0),this.l=js(c[2]||""),this.a=js(c[3]||"",!0),Vs(this,c[4]),this.f=js(c[5]||"",!0),Nf(this,c[6]||"",!0),this.h=js(c[7]||"")):(this.i=!!a,this.b=new si(null,this.i))}wr.prototype.toString=function(){var i=[],a=this.c;a&&i.push(Bs(a,m_,!0),":");var c=this.a;return(c||a=="file")&&(i.push("//"),(a=this.l)&&i.push(Bs(a,m_,!0),"@"),i.push(encodeURIComponent(String(c)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),c=this.g,c!=null&&i.push(":",String(c))),(c=this.f)&&(this.a&&c.charAt(0)!="/"&&i.push("/"),i.push(Bs(c,c.charAt(0)=="/"?qN:BN,!0))),(c=this.b.toString())&&i.push("?",c),(c=this.h)&&i.push("#",Bs(c,WN)),i.join("")},wr.prototype.resolve=function(i){var a=new wr(this),c=!!i.c;c?Us(a,i.c):c=!!i.l,c?a.l=i.l:c=!!i.a,c?a.a=i.a:c=i.g!=null;var f=i.f;if(c)Vs(a,i.g);else if(c=!!i.f){if(f.charAt(0)!="/")if(this.a&&!this.f)f="/"+f;else{var v=a.f.lastIndexOf("/");v!=-1&&(f=a.f.substr(0,v+1)+f)}if(v=f,v==".."||v==".")f="";else if(Ee(v,"./")||Ee(v,"/.")){f=v.lastIndexOf("/",0)==0,v=v.split("/");for(var m=[],_=0;_<v.length;){var I=v[_++];I=="."?f&&_==v.length&&m.push(""):I==".."?((1<m.length||m.length==1&&m[0]!="")&&m.pop(),f&&_==v.length&&m.push("")):(m.push(I),f=!0)}f=m.join("/")}else f=v}return c?a.f=f:c=i.b.toString()!=="",c?Nf(a,w_(i.b)):c=!!i.h,c&&(a.h=i.h),a};function Us(i,a,c){i.c=c?js(a,!0):a,i.c&&(i.c=i.c.replace(/:$/,""))}function Vs(i,a){if(a){if(a=Number(a),isNaN(a)||0>a)throw Error("Bad port number "+a);i.g=a}else i.g=null}function Nf(i,a,c){a instanceof si?(i.b=a,HN(i.b,i.i)):(c||(a=Bs(a,GN)),i.b=new si(a,i.i))}function Ue(i,a,c){i.b.set(a,c)}function sn(i,a){return i.b.get(a)}function Mt(i){return i instanceof wr?new wr(i):new wr(i,void 0)}function Qu(i,a,c,f){var v=new wr(null,void 0);return i&&Us(v,i),a&&(v.a=a),c&&Vs(v,c),f&&(v.f=f),v}function js(i,a){return i?a?decodeURI(i.replace(/%25/g,"%2525")):decodeURIComponent(i):""}function Bs(i,a,c){return typeof i=="string"?(i=encodeURI(i).replace(a,jN),c&&(i=i.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),i):null}function jN(i){return i=i.charCodeAt(0),"%"+(i>>4&15).toString(16)+(i&15).toString(16)}var m_=/[#\/\?@]/g,BN=/[#\?:]/g,qN=/[#\?]/g,GN=/[#\?@]/g,WN=/#/g;function si(i,a){this.b=this.a=null,this.c=i||null,this.f=!!a}function br(i){i.a||(i.a=new po,i.b=0,i.c&&VN(i.c,function(a,c){i.add(decodeURIComponent(a.replace(/\+/g," ")),c)}))}function y_(i){var a=v_(i);if(typeof a>"u")throw Error("Keys are undefined");var c=new si(null,void 0);i=p_(i);for(var f=0;f<a.length;f++){var v=a[f],m=i[f];Array.isArray(m)?__(c,v,m):c.add(v,m)}return c}t=si.prototype,t.add=function(i,a){br(this),this.c=null,i=vo(this,i);var c=this.a.get(i);return c||this.a.set(i,c=[]),c.push(a),this.b+=1,this};function xn(i,a){br(i),a=vo(i,a),oi(i.a.b,a)&&(i.c=null,i.b-=i.a.get(a).length,i=i.a,oi(i.b,a)&&(delete i.b[a],i.c--,i.a.length>2*i.c&&kf(i)))}t.clear=function(){this.a=this.c=null,this.b=0};function Rf(i,a){return br(i),a=vo(i,a),oi(i.a.b,a)}t.forEach=function(i,a){br(this),this.a.forEach(function(c,f){De(c,function(v){i.call(a,v,f,this)},this)},this)},t.Y=function(){br(this);for(var i=this.a.X(),a=this.a.Y(),c=[],f=0;f<a.length;f++)for(var v=i[f],m=0;m<v.length;m++)c.push(a[f]);return c},t.X=function(i){br(this);var a=[];if(typeof i=="string")Rf(this,i)&&(a=of(a,this.a.get(vo(this,i))));else{i=this.a.X();for(var c=0;c<i.length;c++)a=of(a,i[c])}return a},t.set=function(i,a){return br(this),this.c=null,i=vo(this,i),Rf(this,i)&&(this.b-=this.a.get(i).length),this.a.set(i,[a]),this.b+=1,this},t.get=function(i,a){return i?(i=this.X(i),0<i.length?String(i[0]):a):a};function __(i,a,c){xn(i,a),0<c.length&&(i.c=null,i.a.set(vo(i,a),ei(c)),i.b+=c.length)}t.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var i=[],a=this.a.Y(),c=0;c<a.length;c++){var f=a[c],v=encodeURIComponent(String(f));f=this.X(f);for(var m=0;m<f.length;m++){var _=v;f[m]!==""&&(_+="="+encodeURIComponent(String(f[m]))),i.push(_)}}return this.c=i.join("&")};function w_(i){var a=new si;return a.c=i.c,i.a&&(a.a=new po(i.a),a.b=i.b),a}function vo(i,a){return a=String(a),i.f&&(a=a.toLowerCase()),a}function HN(i,a){a&&!i.f&&(br(i),i.c=null,i.a.forEach(function(c,f){var v=f.toLowerCase();f!=v&&(xn(this,f),__(this,v,c))},i)),i.f=a}function b_(i){var a=[];return Df(new KN,i,a),a.join("")}function KN(){}function Df(i,a,c){if(a==null)c.push("null");else{if(typeof a=="object"){if(Array.isArray(a)){var f=a;a=f.length,c.push("[");for(var v="",m=0;m<a;m++)c.push(v),Df(i,f[m],c),v=",";c.push("]");return}if(a instanceof String||a instanceof Number||a instanceof Boolean)a=a.valueOf();else{c.push("{"),v="";for(f in a)Object.prototype.hasOwnProperty.call(a,f)&&(m=a[f],typeof m!="function"&&(c.push(v),E_(f,c),c.push(":"),Df(i,m,c),v=","));c.push("}");return}}switch(typeof a){case"string":E_(a,c);break;case"number":c.push(isFinite(a)&&!isNaN(a)?String(a):"null");break;case"boolean":c.push(String(a));break;case"function":c.push("null");break;default:throw Error("Unknown type: "+typeof a)}}}var I_={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","	":"\\t","\v":"\\u000b"},zN=/\uffff/.test("")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;function E_(i,a){a.push('"',i.replace(zN,function(c){var f=I_[c];return f||(f="\\u"+(c.charCodeAt(0)|65536).toString(16).substr(1),I_[c]=f),f}),'"')}function Of(){var i=it();return mn&&!!_r&&_r==11||/Edge\/\d+/.test(i)}function qs(){return h.window&&h.window.location.href||self&&self.location&&self.location.href||""}function T_(i,a){a=a||h.window;var c="about:blank";i&&(c=Vu(Oy(i)||xy)),a.location.href=c}function S_(i,a){var c=[],f;for(f in i)f in a?typeof i[f]!=typeof a[f]?c.push(f):typeof i[f]=="object"&&i[f]!=null&&a[f]!=null?0<S_(i[f],a[f]).length&&c.push(f):i[f]!==a[f]&&c.push(f):c.push(f);for(f in a)f in i||c.push(f);return c}function $N(){var i=it();return i=go(i)!=N_?null:(i=i.match(/\sChrome\/(\d+)/i))&&i.length==2?parseInt(i[1],10):null,i&&30>i?!1:!mn||!_r||9<_r}function C_(i){return i=(i||it()).toLowerCase(),!!(i.match(/android/)||i.match(/webos/)||i.match(/iphone|ipad|ipod/)||i.match(/blackberry/)||i.match(/windows phone/)||i.match(/iemobile/))}function ai(i){i=i||h.window;try{i.close()}catch{}}function A_(i,a,c){var f=Math.floor(1e9*Math.random()).toString();a=a||500,c=c||600;var v=(window.screen.availHeight-c)/2,m=(window.screen.availWidth-a)/2;a={width:a,height:c,top:0<v?v:0,left:0<m?m:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},c=it().toLowerCase(),f&&(a.target=f,Ee(c,"crios/")&&(a.target="_blank")),go(it())==Lf&&(i=i||"http://localhost",a.scrollbars=!0),c=i||"",(i=a)||(i={}),f=window,a=c instanceof xt?c:Oy(typeof c.href<"u"?c.href:String(c))||xy,c=i.target||c.target,v=[];for(_ in i)switch(_){case"width":case"height":case"top":case"left":v.push(_+"="+i[_]);break;case"target":case"noopener":case"noreferrer":break;default:v.push(_+"="+(i[_]?1:0))}var _=v.join(",");if((ze("iPhone")&&!ze("iPod")&&!ze("iPad")||ze("iPad")||ze("iPod"))&&f.navigator&&f.navigator.standalone&&c&&c!="_self"?(_=Bu(document,"A"),Cy(_,"HTMLAnchorElement"),a=a instanceof xt?a:Py(a),_.href=Vu(a),_.setAttribute("target",c),i.noreferrer&&_.setAttribute("rel","noreferrer"),i=document.createEvent("MouseEvent"),i.initMouseEvent("click",!0,!0,f,1),_.dispatchEvent(i),_={}):i.noreferrer?(_=My("",f,c,_),i=Vu(a),_&&(yN&&Ee(i,";")&&(i="'"+i.replace(/'/g,"%27")+"'"),_.opener=null,i='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+cf(i)+'">',i=(f=ky())?f.createHTML(i):i,i=new lo(i,null,Ly),f=_.document)&&(f.write(pN(i)),f.close())):(_=My(a,f,c,_))&&i.noopener&&(_.opener=null),_)try{_.focus()}catch{}return _}function QN(i){return new ae(function(a){function c(){fo(2e3).then(function(){if(!i||i.closed)a();else return c()})}return c()})}var YN=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,XN=/^[^@]+@[^@]+$/;function Yu(){var i=null;return new ae(function(a){h.document.readyState=="complete"?a():(i=function(){a()},Ef(window,"load",i))}).o(function(a){throw Kt(window,"load",i),a})}function JN(){return Pf(void 0)?Yu().then(function(){return new ae(function(i,a){var c=h.document,f=setTimeout(function(){a(Error("Cordova framework is not ready."))},1e3);c.addEventListener("deviceready",function(){clearTimeout(f),i()},!1)})}):Ae(Error("Cordova must run in an Android or iOS file scheme."))}function Pf(i){return i=i||it(),!(yo()!=="file:"&&yo()!=="ionic:"||!i.toLowerCase().match(/iphone|ipad|ipod|android/))}function xf(){var i=h.window;try{return!(!i||i==i.top)}catch{return!1}}function yn(){return typeof h.WorkerGlobalScope<"u"&&typeof h.importScripts=="function"}function Ln(){return J.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":J.INTERNAL.hasOwnProperty("node")?"Node":yn()?"Worker":"Browser"}function k_(){var i=Ln();return i==="ReactNative"||i==="Node"}function ZN(){for(var i=50,a=[];0<i;)a.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),i--;return a.join("")}var Lf="Firefox",N_="Chrome";function go(i){var a=i.toLowerCase();if(Ee(a,"opera/")||Ee(a,"opr/")||Ee(a,"opios/"))return"Opera";if(Ee(a,"iemobile"))return"IEMobile";if(Ee(a,"msie")||Ee(a,"trident/"))return"IE";if(Ee(a,"edge/"))return"Edge";if(Ee(a,"firefox/"))return Lf;if(Ee(a,"silk/"))return"Silk";if(Ee(a,"blackberry"))return"Blackberry";if(Ee(a,"webos"))return"Webos";if(!Ee(a,"safari/")||Ee(a,"chrome/")||Ee(a,"crios/")||Ee(a,"android"))if(!Ee(a,"chrome/")&&!Ee(a,"crios/")||Ee(a,"edge/")){if(Ee(a,"android"))return"Android";if((i=i.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&i.length==2)return i[1]}else return N_;else return"Safari";return"Other"}var R_={md:"FirebaseCore-web",od:"FirebaseUI-web"};function mo(i,a){a=a||[];var c=[],f={},v;for(v in R_)f[R_[v]]=!0;for(v=0;v<a.length;v++)typeof f[a[v]]<"u"&&(delete f[a[v]],c.push(a[v]));return c.sort(),a=c,a.length||(a=["FirebaseCore-web"]),c=Ln(),c==="Browser"?(f=it(),c=go(f)):c==="Worker"&&(f=it(),c=go(f)+"-"+c),c+"/JsCore/"+i+"/"+a.join(",")}function it(){return h.navigator&&h.navigator.userAgent||""}function ke(i,a){i=i.split("."),a=a||h;for(var c=0;c<i.length&&typeof a=="object"&&a!=null;c++)a=a[i[c]];return c!=i.length&&(a=void 0),a}function Mf(){try{var i=h.localStorage,a=ci();if(i)return i.setItem(a,"1"),i.removeItem(a),Of()?!!h.indexedDB:!0}catch{return yn()&&!!h.indexedDB}return!1}function ui(){return(Xu()||yo()==="chrome-extension:"||Pf())&&!k_()&&Mf()&&!yn()}function Xu(){return yo()==="http:"||yo()==="https:"}function yo(){return h.location&&h.location.protocol||null}function Gs(i){return i=i||it(),!(C_(i)||go(i)==Lf)}function Ws(i){return typeof i>"u"?null:b_(i)}function D_(i){var a={},c;for(c in i)i.hasOwnProperty(c)&&i[c]!==null&&i[c]!==void 0&&(a[c]=i[c]);return a}function _o(i){if(i!==null)return JSON.parse(i)}function ci(i){return i||Math.floor(1e9*Math.random()).toString()}function O_(i){return i=i||it(),!(go(i)=="Safari"||i.toLowerCase().match(/iphone|ipad|ipod/))}function P_(){var i=h.___jsl;if(i&&i.H){for(var a in i.H)if(i.H[a].r=i.H[a].r||[],i.H[a].L=i.H[a].L||[],i.H[a].r=i.H[a].L.concat(),i.CP)for(var c=0;c<i.CP.length;c++)i.CP[c]=null}}function Ir(i,a){if(i>a)throw Error("Short delay should be less than long delay!");this.a=i,this.c=a,i=it(),a=Ln(),this.b=C_(i)||a==="ReactNative"}Ir.prototype.get=function(){var i=h.navigator;return!(i&&typeof i.onLine=="boolean"&&(Xu()||yo()==="chrome-extension:"||typeof i.connection<"u"))||i.onLine?this.b?this.c:this.a:Math.min(5e3,this.a)};function Ff(){var i=h.document;return i&&typeof i.visibilityState<"u"?i.visibilityState=="visible":!0}function eR(){var i=h.document,a=null;return Ff()||!i?z():new ae(function(c){a=function(){Ff()&&(i.removeEventListener("visibilitychange",a,!1),c())},i.addEventListener("visibilitychange",a,!1)}).o(function(c){throw i.removeEventListener("visibilitychange",a,!1),c})}function Hs(i){try{var a=new Date(parseInt(i,10));if(!isNaN(a.getTime())&&!/[^0-9]/.test(i))return a.toUTCString()}catch{}return null}function x_(){return!(!ke("fireauth.oauthhelper",h)&&!ke("fireauth.iframe",h))}function tR(){var i=h.navigator;return i&&i.serviceWorker&&i.serviceWorker.controller||null}function nR(){var i=h.navigator;return i&&i.serviceWorker?z().then(function(){return i.serviceWorker.ready}).then(function(a){return a.active||null}).o(function(){return null}):z(null)}var L_={};function Uf(i){L_[i]||(L_[i]=!0,typeof console<"u"&&typeof console.warn=="function"&&console.warn(i))}var Vf;try{var jf={};Object.defineProperty(jf,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(jf,"abcd",{configurable:!0,enumerable:!0,value:2}),Vf=jf.abcd==2}catch{Vf=!1}function G(i,a,c){Vf?Object.defineProperty(i,a,{configurable:!0,enumerable:!0,value:c}):i[a]=c}function Et(i,a){if(a)for(var c in a)a.hasOwnProperty(c)&&G(i,c,a[c])}function Mn(i){var a={};return Et(a,i),a}function rR(i){var a={},c;for(c in i)i.hasOwnProperty(c)&&(a[c]=i[c]);return a}function iR(i,a){if(!a||!a.length)return!0;if(!i)return!1;for(var c=0;c<a.length;c++){var f=i[a[c]];if(f==null||f==="")return!1}return!0}function Bf(i){var a=i;if(typeof i=="object"&&i!=null){a="length"in i?[]:{};for(var c in i)G(a,c,Bf(i[c]))}return a}function qf(i){var a=i&&(i[Kf]?"phone":null);if(a&&i&&i[Hf]){G(this,"uid",i[Hf]),G(this,"displayName",i[M_]||null);var c=null;i[Wf]&&(c=new Date(i[Wf]).toUTCString()),G(this,"enrollmentTime",c),G(this,"factorId",a)}else throw new S("internal-error","Internal assert: invalid MultiFactorInfo object")}qf.prototype.w=function(){return{uid:this.uid,displayName:this.displayName,factorId:this.factorId,enrollmentTime:this.enrollmentTime}};function Gf(i){try{var a=new Ks(i)}catch{a=null}return a}var M_="displayName",Wf="enrolledAt",Hf="mfaEnrollmentId",Kf="phoneInfo";function Ks(i){qf.call(this,i),G(this,"phoneNumber",i[Kf])}$(Ks,qf),Ks.prototype.w=function(){var i=Ks.bb.w.call(this);return i.phoneNumber=this.phoneNumber,i};function oR(i){var a={},c=i[sR],f=i[uR],v=i[cR];if(i=Gf(i[aR]),!v||v!=Ju&&v!=zs&&!c||v==zs&&!f||v==zf&&!i)throw Error("Invalid checkActionCode response!");v==zs?(a[U_]=c||null,a[V_]=c||null,a[F_]=f):(a[U_]=f||null,a[V_]=f||null,a[F_]=c||null),a[lR]=i||null,G(this,fR,v),G(this,hR,Bf(a))}var zf="REVERT_SECOND_FACTOR_ADDITION",Ju="EMAIL_SIGNIN",zs="VERIFY_AND_CHANGE_EMAIL",sR="email",aR="mfaInfo",uR="newEmail",cR="requestType",F_="email",U_="fromEmail",lR="multiFactorInfo",V_="previousEmail",hR="data",fR="operation";function $f(i){i=Mt(i);var a=sn(i,j_)||null,c=sn(i,B_)||null,f=sn(i,q_)||null;if(f=f&&gR[f]||null,!a||!c||!f)throw new S("argument-error",j_+", "+B_+"and "+q_+" are required in a valid action code URL.");Et(this,{apiKey:a,operation:f,code:c,continueUrl:sn(i,dR)||null,languageCode:sn(i,pR)||null,tenantId:sn(i,vR)||null})}var j_="apiKey",B_="oobCode",dR="continueUrl",pR="languageCode",q_="mode",vR="tenantId",gR={recoverEmail:"RECOVER_EMAIL",resetPassword:"PASSWORD_RESET",revertSecondFactorAddition:zf,signIn:Ju,verifyAndChangeEmail:zs,verifyEmail:"VERIFY_EMAIL"};function G_(i){try{return new $f(i)}catch{return null}}function Zu(i){var a=i[mR];if(typeof a>"u")throw new S("missing-continue-uri");if(typeof a!="string"||typeof a=="string"&&!a.length)throw new S("invalid-continue-uri");this.h=a,this.b=this.a=null,this.g=!1;var c=i[W_];if(c&&typeof c=="object"){a=c[Q_];var f=c[z_];if(c=c[$_],typeof a=="string"&&a.length){if(this.a=a,typeof f<"u"&&typeof f!="boolean")throw new S("argument-error",z_+" property must be a boolean when specified.");if(this.g=!!f,typeof c<"u"&&(typeof c!="string"||typeof c=="string"&&!c.length))throw new S("argument-error",$_+" property must be a non empty string when specified.");this.b=c||null}else{if(typeof a<"u")throw new S("argument-error",Q_+" property must be a non empty string when specified.");if(typeof f<"u"||typeof c<"u")throw new S("missing-android-pkg-name")}}else if(typeof c<"u")throw new S("argument-error",W_+" property must be a non null object when specified.");if(this.f=null,(a=i[K_])&&typeof a=="object"){if(a=a[Y_],typeof a=="string"&&a.length)this.f=a;else if(typeof a<"u")throw new S("argument-error",Y_+" property must be a non empty string when specified.")}else if(typeof a<"u")throw new S("argument-error",K_+" property must be a non null object when specified.");if(a=i[Qf],typeof a<"u"&&typeof a!="boolean")throw new S("argument-error",Qf+" property must be a boolean when specified.");if(this.c=!!a,i=i[H_],typeof i<"u"&&(typeof i!="string"||typeof i=="string"&&!i.length))throw new S("argument-error",H_+" property must be a non empty string when specified.");this.i=i||null}var W_="android",H_="dynamicLinkDomain",Qf="handleCodeInApp",K_="iOS",mR="url",z_="installApp",$_="minimumVersion",Q_="packageName",Y_="bundleId";function ec(i){var a={};a.continueUrl=i.h,a.canHandleCodeInApp=i.c,(a.androidPackageName=i.a)&&(a.androidMinimumVersion=i.b,a.androidInstallApp=i.g),a.iOSBundleId=i.f,a.dynamicLinkDomain=i.i;for(var c in a)a[c]===null&&delete a[c];return a}function yR(i){return Lu(i,function(a){return a=a.toString(16),1<a.length?a:"0"+a}).join("")}var $s=null;function _R(i){var a=[];return wR(i,function(c){a.push(c)}),a}function wR(i,a){function c(R){for(;f<i.length;){var D=i.charAt(f++),Z=$s[D];if(Z!=null)return Z;if(!/^[\s\xa0]*$/.test(D))throw Error("Unknown base64 encoding at char: "+D)}return R}bR();for(var f=0;;){var v=c(-1),m=c(0),_=c(64),I=c(64);if(I===64&&v===-1)break;a(v<<2|m>>4),_!=64&&(a(m<<4&240|_>>2),I!=64&&a(_<<6&192|I))}}function bR(){if(!$s){$s={};for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),a=["+/=","+/","-_=","-_.","-_"],c=0;5>c;c++)for(var f=i.concat(a[c].split("")),v=0;v<f.length;v++){var m=f[v];$s[m]===void 0&&($s[m]=v)}}}function tc(i){var a=X_(i);if(!(a&&a.sub&&a.iss&&a.aud&&a.exp))throw Error("Invalid JWT");this.h=i,this.a=a.exp,this.i=a.sub,i=Date.now()/1e3,this.g=a.iat||(i>this.a?this.a:i),this.b=a.provider_id||a.firebase&&a.firebase.sign_in_provider||null,this.f=a.firebase&&a.firebase.tenant||null,this.c=!!a.is_anonymous||this.b=="anonymous"}tc.prototype.T=function(){return this.f},tc.prototype.l=function(){return this.c},tc.prototype.toString=function(){return this.h};function nc(i){try{return new tc(i)}catch{return null}}function X_(i){if(!i||(i=i.split("."),i.length!=3))return null;i=i[1];for(var a=(4-i.length%4)%4,c=0;c<a;c++)i+=".";try{var f=_R(i);for(i=[],c=a=0;a<f.length;){var v=f[a++];if(128>v)i[c++]=String.fromCharCode(v);else if(191<v&&224>v){var m=f[a++];i[c++]=String.fromCharCode((v&31)<<6|m&63)}else if(239<v&&365>v){m=f[a++];var _=f[a++],I=f[a++],R=((v&7)<<18|(m&63)<<12|(_&63)<<6|I&63)-65536;i[c++]=String.fromCharCode(55296+(R>>10)),i[c++]=String.fromCharCode(56320+(R&1023))}else m=f[a++],_=f[a++],i[c++]=String.fromCharCode((v&15)<<12|(m&63)<<6|_&63)}return JSON.parse(i.join(""))}catch{}return null}var J_="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),rc=["client_id","response_type","scope","redirect_uri","state"],Yf={nd:{Ja:"locale",va:700,ua:600,fa:"facebook.com",Ya:rc},pd:{Ja:null,va:500,ua:750,fa:"github.com",Ya:rc},qd:{Ja:"hl",va:515,ua:680,fa:"google.com",Ya:rc},wd:{Ja:"lang",va:485,ua:705,fa:"twitter.com",Ya:J_},kd:{Ja:"locale",va:640,ua:600,fa:"apple.com",Ya:[]}};function Xf(i){for(var a in Yf)if(Yf[a].fa==i)return Yf[a];return null}function Z_(i){var a={};a["facebook.com"]=tw,a["google.com"]=rw,a["github.com"]=nw,a["twitter.com"]=iw;var c=i&&i[ew];try{if(c)return a[c]?new a[c](i):new Fn(i);if(typeof i[Jf]<"u")return new Zf(i)}catch{}return null}var Jf="idToken",ew="providerId";function Zf(i){var a=i[ew];if(!a&&i[Jf]){var c=nc(i[Jf]);c&&c.b&&(a=c.b)}if(!a)throw Error("Invalid additional user info!");(a=="anonymous"||a=="custom")&&(a=null),c=!1,typeof i.isNewUser<"u"?c=!!i.isNewUser:i.kind==="identitytoolkit#SignupNewUserResponse"&&(c=!0),G(this,"providerId",a),G(this,"isNewUser",c)}function Fn(i){Zf.call(this,i),i=_o(i.rawUserInfo||"{}"),G(this,"profile",Bf(i||{}))}$(Fn,Zf);function tw(i){if(Fn.call(this,i),this.providerId!="facebook.com")throw Error("Invalid provider ID!")}$(tw,Fn);function nw(i){if(Fn.call(this,i),this.providerId!="github.com")throw Error("Invalid provider ID!");G(this,"username",this.profile&&this.profile.login||null)}$(nw,Fn);function rw(i){if(Fn.call(this,i),this.providerId!="google.com")throw Error("Invalid provider ID!")}$(rw,Fn);function iw(i){if(Fn.call(this,i),this.providerId!="twitter.com")throw Error("Invalid provider ID!");G(this,"username",i.screenName||null)}$(iw,Fn);function ow(i){var a=Mt(i),c=sn(a,"link"),f=sn(Mt(c),"link");return a=sn(a,"deep_link_id"),sn(Mt(a),"link")||a||f||c||i}function ic(i,a){if(!i&&!a)throw new S("internal-error","Internal assert: no raw session string available");if(i&&a)throw new S("internal-error","Internal assert: unable to determine the session type");this.a=i||null,this.b=a||null,this.type=this.a?Qs:oc}var Qs="enroll",oc="signin";ic.prototype.Ha=function(){return this.a?z(this.a):z(this.b)},ic.prototype.w=function(){return this.type==Qs?{multiFactorSession:{idToken:this.a}}:{multiFactorSession:{pendingCredential:this.b}}};function wo(){}wo.prototype.ka=function(){},wo.prototype.b=function(){},wo.prototype.c=function(){},wo.prototype.w=function(){};function bo(i,a){return i.then(function(c){if(c[bn]){var f=nc(c[bn]);if(!f||a!=f.i)throw new S("user-mismatch");return c}throw new S("user-mismatch")}).o(function(c){throw c&&c.code&&c.code==Ds+"user-not-found"?new S("user-mismatch"):c})}function li(i,a){if(a)this.a=a;else throw new S("internal-error","failed to construct a credential");G(this,"providerId",i),G(this,"signInMethod",i)}li.prototype.ka=function(i){return Ed(i,ed(this))},li.prototype.b=function(i,a){var c=ed(this);return c.idToken=a,Td(i,c)},li.prototype.c=function(i,a){return bo(Sd(i,ed(this)),a)};function ed(i){return{pendingToken:i.a,requestUri:"http://localhost"}}li.prototype.w=function(){return{providerId:this.providerId,signInMethod:this.signInMethod,pendingToken:this.a}};function IR(i){if(i&&i.providerId&&i.signInMethod&&i.providerId.indexOf("saml.")==0&&i.pendingToken)try{return new li(i.providerId,i.pendingToken)}catch{}return null}function tr(i,a,c){if(this.a=null,a.idToken||a.accessToken)a.idToken&&G(this,"idToken",a.idToken),a.accessToken&&G(this,"accessToken",a.accessToken),a.nonce&&!a.pendingToken&&G(this,"nonce",a.nonce),a.pendingToken&&(this.a=a.pendingToken);else if(a.oauthToken&&a.oauthTokenSecret)G(this,"accessToken",a.oauthToken),G(this,"secret",a.oauthTokenSecret);else throw new S("internal-error","failed to construct a credential");G(this,"providerId",i),G(this,"signInMethod",c)}tr.prototype.ka=function(i){return Ed(i,td(this))},tr.prototype.b=function(i,a){var c=td(this);return c.idToken=a,Td(i,c)},tr.prototype.c=function(i,a){var c=td(this);return bo(Sd(i,c),a)};function td(i){var a={};return i.idToken&&(a.id_token=i.idToken),i.accessToken&&(a.access_token=i.accessToken),i.secret&&(a.oauth_token_secret=i.secret),a.providerId=i.providerId,i.nonce&&!i.a&&(a.nonce=i.nonce),a={postBody:y_(a).toString(),requestUri:"http://localhost"},i.a&&(delete a.postBody,a.pendingToken=i.a),a}tr.prototype.w=function(){var i={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(i.oauthIdToken=this.idToken),this.accessToken&&(i.oauthAccessToken=this.accessToken),this.secret&&(i.oauthTokenSecret=this.secret),this.nonce&&(i.nonce=this.nonce),this.a&&(i.pendingToken=this.a),i};function ER(i){if(i&&i.providerId&&i.signInMethod){var a={idToken:i.oauthIdToken,accessToken:i.oauthTokenSecret?null:i.oauthAccessToken,oauthTokenSecret:i.oauthTokenSecret,oauthToken:i.oauthTokenSecret&&i.oauthAccessToken,nonce:i.nonce,pendingToken:i.pendingToken};try{return new tr(i.providerId,a,i.signInMethod)}catch{}}return null}function hi(i,a){this.Qc=a||[],Et(this,{providerId:i,isOAuthProvider:!0}),this.Jb={},this.qb=(Xf(i)||{}).Ja||null,this.pb=null}hi.prototype.Ka=function(i){return this.Jb=yr(i),this};function sw(i){if(typeof i!="string"||i.indexOf("saml.")!=0)throw new S("argument-error",'SAML provider IDs must be prefixed with "saml."');hi.call(this,i,[])}$(sw,hi);function zt(i){hi.call(this,i,rc),this.a=[]}$(zt,hi),zt.prototype.Ca=function(i){return Zn(this.a,i)||this.a.push(i),this},zt.prototype.Rb=function(){return ei(this.a)},zt.prototype.credential=function(i,a){var c;if(T(i)?c={idToken:i.idToken||null,accessToken:i.accessToken||null,nonce:i.rawNonce||null}:c={idToken:i||null,accessToken:a||null},!c.idToken&&!c.accessToken)throw new S("argument-error","credential failed: must provide the ID token and/or the access token.");return new tr(this.providerId,c,this.providerId)};function fi(){zt.call(this,"facebook.com")}$(fi,zt),G(fi,"PROVIDER_ID","facebook.com"),G(fi,"FACEBOOK_SIGN_IN_METHOD","facebook.com");function aw(i){if(!i)throw new S("argument-error","credential failed: expected 1 argument (the OAuth access token).");var a=i;return T(i)&&(a=i.accessToken),new fi().credential({accessToken:a})}function di(){zt.call(this,"github.com")}$(di,zt),G(di,"PROVIDER_ID","github.com"),G(di,"GITHUB_SIGN_IN_METHOD","github.com");function uw(i){if(!i)throw new S("argument-error","credential failed: expected 1 argument (the OAuth access token).");var a=i;return T(i)&&(a=i.accessToken),new di().credential({accessToken:a})}function pi(){zt.call(this,"google.com"),this.Ca("profile")}$(pi,zt),G(pi,"PROVIDER_ID","google.com"),G(pi,"GOOGLE_SIGN_IN_METHOD","google.com");function cw(i,a){var c=i;return T(i)&&(c=i.idToken,a=i.accessToken),new pi().credential({idToken:c,accessToken:a})}function Io(){hi.call(this,"twitter.com",J_)}$(Io,hi),G(Io,"PROVIDER_ID","twitter.com"),G(Io,"TWITTER_SIGN_IN_METHOD","twitter.com");function lw(i,a){var c=i;if(T(c)||(c={oauthToken:i,oauthTokenSecret:a}),!c.oauthToken||!c.oauthTokenSecret)throw new S("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new tr("twitter.com",c,"twitter.com")}function Er(i,a,c){this.a=i,this.f=a,G(this,"providerId","password"),G(this,"signInMethod",c===an.EMAIL_LINK_SIGN_IN_METHOD?an.EMAIL_LINK_SIGN_IN_METHOD:an.EMAIL_PASSWORD_SIGN_IN_METHOD)}Er.prototype.ka=function(i){return this.signInMethod==an.EMAIL_LINK_SIGN_IN_METHOD?ue(i,aD,{email:this.a,oobCode:this.f}):ue(i,Uw,{email:this.a,password:this.f})},Er.prototype.b=function(i,a){return this.signInMethod==an.EMAIL_LINK_SIGN_IN_METHOD?ue(i,uD,{idToken:a,email:this.a,oobCode:this.f}):ue(i,Fw,{idToken:a,email:this.a,password:this.f})},Er.prototype.c=function(i,a){return bo(this.ka(i),a)},Er.prototype.w=function(){return{email:this.a,password:this.f,signInMethod:this.signInMethod}};function TR(i){return i&&i.email&&i.password?new Er(i.email,i.password,i.signInMethod):null}function an(){Et(this,{providerId:"password",isOAuthProvider:!1})}function hw(i,a){if(a=nd(a),!a)throw new S("argument-error","Invalid email link!");return new Er(i,a.code,an.EMAIL_LINK_SIGN_IN_METHOD)}function nd(i){return i=ow(i),(i=G_(i))&&i.operation===Ju?i:null}Et(an,{PROVIDER_ID:"password"}),Et(an,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),Et(an,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"});function Tr(i){if(!(i.fb&&i.eb||i.La&&i.ea))throw new S("internal-error");this.a=i,G(this,"providerId","phone"),this.fa="phone",G(this,"signInMethod","phone")}Tr.prototype.ka=function(i){return i.gb(Ys(this))},Tr.prototype.b=function(i,a){var c=Ys(this);return c.idToken=a,ue(i,kD,c)},Tr.prototype.c=function(i,a){var c=Ys(this);return c.operation="REAUTH",i=ue(i,ND,c),bo(i,a)},Tr.prototype.w=function(){var i={providerId:"phone"};return this.a.fb&&(i.verificationId=this.a.fb),this.a.eb&&(i.verificationCode=this.a.eb),this.a.La&&(i.temporaryProof=this.a.La),this.a.ea&&(i.phoneNumber=this.a.ea),i};function SR(i){if(i&&i.providerId==="phone"&&(i.verificationId&&i.verificationCode||i.temporaryProof&&i.phoneNumber)){var a={};return De(["verificationId","verificationCode","temporaryProof","phoneNumber"],function(c){i[c]&&(a[c]=i[c])}),new Tr(a)}return null}function Ys(i){return i.a.La&&i.a.ea?{temporaryProof:i.a.La,phoneNumber:i.a.ea}:{sessionInfo:i.a.fb,code:i.a.eb}}function nr(i){try{this.a=i||J.auth()}catch{throw new S("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}Et(this,{providerId:"phone",isOAuthProvider:!1})}nr.prototype.gb=function(i,a){var c=this.a.a;return z(a.verify()).then(function(f){if(typeof f!="string")throw new S("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(a.type){case"recaptcha":var v=T(i)?i.session:null,m=T(i)?i.phoneNumber:i,_;return v&&v.type==Qs?_=v.Ha().then(function(I){return JR(c,{idToken:I,phoneEnrollmentInfo:{phoneNumber:m,recaptchaToken:f}})}):v&&v.type==oc?_=v.Ha().then(function(I){return ZR(c,{mfaPendingCredential:I,mfaEnrollmentId:i.multiFactorHint&&i.multiFactorHint.uid||i.multiFactorUid,phoneSignInInfo:{recaptchaToken:f}})}):_=XR(c,{phoneNumber:m,recaptchaToken:f}),_.then(function(I){return typeof a.reset=="function"&&a.reset(),I},function(I){throw typeof a.reset=="function"&&a.reset(),I});default:throw new S("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}})};function fw(i,a){if(!i)throw new S("missing-verification-id");if(!a)throw new S("missing-verification-code");return new Tr({fb:i,eb:a})}Et(nr,{PROVIDER_ID:"phone"}),Et(nr,{PHONE_SIGN_IN_METHOD:"phone"});function rd(i){if(i.temporaryProof&&i.phoneNumber)return new Tr({La:i.temporaryProof,ea:i.phoneNumber});var a=i&&i.providerId;if(!a||a==="password")return null;var c=i&&i.oauthAccessToken,f=i&&i.oauthTokenSecret,v=i&&i.nonce,m=i&&i.oauthIdToken,_=i&&i.pendingToken;try{switch(a){case"google.com":return cw(m,c);case"facebook.com":return aw(c);case"github.com":return uw(c);case"twitter.com":return lw(c,f);default:return c||f||m||_?_?a.indexOf("saml.")==0?new li(a,_):new tr(a,{pendingToken:_,idToken:i.oauthIdToken,accessToken:i.oauthAccessToken},a):new zt(a).credential({idToken:m,accessToken:c,rawNonce:v}):null}}catch{return null}}function id(i){if(!i.isOAuthProvider)throw new S("invalid-oauth-provider")}function _n(i,a,c,f,v,m,_){if(this.c=i,this.b=a||null,this.g=c||null,this.f=f||null,this.i=m||null,this.h=_||null,this.a=v||null,this.g||this.a){if(this.g&&this.a)throw new S("invalid-auth-event");if(this.g&&!this.f)throw new S("invalid-auth-event")}else throw new S("invalid-auth-event")}_n.prototype.getUid=function(){var i=[];return i.push(this.c),this.b&&i.push(this.b),this.f&&i.push(this.f),this.h&&i.push(this.h),i.join("-")},_n.prototype.T=function(){return this.h},_n.prototype.w=function(){return{type:this.c,eventId:this.b,urlResponse:this.g,sessionId:this.f,postBody:this.i,tenantId:this.h,error:this.a&&this.a.w()}};function dw(i){return i=i||{},i.type?new _n(i.type,i.eventId,i.urlResponse,i.sessionId,i.error&&Rs(i.error),i.postBody,i.tenantId):null}function CR(){this.b=null,this.a=[]}var od=null;function AR(i){var a=od;a.a.push(i),a.b||(a.b=function(c){for(var f=0;f<a.a.length;f++)a.a[f](c)},i=ke("universalLinks.subscribe",h),typeof i=="function"&&i(null,a.b))}function sd(i){var a="unauthorized-domain",c=void 0,f=Mt(i);i=f.a,f=f.c,f=="chrome-extension"?c=Fy("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",i):f=="http"||f=="https"?c=Fy("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",i):a="operation-not-supported-in-this-environment",S.call(this,a,c)}$(sd,S);function Xs(i,a,c){S.call(this,i,c),i=a||{},i.Kb&&G(this,"email",i.Kb),i.ea&&G(this,"phoneNumber",i.ea),i.credential&&G(this,"credential",i.credential),i.$b&&G(this,"tenantId",i.$b)}$(Xs,S),Xs.prototype.w=function(){var i={code:this.code,message:this.message};this.email&&(i.email=this.email),this.phoneNumber&&(i.phoneNumber=this.phoneNumber),this.tenantId&&(i.tenantId=this.tenantId);var a=this.credential&&this.credential.w();return a&&Pt(i,a),i},Xs.prototype.toJSON=function(){return this.w()};function sc(i){if(i.code){var a=i.code||"";a.indexOf(Ds)==0&&(a=a.substring(Ds.length));var c={credential:rd(i),$b:i.tenantId};if(i.email)c.Kb=i.email;else if(i.phoneNumber)c.ea=i.phoneNumber;else if(!c.credential)return new S(a,i.message||void 0);return new Xs(a,c,i.message)}return null}function Js(){}Js.prototype.c=null;function pw(i){return i.c||(i.c=i.b())}var ad;function ac(){}$(ac,Js),ac.prototype.a=function(){var i=vw(this);return i?new ActiveXObject(i):new XMLHttpRequest},ac.prototype.b=function(){var i={};return vw(this)&&(i[0]=!0,i[1]=!0),i};function vw(i){if(!i.f&&typeof XMLHttpRequest>"u"&&typeof ActiveXObject<"u"){for(var a=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],c=0;c<a.length;c++){var f=a[c];try{return new ActiveXObject(f),i.f=f}catch{}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return i.f}ad=new ac;function uc(){}$(uc,Js),uc.prototype.a=function(){var i=new XMLHttpRequest;if("withCredentials"in i)return i;if(typeof XDomainRequest<"u")return new gw;throw Error("Unsupported browser")},uc.prototype.b=function(){return{}};function gw(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseType=this.responseText=this.response="",this.status=-1,this.statusText="",this.a.onload=F(this.qc,this),this.a.onerror=F(this.Tb,this),this.a.onprogress=F(this.rc,this),this.a.ontimeout=F(this.vc,this)}t=gw.prototype,t.open=function(i,a,c){if(c!=null&&!c)throw Error("Only async requests are supported.");this.a.open(i,a)},t.send=function(i){if(i)if(typeof i=="string")this.a.send(i);else throw Error("Only string data is supported");else this.a.send()},t.abort=function(){this.a.abort()},t.setRequestHeader=function(){},t.getResponseHeader=function(i){return i.toLowerCase()=="content-type"?this.a.contentType:""},t.qc=function(){this.status=200,this.response=this.responseText=this.a.responseText,ud(this,4)},t.Tb=function(){this.status=500,this.response=this.responseText="",ud(this,4)},t.vc=function(){this.Tb()},t.rc=function(){this.status=200,ud(this,1)};function ud(i,a){i.readyState=a,i.onreadystatechange&&i.onreadystatechange()}t.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType};function cd(i,a,c){this.reset(i,a,c,void 0,void 0)}cd.prototype.a=null,cd.prototype.reset=function(i,a,c,f,v){delete this.a};function ld(i){this.f=i,this.b=this.c=this.a=null}function Zs(i,a){this.name=i,this.value=a}Zs.prototype.toString=function(){return this.name};var mw=new Zs("SEVERE",1e3),hd=new Zs("WARNING",900),kR=new Zs("CONFIG",700),NR=new Zs("FINE",500);function yw(i){return i.c?i.c:i.a?yw(i.a):(ao("Root logger has no level set."),null)}ld.prototype.log=function(i,a,c){if(i.value>=yw(this).value)for(E(a)&&(a=a()),i=new cd(i,String(a),this.f),c&&(i.a=c),c=this;c;)c=c.a};var fd={},cc=null;function dd(i){cc||(cc=new ld(""),fd[""]=cc,cc.c=kR);var a;if(!(a=fd[i])){a=new ld(i);var c=i.lastIndexOf("."),f=i.substr(c+1);c=dd(i.substr(0,c)),c.b||(c.b={}),c.b[f]=a,a.a=c,fd[i]=a}return a}function un(i,a){i&&i.log(NR,a,void 0)}function lc(i){this.f=i}$(lc,Js),lc.prototype.a=function(){return new hc(this.f)},lc.prototype.b=function(i){return function(){return i}}({});function hc(i){It.call(this),this.u=i,this.h=void 0,this.readyState=pd,this.status=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.l=new Headers,this.b=null,this.s="GET",this.f="",this.a=!1,this.i=dd("goog.net.FetchXmlHttp"),this.m=this.c=this.g=null}$(hc,It);var pd=0;t=hc.prototype,t.open=function(i,a){if(this.readyState!=pd)throw this.abort(),Error("Error reopening a connection");this.s=i,this.f=a,this.readyState=1,ta(this)},t.send=function(i){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.a=!0;var a={headers:this.l,method:this.s,credentials:this.h,cache:void 0};i&&(a.body=i),this.u.fetch(new Request(this.f,a)).then(this.uc.bind(this),this.Va.bind(this))},t.abort=function(){this.response=this.responseText="",this.l=new Headers,this.status=0,this.c&&this.c.cancel("Request was aborted."),1<=this.readyState&&this.a&&this.readyState!=4&&(this.a=!1,ea(this)),this.readyState=pd},t.uc=function(i){this.a&&(this.g=i,this.b||(this.status=this.g.status,this.statusText=this.g.statusText,this.b=i.headers,this.readyState=2,ta(this)),this.a&&(this.readyState=3,ta(this),this.a&&(this.responseType==="arraybuffer"?i.arrayBuffer().then(this.sc.bind(this),this.Va.bind(this)):typeof h.ReadableStream<"u"&&"body"in i?(this.response=this.responseText="",this.c=i.body.getReader(),this.m=new TextDecoder,_w(this)):i.text().then(this.tc.bind(this),this.Va.bind(this)))))};function _w(i){i.c.read().then(i.pc.bind(i)).catch(i.Va.bind(i))}t.pc=function(i){if(this.a){var a=this.m.decode(i.value?i.value:new Uint8Array(0),{stream:!i.done});a&&(this.response=this.responseText+=a),i.done?ea(this):ta(this),this.readyState==3&&_w(this)}},t.tc=function(i){this.a&&(this.response=this.responseText=i,ea(this))},t.sc=function(i){this.a&&(this.response=i,ea(this))},t.Va=function(i){var a=this.i;a&&a.log(hd,"Failed to fetch url "+this.f,i instanceof Error?i:Error(i)),this.a&&ea(this)};function ea(i){i.readyState=4,i.g=null,i.c=null,i.m=null,ta(i)}t.setRequestHeader=function(i,a){this.l.append(i,a)},t.getResponseHeader=function(i){return this.b?this.b.get(i.toLowerCase())||"":((i=this.i)&&i.log(hd,"Attempting to get response header but no headers have been received for url: "+this.f,void 0),"")},t.getAllResponseHeaders=function(){if(!this.b){var i=this.i;return i&&i.log(hd,"Attempting to get all response headers but no headers have been received for url: "+this.f,void 0),""}i=[];for(var a=this.b.entries(),c=a.next();!c.done;)c=c.value,i.push(c[0]+": "+c[1]),c=a.next();return i.join(`\r
`)};function ta(i){i.onreadystatechange&&i.onreadystatechange.call(i)}Object.defineProperty(hc.prototype,"withCredentials",{get:function(){return this.h==="include"},set:function(i){this.h=i?"include":"same-origin"}});function na(i){It.call(this),this.headers=new po,this.D=i||null,this.c=!1,this.C=this.a=null,this.h=this.P=this.l="",this.f=this.N=this.i=this.J=!1,this.g=0,this.s=null,this.m=ww,this.u=this.S=!1}$(na,It);var ww="";na.prototype.b=dd("goog.net.XhrIo");var RR=/^https?$/i,DR=["POST","PUT"];function OR(i,a,c,f,v){if(i.a)throw Error("[goog.net.XhrIo] Object is active with another request="+i.l+"; newUri="+a);c=c?c.toUpperCase():"GET",i.l=a,i.h="",i.P=c,i.J=!1,i.c=!0,i.a=i.D?i.D.a():ad.a(),i.C=i.D?pw(i.D):pw(ad),i.a.onreadystatechange=F(i.Wb,i);try{un(i.b,rr(i,"Opening Xhr")),i.N=!0,i.a.open(c,String(a),!0),i.N=!1}catch(_){un(i.b,rr(i,"Error opening Xhr: "+_.message)),bw(i,_);return}a=f||"";var m=new po(i.headers);v&&UN(v,function(_,I){m.set(I,_)}),v=tN(m.Y()),f=h.FormData&&a instanceof h.FormData,!Zn(DR,c)||v||f||m.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),m.forEach(function(_,I){this.a.setRequestHeader(I,_)},i),i.m&&(i.a.responseType=i.m),"withCredentials"in i.a&&i.a.withCredentials!==i.S&&(i.a.withCredentials=i.S);try{Tw(i),0<i.g&&(i.u=PR(i.a),un(i.b,rr(i,"Will abort after "+i.g+"ms if incomplete, xhr2 "+i.u)),i.u?(i.a.timeout=i.g,i.a.ontimeout=F(i.Ma,i)):i.s=Af(i.Ma,i.g,i)),un(i.b,rr(i,"Sending request")),i.i=!0,i.a.send(a),i.i=!1}catch(_){un(i.b,rr(i,"Send error: "+_.message)),bw(i,_)}}function PR(i){return mn&&By(9)&&typeof i.timeout=="number"&&i.ontimeout!==void 0}function xR(i){return i.toLowerCase()=="content-type"}t=na.prototype,t.Ma=function(){typeof l<"u"&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",un(this.b,rr(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))};function bw(i,a){i.c=!1,i.a&&(i.f=!0,i.a.abort(),i.f=!1),i.h=a,Iw(i),fc(i)}function Iw(i){i.J||(i.J=!0,i.dispatchEvent("complete"),i.dispatchEvent("error"))}t.abort=function(){this.a&&this.c&&(un(this.b,rr(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),fc(this))},t.Da=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),fc(this,!0)),na.bb.Da.call(this)},t.Wb=function(){this.ya||(this.N||this.i||this.f?Ew(this):this.Jc())},t.Jc=function(){Ew(this)};function Ew(i){if(i.c&&typeof l<"u"){if(i.C[1]&&ra(i)==4&&dc(i)==2)un(i.b,rr(i,"Local request error detected and ignored"));else if(i.i&&ra(i)==4)Af(i.Wb,0,i);else if(i.dispatchEvent("readystatechange"),ra(i)==4){un(i.b,rr(i,"Request complete")),i.c=!1;try{var a=dc(i);e:switch(a){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var c=!0;break e;default:c=!1}var f;if(!(f=c)){var v;if(v=a===0){var m=String(i.l).match(g_)[1]||null;if(!m&&h.self&&h.self.location){var _=h.self.location.protocol;m=_.substr(0,_.length-1)}v=!RR.test(m?m.toLowerCase():"")}f=v}if(f)i.dispatchEvent("complete"),i.dispatchEvent("success");else{try{var I=2<ra(i)?i.a.statusText:""}catch(R){un(i.b,"Can not get status: "+R.message),I=""}i.h=I+" ["+dc(i)+"]",Iw(i)}}finally{fc(i)}}}}function fc(i,a){if(i.a){Tw(i);var c=i.a,f=i.C[0]?y:null;i.a=null,i.C=null,a||i.dispatchEvent("ready");try{c.onreadystatechange=f}catch(v){(i=i.b)&&i.log(mw,"Problem encountered resetting onreadystatechange: "+v.message,void 0)}}}function Tw(i){i.a&&i.u&&(i.a.ontimeout=null),i.s&&(h.clearTimeout(i.s),i.s=null)}function ra(i){return i.a?i.a.readyState:0}function dc(i){try{return 2<ra(i)?i.a.status:-1}catch{return-1}}function LR(i){try{return i.a?i.a.responseText:""}catch(a){return un(i.b,"Can not get responseText: "+a.message),""}}t.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.m){case ww:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var i=this.b;return i&&i.log(mw,"Response type "+this.m+" is not supported on this browser",void 0),null}catch(a){return un(this.b,"Can not get response: "+a.message),null}};function rr(i,a){return a+" ["+i.P+" "+i.l+" "+dc(i)+"]"}function vi(i){var a=UR;this.g=[],this.u=a,this.s=i||null,this.f=this.a=!1,this.c=void 0,this.v=this.C=this.i=!1,this.h=0,this.b=null,this.l=0}vi.prototype.cancel=function(i){if(this.a)this.c instanceof vi&&this.c.cancel();else{if(this.b){var a=this.b;delete this.b,i?a.cancel(i):(a.l--,0>=a.l&&a.cancel())}this.u?this.u.call(this.s,this):this.v=!0,this.a||(i=new oa,pc(this),ia(this,!1,i))}},vi.prototype.m=function(i,a){this.i=!1,ia(this,i,a)};function ia(i,a,c){i.a=!0,i.c=c,i.f=!a,Cw(i)}function pc(i){if(i.a){if(!i.v)throw new vc;i.v=!1}}function MR(i,a){vd(i,null,a,void 0)}function vd(i,a,c,f){i.g.push([a,c,f]),i.a&&Cw(i)}vi.prototype.then=function(i,a,c){var f,v,m=new ae(function(_,I){f=_,v=I});return vd(this,f,function(_){_ instanceof oa?m.cancel():v(_)}),m.then(i,a,c)},vi.prototype.$goog_Thenable=!0;function Sw(i){return eN(i.g,function(a){return E(a[1])})}function Cw(i){if(i.h&&i.a&&Sw(i)){var a=i.h,c=gc[a];c&&(h.clearTimeout(c.a),delete gc[a]),i.h=0}i.b&&(i.b.l--,delete i.b),a=i.c;for(var f=c=!1;i.g.length&&!i.i;){var v=i.g.shift(),m=v[0],_=v[1];if(v=v[2],m=i.f?_:m)try{var I=m.call(v||i.s,a);I!==void 0&&(i.f=i.f&&(I==a||I instanceof Error),i.c=a=I),(gy(a)||typeof h.Promise=="function"&&a instanceof h.Promise)&&(f=!0,i.i=!0)}catch(R){a=R,i.f=!0,Sw(i)||(c=!0)}}i.c=a,f&&(I=F(i.m,i,!0),f=F(i.m,i,!1),a instanceof vi?(vd(a,I,f),a.C=!0):a.then(I,f)),c&&(a=new Aw(a),gc[a.a]=a,i.h=a.a)}function vc(){Ht.call(this)}$(vc,Ht),vc.prototype.message="Deferred has already fired",vc.prototype.name="AlreadyCalledError";function oa(){Ht.call(this)}$(oa,Ht),oa.prototype.message="Deferred was canceled",oa.prototype.name="CanceledError";function Aw(i){this.a=h.setTimeout(F(this.c,this),0),this.b=i}Aw.prototype.c=function(){throw delete gc[this.a],this.b};var gc={};function gd(i){var a={},c=a.document||document,f=Ny(i).toString(),v=Bu(document,"SCRIPT"),m={Xb:v,Ma:void 0},_=new vi(m),I=null,R=a.timeout!=null?a.timeout:5e3;return 0<R&&(I=window.setTimeout(function(){mc(v,!0);var D=new md(jR,"Timeout reached for loading script "+f);pc(_),ia(_,!1,D)},R),m.Ma=I),v.onload=v.onreadystatechange=function(){v.readyState&&v.readyState!="loaded"&&v.readyState!="complete"||(mc(v,a.xd||!1,I),pc(_),ia(_,!0,null))},v.onerror=function(){mc(v,!0,I);var D=new md(VR,"Error while loading script "+f);pc(_),ia(_,!1,D)},m=a.attributes||{},Pt(m,{type:"text/javascript",charset:"UTF-8"}),Gy(v,m),vN(v,i),FR(c).appendChild(v),_}function FR(i){var a;return(a=(i||document).getElementsByTagName("HEAD"))&&a.length!=0?a[0]:i.documentElement}function UR(){if(this&&this.Xb){var i=this.Xb;i&&i.tagName=="SCRIPT"&&mc(i,!0,this.Ma)}}function mc(i,a,c){c!=null&&h.clearTimeout(c),i.onload=y,i.onerror=y,i.onreadystatechange=y,a&&window.setTimeout(function(){i&&i.parentNode&&i.parentNode.removeChild(i)},0)}var VR=0,jR=1;function md(i,a){var c="Jsloader error (code #"+i+")";a&&(c+=": "+a),Ht.call(this,c),this.code=i}$(md,Ht);function yc(i){this.f=i}$(yc,Js),yc.prototype.a=function(){return new this.f},yc.prototype.b=function(){return{}};function wn(i,a,c){if(this.c=i,i=a||{},this.l=i.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.m=i.secureTokenTimeout||BR,this.g=yr(i.secureTokenHeaders||qR),this.h=i.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.i=i.identityPlatformEndpoint||"https://identitytoolkit.googleapis.com/v2/",this.v=i.firebaseTimeout||GR,this.a=yr(i.firebaseHeaders||WR),c&&(this.a["X-Client-Version"]=c,this.g["X-Client-Version"]=c),c=Ln()=="Node",c=h.XMLHttpRequest||c&&J.INTERNAL.node&&J.INTERNAL.node.XMLHttpRequest,!c&&!yn())throw new S("internal-error","The XMLHttpRequest compatibility library was not found.");this.f=void 0,yn()?this.f=new lc(self):k_()?this.f=new yc(c):this.f=new uc,this.b=null}var yd,bn="idToken",BR=new Ir(3e4,6e4),qR={"Content-Type":"application/x-www-form-urlencoded"},GR=new Ir(3e4,6e4),WR={"Content-Type":"application/json"};function kw(i,a){a?i.a["X-Firebase-Locale"]=a:delete i.a["X-Firebase-Locale"]}function _c(i,a){a&&(i.l=_d("https://securetoken.googleapis.com/v1/token",a),i.h=_d("https://www.googleapis.com/identitytoolkit/v3/relyingparty/",a),i.i=_d("https://identitytoolkit.googleapis.com/v2/",a))}function _d(i,a){return i=Mt(i),a=Mt(a.url),i.f=i.a+i.f,Us(i,a.c),i.a=a.a,Vs(i,a.g),i.toString()}function Nw(i,a){a?(i.a["X-Client-Version"]=a,i.g["X-Client-Version"]=a):(delete i.a["X-Client-Version"],delete i.g["X-Client-Version"])}wn.prototype.T=function(){return this.b};function Rw(i,a,c,f,v,m,_){$N()||yn()?i=F(i.u,i):(yd||(yd=new ae(function(I,R){KR(I,R)})),i=F(i.s,i)),i(a,c,f,v,m,_)}wn.prototype.u=function(i,a,c,f,v,m){if(yn()&&(typeof h.fetch>"u"||typeof h.Headers>"u"||typeof h.Request>"u"))throw new S("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var _=new na(this.f);if(m){_.g=Math.max(0,m);var I=setTimeout(function(){_.dispatchEvent("timeout")},m)}d_(_,"complete",function(){I&&clearTimeout(I);var R=null;try{R=JSON.parse(LR(this))||null}catch{R=null}a&&a(R)}),Cf(_,"ready",function(){I&&clearTimeout(I),s_(this)}),Cf(_,"timeout",function(){I&&clearTimeout(I),s_(this),a&&a(null)}),OR(_,i,c,f,v)};var HR=new Pn(Fu,"https://apis.google.com/js/client.js?onload=%{onload}"),Dw="__fcb"+Math.floor(1e6*Math.random()).toString();function KR(i,a){if(((window.gapi||{}).client||{}).request)i();else{h[Dw]=function(){((window.gapi||{}).client||{}).request?i():a(Error("CORS_UNSUPPORTED"))};var c=uf(HR,{onload:Dw});MR(gd(c),function(){a(Error("CORS_UNSUPPORTED"))})}}wn.prototype.s=function(i,a,c,f,v){var m=this;yd.then(function(){window.gapi.client.setApiKey(m.c);var _=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:i,method:c,body:f,headers:v,authType:"none",callback:function(I){window.gapi.auth.setToken(_),a&&a(I)}})}).o(function(_){a&&a({error:{message:_&&_.message||"CORS_UNSUPPORTED"}})})};function zR(i,a){return new ae(function(c,f){a.grant_type=="refresh_token"&&a.refresh_token||a.grant_type=="authorization_code"&&a.code?Rw(i,i.l+"?key="+encodeURIComponent(i.c),function(v){v?v.error?f(Ad(v)):v.access_token&&v.refresh_token?c(v):f(new S("internal-error")):f(new S("network-request-failed"))},"POST",y_(a).toString(),i.g,i.m.get()):f(new S("internal-error"))})}function Ow(i,a,c,f,v,m,_){var I=Mt(a+c);Ue(I,"key",i.c),_&&Ue(I,"cb",Date.now().toString());var R=f=="GET";if(R)for(var D in v)v.hasOwnProperty(D)&&Ue(I,D,v[D]);return new ae(function(Z,we){Rw(i,I.toString(),function(de){de?de.error?we(Ad(de,m||{})):Z(de):we(new S("network-request-failed"))},f,R?void 0:b_(D_(v)),i.a,i.v.get())})}function gi(i){if(i=i.email,typeof i!="string"||!XN.test(i))throw new S("invalid-email")}function Pw(i){"email"in i&&gi(i)}function $R(i,a){return ue(i,iD,{identifier:a,continueUri:Xu()?qs():"http://localhost"}).then(function(c){return c.signinMethods||[]})}function QR(i){return ue(i,gD,{}).then(function(a){return a.authorizedDomains||[]})}function Ft(i){if(!i[bn])throw i.mfaPendingCredential?new S("multi-factor-auth-required",null,yr(i)):new S("internal-error")}function wd(i){if(i.phoneNumber||i.temporaryProof){if(!i.phoneNumber||!i.temporaryProof)throw new S("internal-error")}else{if(!i.sessionInfo)throw new S("missing-verification-id");if(!i.code)throw new S("missing-verification-code")}}wn.prototype.Ab=function(){return ue(this,wD,{})},wn.prototype.Cb=function(i,a){return ue(this,Mw,{idToken:i,email:a})},wn.prototype.Db=function(i,a){return ue(this,Fw,{idToken:i,password:a})};var YR={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};t=wn.prototype,t.Eb=function(i,a){var c={idToken:i},f=[];return Ty(YR,function(v,m){var _=a[m];_===null?f.push(v):m in a&&(c[m]=_)}),f.length&&(c.deleteAttribute=f),ue(this,Mw,c)},t.wb=function(i,a){return i={requestType:"PASSWORD_RESET",email:i},Pt(i,a),ue(this,vD,i)},t.xb=function(i,a){return i={requestType:"EMAIL_SIGNIN",email:i},Pt(i,a),ue(this,fD,i)},t.vb=function(i,a){return i={requestType:"VERIFY_EMAIL",idToken:i},Pt(i,a),ue(this,dD,i)},t.Fb=function(i,a,c){return i={requestType:"VERIFY_AND_CHANGE_EMAIL",idToken:i,newEmail:a},Pt(i,c),ue(this,pD,i)};function XR(i,a){return ue(i,_D,a)}t.gb=function(i){return ue(this,AD,i)};function JR(i,a){return ue(i,bD,a).then(function(c){return c.phoneSessionInfo.sessionInfo})}function xw(i){if(!i.phoneVerificationInfo)throw new S("internal-error");if(!i.phoneVerificationInfo.sessionInfo)throw new S("missing-verification-id");if(!i.phoneVerificationInfo.code)throw new S("missing-verification-code")}function ZR(i,a){return ue(i,ID,a).then(function(c){return c.phoneResponseInfo.sessionInfo})}function eD(i,a,c){return ue(i,sD,{idToken:a,deleteProvider:c})}function bd(i){if(!i.requestUri||!i.sessionId&&!i.postBody&&!i.pendingToken)throw new S("internal-error")}function Id(i,a){return a.oauthIdToken&&a.providerId&&a.providerId.indexOf("oidc.")==0&&!a.pendingToken&&(i.sessionId?a.nonce=i.sessionId:i.postBody&&(i=new si(i.postBody),Rf(i,"nonce")&&(a.nonce=i.get("nonce")))),a}function Lw(i){var a=null;if(i.needConfirmation?(i.code="account-exists-with-different-credential",a=sc(i)):i.errorMessage=="FEDERATED_USER_ID_ALREADY_LINKED"?(i.code="credential-already-in-use",a=sc(i)):i.errorMessage=="EMAIL_EXISTS"?(i.code="email-already-in-use",a=sc(i)):i.errorMessage&&(a=Vw(i.errorMessage)),a)throw a;Ft(i)}function Ed(i,a){return a.returnIdpCredential=!0,ue(i,ED,a)}function Td(i,a){return a.returnIdpCredential=!0,ue(i,SD,a)}function Sd(i,a){return a.returnIdpCredential=!0,a.autoCreate=!1,ue(i,TD,a)}function Cd(i){if(!i.oobCode)throw new S("invalid-action-code")}t.ob=function(i,a){return ue(this,yD,{oobCode:i,newPassword:a})},t.Sa=function(i){return ue(this,nD,{oobCode:i})},t.kb=function(i){return ue(this,tD,{oobCode:i})};var tD={endpoint:"setAccountInfo",A:Cd,Z:"email",B:!0},nD={endpoint:"resetPassword",A:Cd,G:function(i){var a=i.requestType;if(!a||!i.email&&a!="EMAIL_SIGNIN"&&a!="VERIFY_AND_CHANGE_EMAIL")throw new S("internal-error")},B:!0},rD={endpoint:"signupNewUser",A:function(i){if(gi(i),!i.password)throw new S("weak-password")},G:Ft,V:!0,B:!0},iD={endpoint:"createAuthUri",B:!0},oD={endpoint:"deleteAccount",O:["idToken"]},sD={endpoint:"setAccountInfo",O:["idToken","deleteProvider"],A:function(i){if(!Array.isArray(i.deleteProvider))throw new S("internal-error")}},aD={endpoint:"emailLinkSignin",O:["email","oobCode"],A:gi,G:Ft,V:!0,B:!0},uD={endpoint:"emailLinkSignin",O:["idToken","email","oobCode"],A:gi,G:Ft,V:!0},cD={endpoint:"accounts/mfaEnrollment:finalize",O:["idToken","phoneVerificationInfo"],A:xw,G:Ft,B:!0,Na:!0},lD={endpoint:"accounts/mfaSignIn:finalize",O:["mfaPendingCredential","phoneVerificationInfo"],A:xw,G:Ft,B:!0,Na:!0},hD={endpoint:"getAccountInfo"},fD={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(i){if(i.requestType!="EMAIL_SIGNIN")throw new S("internal-error");gi(i)},Z:"email",B:!0},dD={endpoint:"getOobConfirmationCode",O:["idToken","requestType"],A:function(i){if(i.requestType!="VERIFY_EMAIL")throw new S("internal-error")},Z:"email",B:!0},pD={endpoint:"getOobConfirmationCode",O:["idToken","newEmail","requestType"],A:function(i){if(i.requestType!="VERIFY_AND_CHANGE_EMAIL")throw new S("internal-error")},Z:"email",B:!0},vD={endpoint:"getOobConfirmationCode",O:["requestType"],A:function(i){if(i.requestType!="PASSWORD_RESET")throw new S("internal-error");gi(i)},Z:"email",B:!0},gD={mb:!0,endpoint:"getProjectConfig",Vb:"GET"},mD={mb:!0,endpoint:"getRecaptchaParam",Vb:"GET",G:function(i){if(!i.recaptchaSiteKey)throw new S("internal-error")}},yD={endpoint:"resetPassword",A:Cd,Z:"email",B:!0},_D={endpoint:"sendVerificationCode",O:["phoneNumber","recaptchaToken"],Z:"sessionInfo",B:!0},Mw={endpoint:"setAccountInfo",O:["idToken"],A:Pw,V:!0},Fw={endpoint:"setAccountInfo",O:["idToken"],A:function(i){if(Pw(i),!i.password)throw new S("weak-password")},G:Ft,V:!0},wD={endpoint:"signupNewUser",G:Ft,V:!0,B:!0},bD={endpoint:"accounts/mfaEnrollment:start",O:["idToken","phoneEnrollmentInfo"],A:function(i){if(!i.phoneEnrollmentInfo)throw new S("internal-error");if(!i.phoneEnrollmentInfo.phoneNumber)throw new S("missing-phone-number");if(!i.phoneEnrollmentInfo.recaptchaToken)throw new S("missing-app-credential")},G:function(i){if(!i.phoneSessionInfo||!i.phoneSessionInfo.sessionInfo)throw new S("internal-error")},B:!0,Na:!0},ID={endpoint:"accounts/mfaSignIn:start",O:["mfaPendingCredential","mfaEnrollmentId","phoneSignInInfo"],A:function(i){if(!i.phoneSignInInfo||!i.phoneSignInInfo.recaptchaToken)throw new S("missing-app-credential")},G:function(i){if(!i.phoneResponseInfo||!i.phoneResponseInfo.sessionInfo)throw new S("internal-error")},B:!0,Na:!0},ED={endpoint:"verifyAssertion",A:bd,Za:Id,G:Lw,V:!0,B:!0},TD={endpoint:"verifyAssertion",A:bd,Za:Id,G:function(i){if(i.errorMessage&&i.errorMessage=="USER_NOT_FOUND")throw new S("user-not-found");if(i.errorMessage)throw Vw(i.errorMessage);Ft(i)},V:!0,B:!0},SD={endpoint:"verifyAssertion",A:function(i){if(bd(i),!i.idToken)throw new S("internal-error")},Za:Id,G:Lw,V:!0},CD={endpoint:"verifyCustomToken",A:function(i){if(!i.token)throw new S("invalid-custom-token")},G:Ft,V:!0,B:!0},Uw={endpoint:"verifyPassword",A:function(i){if(gi(i),!i.password)throw new S("wrong-password")},G:Ft,V:!0,B:!0},AD={endpoint:"verifyPhoneNumber",A:wd,G:Ft,B:!0},kD={endpoint:"verifyPhoneNumber",A:function(i){if(!i.idToken)throw new S("internal-error");wd(i)},G:function(i){if(i.temporaryProof)throw i.code="credential-already-in-use",sc(i);Ft(i)}},ND={Ib:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:wd,G:Ft,B:!0},RD={endpoint:"accounts/mfaEnrollment:withdraw",O:["idToken","mfaEnrollmentId"],G:function(i){if(!!i[bn]^!!i.refreshToken)throw new S("internal-error")},B:!0,Na:!0};function ue(i,a,c){if(!iR(c,a.O))return Ae(new S("internal-error"));var f=!!a.Na,v=a.Vb||"POST",m;return z(c).then(a.A).then(function(){return a.V&&(c.returnSecureToken=!0),a.B&&i.b&&typeof c.tenantId>"u"&&(c.tenantId=i.b),f?Ow(i,i.i,a.endpoint,v,c,a.Ib,a.mb||!1):Ow(i,i.h,a.endpoint,v,c,a.Ib,a.mb||!1)}).then(function(_){return m=_,a.Za?a.Za(c,m):m}).then(a.G).then(function(){if(!a.Z)return m;if(!(a.Z in m))throw new S("internal-error");return m[a.Z]})}function Vw(i){return Ad({error:{errors:[{message:i}],code:400,message:i}})}function Ad(i,a){var c=(i.error&&i.error.errors&&i.error.errors[0]||{}).reason||"",f={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(c=f[c]?new S(f[c]):null)return c;c=i.error&&i.error.message||"",f={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_OR_INVALID_NONCE:"missing-or-invalid-nonce",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",INVALID_PROVIDER_ID:"invalid-provider-id",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",REJECTED_CREDENTIAL:"rejected-credential",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_DYNAMIC_LINK_DOMAIN:"invalid-dynamic-link-domain",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash",UNSUPPORTED_TENANT_OPERATION:"unsupported-tenant-operation",INVALID_TENANT_ID:"invalid-tenant-id",TENANT_ID_MISMATCH:"tenant-id-mismatch",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",EMAIL_CHANGE_NEEDS_VERIFICATION:"email-change-needs-verification",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",UNSUPPORTED_FIRST_FACTOR:"unsupported-first-factor",UNVERIFIED_EMAIL:"unverified-email"},Pt(f,a||{}),a=(a=c.match(/^[^\s]+\s*:\s*([\s\S]*)$/))&&1<a.length?a[1]:void 0;for(var v in f)if(c.indexOf(v)===0)return new S(f[v],a);return!a&&i&&(a=Ws(i)),new S("internal-error",a)}function DD(i){this.b=i,this.a=null,this.sb=OD(this)}function OD(i){return UD().then(function(){return new ae(function(a,c){ke("gapi.iframes.getContext")().open({where:document.body,url:i.b,messageHandlersFilter:ke("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(f){function v(){clearTimeout(m),a()}i.a=f,i.a.restyle({setHideOnLeave:!1});var m=setTimeout(function(){c(Error("Network Error"))},FD.get());f.ping(v).then(v,function(){c(Error("Network Error"))})})})})}function PD(i,a){return i.sb.then(function(){return new ae(function(c){i.a.send(a.type,a,c,ke("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}function xD(i,a){i.sb.then(function(){i.a.register("authEvent",a,ke("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}var LD=new Pn(Fu,"https://apis.google.com/js/api.js?onload=%{onload}"),MD=new Ir(3e4,6e4),FD=new Ir(5e3,15e3),wc=null;function UD(){return wc||(wc=new ae(function(i,a){function c(){P_(),ke("gapi.load")("gapi.iframes",{callback:i,ontimeout:function(){P_(),a(Error("Network Error"))},timeout:MD.get()})}if(ke("gapi.iframes.Iframe"))i();else if(ke("gapi.load"))c();else{var f="__iframefcb"+Math.floor(1e6*Math.random()).toString();h[f]=function(){ke("gapi.load")?c():a(Error("Network Error"))},f=uf(LD,{onload:f}),z(gd(f)).o(function(){a(Error("Network Error"))})}}).o(function(i){throw wc=null,i}))}function jw(i,a,c,f){this.l=i,this.h=a,this.i=c,this.g=f,this.f=null,this.g?(i=Mt(this.g.url),i=Qu(i.c,i.a,i.g,"/emulator/auth/iframe")):i=Qu("https",this.l,null,"/__/auth/iframe"),this.a=i,Ue(this.a,"apiKey",this.h),Ue(this.a,"appName",this.i),this.b=null,this.c=[]}jw.prototype.toString=function(){return this.f?Ue(this.a,"v",this.f):xn(this.a.b,"v"),this.b?Ue(this.a,"eid",this.b):xn(this.a.b,"eid"),this.c.length?Ue(this.a,"fw",this.c.join(",")):xn(this.a.b,"fw"),this.a.toString()};function kd(i,a,c,f,v,m){this.u=i,this.s=a,this.c=c,this.m=f,this.v=m,this.i=this.g=this.l=null,this.a=v,this.h=this.f=null}kd.prototype.zb=function(i){return this.h=i,this},kd.prototype.toString=function(){if(this.v){var i=Mt(this.v.url);i=Qu(i.c,i.a,i.g,"/emulator/auth/handler")}else i=Qu("https",this.u,null,"/__/auth/handler");if(Ue(i,"apiKey",this.s),Ue(i,"appName",this.c),Ue(i,"authType",this.m),this.a.isOAuthProvider){var a=this.a;try{var c=J.app(this.c).auth().la()}catch{c=null}a.pb=c,Ue(i,"providerId",this.a.providerId),c=this.a,a=D_(c.Jb);for(var f in a)a[f]=a[f].toString();f=c.Qc,a=yr(a);for(var v=0;v<f.length;v++){var m=f[v];m in a&&delete a[m]}c.qb&&c.pb&&!a[c.qb]&&(a[c.qb]=c.pb),ti(a)||Ue(i,"customParameters",Ws(a))}if(typeof this.a.Rb=="function"&&(c=this.a.Rb(),c.length&&Ue(i,"scopes",c.join(","))),this.l?Ue(i,"redirectUrl",this.l):xn(i.b,"redirectUrl"),this.g?Ue(i,"eventId",this.g):xn(i.b,"eventId"),this.i?Ue(i,"v",this.i):xn(i.b,"v"),this.b)for(var _ in this.b)this.b.hasOwnProperty(_)&&!sn(i,_)&&Ue(i,_,this.b[_]);return this.h?Ue(i,"tid",this.h):xn(i.b,"tid"),this.f?Ue(i,"eid",this.f):xn(i.b,"eid"),_=Nd(this.c),_.length&&Ue(i,"fw",_.join(",")),i.toString()};function Nd(i){try{return J.app(i).auth().Ga()}catch{return[]}}function Bw(i,a,c,f,v,m){this.s=i,this.g=a,this.b=c,this.f=m,this.c=f||null,this.i=v||null,this.l=this.u=this.C=null,this.h=[],this.m=this.a=null}function qw(i){var a=qs();return QR(i).then(function(c){e:{var f=Mt(a),v=f.c;f=f.a;for(var m=0;m<c.length;m++){var _=c[m],I=f,R=v;if(_.indexOf("chrome-extension://")==0?I=Mt(_).a==I&&R=="chrome-extension":R!="http"&&R!="https"?I=!1:YN.test(_)?I=I==_:(_=_.split(".").join("\\."),I=new RegExp("^(.+\\."+_+"|"+_+")$","i").test(I)),I){c=!0;break e}}c=!1}if(!c)throw new sd(qs())})}function Gw(i){return i.m||(i.m=Yu().then(function(){if(!i.u){var a=i.c,c=i.i,f=Nd(i.b),v=new jw(i.s,i.g,i.b,i.f);v.f=a,v.b=c,v.c=ei(f||[]),i.u=v.toString()}i.v=new DD(i.u),VD(i)})),i.m}t=Bw.prototype,t.Pb=function(i,a,c){var f=new S("popup-closed-by-user"),v=new S("web-storage-unsupported"),m=this,_=!1;return this.ma().then(function(){jD(m).then(function(I){I||(i&&ai(i),a(v),_=!0)})}).o(function(){}).then(function(){if(!_)return QN(i)}).then(function(){if(!_)return fo(c).then(function(){a(f)})})},t.Yb=function(){var i=it();return!Gs(i)&&!O_(i)},t.Ub=function(){return!1},t.Nb=function(i,a,c,f,v,m,_,I){if(!i)return Ae(new S("popup-blocked"));if(_&&!Gs())return this.ma().o(function(D){ai(i),v(D)}),f(),z();this.a||(this.a=qw(Ww(this)));var R=this;return this.a.then(function(){var D=R.ma().o(function(Z){throw ai(i),v(Z),Z});return f(),D}).then(function(){if(id(c),!_){var D=sa(R.s,R.g,R.b,a,c,null,m,R.c,void 0,R.i,I,R.f);T_(D,i)}}).o(function(D){throw D.code=="auth/network-request-failed"&&(R.a=null),D})};function Ww(i){return i.l||(i.C=i.c?mo(i.c,Nd(i.b)):null,i.l=new wn(i.g,Os(i.i),i.C),i.f&&_c(i.l,i.f)),i.l}t.Ob=function(i,a,c,f){this.a||(this.a=qw(Ww(this)));var v=this;return this.a.then(function(){id(a);var m=sa(v.s,v.g,v.b,i,a,qs(),c,v.c,void 0,v.i,f,v.f);T_(m)}).o(function(m){throw m.code=="auth/network-request-failed"&&(v.a=null),m})},t.ma=function(){var i=this;return Gw(this).then(function(){return i.v.sb}).o(function(){throw i.a=null,new S("network-request-failed")})},t.ac=function(){return!0};function sa(i,a,c,f,v,m,_,I,R,D,Z,we){return i=new kd(i,a,c,f,v,we),i.l=m,i.g=_,i.i=I,i.b=yr(R||null),i.f=D,i.zb(Z).toString()}function VD(i){if(!i.v)throw Error("IfcHandler must be initialized!");xD(i.v,function(a){var c={};if(a&&a.authEvent){var f=!1;for(a=dw(a.authEvent),c=0;c<i.h.length;c++)f=i.h[c](a)||f;return c={},c.status=f?"ACK":"ERROR",z(c)}return c.status="ERROR",z(c)})}function jD(i){var a={type:"webStorageSupport"};return Gw(i).then(function(){return PD(i.v,a)}).then(function(c){if(c&&c.length&&typeof c[0].webStorageSupport<"u")return c[0].webStorageSupport;throw Error()})}t.Ea=function(i){this.h.push(i)},t.Ta=function(i){gn(this.h,function(a){return a==i})};function Hw(i){if(this.a=i||J.INTERNAL.reactNative&&J.INTERNAL.reactNative.AsyncStorage,!this.a)throw new S("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}t=Hw.prototype,t.get=function(i){return z(this.a.getItem(i)).then(function(a){return a&&_o(a)})},t.set=function(i,a){return z(this.a.setItem(i,Ws(a)))},t.U=function(i){return z(this.a.removeItem(i))},t.ca=function(){},t.ia=function(){};function Kw(i){this.b=i,this.a={},this.f=F(this.c,this)}var zw=[];function BD(){var i=yn()?self:null;if(De(zw,function(c){c.b==i&&(a=c)}),!a){var a=new Kw(i);zw.push(a)}return a}Kw.prototype.c=function(i){var a=i.data.eventType,c=i.data.eventId,f=this.a[a];if(f&&0<f.length){i.ports[0].postMessage({status:"ack",eventId:c,eventType:a,response:null});var v=[];De(f,function(m){v.push(z().then(function(){return m(i.origin,i.data.data)}))}),Xy(v).then(function(m){var _=[];De(m,function(I){_.push({fulfilled:I.Qb,value:I.value,reason:I.reason?I.reason.message:void 0})}),De(_,function(I){for(var R in I)typeof I[R]>"u"&&delete I[R]}),i.ports[0].postMessage({status:"done",eventId:c,eventType:a,response:_})})}};function $w(i,a,c){ti(i.a)&&i.b.addEventListener("message",i.f),typeof i.a[a]>"u"&&(i.a[a]=[]),i.a[a].push(c)}function Qw(i){this.a=i}Qw.prototype.postMessage=function(i,a){this.a.postMessage(i,a)};function Yw(i){this.c=i,this.b=!1,this.a=[]}function Xw(i,a,c,f){var v,m=c||{},_,I,R,D=null;if(i.b)return Ae(Error("connection_unavailable"));var Z=f?800:50,we=typeof MessageChannel<"u"?new MessageChannel:null;return new ae(function(de,Ze){we?(v=Math.floor(Math.random()*Math.pow(10,20)).toString(),we.port1.start(),I=setTimeout(function(){Ze(Error("unsupported_event"))},Z),_=function(ir){ir.data.eventId===v&&(ir.data.status==="ack"?(clearTimeout(I),R=setTimeout(function(){Ze(Error("timeout"))},3e3)):ir.data.status==="done"?(clearTimeout(R),typeof ir.data.response<"u"?de(ir.data.response):Ze(Error("unknown_error"))):(clearTimeout(I),clearTimeout(R),Ze(Error("invalid_response"))))},D={messageChannel:we,onMessage:_},i.a.push(D),we.port1.addEventListener("message",_),i.c.postMessage({eventType:a,eventId:v,data:m},[we.port2])):Ze(Error("connection_unavailable"))}).then(function(de){return Rd(i,D),de}).o(function(de){throw Rd(i,D),de})}function Rd(i,a){if(a){var c=a.messageChannel,f=a.onMessage;c&&(c.port1.removeEventListener("message",f),c.port1.close()),gn(i.a,function(v){return v==a})}}Yw.prototype.close=function(){for(;0<this.a.length;)Rd(this,this.a[0]);this.b=!0};function Jw(){if(!Pd())throw new S("web-storage-unsupported");this.c={},this.a=[],this.b=0,this.m=h.indexedDB,this.type="indexedDB",this.g=this.v=this.f=this.l=null,this.s=!1,this.h=null;var i=this;yn()&&self?(this.v=BD(),$w(this.v,"keyChanged",function(a,c){return tb(i).then(function(f){return 0<f.length&&De(i.a,function(v){v(f)}),{keyProcessed:Zn(f,c.key)}})}),$w(this.v,"ping",function(){return z(["keyChanged"])})):nR().then(function(a){(i.h=a)&&(i.g=new Yw(new Qw(a)),Xw(i.g,"ping",null,!0).then(function(c){c[0].fulfilled&&Zn(c[0].value,"keyChanged")&&(i.s=!0)}).o(function(){}))})}var Dd;function qD(i){return new ae(function(a,c){var f=i.m.deleteDatabase("firebaseLocalStorageDb");f.onsuccess=function(){a()},f.onerror=function(v){c(Error(v.target.error))}})}function Zw(i){return new ae(function(a,c){var f=i.m.open("firebaseLocalStorageDb",1);f.onerror=function(v){try{v.preventDefault()}catch{}c(Error(v.target.error))},f.onupgradeneeded=function(v){v=v.target.result;try{v.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(m){c(m)}},f.onsuccess=function(v){v=v.target.result,v.objectStoreNames.contains("firebaseLocalStorage")?a(v):qD(i).then(function(){return Zw(i)}).then(function(m){a(m)}).o(function(m){c(m)})}})}function Od(i){return i.i||(i.i=Zw(i)),i.i}function bc(i,a){function c(v,m){Od(i).then(a).then(v).o(function(_){if(3<++f)m(_);else return Od(i).then(function(I){return I.close(),i.i=void 0,c(v,m)}).o(function(I){m(I)})})}var f=0;return new ae(c)}function Pd(){try{return!!h.indexedDB}catch{return!1}}function aa(i){return i.objectStore("firebaseLocalStorage")}function ua(i,a){return i.transaction(["firebaseLocalStorage"],a?"readwrite":"readonly")}function Eo(i){return new ae(function(a,c){i.onsuccess=function(f){f&&f.target?a(f.target.result):a()},i.onerror=function(f){c(f.target.error)}})}t=Jw.prototype,t.set=function(i,a){var c=this,f=!1;return bc(this,function(v){return v=aa(ua(v,!0)),Eo(v.get(i))}).then(function(v){return bc(c,function(m){if(m=aa(ua(m,!0)),v)return v.value=a,Eo(m.put(v));c.b++,f=!0;var _={};return _.fbase_key=i,_.value=a,Eo(m.add(_))})}).then(function(){return c.c[i]=a,eb(c,i)}).oa(function(){f&&c.b--})};function eb(i,a){return i.g&&i.h&&tR()===i.h?Xw(i.g,"keyChanged",{key:a},i.s).then(function(){}).o(function(){}):z()}t.get=function(i){return bc(this,function(a){return Eo(aa(ua(a,!1)).get(i))}).then(function(a){return a&&a.value})},t.U=function(i){var a=this,c=!1;return bc(this,function(f){return c=!0,a.b++,Eo(aa(ua(f,!0)).delete(i))}).then(function(){return delete a.c[i],eb(a,i)}).oa(function(){c&&a.b--})};function tb(i){return Od(i).then(function(a){var c=aa(ua(a,!1));return c.getAll?Eo(c.getAll()):new ae(function(f,v){var m=[],_=c.openCursor();_.onsuccess=function(I){(I=I.target.result)?(m.push(I.value),I.continue()):f(m)},_.onerror=function(I){v(I.target.error)}})}).then(function(a){var c={},f=[];if(i.b==0){for(f=0;f<a.length;f++)c[a[f].fbase_key]=a[f].value;f=S_(i.c,c),i.c=c}return f})}t.ca=function(i){this.a.length==0&&GD(this),this.a.push(i)},t.ia=function(i){gn(this.a,function(a){return a==i}),this.a.length==0&&nb(this)};function GD(i){function a(){i.f=setTimeout(function(){i.l=tb(i).then(function(c){0<c.length&&De(i.a,function(f){f(c)})}).then(function(){a()}).o(function(c){c.message!="STOP_EVENT"&&a()})},800)}nb(i),a()}function nb(i){i.l&&i.l.cancel("STOP_EVENT"),i.f&&(clearTimeout(i.f),i.f=null)}function rb(i){var a=this,c=null;this.a=[],this.type="indexedDB",this.c=i,this.b=z().then(function(){if(Pd()){var f=ci(),v="__sak"+f;return Dd||(Dd=new Jw),c=Dd,c.set(v,f).then(function(){return c.get(v)}).then(function(m){if(m!==f)throw Error("indexedDB not supported!");return c.U(v)}).then(function(){return c}).o(function(){return a.c})}return a.c}).then(function(f){return a.type=f.type,f.ca(function(v){De(a.a,function(m){m(v)})}),f})}t=rb.prototype,t.get=function(i){return this.b.then(function(a){return a.get(i)})},t.set=function(i,a){return this.b.then(function(c){return c.set(i,a)})},t.U=function(i){return this.b.then(function(a){return a.U(i)})},t.ca=function(i){this.a.push(i)},t.ia=function(i){gn(this.a,function(a){return a==i})};function ca(){this.a={},this.type="inMemory"}t=ca.prototype,t.get=function(i){return z(this.a[i])},t.set=function(i,a){return this.a[i]=a,z()},t.U=function(i){return delete this.a[i],z()},t.ca=function(){},t.ia=function(){};function Ic(){if(!WD())throw Ln()=="Node"?new S("internal-error","The LocalStorage compatibility library was not found."):new S("web-storage-unsupported");this.a=ib()||J.INTERNAL.node.localStorage,this.type="localStorage"}function ib(){try{var i=h.localStorage,a=ci();return i&&(i.setItem(a,"1"),i.removeItem(a)),i}catch{return null}}function WD(){var i=Ln()=="Node";if(i=ib()||i&&J.INTERNAL.node&&J.INTERNAL.node.localStorage,!i)return!1;try{return i.setItem("__sak","1"),i.removeItem("__sak"),!0}catch{return!1}}t=Ic.prototype,t.get=function(i){var a=this;return z().then(function(){var c=a.a.getItem(i);return _o(c)})},t.set=function(i,a){var c=this;return z().then(function(){var f=Ws(a);f===null?c.U(i):c.a.setItem(i,f)})},t.U=function(i){var a=this;return z().then(function(){a.a.removeItem(i)})},t.ca=function(i){h.window&&on(h.window,"storage",i)},t.ia=function(i){h.window&&Kt(h.window,"storage",i)};function xd(){this.type="nullStorage"}t=xd.prototype,t.get=function(){return z(null)},t.set=function(){return z()},t.U=function(){return z()},t.ca=function(){},t.ia=function(){};function Ld(){if(!HD())throw Ln()=="Node"?new S("internal-error","The SessionStorage compatibility library was not found."):new S("web-storage-unsupported");this.a=ob()||J.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function ob(){try{var i=h.sessionStorage,a=ci();return i&&(i.setItem(a,"1"),i.removeItem(a)),i}catch{return null}}function HD(){var i=Ln()=="Node";if(i=ob()||i&&J.INTERNAL.node&&J.INTERNAL.node.sessionStorage,!i)return!1;try{return i.setItem("__sak","1"),i.removeItem("__sak"),!0}catch{return!1}}t=Ld.prototype,t.get=function(i){var a=this;return z().then(function(){var c=a.a.getItem(i);return _o(c)})},t.set=function(i,a){var c=this;return z().then(function(){var f=Ws(a);f===null?c.U(i):c.a.setItem(i,f)})},t.U=function(i){var a=this;return z().then(function(){a.a.removeItem(i)})},t.ca=function(){},t.ia=function(){};function KD(){var i={};i.Browser=zD,i.Node=$D,i.ReactNative=QD,i.Worker=YD,this.a=i[Ln()]}var Md,zD={F:Ic,cb:Ld},$D={F:Ic,cb:Ld},QD={F:Hw,cb:xd},YD={F:Ic,cb:xd},To={rd:"local",NONE:"none",td:"session"};function XD(i){var a=new S("invalid-persistence-type"),c=new S("unsupported-persistence-type");e:{for(f in To)if(To[f]==i){var f=!0;break e}f=!1}if(!f||typeof i!="string")throw a;switch(Ln()){case"ReactNative":if(i==="session")throw c;break;case"Node":if(i!=="none")throw c;break;case"Worker":if(i==="session"||!Pd()&&i!=="none")throw c;break;default:if(!Mf()&&i!=="none")throw c}}function sb(){var i=!!(!O_(it())&&xf()),a=Gs(),c=Mf();this.m=i,this.h=a,this.l=c,this.a={},Md||(Md=new KD),i=Md;try{this.g=!Of()&&x_()||!h.indexedDB?new i.a.F:new rb(yn()?new ca:new i.a.F)}catch{this.g=new ca,this.h=!0}try{this.i=new i.a.cb}catch{this.i=new ca}this.v=new ca,this.f=F(this.Zb,this),this.b={}}var Fd;function la(){return Fd||(Fd=new sb),Fd}function mi(i,a){switch(a){case"session":return i.i;case"none":return i.v;default:return i.g}}function So(i,a){return"firebase:"+i.name+(a?":"+a:"")}function JD(i,a,c){var f=So(a,c),v=mi(i,a.F);return i.get(a,c).then(function(m){var _=null;try{_=_o(h.localStorage.getItem(f))}catch{}if(_&&!m)return h.localStorage.removeItem(f),i.set(a,_,c);_&&m&&v.type!="localStorage"&&h.localStorage.removeItem(f)})}t=sb.prototype,t.get=function(i,a){return mi(this,i.F).get(So(i,a))};function Co(i,a,c){return c=So(a,c),a.F=="local"&&(i.b[c]=null),mi(i,a.F).U(c)}t.set=function(i,a,c){var f=So(i,c),v=this,m=mi(this,i.F);return m.set(f,a).then(function(){return m.get(f)}).then(function(_){i.F=="local"&&(v.b[f]=_)})},t.addListener=function(i,a,c){i=So(i,a),this.l&&(this.b[i]=h.localStorage.getItem(i)),ti(this.a)&&(mi(this,"local").ca(this.f),this.h||(Of()||!x_())&&h.indexedDB||!this.l||ZD(this)),this.a[i]||(this.a[i]=[]),this.a[i].push(c)},t.removeListener=function(i,a,c){i=So(i,a),this.a[i]&&(gn(this.a[i],function(f){return f==c}),this.a[i].length==0&&delete this.a[i]),ti(this.a)&&(mi(this,"local").ia(this.f),Ud(this))};function ZD(i){Ud(i),i.c=setInterval(function(){for(var a in i.a){var c=h.localStorage.getItem(a),f=i.b[a];c!=f&&(i.b[a]=c,c=new ii({type:"storage",key:a,target:window,oldValue:f,newValue:c,a:!0}),i.Zb(c))}},1e3)}function Ud(i){i.c&&(clearInterval(i.c),i.c=null)}t.Zb=function(i){if(i&&i.g){var a=i.a.key;if(a==null)for(var c in this.a){var f=this.b[c];typeof f>"u"&&(f=null);var v=h.localStorage.getItem(c);v!==f&&(this.b[c]=v,this.nb(c))}else if(a.indexOf("firebase:")==0&&this.a[a]){if(typeof i.a.a<"u"?mi(this,"local").ia(this.f):Ud(this),this.m){if(c=h.localStorage.getItem(a),f=i.a.newValue,f!==c)f!==null?h.localStorage.setItem(a,f):h.localStorage.removeItem(a);else if(this.b[a]===f&&typeof i.a.a>"u")return}var m=this;c=function(){(typeof i.a.a<"u"||m.b[a]!==h.localStorage.getItem(a))&&(m.b[a]=h.localStorage.getItem(a),m.nb(a))},mn&&_r&&_r==10&&h.localStorage.getItem(a)!==i.a.newValue&&i.a.newValue!==i.a.oldValue?setTimeout(c,10):c()}}else De(i,F(this.nb,this))},t.nb=function(i){this.a[i]&&De(this.a[i],function(a){a()})};function e1(i){this.a=i,this.b=la()}var Vd={name:"authEvent",F:"local"};function t1(i){return i.b.get(Vd,i.a).then(function(a){return dw(a)})}function n1(){this.a=la()}function r1(){this.b=-1}function Ec(i,a){this.b=ab,this.f=h.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.i=i,this.h=a,this.l=h.Int32Array?new Int32Array(64):Array(64),Tc===void 0&&(h.Int32Array?Tc=new Int32Array(lb):Tc=lb),this.reset()}var Tc;$(Ec,r1);for(var ab=64,i1=ab-1,ub=[],jd=0;jd<i1;jd++)ub[jd]=0;var cb=of(128,ub);Ec.prototype.reset=function(){this.g=this.c=0,this.a=h.Int32Array?new Int32Array(this.h):ei(this.h)};function Bd(i){for(var a=i.f,c=i.l,f=0,v=0;v<a.length;)c[f++]=a[v]<<24|a[v+1]<<16|a[v+2]<<8|a[v+3],v=4*f;for(a=16;64>a;a++){v=c[a-15]|0,f=c[a-2]|0;var m=(c[a-16]|0)+((v>>>7|v<<25)^(v>>>18|v<<14)^v>>>3)|0,_=(c[a-7]|0)+((f>>>17|f<<15)^(f>>>19|f<<13)^f>>>10)|0;c[a]=m+_|0}f=i.a[0]|0,v=i.a[1]|0;var I=i.a[2]|0,R=i.a[3]|0,D=i.a[4]|0,Z=i.a[5]|0,we=i.a[6]|0;for(m=i.a[7]|0,a=0;64>a;a++){var de=((f>>>2|f<<30)^(f>>>13|f<<19)^(f>>>22|f<<10))+(f&v^f&I^v&I)|0;_=D&Z^~D&we,m=m+((D>>>6|D<<26)^(D>>>11|D<<21)^(D>>>25|D<<7))|0,_=_+(Tc[a]|0)|0,_=m+(_+(c[a]|0)|0)|0,m=we,we=Z,Z=D,D=R+_|0,R=I,I=v,v=f,f=_+de|0}i.a[0]=i.a[0]+f|0,i.a[1]=i.a[1]+v|0,i.a[2]=i.a[2]+I|0,i.a[3]=i.a[3]+R|0,i.a[4]=i.a[4]+D|0,i.a[5]=i.a[5]+Z|0,i.a[6]=i.a[6]+we|0,i.a[7]=i.a[7]+m|0}function qd(i,a,c){c===void 0&&(c=a.length);var f=0,v=i.c;if(typeof a=="string")for(;f<c;)i.f[v++]=a.charCodeAt(f++),v==i.b&&(Bd(i),v=0);else if(b(a))for(;f<c;){var m=a[f++];if(!(typeof m=="number"&&0<=m&&255>=m&&m==(m|0)))throw Error("message must be a byte array");i.f[v++]=m,v==i.b&&(Bd(i),v=0)}else throw Error("message must be string or array");i.c=v,i.g+=c}var lb=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function hb(){Ec.call(this,8,o1)}$(hb,Ec);var o1=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];function fb(i,a,c,f,v,m){this.v=i,this.i=a,this.l=c,this.m=f||null,this.u=v||null,this.s=m,this.h=a+":"+c,this.C=new n1,this.g=new e1(this.h),this.f=null,this.b=[],this.a=this.c=null}function Sc(i){return new S("invalid-cordova-configuration",i)}t=fb.prototype,t.ma=function(){return this.Ia?this.Ia:this.Ia=JN().then(function(){if(typeof ke("universalLinks.subscribe",h)!="function")throw Sc("cordova-universal-links-plugin-fix is not installed");if(typeof ke("BuildInfo.packageName",h)>"u")throw Sc("cordova-plugin-buildinfo is not installed");if(typeof ke("cordova.plugins.browsertab.openUrl",h)!="function")throw Sc("cordova-plugin-browsertab is not installed");if(typeof ke("cordova.InAppBrowser.open",h)!="function")throw Sc("cordova-plugin-inappbrowser is not installed")},function(){throw new S("cordova-not-ready")})};function s1(){for(var i=20,a=[];0<i;)a.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),i--;return a.join("")}function a1(i){var a=new hb;qd(a,i),i=[];var c=8*a.g;56>a.c?qd(a,cb,56-a.c):qd(a,cb,a.b-(a.c-56));for(var f=63;56<=f;f--)a.f[f]=c&255,c/=256;for(Bd(a),f=c=0;f<a.i;f++)for(var v=24;0<=v;v-=8)i[c++]=a.a[f]>>v&255;return yR(i)}t.Pb=function(i,a){return a(new S("operation-not-supported-in-this-environment")),z()},t.Nb=function(){return Ae(new S("operation-not-supported-in-this-environment"))},t.ac=function(){return!1},t.Yb=function(){return!0},t.Ub=function(){return!0},t.Ob=function(i,a,c,f){if(this.c)return Ae(new S("redirect-operation-pending"));var v=this,m=h.document,_=null,I=null,R=null,D=null;return this.c=z().then(function(){return id(a),pb(v)}).then(function(){return u1(v,i,a,c,f)}).then(function(){return new ae(function(Z,we){I=function(){var de=ke("cordova.plugins.browsertab.close",h);return Z(),typeof de=="function"&&de(),v.a&&typeof v.a.close=="function"&&(v.a.close(),v.a=null),!1},v.Ea(I),R=function(){_||(_=fo(2e3).then(function(){we(new S("redirect-cancelled-by-user"))}))},D=function(){Ff()&&R()},m.addEventListener("resume",R,!1),it().toLowerCase().match(/android/)||m.addEventListener("visibilitychange",D,!1)}).o(function(Z){return Gd(v).then(function(){throw Z})})}).oa(function(){R&&m.removeEventListener("resume",R,!1),D&&m.removeEventListener("visibilitychange",D,!1),_&&_.cancel(),I&&v.Ta(I),v.c=null})};function u1(i,a,c,f,v){var m=s1(),_=new _n(a,f,null,m,new S("no-auth-event"),null,v),I=ke("BuildInfo.packageName",h);if(typeof I!="string")throw new S("invalid-cordova-configuration");var R=ke("BuildInfo.displayName",h),D={};if(it().toLowerCase().match(/iphone|ipad|ipod/))D.ibi=I;else if(it().toLowerCase().match(/android/))D.apn=I;else return Ae(new S("operation-not-supported-in-this-environment"));R&&(D.appDisplayName=R),m=a1(m),D.sessionId=m;var Z=sa(i.v,i.i,i.l,a,c,null,f,i.m,D,i.u,v,i.s);return i.ma().then(function(){var we=i.h;return i.C.a.set(Vd,_.w(),we)}).then(function(){var we=ke("cordova.plugins.browsertab.isAvailable",h);if(typeof we!="function")throw new S("invalid-cordova-configuration");var de=null;we(function(Ze){if(Ze){if(de=ke("cordova.plugins.browsertab.openUrl",h),typeof de!="function")throw new S("invalid-cordova-configuration");de(Z)}else{if(de=ke("cordova.InAppBrowser.open",h),typeof de!="function")throw new S("invalid-cordova-configuration");Ze=it(),i.a=de(Z,Ze.match(/(iPad|iPhone|iPod).*OS 7_\d/i)||Ze.match(/(iPad|iPhone|iPod).*OS 8_\d/i)?"_blank":"_system","location=yes")}})})}function db(i,a){for(var c=0;c<i.b.length;c++)try{i.b[c](a)}catch{}}function pb(i){return i.f||(i.f=i.ma().then(function(){return new ae(function(a){function c(f){return a(f),i.Ta(c),!1}i.Ea(c),c1(i)})})),i.f}function Gd(i){var a=null;return t1(i.g).then(function(c){return a=c,c=i.g,Co(c.b,Vd,c.a)}).then(function(){return a})}function c1(i){function a(_){f=!0,v&&v.cancel(),Gd(i).then(function(I){var R=c;if(I&&_&&_.url){var D=null;R=ow(_.url),R.indexOf("/__/auth/callback")!=-1&&(D=Mt(R),D=_o(sn(D,"firebaseError")||null),D=(D=typeof D=="object"?Rs(D):null)?new _n(I.c,I.b,null,null,D,null,I.T()):new _n(I.c,I.b,R,I.f,null,null,I.T())),R=D||c}db(i,R)})}var c=new _n("unknown",null,null,null,new S("no-auth-event")),f=!1,v=fo(500).then(function(){return Gd(i).then(function(){f||db(i,c)})}),m=h.handleOpenURL;h.handleOpenURL=function(_){if(_.toLowerCase().indexOf(ke("BuildInfo.packageName",h).toLowerCase()+"://")==0&&a({url:_}),typeof m=="function")try{m(_)}catch(I){console.error(I)}},od||(od=new CR),AR(a)}t.Ea=function(i){this.b.push(i),pb(this).o(function(a){a.code==="auth/invalid-cordova-configuration"&&(a=new _n("unknown",null,null,null,new S("no-auth-event")),i(a))})},t.Ta=function(i){gn(this.b,function(a){return a==i})};function l1(i){this.a=i,this.b=la()}var Wd={name:"pendingRedirect",F:"session"};function h1(i){return i.b.set(Wd,"pending",i.a)}function Hd(i){return Co(i.b,Wd,i.a)}function f1(i){return i.b.get(Wd,i.a).then(function(a){return a=="pending"})}function Cc(i,a,c,f){this.i={},this.u=0,this.D=i,this.v=a,this.m=c,this.J=f,this.h=[],this.f=!1,this.l=F(this.s,this),this.b=new kc,this.C=new Tb,this.g=new l1(bb(this.v,this.m)),this.c={},this.c.unknown=this.b,this.c.signInViaRedirect=this.b,this.c.linkViaRedirect=this.b,this.c.reauthViaRedirect=this.b,this.c.signInViaPopup=this.C,this.c.linkViaPopup=this.C,this.c.reauthViaPopup=this.C,this.a=vb(this.D,this.v,this.m,Ps,this.J)}function vb(i,a,c,f,v){var m=J.SDK_VERSION||null;return Pf()?new fb(i,a,c,m,f,v):new Bw(i,a,c,m,f,v)}Cc.prototype.reset=function(){this.f=!1,this.a.Ta(this.l),this.a=vb(this.D,this.v,this.m,null,this.J),this.i={}};function gb(i){i.f||(i.f=!0,i.a.Ea(i.l));var a=i.a;return i.a.ma().o(function(c){throw i.a==a&&i.reset(),c})}function mb(i){i.a.Yb()&&gb(i).o(function(a){var c=new _n("unknown",null,null,null,new S("operation-not-supported-in-this-environment"));zd(a)&&i.s(c)}),i.a.Ub()||Ib(i.b)}function Ac(i,a){Zn(i.h,a)||i.h.push(a),i.f||f1(i.g).then(function(c){c?Hd(i.g).then(function(){gb(i).o(function(f){var v=new _n("unknown",null,null,null,new S("operation-not-supported-in-this-environment"));zd(f)&&i.s(v)})}):mb(i)}).o(function(){mb(i)})}function Kd(i,a){gn(i.h,function(c){return c==a})}Cc.prototype.s=function(i){if(!i)throw new S("invalid-auth-event");if(6e5<=Date.now()-this.u&&(this.i={},this.u=0),i&&i.getUid()&&this.i.hasOwnProperty(i.getUid()))return!1;for(var a=!1,c=0;c<this.h.length;c++){var f=this.h[c];if(f.Gb(i.c,i.b)){(a=this.c[i.c])&&(a.h(i,f),i&&(i.f||i.b)&&(this.i[i.getUid()]=!0,this.u=Date.now())),a=!0;break}}return Ib(this.b),a};var d1=new Ir(2e3,1e4),p1=new Ir(3e4,6e4);Cc.prototype.ra=function(){return this.b.ra()};function yb(i,a,c,f,v,m,_){return i.a.Nb(a,c,f,function(){i.f||(i.f=!0,i.a.Ea(i.l))},function(){i.reset()},v,m,_)}function zd(i){return!!(i&&i.code=="auth/cordova-not-ready")}function _b(i,a,c,f,v){var m;return h1(i.g).then(function(){return i.a.Ob(a,c,f,v).o(function(_){if(zd(_))throw new S("operation-not-supported-in-this-environment");return m=_,Hd(i.g).then(function(){throw m})}).then(function(){return i.a.ac()?new ae(function(){}):Hd(i.g).then(function(){return i.ra()}).then(function(){}).o(function(){})})})}function wb(i,a,c,f,v){return i.a.Pb(f,function(m){a.na(c,null,m,v)},d1.get())}var $d={};function bb(i,a,c){return i=i+":"+a,c&&(i=i+":"+c.url),i}function Qd(i,a,c,f){var v=bb(a,c,f);return $d[v]||($d[v]=new Cc(i,a,c,f)),$d[v]}function kc(){this.b=null,this.f=[],this.c=[],this.a=null,this.i=this.g=!1}kc.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},kc.prototype.h=function(i,a){if(i){this.reset(),this.g=!0;var c=i.c,f=i.b,v=i.a&&i.a.code=="auth/web-storage-unsupported",m=i.a&&i.a.code=="auth/operation-not-supported-in-this-environment";this.i=!(!v&&!m),c!="unknown"||v||m?i.a?(yi(this,!0,null,i.a),z()):a.Fa(c,f)?v1(this,i,a):Ae(new S("invalid-auth-event")):(yi(this,!1,null,null),z())}else Ae(new S("invalid-auth-event"))};function Ib(i){i.g||(i.g=!0,yi(i,!1,null,null))}function Nc(i){i.g&&!i.i&&yi(i,!1,null,null)}function v1(i,a,c){c=c.Fa(a.c,a.b);var f=a.g,v=a.f,m=a.i,_=a.T(),I=!!a.c.match(/Redirect$/);c(f,v,_,m).then(function(R){yi(i,I,R,null)}).o(function(R){yi(i,I,null,R)})}function g1(i,a){if(i.b=function(){return Ae(a)},i.c.length)for(var c=0;c<i.c.length;c++)i.c[c](a)}function Eb(i,a){if(i.b=function(){return z(a)},i.f.length)for(var c=0;c<i.f.length;c++)i.f[c](a)}function yi(i,a,c,f){a?f?g1(i,f):Eb(i,c):Eb(i,{user:null}),i.f=[],i.c=[]}kc.prototype.ra=function(){var i=this;return new ae(function(a,c){i.b?i.b().then(a,c):(i.f.push(a),i.c.push(c),m1(i))})};function m1(i){var a=new S("timeout");i.a&&i.a.cancel(),i.a=fo(p1.get()).then(function(){i.b||(i.g=!0,yi(i,!0,null,a))})}function Tb(){}Tb.prototype.h=function(i,a){if(i){var c=i.c,f=i.b;i.a?(a.na(i.c,null,i.a,i.b),z()):a.Fa(c,f)?y1(i,a):Ae(new S("invalid-auth-event"))}else Ae(new S("invalid-auth-event"))};function y1(i,a){var c=i.b,f=i.c;a.Fa(f,c)(i.g,i.f,i.T(),i.i).then(function(v){a.na(f,v,null,c)}).o(function(v){a.na(f,null,v,c)})}function Sb(){this.jb=!1,Object.defineProperty(this,"appVerificationDisabled",{get:function(){return this.jb},set:function(i){this.jb=i},enumerable:!1})}function Yd(i,a){this.a=a,G(this,"verificationId",i)}Yd.prototype.confirm=function(i){return i=fw(this.verificationId,i),this.a(i)};function Xd(i,a,c,f){return new nr(i).gb(a,c).then(function(v){return new Yd(v,f)})}function _1(i){var a=X_(i);if(!(a&&a.exp&&a.auth_time&&a.iat))throw new S("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");Et(this,{token:i,expirationTime:Hs(1e3*a.exp),authTime:Hs(1e3*a.auth_time),issuedAtTime:Hs(1e3*a.iat),signInProvider:a.firebase&&a.firebase.sign_in_provider?a.firebase.sign_in_provider:null,signInSecondFactor:a.firebase&&a.firebase.sign_in_second_factor?a.firebase.sign_in_second_factor:null,claims:a})}function Jd(i,a,c){var f=a&&a[Ab];if(!f)throw new S("argument-error","Internal assert: Invalid MultiFactorResolver");this.a=i,this.f=yr(a),this.g=c,this.c=new ic(null,f),this.b=[];var v=this;De(a[Cb]||[],function(m){(m=Gf(m))&&v.b.push(m)}),G(this,"auth",this.a),G(this,"session",this.c),G(this,"hints",this.b)}var Cb="mfaInfo",Ab="mfaPendingCredential";Jd.prototype.Rc=function(i){var a=this;return i.tb(this.a.a,this.c).then(function(c){var f=yr(a.f);return delete f[Cb],delete f[Ab],Pt(f,c),a.g(f)})};function Zd(i,a,c,f){S.call(this,"multi-factor-auth-required",f,a),this.b=new Jd(i,a,c),G(this,"resolver",this.b)}$(Zd,S);function kb(i,a,c){if(i&&T(i.serverResponse)&&i.code==="auth/multi-factor-auth-required")try{return new Zd(a,i.serverResponse,c,i.message)}catch{}return null}function Nb(){}Nb.prototype.tb=function(i,a,c){return a.type==Qs?w1(this,i,a,c):b1(this,i,a)};function w1(i,a,c,f){return c.Ha().then(function(v){return v={idToken:v},typeof f<"u"&&(v.displayName=f),Pt(v,{phoneVerificationInfo:Ys(i.a)}),ue(a,cD,v)})}function b1(i,a,c){return c.Ha().then(function(f){return f={mfaPendingCredential:f},Pt(f,{phoneVerificationInfo:Ys(i.a)}),ue(a,lD,f)})}function ep(i){G(this,"factorId",i.fa),this.a=i}$(ep,Nb);function Rb(i){if(ep.call(this,i),this.a.fa!=nr.PROVIDER_ID)throw new S("argument-error","firebase.auth.PhoneMultiFactorAssertion requires a valid firebase.auth.PhoneAuthCredential")}$(Rb,ep);function Ao(i,a){Lt.call(this,i);for(var c in a)this[c]=a[c]}$(Ao,Lt);function tp(i,a){this.a=i,this.b=[],this.c=F(this.yc,this),on(this.a,"userReloaded",this.c);var c=[];a&&a.multiFactor&&a.multiFactor.enrolledFactors&&De(a.multiFactor.enrolledFactors,function(f){var v=null,m={};if(f){f.uid&&(m[Hf]=f.uid),f.displayName&&(m[M_]=f.displayName),f.enrollmentTime&&(m[Wf]=new Date(f.enrollmentTime).toISOString()),f.phoneNumber&&(m[Kf]=f.phoneNumber);try{v=new Ks(m)}catch{}f=v}else f=null;f&&c.push(f)}),Rc(this,c)}function I1(i){var a=[];return De(i.mfaInfo||[],function(c){(c=Gf(c))&&a.push(c)}),a}t=tp.prototype,t.yc=function(i){Rc(this,I1(i.hd))};function Rc(i,a){i.b=a,G(i,"enrolledFactors",a)}t.Sb=function(){return this.a.I().then(function(i){return new ic(i,null)})},t.fc=function(i,a){var c=this,f=this.a.a;return this.Sb().then(function(v){return i.tb(f,v,a)}).then(function(v){return Un(c.a,v),c.a.reload()})},t.bd=function(i){var a=this,c=typeof i=="string"?i:i.uid,f=this.a.a;return this.a.I().then(function(v){return ue(f,RD,{idToken:v,mfaEnrollmentId:c})}).then(function(v){var m=Zk(a.b,function(_){return _.uid!=c});return Rc(a,m),Un(a.a,v),a.a.reload().o(function(_){if(_.code!="auth/user-token-expired")throw _})})},t.w=function(){return{multiFactor:{enrolledFactors:Lu(this.b,function(i){return i.w()})}}};function np(i,a,c){if(this.h=i,this.i=a,this.g=c,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}np.prototype.start=function(){this.a=this.c,rp(this,!0)};function E1(i,a){return a?(i.a=i.c,i.g()):(a=i.a,i.a*=2,i.a>i.f&&(i.a=i.f),a)}function rp(i,a){i.stop(),i.b=fo(E1(i,a)).then(function(){return eR()}).then(function(){return i.h()}).then(function(){rp(i,!0)}).o(function(c){i.i(c)&&rp(i,!1)})}np.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)};function ip(i){this.f=i,this.b=this.a=null,this.c=Date.now()}ip.prototype.w=function(){return{apiKey:this.f.c,refreshToken:this.a,accessToken:this.b&&this.b.toString(),expirationTime:this.c}};function Db(i,a){typeof a>"u"&&(i.b?(a=i.b,a=a.a-a.g):a=0),i.c=Date.now()+1e3*a}function Ob(i,a){i.b=nc(a[bn]||""),i.a=a.refreshToken,a=a.expiresIn,Db(i,typeof a<"u"?Number(a):void 0)}function T1(i,a){i.b=a.b,i.a=a.a,i.c=a.c}function S1(i,a){return zR(i.f,a).then(function(c){return i.b=nc(c.access_token),i.a=c.refresh_token,Db(i,c.expires_in),{accessToken:i.b.toString(),refreshToken:i.a}}).o(function(c){throw c.code=="auth/user-token-expired"&&(i.a=null),c})}ip.prototype.getToken=function(i){return i=!!i,this.b&&!this.a?Ae(new S("user-token-expired")):i||!this.b||Date.now()>this.c-3e4?this.a?S1(this,{grant_type:"refresh_token",refresh_token:this.a}):z(null):z({accessToken:this.b.toString(),refreshToken:this.a})};function Dc(i,a){this.a=i||null,this.b=a||null,Et(this,{lastSignInTime:Hs(a||null),creationTime:Hs(i||null)})}function C1(i){return new Dc(i.a,i.b)}Dc.prototype.w=function(){return{lastLoginAt:this.b,createdAt:this.a}};function A1(i,a,c,f,v,m){Et(this,{uid:i,displayName:f||null,photoURL:v||null,email:c||null,phoneNumber:m||null,providerId:a})}function $t(i,a,c){this.N=[],this.l=i.apiKey,this.m=i.appName,this.s=i.authDomain||null;var f=J.SDK_VERSION?mo(J.SDK_VERSION):null;this.a=new wn(this.l,Os(Ps),f),(this.u=i.emulatorConfig||null)&&_c(this.a,this.u),this.h=new ip(this.a),hp(this,a[bn]),Ob(this.h,a),G(this,"refreshToken",this.h.a),xb(this,c||{}),It.call(this),this.P=!1,this.s&&ui()&&(this.b=Qd(this.s,this.l,this.m,this.u)),this.W=[],this.i=null,this.D=k1(this),this.ba=F(this.ib,this);var v=this;this.za=null,this.Pa=function(m){v.xa(m.h)},this.qa=null,this.Ba=function(m){op(v,m.c)},this.$=null,this.aa=[],this.Oa=function(m){ha(v,m.f)},this.ja=null,this.S=new tp(this,c),G(this,"multiFactor",this.S)}$($t,It),$t.prototype.xa=function(i){this.za=i,kw(this.a,i)};function op(i,a){i.u=a,_c(i.a,a),i.b&&(a=i.b,i.b=Qd(i.s,i.l,i.m,i.u),i.P&&(Kd(a,i),Ac(i.b,i)))}$t.prototype.la=function(){return this.za};function sp(i,a){i.qa&&Kt(i.qa,"languageCodeChanged",i.Pa),(i.qa=a)&&on(a,"languageCodeChanged",i.Pa)}function ap(i,a){i.$&&Kt(i.$,"emulatorConfigChanged",i.Ba),(i.$=a)&&on(a,"emulatorConfigChanged",i.Ba)}function ha(i,a){i.aa=a,Nw(i.a,J.SDK_VERSION?mo(J.SDK_VERSION,i.aa):null)}$t.prototype.Ga=function(){return ei(this.aa)};function up(i,a){i.ja&&Kt(i.ja,"frameworkChanged",i.Oa),(i.ja=a)&&on(a,"frameworkChanged",i.Oa)}$t.prototype.ib=function(){this.D.b&&(this.D.stop(),this.D.start())};function cp(i){try{return J.app(i.m).auth()}catch{throw new S("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+i.m+"'!")}}function k1(i){return new np(function(){return i.I(!0)},function(a){return!!(a&&a.code=="auth/network-request-failed")},function(){var a=i.h.c-Date.now()-3e5;return 0<a?a:0})}function Pb(i){i.J||i.D.b||(i.D.start(),Kt(i,"tokenChanged",i.ba),on(i,"tokenChanged",i.ba))}function lp(i){Kt(i,"tokenChanged",i.ba),i.D.stop()}function hp(i,a){i.Aa=a,G(i,"_lat",a)}function N1(i,a){gn(i.W,function(c){return c==a})}function _i(i){for(var a=[],c=0;c<i.W.length;c++)a.push(i.W[c](i));return Xy(a).then(function(){return i})}function fa(i){i.b&&!i.P&&(i.P=!0,Ac(i.b,i))}function xb(i,a){Et(i,{uid:a.uid,displayName:a.displayName||null,photoURL:a.photoURL||null,email:a.email||null,emailVerified:a.emailVerified||!1,phoneNumber:a.phoneNumber||null,isAnonymous:a.isAnonymous||!1,tenantId:a.tenantId||null,metadata:new Dc(a.createdAt,a.lastLoginAt),providerData:[]}),i.a.b=i.tenantId}G($t.prototype,"providerId","firebase");function Lb(){}function fp(i){return z().then(function(){if(i.J)throw new S("app-deleted")})}function dp(i){return Lu(i.providerData,function(a){return a.providerId})}function pp(i,a){a&&(Mb(i,a.providerId),i.providerData.push(a))}function Mb(i,a){gn(i.providerData,function(c){return c.providerId==a})}function Sr(i,a,c){(a!="uid"||c)&&i.hasOwnProperty(a)&&G(i,a,c)}function Oc(i,a){i!=a&&(Et(i,{uid:a.uid,displayName:a.displayName,photoURL:a.photoURL,email:a.email,emailVerified:a.emailVerified,phoneNumber:a.phoneNumber,isAnonymous:a.isAnonymous,tenantId:a.tenantId,providerData:[]}),a.metadata?G(i,"metadata",C1(a.metadata)):G(i,"metadata",new Dc),De(a.providerData,function(c){pp(i,c)}),T1(i.h,a.h),G(i,"refreshToken",i.h.a),Rc(i.S,a.S.b))}t=$t.prototype,t.reload=function(){var i=this;return $e(this,fp(this).then(function(){return vp(i).then(function(){return _i(i)}).then(Lb)}))};function vp(i){return i.I().then(function(a){var c=i.isAnonymous;return R1(i,a).then(function(){return c||Sr(i,"isAnonymous",!1),a})})}t.oc=function(i){return this.I(i).then(function(a){return new _1(a)})},t.I=function(i){var a=this;return $e(this,fp(this).then(function(){return a.h.getToken(i)}).then(function(c){if(!c)throw new S("internal-error");return c.accessToken!=a.Aa&&(hp(a,c.accessToken),a.dispatchEvent(new Ao("tokenChanged"))),Sr(a,"refreshToken",c.refreshToken),c.accessToken}))};function Un(i,a){a[bn]&&i.Aa!=a[bn]&&(Ob(i.h,a),i.dispatchEvent(new Ao("tokenChanged")),hp(i,a[bn]),Sr(i,"refreshToken",i.h.a))}function R1(i,a){return ue(i.a,hD,{idToken:a}).then(F(i.Kc,i))}t.Kc=function(i){if(i=i.users,!i||!i.length)throw new S("internal-error");i=i[0],xb(this,{uid:i.localId,displayName:i.displayName,photoURL:i.photoUrl,email:i.email,emailVerified:!!i.emailVerified,phoneNumber:i.phoneNumber,lastLoginAt:i.lastLoginAt,createdAt:i.createdAt,tenantId:i.tenantId});for(var a=D1(i),c=0;c<a.length;c++)pp(this,a[c]);Sr(this,"isAnonymous",!(this.email&&i.passwordHash)&&!(this.providerData&&this.providerData.length)),this.dispatchEvent(new Ao("userReloaded",{hd:i}))};function D1(i){return(i=i.providerUserInfo)&&i.length?Lu(i,function(a){return new A1(a.rawId,a.providerId,a.email,a.displayName,a.photoUrl,a.phoneNumber)}):[]}t.Lc=function(i){return Uf("firebase.User.prototype.reauthenticateAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.reauthenticateWithCredential instead."),this.ub(i)},t.ub=function(i){var a=this,c=null;return $e(this,i.c(this.a,this.uid).then(function(f){return Un(a,f),c=da(a,f,"reauthenticate"),a.i=null,a.reload()}).then(function(){return c}),!0)};function Pc(i,a){return vp(i).then(function(){if(Zn(dp(i),a))return _i(i).then(function(){throw new S("provider-already-linked")})})}t.Cc=function(i){return Uf("firebase.User.prototype.linkAndRetrieveDataWithCredential is deprecated. Please use firebase.User.prototype.linkWithCredential instead."),this.rb(i)},t.rb=function(i){var a=this,c=null;return $e(this,Pc(this,i.providerId).then(function(){return a.I()}).then(function(f){return i.b(a.a,f)}).then(function(f){return c=da(a,f,"link"),Fb(a,f)}).then(function(){return c}))},t.Dc=function(i,a){var c=this;return $e(this,Pc(this,"phone").then(function(){return Xd(cp(c),i,a,F(c.rb,c))}))},t.Mc=function(i,a){var c=this;return $e(this,z().then(function(){return Xd(cp(c),i,a,F(c.ub,c))}),!0)};function da(i,a,c){var f=rd(a);return a=Z_(a),Mn({user:i,credential:f,additionalUserInfo:a,operationType:c})}function Fb(i,a){return Un(i,a),i.reload().then(function(){return i})}t.Cb=function(i){var a=this;return $e(this,this.I().then(function(c){return a.a.Cb(c,i)}).then(function(c){return Un(a,c),a.reload()}))},t.ed=function(i){var a=this;return $e(this,this.I().then(function(c){return i.b(a.a,c)}).then(function(c){return Un(a,c),a.reload()}))},t.Db=function(i){var a=this;return $e(this,this.I().then(function(c){return a.a.Db(c,i)}).then(function(c){return Un(a,c),a.reload()}))},t.Eb=function(i){if(i.displayName===void 0&&i.photoURL===void 0)return fp(this);var a=this;return $e(this,this.I().then(function(c){return a.a.Eb(c,{displayName:i.displayName,photoUrl:i.photoURL})}).then(function(c){return Un(a,c),Sr(a,"displayName",c.displayName||null),Sr(a,"photoURL",c.photoUrl||null),De(a.providerData,function(f){f.providerId==="password"&&(G(f,"displayName",a.displayName),G(f,"photoURL",a.photoURL))}),_i(a)}).then(Lb))},t.cd=function(i){var a=this;return $e(this,vp(this).then(function(c){return Zn(dp(a),i)?eD(a.a,c,[i]).then(function(f){var v={};return De(f.providerUserInfo||[],function(m){v[m.providerId]=!0}),De(dp(a),function(m){v[m]||Mb(a,m)}),v[nr.PROVIDER_ID]||G(a,"phoneNumber",null),_i(a)}):_i(a).then(function(){throw new S("no-such-provider")})}))},t.delete=function(){var i=this;return $e(this,this.I().then(function(a){return ue(i.a,oD,{idToken:a})}).then(function(){i.dispatchEvent(new Ao("userDeleted"))})).then(function(){for(var a=0;a<i.N.length;a++)i.N[a].cancel("app-deleted");sp(i,null),ap(i,null),up(i,null),i.N=[],i.J=!0,lp(i),G(i,"refreshToken",null),i.b&&Kd(i.b,i)})},t.Gb=function(i,a){return!!(i=="linkViaPopup"&&(this.g||null)==a&&this.f||i=="reauthViaPopup"&&(this.g||null)==a&&this.f||i=="linkViaRedirect"&&(this.ga||null)==a||i=="reauthViaRedirect"&&(this.ga||null)==a)},t.na=function(i,a,c,f){i!="linkViaPopup"&&i!="reauthViaPopup"||f!=(this.g||null)||(c&&this.C?this.C(c):a&&!c&&this.f&&this.f(a),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(i,a){return i=="linkViaPopup"&&a==(this.g||null)?F(this.Lb,this):i=="reauthViaPopup"&&a==(this.g||null)?F(this.Mb,this):i=="linkViaRedirect"&&(this.ga||null)==a?F(this.Lb,this):i=="reauthViaRedirect"&&(this.ga||null)==a?F(this.Mb,this):null},t.Ec=function(i){var a=this;return Ub(this,"linkViaPopup",i,function(){return Pc(a,i.providerId).then(function(){return _i(a)})},!1)},t.Nc=function(i){return Ub(this,"reauthViaPopup",i,function(){return z()},!0)};function Ub(i,a,c,f,v){if(!ui())return Ae(new S("operation-not-supported-in-this-environment"));if(i.i&&!v)return Ae(i.i);var m=Xf(c.providerId),_=ci(i.uid+":::"),I=null;(!Gs()||xf())&&i.s&&c.isOAuthProvider&&(I=sa(i.s,i.l,i.m,a,c,null,_,J.SDK_VERSION||null,null,null,i.tenantId,i.u));var R=A_(I,m&&m.va,m&&m.ua);return f=f().then(function(){if(jb(i),!v)return i.I().then(function(){})}).then(function(){return yb(i.b,R,a,c,_,!!I,i.tenantId)}).then(function(){return new ae(function(D,Z){i.na(a,null,new S("cancelled-popup-request"),i.g||null),i.f=D,i.C=Z,i.g=_,i.c=wb(i.b,i,a,R,_)})}).then(function(D){return R&&ai(R),D?Mn(D):null}).o(function(D){throw R&&ai(R),D}),$e(i,f,v)}t.Fc=function(i){var a=this;return Vb(this,"linkViaRedirect",i,function(){return Pc(a,i.providerId)},!1)},t.Oc=function(i){return Vb(this,"reauthViaRedirect",i,function(){return z()},!0)};function Vb(i,a,c,f,v){if(!ui())return Ae(new S("operation-not-supported-in-this-environment"));if(i.i&&!v)return Ae(i.i);var m=null,_=ci(i.uid+":::");return f=f().then(function(){if(jb(i),!v)return i.I().then(function(){})}).then(function(){return i.ga=_,_i(i)}).then(function(I){return i.ha&&(I=i.ha,I=I.b.set(gp,i.w(),I.a)),I}).then(function(){return _b(i.b,a,c,_,i.tenantId)}).o(function(I){if(m=I,i.ha)return qb(i.ha);throw m}).then(function(){if(m)throw m}),$e(i,f,v)}function jb(i){if(!i.b||!i.P)throw i.b&&!i.P?new S("internal-error"):new S("auth-domain-config-required")}t.Lb=function(i,a,c,f){var v=this;this.c&&(this.c.cancel(),this.c=null);var m=null;return c=this.I().then(function(_){return Td(v.a,{requestUri:i,postBody:f,sessionId:a,idToken:_})}).then(function(_){return m=da(v,_,"link"),Fb(v,_)}).then(function(){return m}),$e(this,c)},t.Mb=function(i,a,c,f){var v=this;this.c&&(this.c.cancel(),this.c=null);var m=null,_=z().then(function(){return bo(Sd(v.a,{requestUri:i,sessionId:a,postBody:f,tenantId:c}),v.uid)}).then(function(I){return m=da(v,I,"reauthenticate"),Un(v,I),v.i=null,v.reload()}).then(function(){return m});return $e(this,_,!0)},t.vb=function(i){var a=this,c=null;return $e(this,this.I().then(function(f){return c=f,typeof i>"u"||ti(i)?{}:ec(new Zu(i))}).then(function(f){return a.a.vb(c,f)}).then(function(f){if(a.email!=f)return a.reload()}).then(function(){}))},t.Fb=function(i,a){var c=this,f=null;return $e(this,this.I().then(function(v){return f=v,typeof a>"u"||ti(a)?{}:ec(new Zu(a))}).then(function(v){return c.a.Fb(f,i,v)}).then(function(v){if(c.email!=v)return c.reload()}).then(function(){}))};function $e(i,a,c){var f=O1(i,a,c);return i.N.push(f),f.oa(function(){Mu(i.N,f)}),f.o(function(v){var m=null;throw v&&v.code==="auth/multi-factor-auth-required"&&(m=kb(v.w(),cp(i),F(i.jc,i))),m||v})}t.jc=function(i){var a=null,c=this;return i=bo(z(i),c.uid).then(function(f){return a=da(c,f,"reauthenticate"),Un(c,f),c.i=null,c.reload()}).then(function(){return a}),$e(this,i,!0)};function O1(i,a,c){return i.i&&!c?(a.cancel(),Ae(i.i)):a.o(function(f){throw!f||f.code!="auth/user-disabled"&&f.code!="auth/user-token-expired"||(i.i||i.dispatchEvent(new Ao("userInvalidated")),i.i=f),f})}t.toJSON=function(){return this.w()},t.w=function(){var i={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,tenantId:this.tenantId,providerData:[],apiKey:this.l,appName:this.m,authDomain:this.s,stsTokenManager:this.h.w(),redirectEventId:this.ga||null};return this.metadata&&Pt(i,this.metadata.w()),De(this.providerData,function(a){i.providerData.push(rR(a))}),Pt(i,this.S.w()),i};function Bb(i){if(!i.apiKey)return null;var a={apiKey:i.apiKey,authDomain:i.authDomain,appName:i.appName,emulatorConfig:i.emulatorConfig},c={};if(i.stsTokenManager&&i.stsTokenManager.accessToken){c[bn]=i.stsTokenManager.accessToken,c.refreshToken=i.stsTokenManager.refreshToken||null;var f=i.stsTokenManager.expirationTime;f&&(c.expiresIn=(f-Date.now())/1e3)}else return null;var v=new $t(a,c,i);return i.providerData&&De(i.providerData,function(m){m&&pp(v,Mn(m))}),i.redirectEventId&&(v.ga=i.redirectEventId),v}function P1(i,a,c,f){var v=new $t(i,a);return c&&(v.ha=c),f&&ha(v,f),v.reload().then(function(){return v})}function x1(i,a,c,f){var v=i.h,m={};return m[bn]=v.b&&v.b.toString(),m.refreshToken=v.a,a=new $t(a||{apiKey:i.l,authDomain:i.s,appName:i.m},m),c&&(a.ha=c),f&&ha(a,f),Oc(a,i),a}function L1(i){this.a=i,this.b=la()}var gp={name:"redirectUser",F:"session"};function qb(i){return Co(i.b,gp,i.a)}function M1(i,a){return i.b.get(gp,i.a).then(function(c){return c&&a&&(c.authDomain=a),Bb(c||{})})}function mp(i){this.a=i,this.b=la(),this.c=null,this.f=F1(this),this.b.addListener(Vn("local"),this.a,F(this.g,this))}mp.prototype.g=function(){var i=this,a=Vn("local");ko(this,function(){return z().then(function(){return i.c&&i.c.F!="local"?i.b.get(a,i.a):null}).then(function(c){if(c)return yp(i,"local").then(function(){i.c=a})})})};function yp(i,a){var c=[],f;for(f in To)To[f]!==a&&c.push(Co(i.b,Vn(To[f]),i.a));return c.push(Co(i.b,_p,i.a)),CN(c)}function F1(i){var a=Vn("local"),c=Vn("session"),f=Vn("none");return JD(i.b,a,i.a).then(function(){return i.b.get(c,i.a)}).then(function(v){return v?c:i.b.get(f,i.a).then(function(m){return m?f:i.b.get(a,i.a).then(function(_){return _?a:i.b.get(_p,i.a).then(function(I){return I?Vn(I):a})})})}).then(function(v){return i.c=v,yp(i,v.F)}).o(function(){i.c||(i.c=a)})}var _p={name:"persistence",F:"session"};function Vn(i){return{name:"authUser",F:i}}mp.prototype.yb=function(i){var a=null,c=this;return XD(i),ko(this,function(){return i!=c.c.F?c.b.get(c.c,c.a).then(function(f){return a=f,yp(c,i)}).then(function(){if(c.c=Vn(i),a)return c.b.set(c.c,a,c.a)}):z()})};function U1(i){return ko(i,function(){return i.b.set(_p,i.c.F,i.a)})}function Gb(i,a){return ko(i,function(){return i.b.set(i.c,a.w(),i.a)})}function Wb(i){return ko(i,function(){return Co(i.b,i.c,i.a)})}function Hb(i,a,c){return ko(i,function(){return i.b.get(i.c,i.a).then(function(f){return f&&a&&(f.authDomain=a),f&&c&&(f.emulatorConfig=c),Bb(f||{})})})}function ko(i,a){return i.f=i.f.then(a,a),i.f}function In(i){if(this.l=!1,G(this,"settings",new Sb),G(this,"app",i),be(this).options&&be(this).options.apiKey)i=J.SDK_VERSION?mo(J.SDK_VERSION):null,this.a=new wn(be(this).options&&be(this).options.apiKey,Os(Ps),i);else throw new S("invalid-api-key");this.P=[],this.s=[],this.N=[],this.Pa=J.INTERNAL.createSubscribe(F(this.zc,this)),this.W=void 0,this.ib=J.INTERNAL.createSubscribe(F(this.Ac,this)),No(this,null),this.i=new mp(be(this).options.apiKey+":"+be(this).name),this.D=new L1(be(this).options.apiKey+":"+be(this).name),this.$=Le(this,W1(this)),this.h=Le(this,H1(this)),this.ba=!1,this.ja=F(this.Zc,this),this.Ba=F(this.da,this),this.qa=F(this.mc,this),this.za=F(this.wc,this),this.Aa=F(this.xc,this),this.b=null,B1(this),this.INTERNAL={},this.INTERNAL.delete=F(this.delete,this),this.INTERNAL.logFramework=F(this.Gc,this),this.u=0,It.call(this),j1(this),this.J=[],this.R=null}$(In,It);function Kb(i){Lt.call(this,"languageCodeChanged"),this.h=i}$(Kb,Lt);function zb(i){Lt.call(this,"emulatorConfigChanged"),this.c=i}$(zb,Lt);function $b(i){Lt.call(this,"frameworkChanged"),this.f=i}$($b,Lt),t=In.prototype,t.yb=function(i){return i=this.i.yb(i),Le(this,i)},t.xa=function(i){this.aa===i||this.l||(this.aa=i,kw(this.a,this.aa),this.dispatchEvent(new Kb(this.la())))},t.la=function(){return this.aa},t.fd=function(){var i=h.navigator;this.xa(i&&(i.languages&&i.languages[0]||i.language||i.userLanguage)||null)},t.gd=function(i,a){if(!this.R){if(!/^https?:\/\//.test(i))throw new S("argument-error","Emulator URL must start with a valid scheme (http:// or https://).");a=a?!!a.disableWarnings:!1,V1(a),this.R={url:i,ec:a},this.settings.jb=!0,_c(this.a,this.R),this.dispatchEvent(new zb(this.R))}};function V1(i){typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),h.document&&!i&&Yu().then(function(){var a=h.document.createElement("div");a.innerText="Running in emulator mode. Do not use with production credentials.",a.style.position="fixed",a.style.width="100%",a.style.backgroundColor="#ffffff",a.style.border=".1em solid #000000",a.style.color="#b50000",a.style.bottom="0px",a.style.left="0px",a.style.margin="0px",a.style.zIndex=1e4,a.style.textAlign="center",a.classList.add("firebase-emulator-warning"),h.document.body.appendChild(a)})}t.Gc=function(i){this.J.push(i),Nw(this.a,J.SDK_VERSION?mo(J.SDK_VERSION,this.J):null),this.dispatchEvent(new $b(this.J))},t.Ga=function(){return ei(this.J)},t.zb=function(i){this.S===i||this.l||(this.S=i,this.a.b=this.S)},t.T=function(){return this.S};function j1(i){Object.defineProperty(i,"lc",{get:function(){return this.la()},set:function(a){this.xa(a)},enumerable:!1}),i.aa=null,Object.defineProperty(i,"ti",{get:function(){return this.T()},set:function(a){this.zb(a)},enumerable:!1}),i.S=null,Object.defineProperty(i,"emulatorConfig",{get:function(){if(this.R){var a=Mt(this.R.url);a=Mn({protocol:a.c,host:a.a,port:a.g,options:Mn({disableWarnings:this.R.ec})})}else a=null;return a},enumerable:!1})}t.toJSON=function(){return{apiKey:be(this).options.apiKey,authDomain:be(this).options.authDomain,appName:be(this).name,currentUser:ne(this)&&ne(this).w()}};function wp(i){return i.Oa||Ae(new S("auth-domain-config-required"))}function B1(i){var a=be(i).options.authDomain,c=be(i).options.apiKey;a&&ui()&&(i.Oa=i.$.then(function(){if(!i.l){if(i.b=Qd(a,c,be(i).name,i.R),Ac(i.b,i),ne(i)&&fa(ne(i)),i.m){fa(i.m);var f=i.m;f.xa(i.la()),sp(f,i),f=i.m,ha(f,i.J),up(f,i),f=i.m,op(f,i.R),ap(f,i),i.m=null}return i.b}}))}t.Gb=function(i,a){switch(i){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==a&&!!this.f;default:return!1}},t.na=function(i,a,c,f){i=="signInViaPopup"&&this.g==f&&(c&&this.C?this.C(c):a&&!c&&this.f&&this.f(a),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.C)},t.Fa=function(i,a){return i=="signInViaRedirect"||i=="signInViaPopup"&&this.g==a&&this.f?F(this.ic,this):null},t.ic=function(i,a,c,f){var v=this,m={requestUri:i,postBody:f,sessionId:a,tenantId:c};return this.c&&(this.c.cancel(),this.c=null),v.$.then(function(){return wi(v,Ed(v.a,m))})},t.Xc=function(i){if(!ui())return Ae(new S("operation-not-supported-in-this-environment"));var a=this,c=Xf(i.providerId),f=ci(),v=null;(!Gs()||xf())&&be(this).options.authDomain&&i.isOAuthProvider&&(v=sa(be(this).options.authDomain,be(this).options.apiKey,be(this).name,"signInViaPopup",i,null,f,J.SDK_VERSION||null,null,null,this.T(),this.R));var m=A_(v,c&&c.va,c&&c.ua);return c=wp(this).then(function(_){return yb(_,m,"signInViaPopup",i,f,!!v,a.T())}).then(function(){return new ae(function(_,I){a.na("signInViaPopup",null,new S("cancelled-popup-request"),a.g),a.f=_,a.C=I,a.g=f,a.c=wb(a.b,a,"signInViaPopup",m,f)})}).then(function(_){return m&&ai(m),_?Mn(_):null}).o(function(_){throw m&&ai(m),_}),Le(this,c)},t.Yc=function(i){if(!ui())return Ae(new S("operation-not-supported-in-this-environment"));var a=this,c=wp(this).then(function(){return U1(a.i)}).then(function(){return _b(a.b,"signInViaRedirect",i,void 0,a.T())});return Le(this,c)};function Qb(i){if(!ui())return Ae(new S("operation-not-supported-in-this-environment"));var a=wp(i).then(function(){return i.b.ra()}).then(function(c){return c?Mn(c):null});return Le(i,a)}t.ra=function(){var i=this;return Qb(this).then(function(a){return i.b&&Nc(i.b.b),a}).o(function(a){throw i.b&&Nc(i.b.b),a})},t.dd=function(i){if(!i)return Ae(new S("null-user"));if(this.S!=i.tenantId)return Ae(new S("tenant-id-mismatch"));var a=this,c={};c.apiKey=be(this).options.apiKey,c.authDomain=be(this).options.authDomain,c.appName=be(this).name;var f=x1(i,c,a.D,a.Ga());return Le(this,this.h.then(function(){if(be(a).options.apiKey!=i.l)return f.reload()}).then(function(){return ne(a)&&i.uid==ne(a).uid?(Oc(ne(a),i),a.da(i)):(No(a,f),fa(f),a.da(f))}).then(function(){pa(a)}))};function q1(i,a){var c={};return c.apiKey=be(i).options.apiKey,c.authDomain=be(i).options.authDomain,c.appName=be(i).name,i.R&&(c.emulatorConfig=i.R),i.$.then(function(){return P1(c,a,i.D,i.Ga())}).then(function(f){return ne(i)&&f.uid==ne(i).uid?(Oc(ne(i),f),i.da(f)):(No(i,f),fa(f),i.da(f))}).then(function(){pa(i)})}function No(i,a){ne(i)&&(N1(ne(i),i.Ba),Kt(ne(i),"tokenChanged",i.qa),Kt(ne(i),"userDeleted",i.za),Kt(ne(i),"userInvalidated",i.Aa),lp(ne(i))),a&&(a.W.push(i.Ba),on(a,"tokenChanged",i.qa),on(a,"userDeleted",i.za),on(a,"userInvalidated",i.Aa),0<i.u&&Pb(a)),G(i,"currentUser",a),a&&(a.xa(i.la()),sp(a,i),ha(a,i.J),up(a,i),op(a,i.R),ap(a,i))}t.Bb=function(){var i=this,a=this.h.then(function(){return i.b&&Nc(i.b.b),ne(i)?(No(i,null),Wb(i.i).then(function(){pa(i)})):z()});return Le(this,a)};function G1(i){var a=M1(i.D,be(i).options.authDomain).then(function(c){return(i.m=c)&&(c.ha=i.D),qb(i.D)});return Le(i,a)}function W1(i){var a=be(i).options.authDomain,c=G1(i).then(function(){return Hb(i.i,a,i.R)}).then(function(f){return f?(f.ha=i.D,i.m&&(i.m.ga||null)==(f.ga||null)?f:f.reload().then(function(){return Gb(i.i,f).then(function(){return f})}).o(function(v){return v.code=="auth/network-request-failed"?f:Wb(i.i)})):null}).then(function(f){No(i,f||null)});return Le(i,c)}function H1(i){return i.$.then(function(){return Qb(i)}).o(function(){}).then(function(){if(!i.l)return i.ja()}).o(function(){}).then(function(){if(!i.l){i.ba=!0;var a=i.i;a.b.addListener(Vn("local"),a.a,i.ja)}})}t.Zc=function(){var i=this;return Hb(this.i,be(this).options.authDomain).then(function(a){if(!i.l){var c;if(c=ne(i)&&a){c=ne(i).uid;var f=a.uid;c=c==null||c===""||f===void 0||f===null||f===""?!1:c==f}if(c)return Oc(ne(i),a),ne(i).I();(ne(i)||a)&&(No(i,a),a&&(fa(a),a.ha=i.D),i.b&&Ac(i.b,i),pa(i))}})},t.da=function(i){return Gb(this.i,i)},t.mc=function(){pa(this),this.da(ne(this))},t.wc=function(){this.Bb()},t.xc=function(){this.Bb()};function wi(i,a){var c=null,f=null;return Le(i,a.then(function(v){return c=rd(v),f=Z_(v),q1(i,v)},function(v){var m=null;throw v&&v.code==="auth/multi-factor-auth-required"&&(m=kb(v.w(),i,F(i.kc,i))),m||v}).then(function(){return Mn({user:ne(i),credential:c,additionalUserInfo:f,operationType:"signIn"})}))}t.kc=function(i){var a=this;return this.h.then(function(){return wi(a,z(i))})},t.zc=function(i){var a=this;this.addAuthTokenListener(function(){i.next(ne(a))})},t.Ac=function(i){var a=this;K1(this,function(){i.next(ne(a))})},t.Ic=function(i,a,c){var f=this;return this.ba&&Promise.resolve().then(function(){typeof i=="function"?i(ne(f)):typeof i.next=="function"&&i.next(ne(f))}),this.Pa(i,a,c)},t.Hc=function(i,a,c){var f=this;return this.ba&&Promise.resolve().then(function(){f.W=f.getUid(),typeof i=="function"?i(ne(f)):typeof i.next=="function"&&i.next(ne(f))}),this.ib(i,a,c)},t.nc=function(i){var a=this,c=this.h.then(function(){return ne(a)?ne(a).I(i).then(function(f){return{accessToken:f}}):null});return Le(this,c)},t.Tc=function(i){var a=this;return this.h.then(function(){return wi(a,ue(a.a,CD,{token:i}))}).then(function(c){var f=c.user;return Sr(f,"isAnonymous",!1),a.da(f),c})},t.Uc=function(i,a){var c=this;return this.h.then(function(){return wi(c,ue(c.a,Uw,{email:i,password:a}))})},t.dc=function(i,a){var c=this;return this.h.then(function(){return wi(c,ue(c.a,rD,{email:i,password:a}))})},t.ab=function(i){var a=this;return this.h.then(function(){return wi(a,i.ka(a.a))})},t.Sc=function(i){return Uf("firebase.auth.Auth.prototype.signInAndRetrieveDataWithCredential is deprecated. Please use firebase.auth.Auth.prototype.signInWithCredential instead."),this.ab(i)},t.Ab=function(){var i=this;return this.h.then(function(){var a=ne(i);if(a&&a.isAnonymous){var c=Mn({providerId:null,isNewUser:!1});return Mn({user:a,credential:null,additionalUserInfo:c,operationType:"signIn"})}return wi(i,i.a.Ab()).then(function(f){var v=f.user;return Sr(v,"isAnonymous",!0),i.da(v),f})})};function be(i){return i.app}function ne(i){return i.currentUser}t.getUid=function(){return ne(this)&&ne(this).uid||null};function xc(i){return ne(i)&&ne(i)._lat||null}function pa(i){if(i.ba){for(var a=0;a<i.s.length;a++)i.s[a]&&i.s[a](xc(i));if(i.W!==i.getUid()&&i.N.length)for(i.W=i.getUid(),a=0;a<i.N.length;a++)i.N[a]&&i.N[a](xc(i))}}t.cc=function(i){this.addAuthTokenListener(i),this.u++,0<this.u&&ne(this)&&Pb(ne(this))},t.Pc=function(i){var a=this;De(this.s,function(c){c==i&&a.u--}),0>this.u&&(this.u=0),this.u==0&&ne(this)&&lp(ne(this)),this.removeAuthTokenListener(i)},t.addAuthTokenListener=function(i){var a=this;this.s.push(i),Le(this,this.h.then(function(){a.l||Zn(a.s,i)&&i(xc(a))}))},t.removeAuthTokenListener=function(i){gn(this.s,function(a){return a==i})};function K1(i,a){i.N.push(a),Le(i,i.h.then(function(){!i.l&&Zn(i.N,a)&&i.W!==i.getUid()&&(i.W=i.getUid(),a(xc(i)))}))}t.delete=function(){this.l=!0;for(var i=0;i<this.P.length;i++)this.P[i].cancel("app-deleted");return this.P=[],this.i&&(i=this.i,i.b.removeListener(Vn("local"),i.a,this.ja)),this.b&&(Kd(this.b,this),Nc(this.b.b)),Promise.resolve()};function Le(i,a){return i.P.push(a),a.oa(function(){Mu(i.P,a)}),a}t.hc=function(i){return Le(this,$R(this.a,i))},t.Bc=function(i){return!!nd(i)},t.xb=function(i,a){var c=this;return Le(this,z().then(function(){var f=new Zu(a);if(!f.c)throw new S("argument-error",Qf+" must be true when sending sign in link to email");return ec(f)}).then(function(f){return c.a.xb(i,f)}).then(function(){}))},t.jd=function(i){return this.Sa(i).then(function(a){return a.data.email})},t.ob=function(i,a){return Le(this,this.a.ob(i,a).then(function(){}))},t.Sa=function(i){return Le(this,this.a.Sa(i).then(function(a){return new oR(a)}))},t.kb=function(i){return Le(this,this.a.kb(i).then(function(){}))},t.wb=function(i,a){var c=this;return Le(this,z().then(function(){return typeof a>"u"||ti(a)?{}:ec(new Zu(a))}).then(function(f){return c.a.wb(i,f)}).then(function(){}))},t.Wc=function(i,a){return Le(this,Xd(this,i,a,F(this.ab,this)))},t.Vc=function(i,a){var c=this;return Le(this,z().then(function(){var f=a||qs(),v=hw(i,f);if(f=nd(f),!f)throw new S("argument-error","Invalid email link!");if(f.tenantId!==c.T())throw new S("tenant-id-mismatch");return c.ab(v)}))};function va(){}va.prototype.render=function(){},va.prototype.reset=function(){},va.prototype.getResponse=function(){},va.prototype.execute=function(){};function Ro(){this.a={},this.b=1e12}var bp=null;Ro.prototype.render=function(i,a){return this.a[this.b.toString()]=new Lc(i,a),this.b++},Ro.prototype.reset=function(i){var a=Ip(this,i);i=Yb(i),a&&i&&(a.delete(),delete this.a[i])},Ro.prototype.getResponse=function(i){return(i=Ip(this,i))?i.getResponse():null},Ro.prototype.execute=function(i){(i=Ip(this,i))&&i.execute()};function Ip(i,a){return(a=Yb(a))&&i.a[a]||null}function Yb(i){return(i=typeof i>"u"?1e12:i)?i.toString():null}function Lc(i,a){this.g=!1,this.c=a,this.a=this.b=null,this.h=this.c.size!=="invisible",this.f=Ls(i);var c=this;this.i=function(){c.execute()},this.h?this.execute():on(this.f,"click",this.i)}Lc.prototype.getResponse=function(){return Ep(this),this.b},Lc.prototype.execute=function(){Ep(this);var i=this;this.a||(this.a=setTimeout(function(){i.b=ZN();var a=i.c.callback,c=i.c["expired-callback"];if(a)try{a(i.b)}catch{}i.a=setTimeout(function(){if(i.a=null,i.b=null,c)try{c()}catch{}i.h&&i.execute()},6e4)},500))},Lc.prototype.delete=function(){Ep(this),this.g=!0,clearTimeout(this.a),this.a=null,Kt(this.f,"click",this.i)};function Ep(i){if(i.g)throw Error("reCAPTCHA mock was already deleted!")}function Tp(){}G(Tp,"FACTOR_ID","phone");function Sp(){}Sp.prototype.g=function(){return bp||(bp=new Ro),z(bp)},Sp.prototype.c=function(){};var Cp=null;function Ap(){this.b=h.grecaptcha?1/0:0,this.f=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}var z1=new Pn(Fu,"https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),$1=new Ir(3e4,6e4);Ap.prototype.g=function(i){var a=this;return new ae(function(c,f){var v=setTimeout(function(){f(new S("network-request-failed"))},$1.get());if(!h.grecaptcha||i!==a.f&&!a.b){h[a.a]=function(){if(h.grecaptcha){a.f=i;var _=h.grecaptcha.render;h.grecaptcha.render=function(I,R){return I=_(I,R),a.b++,I},clearTimeout(v),c(h.grecaptcha)}else clearTimeout(v),f(new S("internal-error"));delete h[a.a]};var m=uf(z1,{onload:a.a,hl:i||""});z(gd(m)).o(function(){clearTimeout(v),f(new S("internal-error","Unable to load external reCAPTCHA dependencies!"))})}else clearTimeout(v),c(h.grecaptcha)})},Ap.prototype.c=function(){this.b--};var kp=null;function Np(i,a,c,f,v,m,_){if(G(this,"type","recaptcha"),this.c=this.f=null,this.J=!1,this.v=a,this.g=null,_?(Cp||(Cp=new Sp),_=Cp):(kp||(kp=new Ap),_=kp),this.m=_,this.a=c||{theme:"light",type:"image"},this.h=[],this.a[Zb])throw new S("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.i=this.a[Q1]==="invisible",!h.document)throw new S("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!Ls(a)||!this.i&&Ls(a).hasChildNodes())throw new S("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.s=new wn(i,m||null,v||null),this.u=f||function(){return null};var I=this;this.l=[];var R=this.a[Xb];this.a[Xb]=function(Z){if(e0(I,Z),typeof R=="function")R(Z);else if(typeof R=="string"){var we=ke(R,h);typeof we=="function"&&we(Z)}};var D=this.a[Jb];this.a[Jb]=function(){if(e0(I,null),typeof D=="function")D();else if(typeof D=="string"){var Z=ke(D,h);typeof Z=="function"&&Z()}}}var Xb="callback",Jb="expired-callback",Zb="sitekey",Q1="size";function e0(i,a){for(var c=0;c<i.l.length;c++)try{i.l[c](a)}catch{}}function Y1(i,a){gn(i.l,function(c){return c==a})}function Rp(i,a){return i.h.push(a),a.oa(function(){Mu(i.h,a)}),a}t=Np.prototype,t.Ia=function(){var i=this;return this.f?this.f:this.f=Rp(this,z().then(function(){if(Xu()&&!yn())return Yu();throw new S("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return i.m.g(i.u())}).then(function(a){return i.g=a,ue(i.s,mD,{})}).then(function(a){i.a[Zb]=a.recaptchaSiteKey}).o(function(a){throw i.f=null,a}))},t.render=function(){Mc(this);var i=this;return Rp(this,this.Ia().then(function(){if(i.c===null){var a=i.v;if(!i.i){var c=Ls(a);a=IN("DIV"),c.appendChild(a)}i.c=i.g.render(a,i.a)}return i.c}))},t.verify=function(){Mc(this);var i=this;return Rp(this,this.render().then(function(a){return new ae(function(c){var f=i.g.getResponse(a);if(f)c(f);else{var v=function(m){m&&(Y1(i,v),c(m))};i.l.push(v),i.i&&i.g.execute(i.c)}})}))},t.reset=function(){Mc(this),this.c!==null&&this.g.reset(this.c)};function Mc(i){if(i.J)throw new S("internal-error","RecaptchaVerifier instance has been destroyed.")}t.clear=function(){Mc(this),this.J=!0,this.m.c();for(var i=0;i<this.h.length;i++)this.h[i].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.i){i=Ls(this.v);for(var a;a=i.firstChild;)i.removeChild(a)}};function Dp(i,a,c){var f=!1;try{this.b=c||J.app()}catch{throw new S("argument-error","No firebase.app.App instance is currently initialized.")}if(this.b.options&&this.b.options.apiKey)c=this.b.options.apiKey;else throw new S("invalid-api-key");var v=this,m=null;try{m=this.b.auth().Ga()}catch{}try{f=this.b.auth().settings.appVerificationDisabledForTesting}catch{}m=J.SDK_VERSION?mo(J.SDK_VERSION,m):null,Np.call(this,c,i,a,function(){try{var _=v.b.auth().la()}catch{_=null}return _},m,Os(Ps),f)}$(Dp,Np);function t0(i,a,c,f){e:{c=Array.prototype.slice.call(c);for(var v=0,m=!1,_=0;_<a.length;_++)if(a[_].optional)m=!0;else{if(m)throw new S("internal-error","Argument validator encountered a required argument after an optional argument.");v++}if(m=a.length,c.length<v||m<c.length)f="Expected "+(v==m?v==1?"1 argument":v+" arguments":v+"-"+m+" arguments")+" but got "+c.length+".";else{for(v=0;v<c.length;v++)if(m=a[v].optional&&c[v]===void 0,!a[v].M(c[v])&&!m){if(a=a[v],0>v||v>=n0.length)throw new S("internal-error","Argument validator received an unsupported number of arguments.");c=n0[v],f=(f?"":c+" argument ")+(a.name?'"'+a.name+'" ':"")+"must be "+a.K+".";break e}f=null}}if(f)throw new S("argument-error",i+" failed: "+f)}var n0="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");function q(i,a){return{name:i||"",K:"a valid string",optional:!!a,M:function(c){return typeof c=="string"}}}function Op(i,a){return{name:i||"",K:"a boolean",optional:!!a,M:function(c){return typeof c=="boolean"}}}function Be(i,a){return{name:i||"",K:"a valid object",optional:!!a,M:T}}function Do(i,a){return{name:i||"",K:"a function",optional:!!a,M:function(c){return typeof c=="function"}}}function jn(i,a){return{name:i||"",K:"null",optional:!!a,M:function(c){return c===null}}}function X1(){return{name:"",K:"an HTML element",optional:!1,M:function(i){return!!(i&&i instanceof Element)}}}function J1(){return{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(i){return!!(i&&i instanceof In)}}}function Z1(){return{name:"app",K:"an instance of Firebase App",optional:!0,M:function(i){return!!(i&&i instanceof J.app.App)}}}function Cr(i){return{name:i?i+"Credential":"credential",K:i?"a valid "+i+" credential":"a valid credential",optional:!1,M:function(a){if(!a)return!1;var c=!i||a.providerId===i;return!(!a.ka||!c)}}}function r0(){return{name:"multiFactorAssertion",K:"a valid multiFactorAssertion",optional:!1,M:function(i){return i?!!i.tb:!1}}}function Oo(){return{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(i){return!!(i&&i.providerId&&i.hasOwnProperty&&i.hasOwnProperty("isOAuthProvider"))}}}function Pp(i,a){return T(i)&&typeof i.type=="string"&&i.type===a&&typeof i.Ha=="function"}function i0(i){return T(i)&&typeof i.uid=="string"}function Fc(){return{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(i){return!(!i||typeof i.type!="string"||typeof i.verify!="function")}}}function Ve(i,a,c,f){return{name:c||"",K:i.K+" or "+a.K,optional:!!f,M:function(v){return i.M(v)||a.M(v)}}}function Oe(i,a){for(var c in a){var f=a[c].name;i[f]=s0(f,i[c],a[c].j)}}function o0(i,a){for(var c in a){var f=a[c].name;f!==c&&Object.defineProperty(i,f,{get:me(function(v){return this[v]},c),set:me(function(v,m,_,I){t0(v,[_],[I],!0),this[m]=I},f,c,a[c].lb),enumerable:!0})}}function je(i,a,c,f){i[a]=s0(a,c,f)}function s0(i,a,c){function f(){var _=Array.prototype.slice.call(arguments);return t0(v,c,_),a.apply(this,_)}if(!c)return a;var v=eO(i),m;for(m in a)f[m]=a[m];for(m in a.prototype)f.prototype[m]=a.prototype[m];return f}function eO(i){return i=i.split("."),i[i.length-1]}Oe(In.prototype,{kb:{name:"applyActionCode",j:[q("code")]},Sa:{name:"checkActionCode",j:[q("code")]},ob:{name:"confirmPasswordReset",j:[q("code"),q("newPassword")]},dc:{name:"createUserWithEmailAndPassword",j:[q("email"),q("password")]},hc:{name:"fetchSignInMethodsForEmail",j:[q("email")]},ra:{name:"getRedirectResult",j:[]},Bc:{name:"isSignInWithEmailLink",j:[q("emailLink")]},Hc:{name:"onAuthStateChanged",j:[Ve(Be(),Do(),"nextOrObserver"),Do("opt_error",!0),Do("opt_completed",!0)]},Ic:{name:"onIdTokenChanged",j:[Ve(Be(),Do(),"nextOrObserver"),Do("opt_error",!0),Do("opt_completed",!0)]},wb:{name:"sendPasswordResetEmail",j:[q("email"),Ve(Be("opt_actionCodeSettings",!0),jn(null,!0),"opt_actionCodeSettings",!0)]},xb:{name:"sendSignInLinkToEmail",j:[q("email"),Be("actionCodeSettings")]},yb:{name:"setPersistence",j:[q("persistence")]},Sc:{name:"signInAndRetrieveDataWithCredential",j:[Cr()]},Ab:{name:"signInAnonymously",j:[]},ab:{name:"signInWithCredential",j:[Cr()]},Tc:{name:"signInWithCustomToken",j:[q("token")]},Uc:{name:"signInWithEmailAndPassword",j:[q("email"),q("password")]},Vc:{name:"signInWithEmailLink",j:[q("email"),q("emailLink",!0)]},Wc:{name:"signInWithPhoneNumber",j:[q("phoneNumber"),Fc()]},Xc:{name:"signInWithPopup",j:[Oo()]},Yc:{name:"signInWithRedirect",j:[Oo()]},dd:{name:"updateCurrentUser",j:[Ve(function(i){return{name:"user",K:"an instance of Firebase User",optional:!!i,M:function(a){return!!(a&&a instanceof $t)}}}(),jn(),"user")]},Bb:{name:"signOut",j:[]},toJSON:{name:"toJSON",j:[q(null,!0)]},fd:{name:"useDeviceLanguage",j:[]},gd:{name:"useEmulator",j:[q("url"),Be("options",!0)]},jd:{name:"verifyPasswordResetCode",j:[q("code")]}}),o0(In.prototype,{lc:{name:"languageCode",lb:Ve(q(),jn(),"languageCode")},ti:{name:"tenantId",lb:Ve(q(),jn(),"tenantId")}}),In.Persistence=To,In.Persistence.LOCAL="local",In.Persistence.SESSION="session",In.Persistence.NONE="none",Oe($t.prototype,{delete:{name:"delete",j:[]},oc:{name:"getIdTokenResult",j:[Op("opt_forceRefresh",!0)]},I:{name:"getIdToken",j:[Op("opt_forceRefresh",!0)]},Cc:{name:"linkAndRetrieveDataWithCredential",j:[Cr()]},rb:{name:"linkWithCredential",j:[Cr()]},Dc:{name:"linkWithPhoneNumber",j:[q("phoneNumber"),Fc()]},Ec:{name:"linkWithPopup",j:[Oo()]},Fc:{name:"linkWithRedirect",j:[Oo()]},Lc:{name:"reauthenticateAndRetrieveDataWithCredential",j:[Cr()]},ub:{name:"reauthenticateWithCredential",j:[Cr()]},Mc:{name:"reauthenticateWithPhoneNumber",j:[q("phoneNumber"),Fc()]},Nc:{name:"reauthenticateWithPopup",j:[Oo()]},Oc:{name:"reauthenticateWithRedirect",j:[Oo()]},reload:{name:"reload",j:[]},vb:{name:"sendEmailVerification",j:[Ve(Be("opt_actionCodeSettings",!0),jn(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",j:[q(null,!0)]},cd:{name:"unlink",j:[q("provider")]},Cb:{name:"updateEmail",j:[q("email")]},Db:{name:"updatePassword",j:[q("password")]},ed:{name:"updatePhoneNumber",j:[Cr("phone")]},Eb:{name:"updateProfile",j:[Be("profile")]},Fb:{name:"verifyBeforeUpdateEmail",j:[q("email"),Ve(Be("opt_actionCodeSettings",!0),jn(null,!0),"opt_actionCodeSettings",!0)]}}),Oe(Ro.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Oe(va.prototype,{execute:{name:"execute"},render:{name:"render"},reset:{name:"reset"},getResponse:{name:"getResponse"}}),Oe(ae.prototype,{oa:{name:"finally"},o:{name:"catch"},then:{name:"then"}}),o0(Sb.prototype,{appVerificationDisabled:{name:"appVerificationDisabledForTesting",lb:Op("appVerificationDisabledForTesting")}}),Oe(Yd.prototype,{confirm:{name:"confirm",j:[q("verificationCode")]}}),je(wo,"fromJSON",function(i){i=typeof i=="string"?JSON.parse(i):i;for(var a,c=[ER,TR,SR,IR],f=0;f<c.length;f++)if(a=c[f](i))return a;return null},[Ve(q(),Be(),"json")]),je(an,"credential",function(i,a){return new Er(i,a)},[q("email"),q("password")]),Oe(Er.prototype,{w:{name:"toJSON",j:[q(null,!0)]}}),Oe(fi.prototype,{Ca:{name:"addScope",j:[q("scope")]},Ka:{name:"setCustomParameters",j:[Be("customOAuthParameters")]}}),je(fi,"credential",aw,[Ve(q(),Be(),"token")]),je(an,"credentialWithLink",hw,[q("email"),q("emailLink")]),Oe(di.prototype,{Ca:{name:"addScope",j:[q("scope")]},Ka:{name:"setCustomParameters",j:[Be("customOAuthParameters")]}}),je(di,"credential",uw,[Ve(q(),Be(),"token")]),Oe(pi.prototype,{Ca:{name:"addScope",j:[q("scope")]},Ka:{name:"setCustomParameters",j:[Be("customOAuthParameters")]}}),je(pi,"credential",cw,[Ve(q(),Ve(Be(),jn()),"idToken"),Ve(q(),jn(),"accessToken",!0)]),Oe(Io.prototype,{Ka:{name:"setCustomParameters",j:[Be("customOAuthParameters")]}}),je(Io,"credential",lw,[Ve(q(),Be(),"token"),q("secret",!0)]),Oe(zt.prototype,{Ca:{name:"addScope",j:[q("scope")]},credential:{name:"credential",j:[Ve(q(),Ve(Be(),jn()),"optionsOrIdToken"),Ve(q(),jn(),"accessToken",!0)]},Ka:{name:"setCustomParameters",j:[Be("customOAuthParameters")]}}),Oe(tr.prototype,{w:{name:"toJSON",j:[q(null,!0)]}}),Oe(li.prototype,{w:{name:"toJSON",j:[q(null,!0)]}}),je(nr,"credential",fw,[q("verificationId"),q("verificationCode")]),Oe(nr.prototype,{gb:{name:"verifyPhoneNumber",j:[Ve(q(),function(i,a){return{name:i||"phoneInfoOptions",K:"valid phone info options",optional:!!a,M:function(c){return c?c.session&&c.phoneNumber?Pp(c.session,Qs)&&typeof c.phoneNumber=="string":c.session&&c.multiFactorHint?Pp(c.session,oc)&&i0(c.multiFactorHint):c.session&&c.multiFactorUid?Pp(c.session,oc)&&typeof c.multiFactorUid=="string":c.phoneNumber?typeof c.phoneNumber=="string":!1:!1}}}(),"phoneInfoOptions"),Fc()]}}),Oe(Tr.prototype,{w:{name:"toJSON",j:[q(null,!0)]}}),Oe(S.prototype,{toJSON:{name:"toJSON",j:[q(null,!0)]}}),Oe(Xs.prototype,{toJSON:{name:"toJSON",j:[q(null,!0)]}}),Oe(sd.prototype,{toJSON:{name:"toJSON",j:[q(null,!0)]}}),Oe(Zd.prototype,{toJSON:{name:"toJSON",j:[q(null,!0)]}}),Oe(Jd.prototype,{Rc:{name:"resolveSignIn",j:[r0()]}}),Oe(tp.prototype,{Sb:{name:"getSession",j:[]},fc:{name:"enroll",j:[r0(),q("displayName",!0)]},bd:{name:"unenroll",j:[Ve({name:"multiFactorInfo",K:"a valid multiFactorInfo",optional:!1,M:i0},q(),"multiFactorInfoIdentifier")]}}),Oe(Dp.prototype,{clear:{name:"clear",j:[]},render:{name:"render",j:[]},verify:{name:"verify",j:[]}}),je($f,"parseLink",G_,[q("link")]),je(Tp,"assertion",function(i){return new Rb(i)},[Cr("phone")]),function(){if(typeof J<"u"&&J.INTERNAL&&J.INTERNAL.registerComponent){var i={ActionCodeInfo:{Operation:{EMAIL_SIGNIN:Ju,PASSWORD_RESET:"PASSWORD_RESET",RECOVER_EMAIL:"RECOVER_EMAIL",REVERT_SECOND_FACTOR_ADDITION:zf,VERIFY_AND_CHANGE_EMAIL:zs,VERIFY_EMAIL:"VERIFY_EMAIL"}},Auth:In,AuthCredential:wo,Error:S};je(i,"EmailAuthProvider",an,[]),je(i,"FacebookAuthProvider",fi,[]),je(i,"GithubAuthProvider",di,[]),je(i,"GoogleAuthProvider",pi,[]),je(i,"TwitterAuthProvider",Io,[]),je(i,"OAuthProvider",zt,[q("providerId")]),je(i,"SAMLAuthProvider",sw,[q("providerId")]),je(i,"PhoneAuthProvider",nr,[J1()]),je(i,"RecaptchaVerifier",Dp,[Ve(q(),X1(),"recaptchaContainer"),Be("recaptchaParameters",!0),Z1()]),je(i,"ActionCodeURL",$f,[]),je(i,"PhoneMultiFactorGenerator",Tp,[]),J.INTERNAL.registerComponent({name:"auth",instanceFactory:function(a){return a=a.getProvider("app").getImmediate(),new In(a)},multipleInstances:!1,serviceProps:i,instantiationMode:"LAZY",type:"PUBLIC",onInstanceCreated:function(a){a.getProvider("auth-internal").initialize()}}),J.INTERNAL.registerComponent({name:"auth-internal",instanceFactory:function(a){return a=a.getProvider("auth").getImmediate(),{getUid:F(a.getUid,a),getToken:F(a.nc,a),addAuthTokenListener:F(a.cc,a),removeAuthTokenListener:F(a.Pc,a)}},multipleInstances:!1,instantiationMode:"LAZY",type:"PRIVATE"}),J.registerVersion("@firebase/auth","0.16.8"),J.INTERNAL.extendNamespace({User:$t})}else throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.")}()}).apply(typeof global<"u"?global:typeof self<"u"?self:typeof window<"u"?window:{});/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hk="firebasestorage.googleapis.com",fk="storageBucket",lB=2*60*1e3,hB=10*60*1e3,Ke=function(t){V(e,t);function e(n,r){var o=t.call(this,nv(n),"Firebase Storage: "+r+" ("+nv(n)+")")||this;return o.customData={serverResponse:null},o._baseMessage=o.message,Object.setPrototypeOf(o,e.prototype),o}return e.prototype._codeEquals=function(n){return nv(n)===this.code},Object.defineProperty(e.prototype,"serverResponse",{get:function(){return this.customData.serverResponse},set:function(n){this.customData.serverResponse=n,this.customData.serverResponse?this.message=this._baseMessage+`
`+this.customData.serverResponse:this.message=this._baseMessage},enumerable:!1,configurable:!0}),e}(Ql);function nv(t){return"storage/"+t}function ry(){var t="An unknown error occurred, please check the error payload for server response.";return new Ke("unknown",t)}function fB(t){return new Ke("object-not-found","Object '"+t+"' does not exist.")}function dB(t){return new Ke("quota-exceeded","Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function pB(){var t="User is not authenticated, please authenticate using Firebase Authentication and try again.";return new Ke("unauthenticated",t)}function vB(){return new Ke("unauthorized-app","This app does not have permission to access Firebase Storage on this project.")}function gB(t){return new Ke("unauthorized","User does not have permission to access '"+t+"'.")}function mB(){return new Ke("retry-limit-exceeded","Max retry time for operation exceeded, please try again.")}function dk(){return new Ke("canceled","User canceled the upload/download.")}function yB(t){return new Ke("invalid-url","Invalid URL '"+t+"'.")}function _B(t){return new Ke("invalid-default-bucket","Invalid default bucket '"+t+"'.")}function wB(){return new Ke("no-default-bucket","No default bucket found. Did you set the '"+fk+"' property when initializing the app?")}function pk(){return new Ke("cannot-slice-blob","Cannot slice blob for upload. Please retry the upload.")}function bB(){return new Ke("server-file-wrong-size","Server recorded incorrect upload file size, please retry the upload.")}function IB(){return new Ke("no-download-url","The given file does not have any download URLs.")}function Wo(t){return new Ke("invalid-argument",t)}function vk(){return new Ke("app-deleted","The Firebase app was deleted.")}function gk(t){return new Ke("invalid-root-operation","The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function Ma(t,e){return new Ke("invalid-format","String does not match format '"+t+"': "+e)}function $c(t){throw new Ke("internal-error","Internal error: "+t)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EB(t){return atob(t)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var hn={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},rv=function(){function t(e,n){this.data=e,this.contentType=n||null}return t}();function mk(t,e){switch(t){case hn.RAW:return new rv(yk(e));case hn.BASE64:case hn.BASE64URL:return new rv(_k(t,e));case hn.DATA_URL:return new rv(SB(e),CB(e))}throw ry()}function yk(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|r&63);else if((r&64512)===55296){var o=n<t.length-1&&(t.charCodeAt(n+1)&64512)===56320;if(!o)e.push(239,191,189);else{var s=r,u=t.charCodeAt(++n);r=65536|(s&1023)<<10|u&1023,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|r&63)}}else(r&64512)===56320?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|r&63)}return new Uint8Array(e)}function TB(t){var e;try{e=decodeURIComponent(t)}catch{throw Ma(hn.DATA_URL,"Malformed data URL.")}return yk(e)}function _k(t,e){switch(t){case hn.BASE64:{var n=e.indexOf("-")!==-1,r=e.indexOf("_")!==-1;if(n||r){var o=n?"-":"_";throw Ma(t,"Invalid character '"+o+"' found: is it base64url encoded?")}break}case hn.BASE64URL:{var s=e.indexOf("+")!==-1,u=e.indexOf("/")!==-1;if(s||u){var o=s?"+":"/";throw Ma(t,"Invalid character '"+o+"' found: is it base64 encoded?")}e=e.replace(/-/g,"+").replace(/_/g,"/");break}}var l;try{l=EB(e)}catch{throw Ma(t,"Invalid character found")}for(var h=new Uint8Array(l.length),d=0;d<l.length;d++)h[d]=l.charCodeAt(d);return h}var wk=function(){function t(e){this.base64=!1,this.contentType=null;var n=e.match(/^data:([^,]+)?,/);if(n===null)throw Ma(hn.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var r=n[1]||null;r!=null&&(this.base64=AB(r,";base64"),this.contentType=this.base64?r.substring(0,r.length-7):r),this.rest=e.substring(e.indexOf(",")+1)}return t}();function SB(t){var e=new wk(t);return e.base64?_k(hn.BASE64,e.rest):TB(e.rest)}function CB(t){var e=new wk(t);return e.contentType}function AB(t,e){var n=t.length>=e.length;return n?t.substring(t.length-e.length)===e:!1}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var kB={STATE_CHANGED:"state_changed"},Ct={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};function iv(t){switch(t){case"running":case"pausing":case"canceling":return Ct.RUNNING;case"paused":return Ct.PAUSED;case"success":return Ct.SUCCESS;case"canceled":return Ct.CANCELED;case"error":return Ct.ERROR;default:return Ct.ERROR}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ui;(function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"})(Ui||(Ui={}));/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var NB=function(){function t(){var e=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=Ui.NO_ERROR,this.sendPromise_=new Promise(function(n){e.xhr_.addEventListener("abort",function(){e.errorCode_=Ui.ABORT,n()}),e.xhr_.addEventListener("error",function(){e.errorCode_=Ui.NETWORK_ERROR,n()}),e.xhr_.addEventListener("load",function(){n()})})}return t.prototype.send=function(e,n,r,o){if(this.sent_)throw $c("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(n,e,!0),o!==void 0)for(var s in o)o.hasOwnProperty(s)&&this.xhr_.setRequestHeader(s,o[s].toString());return r!==void 0?this.xhr_.send(r):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw $c("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw $c("cannot .getStatus() before sending");try{return this.xhr_.status}catch{return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw $c("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(e){return this.xhr_.getResponseHeader(e)},t.prototype.addUploadProgressListener=function(e){this.xhr_.upload!=null&&this.xhr_.upload.addEventListener("progress",e)},t.prototype.removeUploadProgressListener=function(e){this.xhr_.upload!=null&&this.xhr_.upload.removeEventListener("progress",e)},t}();function RB(){return new NB}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var DB=function(){function t(){}return t.prototype.createConnection=function(){return RB()},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var fn=function(){function t(e,n){this.bucket=e,this.path_=n}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"isRoot",{get:function(){return this.path.length===0},enumerable:!1,configurable:!0}),t.prototype.fullServerUrl=function(){var e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o/"+e(this.path)},t.prototype.bucketOnlyServerUrl=function(){var e=encodeURIComponent;return"/b/"+e(this.bucket)+"/o"},t.makeFromBucketSpec=function(e,n){var r;try{r=t.makeFromUrl(e,n)}catch{return new t(e,"")}if(r.path==="")return r;throw _B(e)},t.makeFromUrl=function(e,n){var r=null,o="([A-Za-z0-9.\\-_]+)";function s(Fe){Fe.path.charAt(Fe.path.length-1)==="/"&&(Fe.path_=Fe.path_.slice(0,-1))}var u="(/(.*))?$",l=new RegExp("^gs://"+o+u,"i"),h={bucket:1,path:3};function d(Fe){Fe.path_=decodeURIComponent(Fe.path)}for(var p="v[A-Za-z0-9_]+",g=n.replace(/[.]/g,"\\."),y="(/([^?#]*).*)?$",w=new RegExp("^https?://"+g+"/"+p+"/b/"+o+"/o"+y,"i"),b={bucket:1,path:3},E=n===hk?"(?:storage.googleapis.com|storage.cloud.google.com)":n,T="([^?#]*)",k=new RegExp("^https?://"+E+"/"+o+"/"+T,"i"),O={bucket:1,path:2},M=[{regex:l,indices:h,postModify:s},{regex:w,indices:b,postModify:d},{regex:k,indices:O,postModify:d}],H=0;H<M.length;H++){var X=M[H],F=X.regex.exec(e);if(F){var me=F[X.indices.bucket],$=F[X.indices.path];$||($=""),r=new t(me,$),X.postModify(r);break}}if(r==null)throw yB(e);return r},t}(),OB=function(){function t(e){this.promise_=Promise.reject(e)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(e){},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PB(t,e,n){var r=1,o=null,s=!1,u=0;function l(){return u===2}var h=!1;function d(){for(var b=[],E=0;E<arguments.length;E++)b[E]=arguments[E];h||(h=!0,e.apply(null,b))}function p(b){o=setTimeout(function(){o=null,t(g,l())},b)}function g(b){for(var E=[],T=1;T<arguments.length;T++)E[T-1]=arguments[T];if(!h){if(b){d.call.apply(d,ve([null,b],E));return}var k=l()||s;if(k){d.call.apply(d,ve([null,b],E));return}r<64&&(r*=2);var O;u===1?(u=2,O=0):O=(r+Math.random())*1e3,p(O)}}var y=!1;function w(b){y||(y=!0,!h&&(o!==null?(b||(u=2),clearTimeout(o),p(0)):b||(u=1)))}return p(0),setTimeout(function(){s=!0,w(!0)},n),w}function xB(t){t(!1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function LB(t){return t!==void 0}function MB(t){return typeof t=="function"}function FB(t){return typeof t=="object"&&!Array.isArray(t)}function $h(t){return typeof t=="string"||t instanceof String}function _E(t){return iy()&&t instanceof Blob}function iy(){return typeof Blob<"u"}function ng(t,e,n,r){if(r<e)throw Wo("Invalid value for '"+t+"'. Expected "+e+" or greater.");if(r>n)throw Wo("Invalid value for '"+t+"'. Expected "+n+" or less.")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zr(t,e){var n=e.match(/^(\w+):\/\/.+/),r=n==null?void 0:n[1],o=e;return r==null&&(o="https://"+e),o+"/v0"+t}function bk(t){var e=encodeURIComponent,n="?";for(var r in t)if(t.hasOwnProperty(r)){var o=e(r)+"="+e(t[r]);n=n+o+"&"}return n=n.slice(0,-1),n}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var UB=function(){function t(e,n,r,o,s,u,l,h,d,p,g){var y=this;this.pendingConnection_=null,this.backoffId_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=e,this.method_=n,this.headers_=r,this.body_=o,this.successCodes_=s.slice(),this.additionalRetryCodes_=u.slice(),this.callback_=l,this.errorCallback_=h,this.progressCallback_=p,this.timeout_=d,this.pool_=g,this.promise_=new Promise(function(w,b){y.resolve_=w,y.reject_=b,y.start_()})}return t.prototype.start_=function(){var e=this;function n(o,s){if(s){o(!1,new Qc(!1,null,!0));return}var u=e.pool_.createConnection();e.pendingConnection_=u;function l(h){var d=h.loaded,p=h.lengthComputable?h.total:-1;e.progressCallback_!==null&&e.progressCallback_(d,p)}e.progressCallback_!==null&&u.addUploadProgressListener(l),u.send(e.url_,e.method_,e.body_,e.headers_).then(function(){e.progressCallback_!==null&&u.removeUploadProgressListener(l),e.pendingConnection_=null;var h=u.getErrorCode()===Ui.NO_ERROR,d=u.getStatus();if(!h||e.isRetryStatusCode_(d)){var p=u.getErrorCode()===Ui.ABORT;o(!1,new Qc(!1,null,p));return}var g=e.successCodes_.indexOf(d)!==-1;o(!0,new Qc(g,u))})}function r(o,s){var u=e.resolve_,l=e.reject_,h=s.connection;if(s.wasSuccessCode)try{var d=e.callback_(h,h.getResponseText());LB(d)?u(d):u()}catch(g){l(g)}else if(h!==null){var p=ry();p.serverResponse=h.getResponseText(),e.errorCallback_?l(e.errorCallback_(h,p)):l(p)}else if(s.canceled){var p=e.appDelete_?vk():dk();l(p)}else{var p=mB();l(p)}}this.canceled_?r(!1,new Qc(!1,null,!0)):this.backoffId_=PB(n,r,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(e){this.canceled_=!0,this.appDelete_=e||!1,this.backoffId_!==null&&xB(this.backoffId_),this.pendingConnection_!==null&&this.pendingConnection_.abort()},t.prototype.isRetryStatusCode_=function(e){var n=e>=500&&e<600,r=[408,429],o=r.indexOf(e)!==-1,s=this.additionalRetryCodes_.indexOf(e)!==-1;return n||o||s},t}(),Qc=function(){function t(e,n,r){this.wasSuccessCode=e,this.connection=n,this.canceled=!!r}return t}();function VB(t,e){e!==null&&e.length>0&&(t.Authorization="Firebase "+e)}function jB(t,e){t["X-Firebase-Storage-Version"]="webjs/"+(e??"AppManager")}function BB(t,e){e&&(t["X-Firebase-GMPID"]=e)}function qB(t,e){e!==null&&(t["X-Firebase-AppCheck"]=e)}function GB(t,e,n,r,o,s){var u=bk(t.urlParams),l=t.url+u,h=Object.assign({},t.headers);return BB(h,e),VB(h,n),jB(h,s),qB(h,r),new UB(l,t.method,h,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,o)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function WB(){return typeof BlobBuilder<"u"?BlobBuilder:typeof WebKitBlobBuilder<"u"?WebKitBlobBuilder:void 0}function HB(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=WB();if(n!==void 0){for(var r=new n,o=0;o<t.length;o++)r.append(t[o]);return r.getBlob()}else{if(iy())return new Blob(t);throw new Ke("unsupported-environment","This browser doesn't seem to support creating Blobs")}}function KB(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var oy=function(){function t(e,n){var r=0,o="";_E(e)?(this.data_=e,r=e.size,o=e.type):e instanceof ArrayBuffer?(n?this.data_=new Uint8Array(e):(this.data_=new Uint8Array(e.byteLength),this.data_.set(new Uint8Array(e))),r=this.data_.length):e instanceof Uint8Array&&(n?this.data_=e:(this.data_=new Uint8Array(e.length),this.data_.set(e)),r=e.length),this.size_=r,this.type_=o}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(_E(this.data_)){var r=this.data_,o=KB(r,e,n);return o===null?null:new t(o)}else{var s=new Uint8Array(this.data_.buffer,e,n-e);return new t(s,!0)}},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(iy()){var r=e.map(function(h){return h instanceof t?h.data_:h});return new t(HB.apply(null,r))}else{var o=e.map(function(h){return $h(h)?mk(hn.RAW,h).data:h.data_}),s=0;o.forEach(function(h){s+=h.byteLength});var u=new Uint8Array(s),l=0;return o.forEach(function(h){for(var d=0;d<h.length;d++)u[l++]=h[d]}),new t(u,!0)}},t.prototype.uploadData=function(){return this.data_},t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function sy(t){var e;try{e=JSON.parse(t)}catch{return null}return FB(e)?e:null}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zB(t){if(t.length===0)return null;var e=t.lastIndexOf("/");if(e===-1)return"";var n=t.slice(0,e);return n}function $B(t,e){var n=e.split("/").filter(function(r){return r.length>0}).join("/");return t.length===0?n:t+"/"+n}function Ik(t){var e=t.lastIndexOf("/",t.length-2);return e===-1?t:t.slice(e+1)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QB(t,e){return e}var Tt=function(){function t(e,n,r,o){this.server=e,this.local=n||e,this.writable=!!r,this.xform=o||QB}return t}(),Yc=null;function YB(t){return!$h(t)||t.length<2?t:Ik(t)}function Qh(){if(Yc)return Yc;var t=[];t.push(new Tt("bucket")),t.push(new Tt("generation")),t.push(new Tt("metageneration")),t.push(new Tt("name","fullPath",!0));function e(s,u){return YB(u)}var n=new Tt("name");n.xform=e,t.push(n);function r(s,u){return u!==void 0?Number(u):u}var o=new Tt("size");return o.xform=r,t.push(o),t.push(new Tt("timeCreated")),t.push(new Tt("updated")),t.push(new Tt("md5Hash",null,!0)),t.push(new Tt("cacheControl",null,!0)),t.push(new Tt("contentDisposition",null,!0)),t.push(new Tt("contentEncoding",null,!0)),t.push(new Tt("contentLanguage",null,!0)),t.push(new Tt("contentType",null,!0)),t.push(new Tt("metadata","customMetadata",!0)),Yc=t,Yc}function XB(t,e){function n(){var r=t.bucket,o=t.fullPath,s=new fn(r,o);return e._makeStorageReference(s)}Object.defineProperty(t,"ref",{get:n})}function JB(t,e,n){var r={};r.type="file";for(var o=n.length,s=0;s<o;s++){var u=n[s];r[u.local]=u.xform(r,e[u.server])}return XB(r,t),r}function Ek(t,e,n){var r=sy(e);if(r===null)return null;var o=r;return JB(t,o,n)}function ZB(t,e,n){var r=sy(e);if(r===null||!$h(r.downloadTokens))return null;var o=r.downloadTokens;if(o.length===0)return null;var s=encodeURIComponent,u=o.split(","),l=u.map(function(h){var d=t.bucket,p=t.fullPath,g="/b/"+s(d)+"/o/"+s(p),y=Zr(g,n),w=bk({alt:"media",token:h});return y+w});return l[0]}function ay(t,e){for(var n={},r=e.length,o=0;o<r;o++){var s=e[o];s.writable&&(n[s.server]=t[s.local])}return JSON.stringify(n)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var wE="prefixes",bE="items";function eq(t,e,n){var r={prefixes:[],items:[],nextPageToken:n.nextPageToken};if(n[wE])for(var o=0,s=n[wE];o<s.length;o++){var u=s[o],l=u.replace(/\/$/,""),h=t._makeStorageReference(new fn(e,l));r.prefixes.push(h)}if(n[bE])for(var d=0,p=n[bE];d<p.length;d++){var g=p[d],h=t._makeStorageReference(new fn(e,g.name));r.items.push(h)}return r}function tq(t,e,n){var r=sy(n);if(r===null)return null;var o=r;return eq(t,e,o)}var mr=function(){function t(e,n,r,o){this.url=e,this.method=n,this.handler=r,this.timeout=o,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}return t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Hn(t){if(!t)throw ry()}function Yh(t,e){function n(r,o){var s=Ek(t,o,e);return Hn(s!==null),s}return n}function nq(t,e){function n(r,o){var s=tq(t,e,o);return Hn(s!==null),s}return n}function rq(t,e){function n(r,o){var s=Ek(t,o,e);return Hn(s!==null),ZB(s,o,t.host)}return n}function ks(t){function e(n,r){var o;return n.getStatus()===401?n.getResponseText().includes("Firebase App Check token is invalid")?o=vB():o=pB():n.getStatus()===402?o=dB(t.bucket):n.getStatus()===403?o=gB(t.path):o=r,o.serverResponse=r.serverResponse,o}return e}function Xh(t){var e=ks(t);function n(r,o){var s=e(r,o);return r.getStatus()===404&&(s=fB(t.path)),s.serverResponse=o.serverResponse,s}return n}function Tk(t,e,n){var r=e.fullServerUrl(),o=Zr(r,t.host),s="GET",u=t.maxOperationRetryTime,l=new mr(o,s,Yh(t,n),u);return l.errorHandler=Xh(e),l}function iq(t,e,n,r,o){var s={};e.isRoot?s.prefix="":s.prefix=e.path+"/",n.length>0&&(s.delimiter=n),r&&(s.pageToken=r),o&&(s.maxResults=o);var u=e.bucketOnlyServerUrl(),l=Zr(u,t.host),h="GET",d=t.maxOperationRetryTime,p=new mr(l,h,nq(t,e.bucket),d);return p.urlParams=s,p.errorHandler=ks(e),p}function oq(t,e,n){var r=e.fullServerUrl(),o=Zr(r,t.host),s="GET",u=t.maxOperationRetryTime,l=new mr(o,s,rq(t,n),u);return l.errorHandler=Xh(e),l}function sq(t,e,n,r){var o=e.fullServerUrl(),s=Zr(o,t.host),u="PATCH",l=ay(n,r),h={"Content-Type":"application/json; charset=utf-8"},d=t.maxOperationRetryTime,p=new mr(s,u,Yh(t,r),d);return p.headers=h,p.body=l,p.errorHandler=Xh(e),p}function aq(t,e){var n=e.fullServerUrl(),r=Zr(n,t.host),o="DELETE",s=t.maxOperationRetryTime;function u(h,d){}var l=new mr(r,o,u,s);return l.successCodes=[200,204],l.errorHandler=Xh(e),l}function uq(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function Sk(t,e,n){var r=Object.assign({},n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=uq(null,e)),r}function cq(t,e,n,r,o){var s=e.bucketOnlyServerUrl(),u={"X-Goog-Upload-Protocol":"multipart"};function l(){for(var M="",H=0;H<2;H++)M=M+Math.random().toString().slice(2);return M}var h=l();u["Content-Type"]="multipart/related; boundary="+h;var d=Sk(e,r,o),p=ay(d,n),g="--"+h+`\r
Content-Type: application/json; charset=utf-8\r
\r
`+p+`\r
--`+h+`\r
Content-Type: `+d.contentType+`\r
\r
`,y=`\r
--`+h+"--",w=oy.getBlob(g,r,y);if(w===null)throw pk();var b={name:d.fullPath},E=Zr(s,t.host),T="POST",k=t.maxUploadRetryTime,O=new mr(E,T,Yh(t,n),k);return O.urlParams=b,O.headers=u,O.body=w.uploadData(),O.errorHandler=ks(e),O}var zl=function(){function t(e,n,r,o){this.current=e,this.total=n,this.finalized=!!r,this.metadata=o||null}return t}();function uy(t,e){var n=null;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch{Hn(!1)}var r=e||["active"];return Hn(!!n&&r.indexOf(n)!==-1),n}function lq(t,e,n,r,o){var s=e.bucketOnlyServerUrl(),u=Sk(e,r,o),l={name:u.fullPath},h=Zr(s,t.host),d="POST",p={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":""+r.size(),"X-Goog-Upload-Header-Content-Type":u.contentType,"Content-Type":"application/json; charset=utf-8"},g=ay(u,n),y=t.maxUploadRetryTime;function w(E){uy(E);var T;try{T=E.getResponseHeader("X-Goog-Upload-URL")}catch{Hn(!1)}return Hn($h(T)),T}var b=new mr(h,d,w,y);return b.urlParams=l,b.headers=p,b.body=g,b.errorHandler=ks(e),b}function hq(t,e,n,r){var o={"X-Goog-Upload-Command":"query"};function s(d){var p=uy(d,["active","final"]),g=null;try{g=d.getResponseHeader("X-Goog-Upload-Size-Received")}catch{Hn(!1)}g||Hn(!1);var y=Number(g);return Hn(!isNaN(y)),new zl(y,r.size(),p==="final")}var u="POST",l=t.maxUploadRetryTime,h=new mr(n,u,s,l);return h.headers=o,h.errorHandler=ks(e),h}var IE=256*1024;function fq(t,e,n,r,o,s,u,l){var h=new zl(0,0);if(u?(h.current=u.current,h.total=u.total):(h.current=0,h.total=r.size()),r.size()!==h.total)throw bB();var d=h.total-h.current,p=d;o>0&&(p=Math.min(p,o));var g=h.current,y=g+p,w=p===d?"upload, finalize":"upload",b={"X-Goog-Upload-Command":w,"X-Goog-Upload-Offset":""+h.current},E=r.slice(g,y);if(E===null)throw pk();function T(H,X){var F=uy(H,["active","final"]),me=h.current+p,$=r.size(),Fe;return F==="final"?Fe=Yh(e,s)(H,X):Fe=null,new zl(me,$,F==="final",Fe)}var k="POST",O=e.maxUploadRetryTime,M=new mr(n,k,T,O);return M.headers=b,M.body=E.uploadData(),M.progressCallback=l||null,M.errorHandler=ks(t),M}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var dq=function(){function t(e,n,r){var o=MB(e)||n!=null||r!=null;if(o)this.next=e,this.error=n,this.complete=r;else{var s=e;this.next=s.next,this.error=s.error,this.complete=s.complete}}return t}();/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mo(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];Promise.resolve().then(function(){return t.apply(void 0,e)})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ck=function(){function t(e,n,r){var o=this;r===void 0&&(r=null),this._transferred=0,this._needToFetchStatus=!1,this._needToFetchMetadata=!1,this._observers=[],this._error=void 0,this._uploadUrl=void 0,this._request=void 0,this._chunkMultiplier=1,this._resolve=void 0,this._reject=void 0,this._ref=e,this._blob=n,this._metadata=r,this._mappings=Qh(),this._resumable=this._shouldDoResumable(this._blob),this._state="running",this._errorHandler=function(s){o._request=void 0,o._chunkMultiplier=1,s._codeEquals("canceled")?(o._needToFetchStatus=!0,o.completeTransitions_()):(o._error=s,o._transition("error"))},this._metadataErrorHandler=function(s){o._request=void 0,s._codeEquals("canceled")?o.completeTransitions_():(o._error=s,o._transition("error"))},this._promise=new Promise(function(s,u){o._resolve=s,o._reject=u,o._start()}),this._promise.then(null,function(){})}return t.prototype._makeProgressCallback=function(){var e=this,n=this._transferred;return function(r){return e._updateProgress(n+r)}},t.prototype._shouldDoResumable=function(e){return e.size()>256*1024},t.prototype._start=function(){this._state==="running"&&this._request===void 0&&(this._resumable?this._uploadUrl===void 0?this._createResumable():this._needToFetchStatus?this._fetchStatus():this._needToFetchMetadata?this._fetchMetadata():this._continueUpload():this._oneShotUpload())},t.prototype._resolveToken=function(e){var n=this;Promise.all([this._ref.storage._getAuthToken(),this._ref.storage._getAppCheckToken()]).then(function(r){var o=r[0],s=r[1];switch(n._state){case"running":e(o,s);break;case"canceling":n._transition("canceled");break;case"pausing":n._transition("paused");break}})},t.prototype._createResumable=function(){var e=this;this._resolveToken(function(n,r){var o=lq(e._ref.storage,e._ref._location,e._mappings,e._blob,e._metadata),s=e._ref.storage._makeRequest(o,n,r);e._request=s,s.getPromise().then(function(u){e._request=void 0,e._uploadUrl=u,e._needToFetchStatus=!1,e.completeTransitions_()},e._errorHandler)})},t.prototype._fetchStatus=function(){var e=this,n=this._uploadUrl;this._resolveToken(function(r,o){var s=hq(e._ref.storage,e._ref._location,n,e._blob),u=e._ref.storage._makeRequest(s,r,o);e._request=u,u.getPromise().then(function(l){l=l,e._request=void 0,e._updateProgress(l.current),e._needToFetchStatus=!1,l.finalized&&(e._needToFetchMetadata=!0),e.completeTransitions_()},e._errorHandler)})},t.prototype._continueUpload=function(){var e=this,n=IE*this._chunkMultiplier,r=new zl(this._transferred,this._blob.size()),o=this._uploadUrl;this._resolveToken(function(s,u){var l;try{l=fq(e._ref._location,e._ref.storage,o,e._blob,n,e._mappings,r,e._makeProgressCallback())}catch(d){e._error=d,e._transition("error");return}var h=e._ref.storage._makeRequest(l,s,u);e._request=h,h.getPromise().then(function(d){e._increaseMultiplier(),e._request=void 0,e._updateProgress(d.current),d.finalized?(e._metadata=d.metadata,e._transition("success")):e.completeTransitions_()},e._errorHandler)})},t.prototype._increaseMultiplier=function(){var e=IE*this._chunkMultiplier;e<32*1024*1024&&(this._chunkMultiplier*=2)},t.prototype._fetchMetadata=function(){var e=this;this._resolveToken(function(n,r){var o=Tk(e._ref.storage,e._ref._location,e._mappings),s=e._ref.storage._makeRequest(o,n,r);e._request=s,s.getPromise().then(function(u){e._request=void 0,e._metadata=u,e._transition("success")},e._metadataErrorHandler)})},t.prototype._oneShotUpload=function(){var e=this;this._resolveToken(function(n,r){var o=cq(e._ref.storage,e._ref._location,e._mappings,e._blob,e._metadata),s=e._ref.storage._makeRequest(o,n,r);e._request=s,s.getPromise().then(function(u){e._request=void 0,e._metadata=u,e._updateProgress(e._blob.size()),e._transition("success")},e._errorHandler)})},t.prototype._updateProgress=function(e){var n=this._transferred;this._transferred=e,this._transferred!==n&&this._notifyObservers()},t.prototype._transition=function(e){if(this._state!==e)switch(e){case"canceling":this._state=e,this._request!==void 0&&this._request.cancel();break;case"pausing":this._state=e,this._request!==void 0&&this._request.cancel();break;case"running":var n=this._state==="paused";this._state=e,n&&(this._notifyObservers(),this._start());break;case"paused":this._state=e,this._notifyObservers();break;case"canceled":this._error=dk(),this._state=e,this._notifyObservers();break;case"error":this._state=e,this._notifyObservers();break;case"success":this._state=e,this._notifyObservers();break}},t.prototype.completeTransitions_=function(){switch(this._state){case"pausing":this._transition("paused");break;case"canceling":this._transition("canceled");break;case"running":this._start();break}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var e=iv(this._state);return{bytesTransferred:this._transferred,totalBytes:this._blob.size(),state:e,metadata:this._metadata,task:this,ref:this._ref}},enumerable:!1,configurable:!0}),t.prototype.on=function(e,n,r,o){var s=this,u=new dq(n,r,o);return this._addObserver(u),function(){s._removeObserver(u)}},t.prototype.then=function(e,n){return this._promise.then(e,n)},t.prototype.catch=function(e){return this.then(null,e)},t.prototype._addObserver=function(e){this._observers.push(e),this._notifyObserver(e)},t.prototype._removeObserver=function(e){var n=this._observers.indexOf(e);n!==-1&&this._observers.splice(n,1)},t.prototype._notifyObservers=function(){var e=this;this._finishPromise();var n=this._observers.slice();n.forEach(function(r){e._notifyObserver(r)})},t.prototype._finishPromise=function(){if(this._resolve!==void 0){var e=!0;switch(iv(this._state)){case Ct.SUCCESS:Mo(this._resolve.bind(null,this.snapshot))();break;case Ct.CANCELED:case Ct.ERROR:var n=this._reject;Mo(n.bind(null,this._error))();break;default:e=!1;break}e&&(this._resolve=void 0,this._reject=void 0)}},t.prototype._notifyObserver=function(e){var n=iv(this._state);switch(n){case Ct.RUNNING:case Ct.PAUSED:e.next&&Mo(e.next.bind(e,this.snapshot))();break;case Ct.SUCCESS:e.complete&&Mo(e.complete.bind(e))();break;case Ct.CANCELED:case Ct.ERROR:e.error&&Mo(e.error.bind(e,this._error))();break;default:e.error&&Mo(e.error.bind(e,this._error))()}},t.prototype.resume=function(){var e=this._state==="paused"||this._state==="pausing";return e&&this._transition("running"),e},t.prototype.pause=function(){var e=this._state==="running";return e&&this._transition("pausing"),e},t.prototype.cancel=function(){var e=this._state==="running"||this._state==="pausing";return e&&this._transition("canceling"),e},t}();/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Jh=function(){function t(e,n){this._service=e,n instanceof fn?this._location=n:this._location=fn.makeFromUrl(n,e.host)}return t.prototype.toString=function(){return"gs://"+this._location.bucket+"/"+this._location.path},t.prototype._newRef=function(e,n){return new t(e,n)},Object.defineProperty(t.prototype,"root",{get:function(){var e=new fn(this._location.bucket,"");return this._newRef(this._service,e)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._location.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._location.path},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return Ik(this._location.path)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this._service},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=zB(this._location.path);if(e===null)return null;var n=new fn(this._location.bucket,e);return new t(this._service,n)},enumerable:!1,configurable:!0}),t.prototype._throwIfRoot=function(e){if(this._location.path==="")throw gk(e)},t}();function pq(t,e,n){return t._throwIfRoot("uploadBytesResumable"),new Ck(t,new oy(e),n)}function vq(t){var e={prefixes:[],items:[]};return Ak(t,e).then(function(){return e})}function Ak(t,e,n){return A(this,void 0,void 0,function(){var r,o,s,u;return C(this,function(l){switch(l.label){case 0:return r={pageToken:n},[4,kk(t,r)];case 1:return o=l.sent(),(s=e.prefixes).push.apply(s,o.prefixes),(u=e.items).push.apply(u,o.items),o.nextPageToken==null?[3,3]:[4,Ak(t,e,o.nextPageToken)];case 2:l.sent(),l.label=3;case 3:return[2]}})})}function kk(t,e){return A(this,void 0,void 0,function(){var n,r;return C(this,function(o){switch(o.label){case 0:return e!=null&&typeof e.maxResults=="number"&&ng("options.maxResults",1,1e3,e.maxResults),n=e||{},r=iq(t.storage,t._location,"/",n.pageToken,n.maxResults),[4,t.storage.makeRequestWithTokens(r)];case 1:return[2,o.sent().getPromise()]}})})}function gq(t){return A(this,void 0,void 0,function(){var e;return C(this,function(n){switch(n.label){case 0:return t._throwIfRoot("getMetadata"),e=Tk(t.storage,t._location,Qh()),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise()]}})})}function mq(t,e){return A(this,void 0,void 0,function(){var n;return C(this,function(r){switch(r.label){case 0:return t._throwIfRoot("updateMetadata"),n=sq(t.storage,t._location,e,Qh()),[4,t.storage.makeRequestWithTokens(n)];case 1:return[2,r.sent().getPromise()]}})})}function yq(t){return A(this,void 0,void 0,function(){var e;return C(this,function(n){switch(n.label){case 0:return t._throwIfRoot("getDownloadURL"),e=oq(t.storage,t._location,Qh()),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise().then(function(r){if(r===null)throw IB();return r})]}})})}function _q(t){return A(this,void 0,void 0,function(){var e;return C(this,function(n){switch(n.label){case 0:return t._throwIfRoot("deleteObject"),e=aq(t.storage,t._location),[4,t.storage.makeRequestWithTokens(e)];case 1:return[2,n.sent().getPromise()]}})})}function Nk(t,e){var n=$B(t._location.path,e),r=new fn(t._location.bucket,n);return new Jh(t.storage,r)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function rg(t){return/^[A-Za-z]+:\/\//.test(t)}function wq(t,e){return new Jh(t,e)}function Rk(t,e){if(t instanceof Zh){var n=t;if(n._bucket==null)throw wB();var r=new Jh(n,n._bucket);return e!=null?Rk(r,e):r}else return e!==void 0?Nk(t,e):t}function bq(t,e){if(e&&rg(e)){if(t instanceof Zh)return wq(t,e);throw Wo("To use ref(service, url), the first argument must be a Storage instance.")}else return Rk(t,e)}function EE(t,e){var n=e==null?void 0:e[fk];return n==null?null:fn.makeFromBucketSpec(n,t)}function Iq(t,e,n,r){r===void 0&&(r={}),t.host="http://"+e+":"+n;var o=r.mockUserToken;o&&(t._overrideAuthToken=typeof o=="string"?o:ug(o,t.app.options.projectId))}var Zh=function(){function t(e,n,r,o,s,u){this.app=e,this._authProvider=n,this._appCheckProvider=r,this._pool=o,this._url=s,this._firebaseVersion=u,this._bucket=null,this._host=hk,this._appId=null,this._deleted=!1,this._maxOperationRetryTime=lB,this._maxUploadRetryTime=hB,this._requests=new Set,s!=null?this._bucket=fn.makeFromBucketSpec(s,this._host):this._bucket=EE(this._host,this.app.options)}return Object.defineProperty(t.prototype,"host",{get:function(){return this._host},set:function(e){this._host=e,this._url!=null?this._bucket=fn.makeFromBucketSpec(this._url,e):this._bucket=EE(e,this.app.options)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._maxUploadRetryTime},set:function(e){ng("time",0,Number.POSITIVE_INFINITY,e),this._maxUploadRetryTime=e},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._maxOperationRetryTime},set:function(e){ng("time",0,Number.POSITIVE_INFINITY,e),this._maxOperationRetryTime=e},enumerable:!1,configurable:!0}),t.prototype._getAuthToken=function(){return A(this,void 0,void 0,function(){var e,n;return C(this,function(r){switch(r.label){case 0:return this._overrideAuthToken?[2,this._overrideAuthToken]:(e=this._authProvider.getImmediate({optional:!0}),e?[4,e.getToken()]:[3,2]);case 1:if(n=r.sent(),n!==null)return[2,n.accessToken];r.label=2;case 2:return[2,null]}})})},t.prototype._getAppCheckToken=function(){return A(this,void 0,void 0,function(){var e,n;return C(this,function(r){switch(r.label){case 0:return e=this._appCheckProvider.getImmediate({optional:!0}),e?[4,e.getToken()]:[3,2];case 1:return n=r.sent(),[2,n.token];case 2:return[2,null]}})})},t.prototype._delete=function(){return this._deleted||(this._deleted=!0,this._requests.forEach(function(e){return e.cancel()}),this._requests.clear()),Promise.resolve()},t.prototype._makeStorageReference=function(e){return new Jh(this,e)},t.prototype._makeRequest=function(e,n,r){var o=this;if(this._deleted)return new OB(vk());var s=GB(e,this._appId,n,r,this._pool,this._firebaseVersion);return this._requests.add(s),s.getPromise().then(function(){return o._requests.delete(s)},function(){return o._requests.delete(s)}),s},t.prototype.makeRequestWithTokens=function(e){return A(this,void 0,void 0,function(){var n,r,o;return C(this,function(s){switch(s.label){case 0:return[4,Promise.all([this._getAuthToken(),this._getAppCheckToken()])];case 1:return n=s.sent(),r=n[0],o=n[1],[2,this._makeRequest(e,r,o)]}})})},t}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Eq(t,e,n){return t=re(t),pq(t,e,n)}function Tq(t){return t=re(t),gq(t)}function Sq(t,e){return t=re(t),mq(t,e)}function Cq(t,e){return t=re(t),kk(t,e)}function Aq(t){return t=re(t),vq(t)}function kq(t){return t=re(t),yq(t)}function Nq(t){return t=re(t),_q(t)}function TE(t,e){return t=re(t),bq(t,e)}function Rq(t,e){return Nk(t,e)}function Dq(t,e,n,r){r===void 0&&(r={}),Iq(t,e,n,r)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xc=function(){function t(e,n,r){this._delegate=e,this.task=n,this.ref=r}return Object.defineProperty(t.prototype,"bytesTransferred",{get:function(){return this._delegate.bytesTransferred},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return this._delegate.metadata},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"state",{get:function(){return this._delegate.state},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"totalBytes",{get:function(){return this._delegate.totalBytes},enumerable:!1,configurable:!0}),t}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var SE=function(){function t(e,n){this._delegate=e,this._ref=n,this.cancel=this._delegate.cancel.bind(this._delegate),this.catch=this._delegate.catch.bind(this._delegate),this.pause=this._delegate.pause.bind(this._delegate),this.resume=this._delegate.resume.bind(this._delegate)}return Object.defineProperty(t.prototype,"snapshot",{get:function(){return new Xc(this._delegate.snapshot,this,this._ref)},enumerable:!1,configurable:!0}),t.prototype.then=function(e,n){var r=this;return this._delegate.then(function(o){if(e)return e(new Xc(o,r,r._ref))},n)},t.prototype.on=function(e,n,r,o){var s=this,u=void 0;return n&&(typeof n=="function"?u=function(l){return n(new Xc(l,s,s._ref))}:u={next:n.next?function(l){return n.next(new Xc(l,s,s._ref))}:void 0,complete:n.complete||void 0,error:n.error||void 0}),this._delegate.on(e,u,r||void 0,o||void 0)},t}(),CE=function(){function t(e,n){this._delegate=e,this._service=n}return Object.defineProperty(t.prototype,"prefixes",{get:function(){var e=this;return this._delegate.prefixes.map(function(n){return new su(n,e._service)})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"items",{get:function(){var e=this;return this._delegate.items.map(function(n){return new su(n,e._service)})},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"nextPageToken",{get:function(){return this._delegate.nextPageToken||null},enumerable:!1,configurable:!0}),t}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *  http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var su=function(){function t(e,n){this._delegate=e,this.storage=n}return Object.defineProperty(t.prototype,"name",{get:function(){return this._delegate.name},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this._delegate.bucket},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this._delegate.fullPath},enumerable:!1,configurable:!0}),t.prototype.toString=function(){return this._delegate.toString()},t.prototype.child=function(e){var n=Rq(this._delegate,e);return new t(n,this.storage)},Object.defineProperty(t.prototype,"root",{get:function(){return new t(this._delegate.root,this.storage)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){var e=this._delegate.parent;return e==null?null:new t(e,this.storage)},enumerable:!1,configurable:!0}),t.prototype.put=function(e,n){return this._throwIfRoot("put"),new SE(Eq(this._delegate,e,n),this)},t.prototype.putString=function(e,n,r){n===void 0&&(n=hn.RAW),this._throwIfRoot("putString");var o=mk(n,e),s=at({},r);return s.contentType==null&&o.contentType!=null&&(s.contentType=o.contentType),new SE(new Ck(this._delegate,new oy(o.data,!0),s),this)},t.prototype.listAll=function(){var e=this;return Aq(this._delegate).then(function(n){return new CE(n,e.storage)})},t.prototype.list=function(e){var n=this;return Cq(this._delegate,e||void 0).then(function(r){return new CE(r,n.storage)})},t.prototype.getMetadata=function(){return Tq(this._delegate)},t.prototype.updateMetadata=function(e){return Sq(this._delegate,e)},t.prototype.getDownloadURL=function(){return kq(this._delegate)},t.prototype.delete=function(){return this._throwIfRoot("delete"),Nq(this._delegate)},t.prototype._throwIfRoot=function(e){if(this._delegate._location.path==="")throw gk(e)},t}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Oq=function(){function t(e,n){this.app=e,this._delegate=n}return Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this._delegate.maxOperationRetryTime},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this._delegate.maxUploadRetryTime},enumerable:!1,configurable:!0}),t.prototype.ref=function(e){if(rg(e))throw Wo("ref() expected a child path but got a URL, use refFromURL instead.");return new su(TE(this._delegate,e),this)},t.prototype.refFromURL=function(e){if(!rg(e))throw Wo("refFromURL() expected a full URL but got a child path, use ref() instead.");try{fn.makeFromUrl(e,this._delegate.host)}catch{throw Wo("refFromUrl() expected a valid full URL but got an invalid one.")}return new su(TE(this._delegate,e),this)},t.prototype.setMaxUploadRetryTime=function(e){this._delegate.maxUploadRetryTime=e},t.prototype.setMaxOperationRetryTime=function(e){this._delegate.maxOperationRetryTime=e},t.prototype.useEmulator=function(e,n,r){r===void 0&&(r={}),Dq(this._delegate,e,n,r)},t}(),Pq="@firebase/storage",xq="0.7.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Lq="storage";function Mq(t,e){var n=e.instanceIdentifier,r=t.getProvider("app").getImmediate(),o=t.getProvider("auth-internal"),s=t.getProvider("app-check-internal"),u=new Oq(r,new Zh(r,o,s,new DB,n,J.SDK_VERSION));return u}function Fq(t){var e={TaskState:Ct,TaskEvent:kB,StringFormat:hn,Storage:Zh,Reference:su};t.INTERNAL.registerComponent(new Kn(Lq,Mq,"PUBLIC").setServiceProps(e).setMultipleInstances(!0)),t.registerVersion(Pq,xq)}Fq(J);var Uq="@firebase/installations",Dk="0.4.32";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Ok=1e4,Pk="w:"+Dk,xk="FIS_v2",Vq="https://firebaseinstallations.googleapis.com/v1",jq=60*60*1e3,Bq="installations",qq="Installations";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Rr,Gq=(Rr={},Rr["missing-app-config-values"]='Missing App configuration value: "{$valueName}"',Rr["not-registered"]="Firebase Installation is not registered.",Rr["installation-not-found"]="Firebase Installation not found.",Rr["request-failed"]='{$requestName} request failed with error "{$serverCode} {$serverStatus}: {$serverMessage}"',Rr["app-offline"]="Could not process request. Application offline.",Rr["delete-pending-registration"]="Can't delete installation while there is a pending registration request.",Rr),vr=new au(Bq,qq,Gq);function Lk(t){return t instanceof Ql&&t.code.includes("request-failed")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function cy(t){var e=t.projectId;return Vq+"/projects/"+e+"/installations"}function Mk(t){return{token:t.token,requestStatus:2,expiresIn:Wq(t.expiresIn),creationTime:Date.now()}}function ly(t,e){return A(this,void 0,void 0,function(){var n,r;return C(this,function(o){switch(o.label){case 0:return[4,e.json()];case 1:return n=o.sent(),r=n.error,[2,vr.create("request-failed",{requestName:t,serverCode:r.code,serverMessage:r.message,serverStatus:r.status})]}})})}function Fk(t){var e=t.apiKey;return new Headers({"Content-Type":"application/json",Accept:"application/json","x-goog-api-key":e})}function Uk(t,e){var n=e.refreshToken,r=Fk(t);return r.append("Authorization",Hq(n)),r}function hy(t){return A(this,void 0,void 0,function(){var e;return C(this,function(n){switch(n.label){case 0:return[4,t()];case 1:return e=n.sent(),e.status>=500&&e.status<600?[2,t()]:[2,e]}})})}function Wq(t){return Number(t.replace("s","000"))}function Hq(t){return xk+" "+t}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Kq(t,e){var n=e.fid;return A(this,void 0,void 0,function(){var r,o,s,u,l,h,d;return C(this,function(p){switch(p.label){case 0:return r=cy(t),o=Fk(t),s={fid:n,authVersion:xk,appId:t.appId,sdkVersion:Pk},u={method:"POST",headers:o,body:JSON.stringify(s)},[4,hy(function(){return fetch(r,u)})];case 1:return l=p.sent(),l.ok?[4,l.json()]:[3,3];case 2:return h=p.sent(),d={fid:h.fid||n,registrationStatus:2,refreshToken:h.refreshToken,authToken:Mk(h.authToken)},[2,d];case 3:return[4,ly("Create Installation",l)];case 4:throw p.sent()}})})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Vk(t){return new Promise(function(e){setTimeout(e,t)})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zq(t){var e=btoa(String.fromCharCode.apply(String,ve([],gt(t))));return e.replace(/\+/g,"-").replace(/\//g,"_")}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var $q=/^[cdef][\w-]{21}$/,ig="";function Qq(){try{var t=new Uint8Array(17),e=self.crypto||self.msCrypto;e.getRandomValues(t),t[0]=112+t[0]%16;var n=Yq(t);return $q.test(n)?n:ig}catch{return ig}}function Yq(t){var e=zq(t);return e.substr(0,22)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Ns(t){return t.appName+"!"+t.appId}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var ps=new Map;function jk(t,e){var n=Ns(t);Bk(n,e),Zq(n,e)}function Xq(t,e){qk();var n=Ns(t),r=ps.get(n);r||(r=new Set,ps.set(n,r)),r.add(e)}function Jq(t,e){var n=Ns(t),r=ps.get(n);r&&(r.delete(e),r.size===0&&ps.delete(n),Gk())}function Bk(t,e){var n,r,o=ps.get(t);if(o)try{for(var s=Ot(o),u=s.next();!u.done;u=s.next()){var l=u.value;l(e)}}catch(h){n={error:h}}finally{try{u&&!u.done&&(r=s.return)&&r.call(s)}finally{if(n)throw n.error}}}function Zq(t,e){var n=qk();n&&n.postMessage({key:t,fid:e}),Gk()}var Oi=null;function qk(){return!Oi&&"BroadcastChannel"in self&&(Oi=new BroadcastChannel("[Firebase] FID Change"),Oi.onmessage=function(t){Bk(t.data.key,t.data.fid)}),Oi}function Gk(){ps.size===0&&Oi&&(Oi.close(),Oi=null)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var eG="firebase-installations-database",tG=1,Qi="firebase-installations-store",ov=null;function fy(){return ov||(ov=tO(eG,tG,function(t){switch(t.oldVersion){case 0:t.createObjectStore(Qi)}})),ov}function $l(t,e){return A(this,void 0,void 0,function(){var n,r,o,s,u;return C(this,function(l){switch(l.label){case 0:return n=Ns(t),[4,fy()];case 1:return r=l.sent(),o=r.transaction(Qi,"readwrite"),s=o.objectStore(Qi),[4,s.get(n)];case 2:return u=l.sent(),[4,s.put(e,n)];case 3:return l.sent(),[4,o.complete];case 4:return l.sent(),(!u||u.fid!==e.fid)&&jk(t,e.fid),[2,e]}})})}function dy(t){return A(this,void 0,void 0,function(){var e,n,r;return C(this,function(o){switch(o.label){case 0:return e=Ns(t),[4,fy()];case 1:return n=o.sent(),r=n.transaction(Qi,"readwrite"),[4,r.objectStore(Qi).delete(e)];case 2:return o.sent(),[4,r.complete];case 3:return o.sent(),[2]}})})}function xu(t,e){return A(this,void 0,void 0,function(){var n,r,o,s,u,l;return C(this,function(h){switch(h.label){case 0:return n=Ns(t),[4,fy()];case 1:return r=h.sent(),o=r.transaction(Qi,"readwrite"),s=o.objectStore(Qi),[4,s.get(n)];case 2:return u=h.sent(),l=e(u),l!==void 0?[3,4]:[4,s.delete(n)];case 3:return h.sent(),[3,6];case 4:return[4,s.put(l,n)];case 5:h.sent(),h.label=6;case 6:return[4,o.complete];case 7:return h.sent(),l&&(!u||u.fid!==l.fid)&&jk(t,l.fid),[2,l]}})})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function py(t){return A(this,void 0,void 0,function(){var e,n,r;return C(this,function(o){switch(o.label){case 0:return[4,xu(t,function(s){var u=nG(s),l=rG(t,u);return e=l.registrationPromise,l.installationEntry})];case 1:return n=o.sent(),n.fid!==ig?[3,3]:(r={},[4,e]);case 2:return[2,(r.installationEntry=o.sent(),r)];case 3:return[2,{installationEntry:n,registrationPromise:e}]}})})}function nG(t){var e=t||{fid:Qq(),registrationStatus:0};return Wk(e)}function rG(t,e){if(e.registrationStatus===0){if(!navigator.onLine){var n=Promise.reject(vr.create("app-offline"));return{installationEntry:e,registrationPromise:n}}var r={fid:e.fid,registrationStatus:1,registrationTime:Date.now()},o=iG(t,r);return{installationEntry:r,registrationPromise:o}}else return e.registrationStatus===1?{installationEntry:e,registrationPromise:oG(t)}:{installationEntry:e}}function iG(t,e){return A(this,void 0,void 0,function(){var n,r;return C(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,7]),[4,Kq(t,e)];case 1:return n=o.sent(),[2,$l(t,n)];case 2:return r=o.sent(),Lk(r)&&r.customData.serverCode===409?[4,dy(t)]:[3,4];case 3:return o.sent(),[3,6];case 4:return[4,$l(t,{fid:e.fid,registrationStatus:0})];case 5:o.sent(),o.label=6;case 6:throw r;case 7:return[2]}})})}function oG(t){return A(this,void 0,void 0,function(){var e,n,r,o;return C(this,function(s){switch(s.label){case 0:return[4,AE(t)];case 1:e=s.sent(),s.label=2;case 2:return e.registrationStatus!==1?[3,5]:[4,Vk(100)];case 3:return s.sent(),[4,AE(t)];case 4:return e=s.sent(),[3,2];case 5:return e.registrationStatus!==0?[3,7]:[4,py(t)];case 6:return n=s.sent(),r=n.installationEntry,o=n.registrationPromise,o?[2,o]:[2,r];case 7:return[2,e]}})})}function AE(t){return xu(t,function(e){if(!e)throw vr.create("installation-not-found");return Wk(e)})}function Wk(t){return sG(t)?{fid:t.fid,registrationStatus:0}:t}function sG(t){return t.registrationStatus===1&&t.registrationTime+Ok<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function aG(t,e){var n=t.appConfig,r=t.platformLoggerProvider;return A(this,void 0,void 0,function(){var o,s,u,l,h,d,p,g;return C(this,function(y){switch(y.label){case 0:return o=uG(n,e),s=Uk(n,e),u=r.getImmediate({optional:!0}),u&&s.append("x-firebase-client",u.getPlatformInfoString()),l={installation:{sdkVersion:Pk}},h={method:"POST",headers:s,body:JSON.stringify(l)},[4,hy(function(){return fetch(o,h)})];case 1:return d=y.sent(),d.ok?[4,d.json()]:[3,3];case 2:return p=y.sent(),g=Mk(p),[2,g];case 3:return[4,ly("Generate Auth Token",d)];case 4:throw y.sent()}})})}function uG(t,e){var n=e.fid;return cy(t)+"/"+n+"/authTokens:generate"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vy(t,e){return e===void 0&&(e=!1),A(this,void 0,void 0,function(){var n,r,o,s;return C(this,function(u){switch(u.label){case 0:return[4,xu(t.appConfig,function(l){if(!Hk(l))throw vr.create("not-registered");var h=l.authToken;if(!e&&hG(h))return l;if(h.requestStatus===1)return n=cG(t,e),l;if(!navigator.onLine)throw vr.create("app-offline");var d=dG(l);return n=lG(t,d),d})];case 1:return r=u.sent(),n?[4,n]:[3,3];case 2:return s=u.sent(),[3,4];case 3:s=r.authToken,u.label=4;case 4:return o=s,[2,o]}})})}function cG(t,e){return A(this,void 0,void 0,function(){var n,r;return C(this,function(o){switch(o.label){case 0:return[4,kE(t.appConfig)];case 1:n=o.sent(),o.label=2;case 2:return n.authToken.requestStatus!==1?[3,5]:[4,Vk(100)];case 3:return o.sent(),[4,kE(t.appConfig)];case 4:return n=o.sent(),[3,2];case 5:return r=n.authToken,r.requestStatus===0?[2,vy(t,e)]:[2,r]}})})}function kE(t){return xu(t,function(e){if(!Hk(e))throw vr.create("not-registered");var n=e.authToken;return pG(n)?at(at({},e),{authToken:{requestStatus:0}}):e})}function lG(t,e){return A(this,void 0,void 0,function(){var n,o,r,o;return C(this,function(s){switch(s.label){case 0:return s.trys.push([0,3,,8]),[4,aG(t,e)];case 1:return n=s.sent(),o=at(at({},e),{authToken:n}),[4,$l(t.appConfig,o)];case 2:return s.sent(),[2,n];case 3:return r=s.sent(),Lk(r)&&(r.customData.serverCode===401||r.customData.serverCode===404)?[4,dy(t.appConfig)]:[3,5];case 4:return s.sent(),[3,7];case 5:return o=at(at({},e),{authToken:{requestStatus:0}}),[4,$l(t.appConfig,o)];case 6:s.sent(),s.label=7;case 7:throw r;case 8:return[2]}})})}function Hk(t){return t!==void 0&&t.registrationStatus===2}function hG(t){return t.requestStatus===2&&!fG(t)}function fG(t){var e=Date.now();return e<t.creationTime||t.creationTime+t.expiresIn<e+jq}function dG(t){var e={requestStatus:1,requestTime:Date.now()};return at(at({},t),{authToken:e})}function pG(t){return t.requestStatus===1&&t.requestTime+Ok<Date.now()}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function vG(t){return A(this,void 0,void 0,function(){var e,n,r;return C(this,function(o){switch(o.label){case 0:return[4,py(t.appConfig)];case 1:return e=o.sent(),n=e.installationEntry,r=e.registrationPromise,r?r.catch(console.error):vy(t).catch(console.error),[2,n.fid]}})})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gG(t,e){return e===void 0&&(e=!1),A(this,void 0,void 0,function(){var n;return C(this,function(r){switch(r.label){case 0:return[4,mG(t.appConfig)];case 1:return r.sent(),[4,vy(t,e)];case 2:return n=r.sent(),[2,n.token]}})})}function mG(t){return A(this,void 0,void 0,function(){var e;return C(this,function(n){switch(n.label){case 0:return[4,py(t)];case 1:return e=n.sent().registrationPromise,e?[4,e]:[3,3];case 2:n.sent(),n.label=3;case 3:return[2]}})})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function yG(t,e){return A(this,void 0,void 0,function(){var n,r,o,s;return C(this,function(u){switch(u.label){case 0:return n=_G(t,e),r=Uk(t,e),o={method:"DELETE",headers:r},[4,hy(function(){return fetch(n,o)})];case 1:return s=u.sent(),s.ok?[3,3]:[4,ly("Delete Installation",s)];case 2:throw u.sent();case 3:return[2]}})})}function _G(t,e){var n=e.fid;return cy(t)+"/"+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function wG(t){return A(this,void 0,void 0,function(){var e,n;return C(this,function(r){switch(r.label){case 0:return e=t.appConfig,[4,xu(e,function(o){if(!(o&&o.registrationStatus===0))return o})];case 1:if(n=r.sent(),!n)return[3,6];if(n.registrationStatus!==1)return[3,2];throw vr.create("delete-pending-registration");case 2:if(n.registrationStatus!==2)return[3,6];if(navigator.onLine)return[3,3];throw vr.create("app-offline");case 3:return[4,yG(e,n)];case 4:return r.sent(),[4,dy(e)];case 5:r.sent(),r.label=6;case 6:return[2]}})})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function bG(t,e){var n=t.appConfig;return Xq(n,e),function(){Jq(n,e)}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function IG(t){var e,n;if(!t||!t.options)throw sv("App Configuration");if(!t.name)throw sv("App Name");var r=["projectId","apiKey","appId"];try{for(var o=Ot(r),s=o.next();!s.done;s=o.next()){var u=s.value;if(!t.options[u])throw sv(u)}}catch(l){e={error:l}}finally{try{s&&!s.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}return{appName:t.name,projectId:t.options.projectId,apiKey:t.options.apiKey,appId:t.options.appId}}function sv(t){return vr.create("missing-app-config-values",{valueName:t})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EG(t){var e="installations";t.INTERNAL.registerComponent(new Kn(e,function(n){var r=n.getProvider("app").getImmediate(),o=IG(r),s=n.getProvider("platform-logger"),u={appConfig:o,platformLoggerProvider:s},l={app:r,getId:function(){return vG(u)},getToken:function(h){return gG(u,h)},delete:function(){return wG(u)},onIdChange:function(h){return bG(u,h)}};return l},"PUBLIC")),t.registerVersion(Uq,Dk)}EG(J);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var TG="firebase_id",SG="origin",CG=60*1e3,AG="https://firebase.googleapis.com/v1alpha/projects/-/apps/{app-id}/webConfig",Kk="https://www.googletagmanager.com/gtag/js",_t;(function(t){t.EVENT="event",t.SET="set",t.CONFIG="config"})(_t||(_t={}));var og;(function(t){t.ADD_SHIPPING_INFO="add_shipping_info",t.ADD_PAYMENT_INFO="add_payment_info",t.ADD_TO_CART="add_to_cart",t.ADD_TO_WISHLIST="add_to_wishlist",t.BEGIN_CHECKOUT="begin_checkout",t.CHECKOUT_PROGRESS="checkout_progress",t.EXCEPTION="exception",t.GENERATE_LEAD="generate_lead",t.LOGIN="login",t.PAGE_VIEW="page_view",t.PURCHASE="purchase",t.REFUND="refund",t.REMOVE_FROM_CART="remove_from_cart",t.SCREEN_VIEW="screen_view",t.SEARCH="search",t.SELECT_CONTENT="select_content",t.SELECT_ITEM="select_item",t.SELECT_PROMOTION="select_promotion",t.SET_CHECKOUT_OPTION="set_checkout_option",t.SHARE="share",t.SIGN_UP="sign_up",t.TIMING_COMPLETE="timing_complete",t.VIEW_CART="view_cart",t.VIEW_ITEM="view_item",t.VIEW_ITEM_LIST="view_item_list",t.VIEW_PROMOTION="view_promotion",t.VIEW_SEARCH_RESULTS="view_search_results"})(og||(og={}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kG(t,e,n,r,o){return A(this,void 0,void 0,function(){var s,u;return C(this,function(l){switch(l.label){case 0:return o&&o.global?(t(_t.EVENT,n,r),[2]):[3,1];case 1:return[4,e];case 2:s=l.sent(),u=at(at({},r),{send_to:s}),t(_t.EVENT,n,u),l.label=3;case 3:return[2]}})})}function NG(t,e,n,r){return A(this,void 0,void 0,function(){var o;return C(this,function(s){switch(s.label){case 0:return r&&r.global?(t(_t.SET,{screen_name:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:o=s.sent(),t(_t.CONFIG,o,{update:!0,screen_name:n}),s.label=3;case 3:return[2]}})})}function RG(t,e,n,r){return A(this,void 0,void 0,function(){var o;return C(this,function(s){switch(s.label){case 0:return r&&r.global?(t(_t.SET,{user_id:n}),[2,Promise.resolve()]):[3,1];case 1:return[4,e];case 2:o=s.sent(),t(_t.CONFIG,o,{update:!0,user_id:n}),s.label=3;case 3:return[2]}})})}function DG(t,e,n,r){return A(this,void 0,void 0,function(){var o,s,u,l,h;return C(this,function(d){switch(d.label){case 0:if(!(r&&r.global))return[3,1];for(o={},s=0,u=Object.keys(n);s<u.length;s++)l=u[s],o["user_properties."+l]=n[l];return t(_t.SET,o),[2,Promise.resolve()];case 1:return[4,e];case 2:h=d.sent(),t(_t.CONFIG,h,{update:!0,user_properties:n}),d.label=3;case 3:return[2]}})})}function OG(t,e){return A(this,void 0,void 0,function(){var n;return C(this,function(r){switch(r.label){case 0:return[4,t];case 1:return n=r.sent(),window["ga-disable-"+n]=!e,[2]}})})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var st=new Xl("@firebase/analytics");/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function PG(t,e){var n=document.createElement("script");n.src=Kk+"?l="+t+"&id="+e,n.async=!0,document.head.appendChild(n)}function xG(t){var e=[];return Array.isArray(window[t])?e=window[t]:window[t]=e,e}function LG(t,e,n,r,o,s){return A(this,void 0,void 0,function(){var u,l,h,d;return C(this,function(p){switch(p.label){case 0:u=r[o],p.label=1;case 1:return p.trys.push([1,7,,8]),u?[4,e[u]]:[3,3];case 2:return p.sent(),[3,6];case 3:return[4,Promise.all(n)];case 4:return l=p.sent(),h=l.find(function(g){return g.measurementId===o}),h?[4,e[h.appId]]:[3,6];case 5:p.sent(),p.label=6;case 6:return[3,8];case 7:return d=p.sent(),st.error(d),[3,8];case 8:return t(_t.CONFIG,o,s),[2]}})})}function MG(t,e,n,r,o){return A(this,void 0,void 0,function(){var s,u,l,h,d,p,g,y,w;return C(this,function(b){switch(b.label){case 0:return b.trys.push([0,4,,5]),s=[],o&&o.send_to?(u=o.send_to,Array.isArray(u)||(u=[u]),[4,Promise.all(n)]):[3,2];case 1:for(l=b.sent(),h=function(E){var T=l.find(function(O){return O.measurementId===E}),k=T&&e[T.appId];if(k)s.push(k);else return s=[],"break"},d=0,p=u;d<p.length&&(g=p[d],y=h(g),y!=="break");d++);b.label=2;case 2:return s.length===0&&(s=Object.values(e)),[4,Promise.all(s)];case 3:return b.sent(),t(_t.EVENT,r,o||{}),[3,5];case 4:return w=b.sent(),st.error(w),[3,5];case 5:return[2]}})})}function FG(t,e,n,r){function o(s,u,l){return A(this,void 0,void 0,function(){var h;return C(this,function(d){switch(d.label){case 0:return d.trys.push([0,6,,7]),s!==_t.EVENT?[3,2]:[4,MG(t,e,n,u,l)];case 1:return d.sent(),[3,5];case 2:return s!==_t.CONFIG?[3,4]:[4,LG(t,e,n,r,u,l)];case 3:return d.sent(),[3,5];case 4:t(_t.SET,u),d.label=5;case 5:return[3,7];case 6:return h=d.sent(),st.error(h),[3,7];case 7:return[2]}})})}return o}function UG(t,e,n,r,o){var s=function(){window[r].push(arguments)};return window[o]&&typeof window[o]=="function"&&(s=window[o]),window[o]=FG(s,t,e,n),{gtagCore:s,wrappedGtag:window[o]}}function VG(){for(var t=window.document.getElementsByTagName("script"),e=0,n=Object.values(t);e<n.length;e++){var r=n[e];if(r.src&&r.src.includes(Kk))return r}return null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Tn,jG=(Tn={},Tn["already-exists"]="A Firebase Analytics instance with the appId {$id}  already exists. Only one Firebase Analytics instance can be created for each appId.",Tn["already-initialized"]="Firebase Analytics has already been initialized.settings() must be called before initializing any Analytics instanceor it will have no effect.",Tn["interop-component-reg-failed"]="Firebase Analytics Interop Component failed to instantiate: {$reason}",Tn["invalid-analytics-context"]="Firebase Analytics is not supported in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",Tn["indexeddb-unavailable"]="IndexedDB unavailable or restricted in this environment. Wrap initialization of analytics in analytics.isSupported() to prevent initialization in unsupported environments. Details: {$errorInfo}",Tn["fetch-throttle"]="The config fetch request timed out while in an exponential backoff state. Unix timestamp in milliseconds when fetch request throttling ends: {$throttleEndTimeMillis}.",Tn["config-fetch-failed"]="Dynamic config fetch failed: [{$httpStatus}] {$responseMessage}",Tn["no-api-key"]='The "apiKey" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid API key.',Tn["no-app-id"]='The "appId" field is empty in the local Firebase config. Firebase Analytics requires this field tocontain a valid app ID.',Tn),dn=new au("analytics","Analytics",jG);/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var BG=30,qG=1e3,GG=function(){function t(e,n){e===void 0&&(e={}),n===void 0&&(n=qG),this.throttleMetadata=e,this.intervalMillis=n}return t.prototype.getThrottleMetadata=function(e){return this.throttleMetadata[e]},t.prototype.setThrottleMetadata=function(e,n){this.throttleMetadata[e]=n},t.prototype.deleteThrottleMetadata=function(e){delete this.throttleMetadata[e]},t}(),zk=new GG;function WG(t){return new Headers({Accept:"application/json","x-goog-api-key":t})}function HG(t){var e;return A(this,void 0,void 0,function(){var n,r,o,s,u,l,h;return C(this,function(d){switch(d.label){case 0:return n=t.appId,r=t.apiKey,o={method:"GET",headers:WG(r)},s=AG.replace("{app-id}",n),[4,fetch(s,o)];case 1:if(u=d.sent(),!(u.status!==200&&u.status!==304))return[3,6];l="",d.label=2;case 2:return d.trys.push([2,4,,5]),[4,u.json()];case 3:return h=d.sent(),!((e=h.error)===null||e===void 0)&&e.message&&(l=h.error.message),[3,5];case 4:return d.sent(),[3,5];case 5:throw dn.create("config-fetch-failed",{httpStatus:u.status,responseMessage:l});case 6:return[2,u.json()]}})})}function KG(t,e,n){return e===void 0&&(e=zk),A(this,void 0,void 0,function(){var r,o,s,u,l,h,d=this;return C(this,function(p){if(r=t.options,o=r.appId,s=r.apiKey,u=r.measurementId,!o)throw dn.create("no-app-id");if(!s){if(u)return[2,{measurementId:u,appId:o}];throw dn.create("no-api-key")}return l=e.getThrottleMetadata(o)||{backoffCount:0,throttleEndTimeMillis:Date.now()},h=new QG,setTimeout(function(){return A(d,void 0,void 0,function(){return C(this,function(g){return h.abort(),[2]})})},CG),[2,$k({appId:o,apiKey:s,measurementId:u},l,h,e)]})})}function $k(t,e,n,r){var o=e.throttleEndTimeMillis,s=e.backoffCount;return r===void 0&&(r=zk),A(this,void 0,void 0,function(){var u,l,h,d,p,g,y;return C(this,function(w){switch(w.label){case 0:u=t.appId,l=t.measurementId,w.label=1;case 1:return w.trys.push([1,3,,4]),[4,zG(n,o)];case 2:return w.sent(),[3,4];case 3:if(h=w.sent(),l)return st.warn("Timed out fetching this Firebase app's measurement ID from the server."+(" Falling back to the measurement ID "+l)+(' provided in the "measurementId" field in the local Firebase config. ['+h.message+"]")),[2,{appId:u,measurementId:l}];throw h;case 4:return w.trys.push([4,6,,7]),[4,HG(t)];case 5:return d=w.sent(),r.deleteThrottleMetadata(u),[2,d];case 6:if(p=w.sent(),!$G(p)){if(r.deleteThrottleMetadata(u),l)return st.warn("Failed to fetch this Firebase app's measurement ID from the server."+(" Falling back to the measurement ID "+l)+(' provided in the "measurementId" field in the local Firebase config. ['+p.message+"]")),[2,{appId:u,measurementId:l}];throw p}return g=Number(p.customData.httpStatus)===503?l0(s,r.intervalMillis,BG):l0(s,r.intervalMillis),y={throttleEndTimeMillis:Date.now()+g,backoffCount:s+1},r.setThrottleMetadata(u,y),st.debug("Calling attemptFetch again in "+g+" millis"),[2,$k(t,y,n,r)];case 7:return[2]}})})}function zG(t,e){return new Promise(function(n,r){var o=Math.max(e-Date.now(),0),s=setTimeout(n,o);t.addEventListener(function(){clearTimeout(s),r(dn.create("fetch-throttle",{throttleEndTimeMillis:e}))})})}function $G(t){if(!(t instanceof Ql)||!t.customData)return!1;var e=Number(t.customData.httpStatus);return e===429||e===500||e===503||e===504}var QG=function(){function t(){this.listeners=[]}return t.prototype.addEventListener=function(e){this.listeners.push(e)},t.prototype.abort=function(){this.listeners.forEach(function(e){return e()})},t}();/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function YG(){return A(this,void 0,void 0,function(){var t;return C(this,function(e){switch(e.label){case 0:return jE()?[3,1]:(st.warn(dn.create("indexeddb-unavailable",{errorInfo:"IndexedDB is not available in this environment."}).message),[2,!1]);case 1:return e.trys.push([1,3,,4]),[4,BE()];case 2:return e.sent(),[3,4];case 3:return t=e.sent(),st.warn(dn.create("indexeddb-unavailable",{errorInfo:t}).message),[2,!1];case 4:return[2,!0]}})})}function XG(t,e,n,r,o,s){return A(this,void 0,void 0,function(){var u,l,h,d,p,g,y;return C(this,function(w){switch(w.label){case 0:return u=KG(t),u.then(function(b){n[b.measurementId]=b.appId,t.options.measurementId&&b.measurementId!==t.options.measurementId&&st.warn("The measurement ID in the local Firebase config ("+t.options.measurementId+")"+(" does not match the measurement ID fetched from the server ("+b.measurementId+").")+" To ensure analytics events are always sent to the correct Analytics property, update the measurement ID field in the local config or remove it from the local config.")}).catch(function(b){return st.error(b)}),e.push(u),l=YG().then(function(b){if(b)return r.getId()}),[4,Promise.all([u,l])];case 1:return h=w.sent(),d=h[0],p=h[1],VG()||PG(s,d.measurementId),o("js",new Date),g=(y={},y[SG]="firebase",y.update=!0,y),p!=null&&(g[TG]=p),o(_t.CONFIG,d.measurementId,g),[2,d.measurementId]}})})}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var or={},NE=[],RE={},ol="dataLayer",Qk="gtag",DE,Ia,sg=!1;function JG(t){if(sg)throw dn.create("already-initialized");t.dataLayerName&&(ol=t.dataLayerName),t.gtagName&&(Qk=t.gtagName)}function ZG(){var t=[];if(lg()&&t.push("This is a browser extension environment."),qE()||t.push("Cookies are not available."),t.length>0){var e=t.map(function(r,o){return"("+(o+1)+") "+r}).join(" "),n=dn.create("invalid-analytics-context",{errorInfo:e});st.warn(n.message)}}function eW(t,e){ZG();var n=t.options.appId;if(!n)throw dn.create("no-app-id");if(!t.options.apiKey)if(t.options.measurementId)st.warn('The "apiKey" field is empty in the local Firebase config. This is needed to fetch the latest'+(" measurement ID for this Firebase app. Falling back to the measurement ID "+t.options.measurementId)+' provided in the "measurementId" field in the local Firebase config.');else throw dn.create("no-api-key");if(or[n]!=null)throw dn.create("already-exists",{id:n});if(!sg){xG(ol);var r=UG(or,NE,RE,ol,Qk),o=r.wrappedGtag,s=r.gtagCore;Ia=o,DE=s,sg=!0}or[n]=XG(t,NE,RE,e,DE,ol);var u={app:t,logEvent:function(l,h,d){kG(Ia,or[n],l,h,d).catch(function(p){return st.error(p)})},setCurrentScreen:function(l,h){NG(Ia,or[n],l,h).catch(function(d){return st.error(d)})},setUserId:function(l,h){RG(Ia,or[n],l,h).catch(function(d){return st.error(d)})},setUserProperties:function(l,h){DG(Ia,or[n],l,h).catch(function(d){return st.error(d)})},setAnalyticsCollectionEnabled:function(l){OG(or[n],l).catch(function(h){return st.error(h)})},INTERNAL:{delete:function(){return delete or[n],Promise.resolve()}}};return u}var tW="@firebase/analytics",nW="0.6.18",OE="analytics";function rW(t){t.INTERNAL.registerComponent(new Kn(OE,function(n){var r=n.getProvider("app").getImmediate(),o=n.getProvider("installations").getImmediate();return eW(r,o)},"PUBLIC").setServiceProps({settings:JG,EventName:og,isSupported:iW})),t.INTERNAL.registerComponent(new Kn("analytics-internal",e,"PRIVATE")),t.registerVersion(tW,nW);function e(n){try{var r=n.getProvider(OE).getImmediate();return{logEvent:r.logEvent}}catch(o){throw dn.create("interop-component-reg-failed",{reason:o})}}}rW(J);function iW(){return A(this,void 0,void 0,function(){var t;return C(this,function(e){switch(e.label){case 0:if(lg())return[2,!1];if(!qE())return[2,!1];if(!jE())return[2,!1];e.label=1;case 1:return e.trys.push([1,3,,4]),[4,BE()];case 2:return t=e.sent(),[2,t];case 3:return e.sent(),[2,!1];case 4:return[2]}})})}export{J as f};
